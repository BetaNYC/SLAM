var zd=Object.defineProperty;var jd=(i,e,t)=>e in i?zd(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Ie=(i,e,t)=>(jd(i,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();function xn(){}function Eh(i){return i()}function Qu(){return Object.create(null)}function Bs(i){i.forEach(Eh)}function Ah(i){return typeof i=="function"}function Vn(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}let za;function Hd(i,e){return za||(za=document.createElement("a")),za.href=e,i===za.href}function Ud(i){return Object.keys(i).length===0}function Wd(i,...e){if(i==null)return xn;const t=i.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Sl(i,e,t){i.$$.on_destroy.push(Wd(e,t))}function $e(i,e){i.appendChild(e)}function Kt(i,e,t){i.insertBefore(e,t||null)}function qt(i){i.parentNode&&i.parentNode.removeChild(i)}function Oh(i,e){for(let t=0;t<i.length;t+=1)i[t]&&i[t].d(e)}function yt(i){return document.createElement(i)}function Vd(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function Ml(i){return document.createTextNode(i)}function St(){return Ml(" ")}function Zd(){return Ml("")}function is(i,e,t,o){return i.addEventListener(e,t,o),()=>i.removeEventListener(e,t,o)}function qd(i){return function(e){return e.preventDefault(),i.call(this,e)}}function ct(i,e,t){t==null?i.removeAttribute(e):i.getAttribute(e)!==t&&i.setAttribute(e,t)}function Gd(i){return Array.from(i.childNodes)}function Yd(i,e){e=""+e,i.wholeText!==e&&(i.data=e)}function Ju(i,e){i.value=e??""}class $u{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,o=null){this.e||(this.is_svg?this.e=Vd(t.nodeName):this.e=yt(t.nodeName),this.t=t,this.c(e)),this.i(o)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)Kt(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(qt)}}let _a;function ca(i){_a=i}function Su(){if(!_a)throw new Error("Function called outside component initialization");return _a}function Kd(i){Su().$$.on_mount.push(i)}function Xd(i,e){return Su().$$.context.set(i,e),e}function $r(i){return Su().$$.context.get(i)}const ra=[],dl=[],tl=[],ec=[],Qd=Promise.resolve();let ou=!1;function Jd(){ou||(ou=!0,Qd.then(kh))}function su(i){tl.push(i)}const ql=new Set;let ja=0;function kh(){const i=_a;do{for(;ja<ra.length;){const e=ra[ja];ja++,ca(e),$d(e.$$)}for(ca(null),ra.length=0,ja=0;dl.length;)dl.pop()();for(let e=0;e<tl.length;e+=1){const t=tl[e];ql.has(t)||(ql.add(t),t())}tl.length=0}while(ra.length);for(;ec.length;)ec.pop()();ou=!1,ql.clear(),ca(i)}function $d(i){if(i.fragment!==null){i.update(),Bs(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(su)}}const nl=new Set;let rs;function pl(){rs={r:0,c:[],p:rs}}function gl(){rs.r||Bs(rs.c),rs=rs.p}function Vt(i,e){i&&i.i&&(nl.delete(i),i.i(e))}function en(i,e,t,o){if(i&&i.o){if(nl.has(i))return;nl.add(i),rs.c.push(()=>{nl.delete(i),o&&(t&&i.d(1),o())}),i.o(e)}else o&&o()}function ep(i,e){en(i,1,1,()=>{e.delete(i.key)})}function tp(i,e,t,o,n,s,a,c,d,l,f,p){let m=i.length,_=s.length,b=m;const x={};for(;b--;)x[i[b].key]=b;const A=[],S=new Map,E=new Map;for(b=_;b--;){const G=p(n,s,b),$=t(G);let Z=a.get($);Z?o&&Z.p(G,e):(Z=l($,G),Z.c()),S.set($,A[b]=Z),$ in x&&E.set($,Math.abs(b-x[$]))}const F=new Set,v=new Set;function P(G){Vt(G,1),G.m(c,f),a.set(G.key,G),f=G.first,_--}for(;m&&_;){const G=A[_-1],$=i[m-1],Z=G.key,ie=$.key;G===$?(f=G.first,m--,_--):S.has(ie)?!a.has(Z)||F.has(Z)?P(G):v.has(ie)?m--:E.get(Z)>E.get(ie)?(v.add(Z),P(G)):(F.add(ie),m--):(d($,a),m--)}for(;m--;){const G=i[m];S.has(G.key)||d(G,a)}for(;_;)P(A[_-1]);return A}function pi(i){i&&i.c()}function ii(i,e,t,o){const{fragment:n,after_update:s}=i.$$;n&&n.m(e,t),o||su(()=>{const a=i.$$.on_mount.map(Eh).filter(Ah);i.$$.on_destroy?i.$$.on_destroy.push(...a):Bs(a),i.$$.on_mount=[]}),s.forEach(su)}function ri(i,e){const t=i.$$;t.fragment!==null&&(Bs(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function np(i,e){i.$$.dirty[0]===-1&&(ra.push(i),Jd(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function ai(i,e,t,o,n,s,a,c=[-1]){const d=_a;ca(i);const l=i.$$={fragment:null,ctx:[],props:s,update:xn,not_equal:n,bound:Qu(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:Qu(),dirty:c,skip_bound:!1,root:e.target||d.$$.root};a&&a(l.root);let f=!1;if(l.ctx=t?t(i,e.props||{},(p,m,..._)=>{const b=_.length?_[0]:m;return l.ctx&&n(l.ctx[p],l.ctx[p]=b)&&(!l.skip_bound&&l.bound[p]&&l.bound[p](b),f&&np(i,p)),m}):[],l.update(),f=!0,Bs(l.before_update),l.fragment=o?o(l.ctx):!1,e.target){if(e.hydrate){const p=Gd(e.target);l.fragment&&l.fragment.l(p),p.forEach(qt)}else l.fragment&&l.fragment.c();e.intro&&Vt(i.$$.fragment),ii(i,e.target,e.anchor,e.customElement),kh()}ca(d)}class li{$destroy(){ri(this,1),this.$destroy=xn}$on(e,t){if(!Ah(t))return xn;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(t),()=>{const n=o.indexOf(t);n!==-1&&o.splice(n,1)}}$set(e){this.$$set&&!Ud(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ts=[];function Tl(i,e=xn){let t;const o=new Set;function n(c){if(Vn(i,c)&&(i=c,t)){const d=!Ts.length;for(const l of o)l[1](),Ts.push(l,i);if(d){for(let l=0;l<Ts.length;l+=2)Ts[l][0](Ts[l+1]);Ts.length=0}}}function s(c){n(c(i))}function a(c,d=xn){const l=[c,d];return o.add(l),o.size===1&&(t=e(n)||xn),c(i),()=>{o.delete(l),o.size===0&&(t(),t=null)}}return{set:n,update:s,subscribe:a}}function ip(){const{subscribe:i,update:e}=Tl([]);return{subscribe:i,add:t=>e(o=>[...o,t])}}function rp(){const{subscribe:i,set:e,update:t}=Tl({});return{subscribe:i,show:o=>(au.set(!0),e(o))}}const Sr=ip(),cs=rp(),au=Tl(!1),Rh=Tl(null);var op=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sp(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var ya={},ap={get exports(){return ya},set exports(i){ya=i}};/* @preserve
 * Leaflet 1.9.3, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2022 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(i,e){(function(t,o){o(e)})(op,function(t){var o="1.9.3";function n(r){var h,y,M,I;for(y=1,M=arguments.length;y<M;y++){I=arguments[y];for(h in I)r[h]=I[h]}return r}var s=Object.create||function(){function r(){}return function(h){return r.prototype=h,new r}}();function a(r,h){var y=Array.prototype.slice;if(r.bind)return r.bind.apply(r,y.call(arguments,1));var M=y.call(arguments,2);return function(){return r.apply(h,M.length?M.concat(y.call(arguments)):arguments)}}var c=0;function d(r){return"_leaflet_id"in r||(r._leaflet_id=++c),r._leaflet_id}function l(r,h,y){var M,I,W,te;return te=function(){M=!1,I&&(W.apply(y,I),I=!1)},W=function(){M?I=arguments:(r.apply(y,arguments),setTimeout(te,h),M=!0)},W}function f(r,h,y){var M=h[1],I=h[0],W=M-I;return r===M&&y?r:((r-I)%W+W)%W+I}function p(){return!1}function m(r,h){if(h===!1)return r;var y=Math.pow(10,h===void 0?6:h);return Math.round(r*y)/y}function _(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function b(r){return _(r).split(/\s+/)}function x(r,h){Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?s(r.options):{});for(var y in h)r.options[y]=h[y];return r.options}function A(r,h,y){var M=[];for(var I in r)M.push(encodeURIComponent(y?I.toUpperCase():I)+"="+encodeURIComponent(r[I]));return(!h||h.indexOf("?")===-1?"?":"&")+M.join("&")}var S=/\{ *([\w_ -]+) *\}/g;function E(r,h){return r.replace(S,function(y,M){var I=h[M];if(I===void 0)throw new Error("No value provided for variable "+y);return typeof I=="function"&&(I=I(h)),I})}var F=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function v(r,h){for(var y=0;y<r.length;y++)if(r[y]===h)return y;return-1}var P="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function G(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var $=0;function Z(r){var h=+new Date,y=Math.max(0,16-(h-$));return $=h+y,window.setTimeout(r,y)}var ie=window.requestAnimationFrame||G("RequestAnimationFrame")||Z,le=window.cancelAnimationFrame||G("CancelAnimationFrame")||G("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function X(r,h,y){if(y&&ie===Z)r.call(h);else return ie.call(window,a(r,h))}function oe(r){r&&le.call(window,r)}var _e={__proto__:null,extend:n,create:s,bind:a,get lastId(){return c},stamp:d,throttle:l,wrapNum:f,falseFn:p,formatNum:m,trim:_,splitWords:b,setOptions:x,getParamString:A,template:E,isArray:F,indexOf:v,emptyImageUrl:P,requestFn:ie,cancelFn:le,requestAnimFrame:X,cancelAnimFrame:oe};function Re(){}Re.extend=function(r){var h=function(){x(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},y=h.__super__=this.prototype,M=s(y);M.constructor=h,h.prototype=M;for(var I in this)Object.prototype.hasOwnProperty.call(this,I)&&I!=="prototype"&&I!=="__super__"&&(h[I]=this[I]);return r.statics&&n(h,r.statics),r.includes&&(Se(r.includes),n.apply(null,[M].concat(r.includes))),n(M,r),delete M.statics,delete M.includes,M.options&&(M.options=y.options?s(y.options):{},n(M.options,r.options)),M._initHooks=[],M.callInitHooks=function(){if(!this._initHooksCalled){y.callInitHooks&&y.callInitHooks.call(this),this._initHooksCalled=!0;for(var W=0,te=M._initHooks.length;W<te;W++)M._initHooks[W].call(this)}},h},Re.include=function(r){var h=this.prototype.options;return n(this.prototype,r),r.options&&(this.prototype.options=h,this.mergeOptions(r.options)),this},Re.mergeOptions=function(r){return n(this.prototype.options,r),this},Re.addInitHook=function(r){var h=Array.prototype.slice.call(arguments,1),y=typeof r=="function"?r:function(){this[r].apply(this,h)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(y),this};function Se(r){if(!(typeof L>"u"||!L||!L.Mixin)){r=F(r)?r:[r];for(var h=0;h<r.length;h++)r[h]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var we={on:function(r,h,y){if(typeof r=="object")for(var M in r)this._on(M,r[M],h);else{r=b(r);for(var I=0,W=r.length;I<W;I++)this._on(r[I],h,y)}return this},off:function(r,h,y){if(!arguments.length)delete this._events;else if(typeof r=="object")for(var M in r)this._off(M,r[M],h);else{r=b(r);for(var I=arguments.length===1,W=0,te=r.length;W<te;W++)I?this._off(r[W]):this._off(r[W],h,y)}return this},_on:function(r,h,y,M){if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}if(this._listens(r,h,y)===!1){y===this&&(y=void 0);var I={fn:h,ctx:y};M&&(I.once=!0),this._events=this._events||{},this._events[r]=this._events[r]||[],this._events[r].push(I)}},_off:function(r,h,y){var M,I,W;if(this._events&&(M=this._events[r],!!M)){if(arguments.length===1){if(this._firingCount)for(I=0,W=M.length;I<W;I++)M[I].fn=p;delete this._events[r];return}if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}var te=this._listens(r,h,y);if(te!==!1){var se=M[te];this._firingCount&&(se.fn=p,this._events[r]=M=M.slice()),M.splice(te,1)}}},fire:function(r,h,y){if(!this.listens(r,y))return this;var M=n({},h,{type:r,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var I=this._events[r];if(I){this._firingCount=this._firingCount+1||1;for(var W=0,te=I.length;W<te;W++){var se=I[W],de=se.fn;se.once&&this.off(r,de,se.ctx),de.call(se.ctx||this,M)}this._firingCount--}}return y&&this._propagateEvent(M),this},listens:function(r,h,y,M){typeof r!="string"&&console.warn('"string" type argument expected');var I=h;typeof h!="function"&&(M=!!h,I=void 0,y=void 0);var W=this._events&&this._events[r];if(W&&W.length&&this._listens(r,I,y)!==!1)return!0;if(M){for(var te in this._eventParents)if(this._eventParents[te].listens(r,h,y,M))return!0}return!1},_listens:function(r,h,y){if(!this._events)return!1;var M=this._events[r]||[];if(!h)return!!M.length;y===this&&(y=void 0);for(var I=0,W=M.length;I<W;I++)if(M[I].fn===h&&M[I].ctx===y)return I;return!1},once:function(r,h,y){if(typeof r=="object")for(var M in r)this._on(M,r[M],h,!0);else{r=b(r);for(var I=0,W=r.length;I<W;I++)this._on(r[I],h,y,!0)}return this},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[d(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[d(r)],this},_propagateEvent:function(r){for(var h in this._eventParents)this._eventParents[h].fire(r.type,n({layer:r.target,propagatedFrom:r.target},r),!0)}};we.addEventListener=we.on,we.removeEventListener=we.clearAllEventListeners=we.off,we.addOneTimeEventListener=we.once,we.fireEvent=we.fire,we.hasEventListeners=we.listens;var Ue=Re.extend(we);function Oe(r,h,y){this.x=y?Math.round(r):r,this.y=y?Math.round(h):h}var Ft=Math.trunc||function(r){return r>0?Math.floor(r):Math.ceil(r)};Oe.prototype={clone:function(){return new Oe(this.x,this.y)},add:function(r){return this.clone()._add(Ne(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(Ne(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new Oe(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new Oe(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Ft(this.x),this.y=Ft(this.y),this},distanceTo:function(r){r=Ne(r);var h=r.x-this.x,y=r.y-this.y;return Math.sqrt(h*h+y*y)},equals:function(r){return r=Ne(r),r.x===this.x&&r.y===this.y},contains:function(r){return r=Ne(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+m(this.x)+", "+m(this.y)+")"}};function Ne(r,h,y){return r instanceof Oe?r:F(r)?new Oe(r[0],r[1]):r==null?r:typeof r=="object"&&"x"in r&&"y"in r?new Oe(r.x,r.y):new Oe(r,h,y)}function it(r,h){if(r)for(var y=h?[r,h]:r,M=0,I=y.length;M<I;M++)this.extend(y[M])}it.prototype={extend:function(r){var h,y;if(!r)return this;if(r instanceof Oe||typeof r[0]=="number"||"x"in r)h=y=Ne(r);else if(r=Me(r),h=r.min,y=r.max,!h||!y)return this;return!this.min&&!this.max?(this.min=h.clone(),this.max=y.clone()):(this.min.x=Math.min(h.x,this.min.x),this.max.x=Math.max(y.x,this.max.x),this.min.y=Math.min(h.y,this.min.y),this.max.y=Math.max(y.y,this.max.y)),this},getCenter:function(r){return Ne((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return Ne(this.min.x,this.max.y)},getTopRight:function(){return Ne(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var h,y;return typeof r[0]=="number"||r instanceof Oe?r=Ne(r):r=Me(r),r instanceof it?(h=r.min,y=r.max):h=y=r,h.x>=this.min.x&&y.x<=this.max.x&&h.y>=this.min.y&&y.y<=this.max.y},intersects:function(r){r=Me(r);var h=this.min,y=this.max,M=r.min,I=r.max,W=I.x>=h.x&&M.x<=y.x,te=I.y>=h.y&&M.y<=y.y;return W&&te},overlaps:function(r){r=Me(r);var h=this.min,y=this.max,M=r.min,I=r.max,W=I.x>h.x&&M.x<y.x,te=I.y>h.y&&M.y<y.y;return W&&te},isValid:function(){return!!(this.min&&this.max)},pad:function(r){var h=this.min,y=this.max,M=Math.abs(h.x-y.x)*r,I=Math.abs(h.y-y.y)*r;return Me(Ne(h.x-M,h.y-I),Ne(y.x+M,y.y+I))},equals:function(r){return r?(r=Me(r),this.min.equals(r.getTopLeft())&&this.max.equals(r.getBottomRight())):!1}};function Me(r,h){return!r||r instanceof it?r:new it(r,h)}function Et(r,h){if(r)for(var y=h?[r,h]:r,M=0,I=y.length;M<I;M++)this.extend(y[M])}Et.prototype={extend:function(r){var h=this._southWest,y=this._northEast,M,I;if(r instanceof et)M=r,I=r;else if(r instanceof Et){if(M=r._southWest,I=r._northEast,!M||!I)return this}else return r?this.extend(Ke(r)||mt(r)):this;return!h&&!y?(this._southWest=new et(M.lat,M.lng),this._northEast=new et(I.lat,I.lng)):(h.lat=Math.min(M.lat,h.lat),h.lng=Math.min(M.lng,h.lng),y.lat=Math.max(I.lat,y.lat),y.lng=Math.max(I.lng,y.lng)),this},pad:function(r){var h=this._southWest,y=this._northEast,M=Math.abs(h.lat-y.lat)*r,I=Math.abs(h.lng-y.lng)*r;return new Et(new et(h.lat-M,h.lng-I),new et(y.lat+M,y.lng+I))},getCenter:function(){return new et((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new et(this.getNorth(),this.getWest())},getSouthEast:function(){return new et(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){typeof r[0]=="number"||r instanceof et||"lat"in r?r=Ke(r):r=mt(r);var h=this._southWest,y=this._northEast,M,I;return r instanceof Et?(M=r.getSouthWest(),I=r.getNorthEast()):M=I=r,M.lat>=h.lat&&I.lat<=y.lat&&M.lng>=h.lng&&I.lng<=y.lng},intersects:function(r){r=mt(r);var h=this._southWest,y=this._northEast,M=r.getSouthWest(),I=r.getNorthEast(),W=I.lat>=h.lat&&M.lat<=y.lat,te=I.lng>=h.lng&&M.lng<=y.lng;return W&&te},overlaps:function(r){r=mt(r);var h=this._southWest,y=this._northEast,M=r.getSouthWest(),I=r.getNorthEast(),W=I.lat>h.lat&&M.lat<y.lat,te=I.lng>h.lng&&M.lng<y.lng;return W&&te},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,h){return r?(r=mt(r),this._southWest.equals(r.getSouthWest(),h)&&this._northEast.equals(r.getNorthEast(),h)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function mt(r,h){return r instanceof Et?r:new Et(r,h)}function et(r,h,y){if(isNaN(r)||isNaN(h))throw new Error("Invalid LatLng object: ("+r+", "+h+")");this.lat=+r,this.lng=+h,y!==void 0&&(this.alt=+y)}et.prototype={equals:function(r,h){if(!r)return!1;r=Ke(r);var y=Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng));return y<=(h===void 0?1e-9:h)},toString:function(r){return"LatLng("+m(this.lat,r)+", "+m(this.lng,r)+")"},distanceTo:function(r){return Be.distance(this,Ke(r))},wrap:function(){return Be.wrapLatLng(this)},toBounds:function(r){var h=180*r/40075017,y=h/Math.cos(Math.PI/180*this.lat);return mt([this.lat-h,this.lng-y],[this.lat+h,this.lng+y])},clone:function(){return new et(this.lat,this.lng,this.alt)}};function Ke(r,h,y){return r instanceof et?r:F(r)&&typeof r[0]!="object"?r.length===3?new et(r[0],r[1],r[2]):r.length===2?new et(r[0],r[1]):null:r==null?r:typeof r=="object"&&"lat"in r?new et(r.lat,"lng"in r?r.lng:r.lon,r.alt):h===void 0?null:new et(r,h,y)}var Mt={latLngToPoint:function(r,h){var y=this.projection.project(r),M=this.scale(h);return this.transformation._transform(y,M)},pointToLatLng:function(r,h){var y=this.scale(h),M=this.transformation.untransform(r,y);return this.projection.unproject(M)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var h=this.projection.bounds,y=this.scale(r),M=this.transformation.transform(h.min,y),I=this.transformation.transform(h.max,y);return new it(M,I)},infinite:!1,wrapLatLng:function(r){var h=this.wrapLng?f(r.lng,this.wrapLng,!0):r.lng,y=this.wrapLat?f(r.lat,this.wrapLat,!0):r.lat,M=r.alt;return new et(y,h,M)},wrapLatLngBounds:function(r){var h=r.getCenter(),y=this.wrapLatLng(h),M=h.lat-y.lat,I=h.lng-y.lng;if(M===0&&I===0)return r;var W=r.getSouthWest(),te=r.getNorthEast(),se=new et(W.lat-M,W.lng-I),de=new et(te.lat-M,te.lng-I);return new Et(se,de)}},Be=n({},Mt,{wrapLng:[-180,180],R:6371e3,distance:function(r,h){var y=Math.PI/180,M=r.lat*y,I=h.lat*y,W=Math.sin((h.lat-r.lat)*y/2),te=Math.sin((h.lng-r.lng)*y/2),se=W*W+Math.cos(M)*Math.cos(I)*te*te,de=2*Math.atan2(Math.sqrt(se),Math.sqrt(1-se));return this.R*de}}),Bt=6378137,Fn={R:Bt,MAX_LATITUDE:85.0511287798,project:function(r){var h=Math.PI/180,y=this.MAX_LATITUDE,M=Math.max(Math.min(y,r.lat),-y),I=Math.sin(M*h);return new Oe(this.R*r.lng*h,this.R*Math.log((1+I)/(1-I))/2)},unproject:function(r){var h=180/Math.PI;return new et((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*h,r.x*h/this.R)},bounds:function(){var r=Bt*Math.PI;return new it([-r,-r],[r,r])}()};function gi(r,h,y,M){if(F(r)){this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3];return}this._a=r,this._b=h,this._c=y,this._d=M}gi.prototype={transform:function(r,h){return this._transform(r.clone(),h)},_transform:function(r,h){return h=h||1,r.x=h*(this._a*r.x+this._b),r.y=h*(this._c*r.y+this._d),r},untransform:function(r,h){return h=h||1,new Oe((r.x/h-this._b)/this._a,(r.y/h-this._d)/this._c)}};function fn(r,h,y,M){return new gi(r,h,y,M)}var B=n({},Be,{code:"EPSG:3857",projection:Fn,transformation:function(){var r=.5/(Math.PI*Fn.R);return fn(r,.5,-r,.5)}()}),w=n({},B,{code:"EPSG:900913"});function R(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function D(r,h){var y="",M,I,W,te,se,de;for(M=0,W=r.length;M<W;M++){for(se=r[M],I=0,te=se.length;I<te;I++)de=se[I],y+=(I?"L":"M")+de.x+" "+de.y;y+=h?je.svg?"z":"x":""}return y||"M0 0"}var z=document.documentElement.style,j="ActiveXObject"in window,K=j&&!document.addEventListener,pe="msLaunchUri"in navigator&&!("documentMode"in document),be=Zn("webkit"),Ee=Zn("android"),We=Zn("android 2")||Zn("android 3"),ot=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ge=Ee&&Zn("Google")&&ot<537&&!("AudioNode"in window),at=!!window.opera,wn=!pe&&Zn("chrome"),lt=Zn("gecko")&&!be&&!at&&!j,dn=!wn&&Zn("safari"),tn=Zn("phantom"),Vi="OTransition"in z,nn=navigator.platform.indexOf("Win")===0,rn=j&&"transition"in z,Mi="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!We,or="MozPerspective"in z,Ds=!window.L_DISABLE_3D&&(rn||Mi||or)&&!Vi&&!tn,ui=typeof orientation<"u"||Zn("mobile"),fs=ui&&be,Tn=ui&&Mi,Mo=!window.PointerEvent&&window.MSPointerEvent,sr=!!(window.PointerEvent||Mo),Mr="ontouchstart"in window||!!window.TouchEvent,on=!window.L_NO_TOUCH&&(Mr||sr),Tr=ui&&at,To=ui&&lt,Pn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Pr=function(){var r=!1;try{var h=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",p,h),window.removeEventListener("testPassiveEventSupport",p,h)}catch{}return r}(),Zi=function(){return!!document.createElement("canvas").getContext}(),Er=!!(document.createElementNS&&R("svg").createSVGRect),Po=!!Er&&function(){var r=document.createElement("div");return r.innerHTML="<svg/>",(r.firstChild&&r.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),mi=!Er&&function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var h=r.firstChild;return h.style.behavior="url(#default#VML)",h&&typeof h.adj=="object"}catch{return!1}}(),Is=navigator.platform.indexOf("Mac")===0,ds=navigator.platform.indexOf("Linux")===0;function Zn(r){return navigator.userAgent.toLowerCase().indexOf(r)>=0}var je={ie:j,ielt9:K,edge:pe,webkit:be,android:Ee,android23:We,androidStock:Ge,opera:at,chrome:wn,gecko:lt,safari:dn,phantom:tn,opera12:Vi,win:nn,ie3d:rn,webkit3d:Mi,gecko3d:or,any3d:Ds,mobile:ui,mobileWebkit:fs,mobileWebkit3d:Tn,msPointer:Mo,pointer:sr,touch:on,touchNative:Mr,mobileOpera:Tr,mobileGecko:To,retina:Pn,passiveEvents:Pr,canvas:Zi,svg:Er,vml:mi,inlineSvg:Po,mac:Is,linux:ds},Di=je.msPointer?"MSPointerDown":"pointerdown",Eo=je.msPointer?"MSPointerMove":"pointermove",Ao=je.msPointer?"MSPointerUp":"pointerup",Ar=je.msPointer?"MSPointerCancel":"pointercancel",to={touchstart:Di,touchmove:Eo,touchend:Ao,touchcancel:Ar},pn={touchstart:lr,touchmove:qi,touchend:qi,touchcancel:qi},qn={},ar=!1;function ps(r,h,y){return h==="touchstart"&&Or(),pn[h]?(y=pn[h].bind(this,y),r.addEventListener(to[h],y,!1),y):(console.warn("wrong event specified:",h),p)}function Oo(r,h,y){if(!to[h]){console.warn("wrong event specified:",h);return}r.removeEventListener(to[h],y,!1)}function gs(r){qn[r.pointerId]=r}function no(r){qn[r.pointerId]&&(qn[r.pointerId]=r)}function Ii(r){delete qn[r.pointerId]}function Or(){ar||(document.addEventListener(Di,gs,!0),document.addEventListener(Eo,no,!0),document.addEventListener(Ao,Ii,!0),document.addEventListener(Ar,Ii,!0),ar=!0)}function qi(r,h){if(h.pointerType!==(h.MSPOINTER_TYPE_MOUSE||"mouse")){h.touches=[];for(var y in qn)h.touches.push(qn[y]);h.changedTouches=[h],r(h)}}function lr(r,h){h.MSPOINTER_TYPE_TOUCH&&h.pointerType===h.MSPOINTER_TYPE_TOUCH&&k(h),qi(r,h)}function Fs(r){var h={},y,M;for(M in r)y=r[M],h[M]=y&&y.bind?y.bind(r):y;return r=h,h.type="dblclick",h.detail=2,h.isTrusted=!1,h._simulated=!0,h}var Ns=200;function ko(r,h){r.addEventListener("dblclick",h);var y=0,M;function I(W){if(W.detail!==1){M=W.detail;return}if(!(W.pointerType==="mouse"||W.sourceCapabilities&&!W.sourceCapabilities.firesTouchEvents)){var te=U(W);if(!(te.some(function(de){return de instanceof HTMLLabelElement&&de.attributes.for})&&!te.some(function(de){return de instanceof HTMLInputElement||de instanceof HTMLSelectElement}))){var se=Date.now();se-y<=Ns?(M++,M===2&&h(Fs(W))):M=1,y=se}}}return r.addEventListener("click",I),{dblclick:h,simDblclick:I}}function ms(r,h){r.removeEventListener("dblclick",h.dblclick),r.removeEventListener("click",h.simDblclick)}var io=Gi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Nn=Gi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),zn=Nn==="webkitTransition"||Nn==="OTransition"?Nn+"End":"transitionend";function Qe(r){return typeof r=="string"?document.getElementById(r):r}function kr(r,h){var y=r.style[h]||r.currentStyle&&r.currentStyle[h];if((!y||y==="auto")&&document.defaultView){var M=document.defaultView.getComputedStyle(r,null);y=M?M[h]:null}return y==="auto"?null:y}function vt(r,h,y){var M=document.createElement(r);return M.className=h||"",y&&y.appendChild(M),M}function At(r){var h=r.parentNode;h&&h.removeChild(r)}function ro(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function Fi(r){var h=r.parentNode;h&&h.lastChild!==r&&h.appendChild(r)}function ur(r){var h=r.parentNode;h&&h.firstChild!==r&&h.insertBefore(r,h.firstChild)}function oo(r,h){if(r.classList!==void 0)return r.classList.contains(h);var y=Rr(r);return y.length>0&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(y)}function Je(r,h){if(r.classList!==void 0)for(var y=b(h),M=0,I=y.length;M<I;M++)r.classList.add(y[M]);else if(!oo(r,h)){var W=Rr(r);jn(r,(W?W+" ":"")+h)}}function Gt(r,h){r.classList!==void 0?r.classList.remove(h):jn(r,_((" "+Rr(r)+" ").replace(" "+h+" "," ")))}function jn(r,h){r.className.baseVal===void 0?r.className=h:r.className.baseVal=h}function Rr(r){return r.correspondingElement&&(r=r.correspondingElement),r.className.baseVal===void 0?r.className:r.className.baseVal}function Cn(r,h){"opacity"in r.style?r.style.opacity=h:"filter"in r.style&&_s(r,h)}function _s(r,h){var y=!1,M="DXImageTransform.Microsoft.Alpha";try{y=r.filters.item(M)}catch{if(h===1)return}h=Math.round(h*100),y?(y.Enabled=h!==100,y.Opacity=h):r.style.filter+=" progid:"+M+"(opacity="+h+")"}function Gi(r){for(var h=document.documentElement.style,y=0;y<r.length;y++)if(r[y]in h)return r[y];return!1}function En(r,h,y){var M=h||new Oe(0,0);r.style[io]=(je.ie3d?"translate("+M.x+"px,"+M.y+"px)":"translate3d("+M.x+"px,"+M.y+"px,0)")+(y?" scale("+y+")":"")}function Ht(r,h){r._leaflet_pos=h,je.any3d?En(r,h):(r.style.left=h.x+"px",r.style.top=h.y+"px")}function Ni(r){return r._leaflet_pos||new Oe(0,0)}var zi,Br,Ro;if("onselectstart"in document)zi=function(){rt(window,"selectstart",k)},Br=function(){Dt(window,"selectstart",k)};else{var Dr=Gi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);zi=function(){if(Dr){var r=document.documentElement.style;Ro=r[Dr],r[Dr]="none"}},Br=function(){Dr&&(document.documentElement.style[Dr]=Ro,Ro=void 0)}}function Bo(){rt(window,"dragstart",k)}function so(){Dt(window,"dragstart",k)}var Ir,cr;function Fr(r){for(;r.tabIndex===-1;)r=r.parentNode;r.style&&(ao(),Ir=r,cr=r.style.outline,r.style.outline="none",rt(window,"keydown",ao))}function ao(){Ir&&(Ir.style.outline=cr,Ir=void 0,cr=void 0,Dt(window,"keydown",ao))}function Nr(r){do r=r.parentNode;while((!r.offsetWidth||!r.offsetHeight)&&r!==document.body);return r}function Do(r){var h=r.getBoundingClientRect();return{x:h.width/r.offsetWidth||1,y:h.height/r.offsetHeight||1,boundingClientRect:h}}var zr={__proto__:null,TRANSFORM:io,TRANSITION:Nn,TRANSITION_END:zn,get:Qe,getStyle:kr,create:vt,remove:At,empty:ro,toFront:Fi,toBack:ur,hasClass:oo,addClass:Je,removeClass:Gt,setClass:jn,getClass:Rr,setOpacity:Cn,testProp:Gi,setTransform:En,setPosition:Ht,getPosition:Ni,get disableTextSelection(){return zi},get enableTextSelection(){return Br},disableImageDrag:Bo,enableImageDrag:so,preventOutline:Fr,restoreOutline:ao,getSizedParentNode:Nr,getScale:Do};function rt(r,h,y,M){if(h&&typeof h=="object")for(var I in h)Io(r,I,h[I],y);else{h=b(h);for(var W=0,te=h.length;W<te;W++)Io(r,h[W],y,M)}return this}var Gn="_leaflet_events";function Dt(r,h,y,M){if(arguments.length===1)lo(r),delete r[Gn];else if(h&&typeof h=="object")for(var I in h)Fo(r,I,h[I],y);else if(h=b(h),arguments.length===2)lo(r,function(se){return v(h,se)!==-1});else for(var W=0,te=h.length;W<te;W++)Fo(r,h[W],y,M);return this}function lo(r,h){for(var y in r[Gn]){var M=y.split(/\d/)[0];(!h||h(M))&&Fo(r,M,null,null,y)}}var uo={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Io(r,h,y,M){var I=h+d(y)+(M?"_"+d(M):"");if(r[Gn]&&r[Gn][I])return this;var W=function(se){return y.call(M||r,se||window.event)},te=W;!je.touchNative&&je.pointer&&h.indexOf("touch")===0?W=ps(r,h,W):je.touch&&h==="dblclick"?W=ko(r,W):"addEventListener"in r?h==="touchstart"||h==="touchmove"||h==="wheel"||h==="mousewheel"?r.addEventListener(uo[h]||h,W,je.passiveEvents?{passive:!1}:!1):h==="mouseenter"||h==="mouseleave"?(W=function(se){se=se||window.event,ge(r,se)&&te(se)},r.addEventListener(uo[h],W,!1)):r.addEventListener(h,te,!1):r.attachEvent("on"+h,W),r[Gn]=r[Gn]||{},r[Gn][I]=W}function Fo(r,h,y,M,I){I=I||h+d(y)+(M?"_"+d(M):"");var W=r[Gn]&&r[Gn][I];if(!W)return this;!je.touchNative&&je.pointer&&h.indexOf("touch")===0?Oo(r,h,W):je.touch&&h==="dblclick"?ms(r,W):"removeEventListener"in r?r.removeEventListener(uo[h]||h,W,!1):r.detachEvent("on"+h,W),r[Gn][I]=null}function g(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,this}function C(r){return Io(r,"wheel",g),this}function T(r){return rt(r,"mousedown touchstart dblclick contextmenu",g),r._leaflet_disable_click=!0,this}function k(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function N(r){return k(r),g(r),this}function U(r){if(r.composedPath)return r.composedPath();for(var h=[],y=r.target;y;)h.push(y),y=y.parentNode;return h}function V(r,h){if(!h)return new Oe(r.clientX,r.clientY);var y=Do(h),M=y.boundingClientRect;return new Oe((r.clientX-M.left)/y.x-h.clientLeft,(r.clientY-M.top)/y.y-h.clientTop)}var ee=je.linux&&je.chrome?window.devicePixelRatio:je.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ae(r){return je.edge?r.wheelDeltaY/2:r.deltaY&&r.deltaMode===0?-r.deltaY/ee:r.deltaY&&r.deltaMode===1?-r.deltaY*20:r.deltaY&&r.deltaMode===2?-r.deltaY*60:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?-r.detail*20:r.detail?r.detail/-32765*60:0}function ge(r,h){var y=h.relatedTarget;if(!y)return!0;try{for(;y&&y!==r;)y=y.parentNode}catch{return!1}return y!==r}var he={__proto__:null,on:rt,off:Dt,stopPropagation:g,disableScrollPropagation:C,disableClickPropagation:T,preventDefault:k,stop:N,getPropagationPath:U,getMousePosition:V,getWheelDelta:ae,isExternalTarget:ge,addListener:rt,removeListener:Dt},Le=Ue.extend({run:function(r,h,y,M){this.stop(),this._el=r,this._inProgress=!0,this._duration=y||.25,this._easeOutPower=1/Math.max(M||.5,.2),this._startPos=Ni(r),this._offset=h.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=X(this._animate,this),this._step()},_step:function(r){var h=+new Date-this._startTime,y=this._duration*1e3;h<y?this._runFrame(this._easeOut(h/y),r):(this._runFrame(1),this._complete())},_runFrame:function(r,h){var y=this._startPos.add(this._offset.multiplyBy(r));h&&y._round(),Ht(this._el,y),this.fire("step")},_complete:function(){oe(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),me=Ue.extend({options:{crs:B,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,h){h=x(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),h.zoom!==void 0&&(this._zoom=this._limitZoom(h.zoom)),h.center&&h.zoom!==void 0&&this.setView(Ke(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Nn&&je.any3d&&!je.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),rt(this._proxy,zn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,h,y){if(h=h===void 0?this._zoom:this._limitZoom(h),r=this._limitCenter(Ke(r),h,this.options.maxBounds),y=y||{},this._stop(),this._loaded&&!y.reset&&y!==!0){y.animate!==void 0&&(y.zoom=n({animate:y.animate},y.zoom),y.pan=n({animate:y.animate,duration:y.duration},y.pan));var M=this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,h,y.zoom):this._tryAnimatedPan(r,y.pan);if(M)return clearTimeout(this._sizeTimer),this}return this._resetView(r,h,y.pan&&y.pan.noMoveStart),this},setZoom:function(r,h){return this._loaded?this.setView(this.getCenter(),r,{zoom:h}):(this._zoom=r,this)},zoomIn:function(r,h){return r=r||(je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+r,h)},zoomOut:function(r,h){return r=r||(je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-r,h)},setZoomAround:function(r,h,y){var M=this.getZoomScale(h),I=this.getSize().divideBy(2),W=r instanceof Oe?r:this.latLngToContainerPoint(r),te=W.subtract(I).multiplyBy(1-1/M),se=this.containerPointToLatLng(I.add(te));return this.setView(se,h,{zoom:y})},_getBoundsCenterZoom:function(r,h){h=h||{},r=r.getBounds?r.getBounds():mt(r);var y=Ne(h.paddingTopLeft||h.padding||[0,0]),M=Ne(h.paddingBottomRight||h.padding||[0,0]),I=this.getBoundsZoom(r,!1,y.add(M));if(I=typeof h.maxZoom=="number"?Math.min(h.maxZoom,I):I,I===1/0)return{center:r.getCenter(),zoom:I};var W=M.subtract(y).divideBy(2),te=this.project(r.getSouthWest(),I),se=this.project(r.getNorthEast(),I),de=this.unproject(te.add(se).divideBy(2).add(W),I);return{center:de,zoom:I}},fitBounds:function(r,h){if(r=mt(r),!r.isValid())throw new Error("Bounds are not valid.");var y=this._getBoundsCenterZoom(r,h);return this.setView(y.center,y.zoom,h)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,h){return this.setView(r,this._zoom,{pan:h})},panBy:function(r,h){if(r=Ne(r).round(),h=h||{},!r.x&&!r.y)return this.fire("moveend");if(h.animate!==!0&&!this.getSize().contains(r))return this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Le,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),h.animate!==!1){Je(this._mapPane,"leaflet-pan-anim");var y=this._getMapPanePos().subtract(r).round();this._panAnim.run(this._mapPane,y,h.duration||.25,h.easeLinearity)}else this._rawPanBy(r),this.fire("move").fire("moveend");return this},flyTo:function(r,h,y){if(y=y||{},y.animate===!1||!je.any3d)return this.setView(r,h,y);this._stop();var M=this.project(this.getCenter()),I=this.project(r),W=this.getSize(),te=this._zoom;r=Ke(r),h=h===void 0?te:h;var se=Math.max(W.x,W.y),de=se*this.getZoomScale(te,h),xe=I.distanceTo(M)||1,Ae=1.42,tt=Ae*Ae;function bt(ft){var Go=ft?-1:1,jl=ft?de:se,Hl=de*de-se*se+Go*tt*tt*xe*xe,Ul=2*jl*tt*xe,Yo=Hl/Ul,mo=Math.sqrt(Yo*Yo+1)-Yo,Ji=mo<1e-9?-18:Math.log(mo);return Ji}function bi(ft){return(Math.exp(ft)-Math.exp(-ft))/2}function Vr(ft){return(Math.exp(ft)+Math.exp(-ft))/2}function Cs(ft){return bi(ft)/Vr(ft)}var di=bt(0);function Rn(ft){return se*(Vr(di)/Vr(di+Ae*ft))}function Nl(ft){return se*(Vr(di)*Cs(di+Ae*ft)-bi(di))/tt}function zl(ft){return 1-Math.pow(1-ft,1.5)}var cn=Date.now(),Da=(bt(1)-di)/Ae,Ia=y.duration?1e3*y.duration:1e3*Da*.8;function Ai(){var ft=(Date.now()-cn)/Ia,Go=zl(ft)*Da;ft<=1?(this._flyToFrame=X(Ai,this),this._move(this.unproject(M.add(I.subtract(M).multiplyBy(Nl(Go)/xe)),te),this.getScaleZoom(se/Rn(Go),te),{flyTo:!0})):this._move(r,h)._moveEnd(!0)}return this._moveStart(!0,y.noMoveStart),Ai.call(this),this},flyToBounds:function(r,h){var y=this._getBoundsCenterZoom(r,h);return this.flyTo(y.center,y.zoom,h)},setMaxBounds:function(r){return r=mt(r),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),r.isValid()?(this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(r){var h=this.options.minZoom;return this.options.minZoom=r,this._loaded&&h!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var h=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&h!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,h){this._enforcingBounds=!0;var y=this.getCenter(),M=this._limitCenter(y,this._zoom,mt(r));return y.equals(M)||this.panTo(M,h),this._enforcingBounds=!1,this},panInside:function(r,h){h=h||{};var y=Ne(h.paddingTopLeft||h.padding||[0,0]),M=Ne(h.paddingBottomRight||h.padding||[0,0]),I=this.project(this.getCenter()),W=this.project(r),te=this.getPixelBounds(),se=Me([te.min.add(y),te.max.subtract(M)]),de=se.getSize();if(!se.contains(W)){this._enforcingBounds=!0;var xe=W.subtract(se.getCenter()),Ae=se.extend(W).getSize().subtract(de);I.x+=xe.x<0?-Ae.x:Ae.x,I.y+=xe.y<0?-Ae.y:Ae.y,this.panTo(this.unproject(I),h),this._enforcingBounds=!1}return this},invalidateSize:function(r){if(!this._loaded)return this;r=n({animate:!1,pan:!0},r===!0?{animate:!0}:r);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var y=this.getSize(),M=h.divideBy(2).round(),I=y.divideBy(2).round(),W=M.subtract(I);return!W.x&&!W.y?this:(r.animate&&r.pan?this.panBy(W):(r.pan&&this._rawPanBy(W),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:y}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=n({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=a(this._handleGeolocationResponse,this),y=a(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,y,r):navigator.geolocation.getCurrentPosition(h,y,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){if(this._container._leaflet_id){var h=r.code,y=r.message||(h===1?"permission denied":h===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+y+"."})}},_handleGeolocationResponse:function(r){if(this._container._leaflet_id){var h=r.coords.latitude,y=r.coords.longitude,M=new et(h,y),I=M.toBounds(r.coords.accuracy*2),W=this._locateOptions;if(W.setView){var te=this.getBoundsZoom(I);this.setView(M,W.maxZoom?Math.min(te,W.maxZoom):te)}var se={latlng:M,bounds:I,timestamp:r.timestamp};for(var de in r.coords)typeof r.coords[de]=="number"&&(se[de]=r.coords[de]);this.fire("locationfound",se)}},addHandler:function(r,h){if(!h)return this;var y=this[r]=new h(this);return this._handlers.push(y),this.options[r]&&y.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),At(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(oe(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var r;for(r in this._layers)this._layers[r].remove();for(r in this._panes)At(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,h){var y="leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),M=vt("div",y,h||this._mapPane);return r&&(this._panes[r]=M),M},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds(),h=this.unproject(r.getBottomLeft()),y=this.unproject(r.getTopRight());return new Et(h,y)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,h,y){r=mt(r),y=Ne(y||[0,0]);var M=this.getZoom()||0,I=this.getMinZoom(),W=this.getMaxZoom(),te=r.getNorthWest(),se=r.getSouthEast(),de=this.getSize().subtract(y),xe=Me(this.project(se,M),this.project(te,M)).getSize(),Ae=je.any3d?this.options.zoomSnap:1,tt=de.x/xe.x,bt=de.y/xe.y,bi=h?Math.max(tt,bt):Math.min(tt,bt);return M=this.getScaleZoom(bi,M),Ae&&(M=Math.round(M/(Ae/100))*(Ae/100),M=h?Math.ceil(M/Ae)*Ae:Math.floor(M/Ae)*Ae),Math.max(I,Math.min(W,M))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Oe(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,h){var y=this._getTopLeftPoint(r,h);return new it(y,y.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(r===void 0?this.getZoom():r)},getPane:function(r){return typeof r=="string"?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,h){var y=this.options.crs;return h=h===void 0?this._zoom:h,y.scale(r)/y.scale(h)},getScaleZoom:function(r,h){var y=this.options.crs;h=h===void 0?this._zoom:h;var M=y.zoom(r*y.scale(h));return isNaN(M)?1/0:M},project:function(r,h){return h=h===void 0?this._zoom:h,this.options.crs.latLngToPoint(Ke(r),h)},unproject:function(r,h){return h=h===void 0?this._zoom:h,this.options.crs.pointToLatLng(Ne(r),h)},layerPointToLatLng:function(r){var h=Ne(r).add(this.getPixelOrigin());return this.unproject(h)},latLngToLayerPoint:function(r){var h=this.project(Ke(r))._round();return h._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(Ke(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(mt(r))},distance:function(r,h){return this.options.crs.distance(Ke(r),Ke(h))},containerPointToLayerPoint:function(r){return Ne(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return Ne(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var h=this.containerPointToLayerPoint(Ne(r));return this.layerPointToLatLng(h)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Ke(r)))},mouseEventToContainerPoint:function(r){return V(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var h=this._container=Qe(r);if(h){if(h._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");rt(h,"scroll",this._onScroll,this),this._containerId=d(h)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&je.any3d,Je(r,"leaflet-container"+(je.touch?" leaflet-touch":"")+(je.retina?" leaflet-retina":"")+(je.ielt9?" leaflet-oldie":"")+(je.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=kr(r,"position");h!=="absolute"&&h!=="relative"&&h!=="fixed"&&h!=="sticky"&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ht(this._mapPane,new Oe(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Je(r.markerPane,"leaflet-zoom-hide"),Je(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,h,y){Ht(this._mapPane,new Oe(0,0));var M=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var I=this._zoom!==h;this._moveStart(I,y)._move(r,h)._moveEnd(I),this.fire("viewreset"),M&&this.fire("load")},_moveStart:function(r,h){return r&&this.fire("zoomstart"),h||this.fire("movestart"),this},_move:function(r,h,y,M){h===void 0&&(h=this._zoom);var I=this._zoom!==h;return this._zoom=h,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),M?y&&y.pinch&&this.fire("zoom",y):((I||y&&y.pinch)&&this.fire("zoom",y),this.fire("move",y)),this},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return oe(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){Ht(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={},this._targets[d(this._container)]=this;var h=r?Dt:rt;h(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),je.any3d&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){oe(this._resizeRequest),this._resizeRequest=X(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,h){for(var y=[],M,I=h==="mouseout"||h==="mouseover",W=r.target||r.srcElement,te=!1;W;){if(M=this._targets[d(W)],M&&(h==="click"||h==="preclick")&&this._draggableMoved(M)){te=!0;break}if(M&&M.listens(h,!0)&&(I&&!ge(W,r)||(y.push(M),I))||W===this._container)break;W=W.parentNode}return!y.length&&!te&&!I&&this.listens(h,!0)&&(y=[this]),y},_isClickDisabled:function(r){for(;r&&r!==this._container;){if(r._leaflet_disable_click)return!0;r=r.parentNode}},_handleDOMEvent:function(r){var h=r.target||r.srcElement;if(!(!this._loaded||h._leaflet_disable_events||r.type==="click"&&this._isClickDisabled(h))){var y=r.type;y==="mousedown"&&Fr(h),this._fireDOMEvent(r,y)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,h,y){if(r.type==="click"){var M=n({},r);M.type="preclick",this._fireDOMEvent(M,M.type,y)}var I=this._findEventTargets(r,h);if(y){for(var W=[],te=0;te<y.length;te++)y[te].listens(h,!0)&&W.push(y[te]);I=W.concat(I)}if(I.length){h==="contextmenu"&&k(r);var se=I[0],de={originalEvent:r};if(r.type!=="keypress"&&r.type!=="keydown"&&r.type!=="keyup"){var xe=se.getLatLng&&(!se._radius||se._radius<=10);de.containerPoint=xe?this.latLngToContainerPoint(se.getLatLng()):this.mouseEventToContainerPoint(r),de.layerPoint=this.containerPointToLayerPoint(de.containerPoint),de.latlng=xe?se.getLatLng():this.layerPointToLatLng(de.layerPoint)}for(te=0;te<I.length;te++)if(I[te].fire(h,de,!0),de.originalEvent._stopped||I[te].options.bubblingMouseEvents===!1&&v(this._mouseEvents,h)!==-1)return}},_draggableMoved:function(r){return r=r.dragging&&r.dragging.enabled()?r:this,r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,h=this._handlers.length;r<h;r++)this._handlers[r].disable()},whenReady:function(r,h){return this._loaded?r.call(h||this,{target:this}):this.on("load",r,h),this},_getMapPanePos:function(){return Ni(this._mapPane)||new Oe(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,h){var y=r&&h!==void 0?this._getNewPixelOrigin(r,h):this.getPixelOrigin();return y.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,h){var y=this.getSize()._divideBy(2);return this.project(r,h)._subtract(y)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,h,y){var M=this._getNewPixelOrigin(y,h);return this.project(r,h)._subtract(M)},_latLngBoundsToNewLayerBounds:function(r,h,y){var M=this._getNewPixelOrigin(y,h);return Me([this.project(r.getSouthWest(),h)._subtract(M),this.project(r.getNorthWest(),h)._subtract(M),this.project(r.getSouthEast(),h)._subtract(M),this.project(r.getNorthEast(),h)._subtract(M)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,h,y){if(!y)return r;var M=this.project(r,h),I=this.getSize().divideBy(2),W=new it(M.subtract(I),M.add(I)),te=this._getBoundsOffset(W,y,h);return Math.abs(te.x)<=1&&Math.abs(te.y)<=1?r:this.unproject(M.add(te),h)},_limitOffset:function(r,h){if(!h)return r;var y=this.getPixelBounds(),M=new it(y.min.add(r),y.max.add(r));return r.add(this._getBoundsOffset(M,h))},_getBoundsOffset:function(r,h,y){var M=Me(this.project(h.getNorthEast(),y),this.project(h.getSouthWest(),y)),I=M.min.subtract(r.min),W=M.max.subtract(r.max),te=this._rebound(I.x,-W.x),se=this._rebound(I.y,-W.y);return new Oe(te,se)},_rebound:function(r,h){return r+h>0?Math.round(r-h)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(h))},_limitZoom:function(r){var h=this.getMinZoom(),y=this.getMaxZoom(),M=je.any3d?this.options.zoomSnap:1;return M&&(r=Math.round(r/M)*M),Math.max(h,Math.min(y,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Gt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,h){var y=this._getCenterOffset(r)._trunc();return(h&&h.animate)!==!0&&!this.getSize().contains(y)?!1:(this.panBy(y,h),!0)},_createAnimProxy:function(){var r=this._proxy=vt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(h){var y=io,M=this._proxy.style[y];En(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),M===this._proxy.style[y]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){At(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),h=this.getZoom();En(this._proxy,this.project(r,h),this.getZoomScale(h,1))},_catchTransitionEnd:function(r){this._animatingZoom&&r.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,h,y){if(this._animatingZoom)return!0;if(y=y||{},!this._zoomAnimated||y.animate===!1||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var M=this.getZoomScale(h),I=this._getCenterOffset(r)._divideBy(1-1/M);return y.animate!==!0&&!this.getSize().contains(I)?!1:(X(function(){this._moveStart(!0,!1)._animateZoom(r,h,!0)},this),!0)},_animateZoom:function(r,h,y,M){this._mapPane&&(y&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=h,Je(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:h,noUpdate:M}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Gt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Pe(r,h){return new me(r,h)}var Xe=Re.extend({options:{position:"topright"},initialize:function(r){x(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var h=this._map;return h&&h.removeControl(this),this.options.position=r,h&&h.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var h=this._container=this.onAdd(r),y=this.getPosition(),M=r._controlCorners[y];return Je(h,"leaflet-control"),y.indexOf("bottom")!==-1?M.insertBefore(h,M.firstChild):M.appendChild(h),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(At(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(r){this._map&&r&&r.screenX>0&&r.screenY>0&&this._map.getContainer().focus()}}),Ve=function(r){return new Xe(r)};me.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},h="leaflet-",y=this._controlContainer=vt("div",h+"control-container",this._container);function M(I,W){var te=h+I+" "+h+W;r[I+W]=vt("div",te,y)}M("top","left"),M("top","right"),M("bottom","left"),M("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)At(this._controlCorners[r]);At(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ut=Xe.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,h,y,M){return y<M?-1:M<y?1:0}},initialize:function(r,h,y){x(this,y),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var M in r)this._addLayer(r[M],M);for(M in h)this._addLayer(h[M],M,!0)},onAdd:function(r){this._initLayout(),this._update(),this._map=r,r.on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return Xe.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,h){return this._addLayer(r,h),this._map?this._update():this},addOverlay:function(r,h){return this._addLayer(r,h,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var h=this._getLayer(d(r));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this},expand:function(){Je(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(Je(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):Gt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Gt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",h=this._container=vt("div",r),y=this.options.collapsed;h.setAttribute("aria-haspopup",!0),T(h),C(h);var M=this._section=vt("section",r+"-list");y&&(this._map.on("click",this.collapse,this),rt(h,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var I=this._layersLink=vt("a",r+"-toggle",h);I.href="#",I.title="Layers",I.setAttribute("role","button"),rt(I,{keydown:function(W){W.keyCode===13&&this._expandSafely()},click:function(W){k(W),this._expandSafely()}},this),y||this.expand(),this._baseLayersList=vt("div",r+"-base",M),this._separator=vt("div",r+"-separator",M),this._overlaysList=vt("div",r+"-overlays",M),h.appendChild(M)},_getLayer:function(r){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&d(this._layers[h].layer)===r)return this._layers[h]},_addLayer:function(r,h,y){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:h,overlay:y}),this.options.sortLayers&&this._layers.sort(a(function(M,I){return this.options.sortFunction(M.layer,I.layer,M.name,I.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ro(this._baseLayersList),ro(this._overlaysList),this._layerControlInputs=[];var r,h,y,M,I=0;for(y=0;y<this._layers.length;y++)M=this._layers[y],this._addItem(M),h=h||M.overlay,r=r||!M.overlay,I+=M.overlay?0:1;return this.options.hideSingleBase&&(r=r&&I>1,this._baseLayersList.style.display=r?"":"none"),this._separator.style.display=h&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var h=this._getLayer(d(r.target)),y=h.overlay?r.type==="add"?"overlayadd":"overlayremove":r.type==="add"?"baselayerchange":null;y&&this._map.fire(y,h)},_createRadioElement:function(r,h){var y='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(h?' checked="checked"':"")+"/>",M=document.createElement("div");return M.innerHTML=y,M.firstChild},_addItem:function(r){var h=document.createElement("label"),y=this._map.hasLayer(r.layer),M;r.overlay?(M=document.createElement("input"),M.type="checkbox",M.className="leaflet-control-layers-selector",M.defaultChecked=y):M=this._createRadioElement("leaflet-base-layers_"+d(this),y),this._layerControlInputs.push(M),M.layerId=d(r.layer),rt(M,"click",this._onInputClick,this);var I=document.createElement("span");I.innerHTML=" "+r.name;var W=document.createElement("span");h.appendChild(W),W.appendChild(M),W.appendChild(I);var te=r.overlay?this._overlaysList:this._baseLayersList;return te.appendChild(h),this._checkDisabledLayers(),h},_onInputClick:function(){var r=this._layerControlInputs,h,y,M=[],I=[];this._handlingClick=!0;for(var W=r.length-1;W>=0;W--)h=r[W],y=this._getLayer(h.layerId).layer,h.checked?M.push(y):h.checked||I.push(y);for(W=0;W<I.length;W++)this._map.hasLayer(I[W])&&this._map.removeLayer(I[W]);for(W=0;W<M.length;W++)this._map.hasLayer(M[W])||this._map.addLayer(M[W]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var r=this._layerControlInputs,h,y,M=this._map.getZoom(),I=r.length-1;I>=0;I--)h=r[I],y=this._getLayer(h.layerId).layer,h.disabled=y.options.minZoom!==void 0&&M<y.options.minZoom||y.options.maxZoom!==void 0&&M>y.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var r=this._section;rt(r,"click",k),this.expand(),setTimeout(function(){Dt(r,"click",k)})}}),Yn=function(r,h,y){return new ut(r,h,y)},Yt=Xe.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(r){var h="leaflet-control-zoom",y=vt("div",h+" leaflet-bar"),M=this.options;return this._zoomInButton=this._createButton(M.zoomInText,M.zoomInTitle,h+"-in",y,this._zoomIn),this._zoomOutButton=this._createButton(M.zoomOutText,M.zoomOutTitle,h+"-out",y,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),y},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,h,y,M,I){var W=vt("a",y,M);return W.innerHTML=r,W.href="#",W.title=h,W.setAttribute("role","button"),W.setAttribute("aria-label",h),T(W),rt(W,"click",N),rt(W,"click",I,this),rt(W,"click",this._refocusOnMap,this),W},_updateDisabled:function(){var r=this._map,h="leaflet-disabled";Gt(this._zoomInButton,h),Gt(this._zoomOutButton,h),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||r._zoom===r.getMinZoom())&&(Je(this._zoomOutButton,h),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||r._zoom===r.getMaxZoom())&&(Je(this._zoomInButton,h),this._zoomInButton.setAttribute("aria-disabled","true"))}});me.mergeOptions({zoomControl:!0}),me.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Yt,this.addControl(this.zoomControl))});var Ti=function(r){return new Yt(r)},De=Xe.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var h="leaflet-control-scale",y=vt("div",h),M=this.options;return this._addScales(M,h+"-line",y),r.on(M.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),y},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,h,y){r.metric&&(this._mScale=vt("div",h,y)),r.imperial&&(this._iScale=vt("div",h,y))},_update:function(){var r=this._map,h=r.getSize().y/2,y=r.distance(r.containerPointToLatLng([0,h]),r.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(y)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var h=this._getRoundNum(r),y=h<1e3?h+" m":h/1e3+" km";this._updateScale(this._mScale,y,h/r)},_updateImperial:function(r){var h=r*3.2808399,y,M,I;h>5280?(y=h/5280,M=this._getRoundNum(y),this._updateScale(this._iScale,M+" mi",M/y)):(I=this._getRoundNum(h),this._updateScale(this._iScale,I+" ft",I/h))},_updateScale:function(r,h,y){r.style.width=Math.round(this.options.maxWidth*y)+"px",r.innerHTML=h},_getRoundNum:function(r){var h=Math.pow(10,(Math.floor(r)+"").length-1),y=r/h;return y=y>=10?10:y>=5?5:y>=3?3:y>=2?2:1,h*y}}),gn=function(r){return new De(r)},ht='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ut=Xe.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(je.inlineSvg?ht+" ":"")+"Leaflet</a>"},initialize:function(r){x(this,r),this._attributions={}},onAdd:function(r){r.attributionControl=this,this._container=vt("div","leaflet-control-attribution"),T(this._container);for(var h in r._layers)r._layers[h].getAttribution&&this.addAttribution(r._layers[h].getAttribution());return this._update(),r.on("layeradd",this._addAttribution,this),this._container},onRemove:function(r){r.off("layeradd",this._addAttribution,this)},_addAttribution:function(r){r.layer.getAttribution&&(this.addAttribution(r.layer.getAttribution()),r.layer.once("remove",function(){this.removeAttribution(r.layer.getAttribution())},this))},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r?(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update(),this):this},removeAttribution:function(r){return r?(this._attributions[r]&&(this._attributions[r]--,this._update()),this):this},_update:function(){if(this._map){var r=[];for(var h in this._attributions)this._attributions[h]&&r.push(h);var y=[];this.options.prefix&&y.push(this.options.prefix),r.length&&y.push(r.join(", ")),this._container.innerHTML=y.join(' <span aria-hidden="true">|</span> ')}}});me.mergeOptions({attributionControl:!0}),me.addInitHook(function(){this.options.attributionControl&&new Ut().addTo(this)});var Hn=function(r){return new Ut(r)};Xe.Layers=ut,Xe.Zoom=Yt,Xe.Scale=De,Xe.Attribution=Ut,Ve.layers=Yn,Ve.zoom=Ti,Ve.scale=gn,Ve.attribution=Hn;var Un=Re.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Un.addTo=function(r,h){return r.addHandler(h,this),this};var _i={Events:we},Kn=je.touch?"touchstart mousedown":"mousedown",mn=Ue.extend({options:{clickTolerance:3},initialize:function(r,h,y,M){x(this,M),this._element=r,this._dragStartTarget=h||r,this._preventOutline=y},enable:function(){this._enabled||(rt(this._dragStartTarget,Kn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(mn._dragging===this&&this.finishDrag(!0),Dt(this._dragStartTarget,Kn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){if(this._enabled&&(this._moved=!1,!oo(this._element,"leaflet-zoom-anim"))){if(r.touches&&r.touches.length!==1){mn._dragging===this&&this.finishDrag();return}if(!(mn._dragging||r.shiftKey||r.which!==1&&r.button!==1&&!r.touches)&&(mn._dragging=this,this._preventOutline&&Fr(this._element),Bo(),zi(),!this._moving)){this.fire("down");var h=r.touches?r.touches[0]:r,y=Nr(this._element);this._startPoint=new Oe(h.clientX,h.clientY),this._startPos=Ni(this._element),this._parentScale=Do(y);var M=r.type==="mousedown";rt(document,M?"mousemove":"touchmove",this._onMove,this),rt(document,M?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(r){if(this._enabled){if(r.touches&&r.touches.length>1){this._moved=!0;return}var h=r.touches&&r.touches.length===1?r.touches[0]:r,y=new Oe(h.clientX,h.clientY)._subtract(this._startPoint);!y.x&&!y.y||Math.abs(y.x)+Math.abs(y.y)<this.options.clickTolerance||(y.x/=this._parentScale.x,y.y/=this._parentScale.y,k(r),this._moved||(this.fire("dragstart"),this._moved=!0,Je(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Je(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(y),this._moving=!0,this._lastEvent=r,this._updatePosition())}},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),Ht(this._element,this._newPos),this.fire("drag",r)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(r){Gt(document.body,"leaflet-dragging"),this._lastTarget&&(Gt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Dt(document,"mousemove touchmove",this._onMove,this),Dt(document,"mouseup touchend touchcancel",this._onUp,this),so(),Br(),this._moved&&this._moving&&this.fire("dragend",{noInertia:r,distance:this._newPos.distanceTo(this._startPos)}),this._moving=!1,mn._dragging=!1}});function Pi(r,h){if(!h||!r.length)return r.slice();var y=h*h;return r=No(r,y),r=zs(r,y),r}function Ln(r,h,y){return Math.sqrt(hr(r,h,y,!0))}function Xn(r,h,y){return hr(r,h,y)}function zs(r,h){var y=r.length,M=typeof Uint8Array!=void 0+""?Uint8Array:Array,I=new M(y);I[0]=I[y-1]=1,yi(r,I,h,0,y-1);var W,te=[];for(W=0;W<y;W++)I[W]&&te.push(r[W]);return te}function yi(r,h,y,M,I){var W=0,te,se,de;for(se=M+1;se<=I-1;se++)de=hr(r[se],r[M],r[I],!0),de>W&&(te=se,W=de);W>y&&(h[te]=1,yi(r,h,y,M,te),yi(r,h,y,te,I))}function No(r,h){for(var y=[r[0]],M=1,I=0,W=r.length;M<W;M++)zo(r[M],r[I])>h&&(y.push(r[M]),I=M);return I<W-1&&y.push(r[W-1]),y}var ci;function hi(r,h,y,M,I){var W=M?ci:Qn(r,y),te=Qn(h,y),se,de,xe;for(ci=te;;){if(!(W|te))return[r,h];if(W&te)return!1;se=W||te,de=Ct(r,h,se,y,I),xe=Qn(de,y),se===W?(r=de,W=xe):(h=de,te=xe)}}function Ct(r,h,y,M,I){var W=h.x-r.x,te=h.y-r.y,se=M.min,de=M.max,xe,Ae;return y&8?(xe=r.x+W*(de.y-r.y)/te,Ae=de.y):y&4?(xe=r.x+W*(se.y-r.y)/te,Ae=se.y):y&2?(xe=de.x,Ae=r.y+te*(de.x-r.x)/W):y&1&&(xe=se.x,Ae=r.y+te*(se.x-r.x)/W),new Oe(xe,Ae,I)}function Qn(r,h){var y=0;return r.x<h.min.x?y|=1:r.x>h.max.x&&(y|=2),r.y<h.min.y?y|=4:r.y>h.max.y&&(y|=8),y}function zo(r,h){var y=h.x-r.x,M=h.y-r.y;return y*y+M*M}function hr(r,h,y,M){var I=h.x,W=h.y,te=y.x-I,se=y.y-W,de=te*te+se*se,xe;return de>0&&(xe=((r.x-I)*te+(r.y-W)*se)/de,xe>1?(I=y.x,W=y.y):xe>0&&(I+=te*xe,W+=se*xe)),te=r.x-I,se=r.y-W,M?te*te+se*se:new Oe(I,W)}function An(r){return!F(r[0])||typeof r[0][0]!="object"&&typeof r[0][0]<"u"}function ys(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),An(r)}function Yi(r,h){var y,M,I,W,te,se,de,xe;if(!r||r.length===0)throw new Error("latlngs not passed");An(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var Ae=[];for(var tt in r)Ae.push(h.project(Ke(r[tt])));var bt=Ae.length;for(y=0,M=0;y<bt-1;y++)M+=Ae[y].distanceTo(Ae[y+1])/2;if(M===0)xe=Ae[0];else for(y=0,W=0;y<bt-1;y++)if(te=Ae[y],se=Ae[y+1],I=te.distanceTo(se),W+=I,W>M){de=(W-M)/I,xe=[se.x-de*(se.x-te.x),se.y-de*(se.y-te.y)];break}return h.unproject(Ne(xe))}var js={__proto__:null,simplify:Pi,pointToSegmentDistance:Ln,closestPointOnSegment:Xn,clipSegment:hi,_getEdgeIntersection:Ct,_getBitCode:Qn,_sqClosestPointOnSegment:hr,isFlat:An,_flat:ys,polylineCenter:Yi};function vs(r,h,y){var M,I=[1,4,2,8],W,te,se,de,xe,Ae,tt,bt;for(W=0,Ae=r.length;W<Ae;W++)r[W]._code=Qn(r[W],h);for(se=0;se<4;se++){for(tt=I[se],M=[],W=0,Ae=r.length,te=Ae-1;W<Ae;te=W++)de=r[W],xe=r[te],de._code&tt?xe._code&tt||(bt=Ct(xe,de,tt,h,y),bt._code=Qn(bt,h),M.push(bt)):(xe._code&tt&&(bt=Ct(xe,de,tt,h,y),bt._code=Qn(bt,h),M.push(bt)),M.push(de));r=M}return r}function bs(r,h){var y,M,I,W,te,se,de,xe,Ae;if(!r||r.length===0)throw new Error("latlngs not passed");An(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var tt=[];for(var bt in r)tt.push(h.project(Ke(r[bt])));var bi=tt.length;for(se=de=xe=0,y=0,M=bi-1;y<bi;M=y++)I=tt[y],W=tt[M],te=I.y*W.x-W.y*I.x,de+=(I.x+W.x)*te,xe+=(I.y+W.y)*te,se+=te*3;return se===0?Ae=tt[0]:Ae=[de/se,xe/se],h.unproject(Ne(Ae))}var Hs={__proto__:null,clipPolygon:vs,polygonCenter:bs},jo={project:function(r){return new Oe(r.lng,r.lat)},unproject:function(r){return new et(r.y,r.x)},bounds:new it([-180,-90],[180,90])},fr={R:6378137,R_MINOR:6356752314245179e-9,bounds:new it([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(r){var h=Math.PI/180,y=this.R,M=r.lat*h,I=this.R_MINOR/y,W=Math.sqrt(1-I*I),te=W*Math.sin(M),se=Math.tan(Math.PI/4-M/2)/Math.pow((1-te)/(1+te),W/2);return M=-y*Math.log(Math.max(se,1e-10)),new Oe(r.lng*h*y,M)},unproject:function(r){for(var h=180/Math.PI,y=this.R,M=this.R_MINOR/y,I=Math.sqrt(1-M*M),W=Math.exp(-r.y/y),te=Math.PI/2-2*Math.atan(W),se=0,de=.1,xe;se<15&&Math.abs(de)>1e-7;se++)xe=I*Math.sin(te),xe=Math.pow((1-xe)/(1+xe),I/2),de=Math.PI/2-2*Math.atan(W*xe)-te,te+=de;return new et(te*h,r.x*h/y)}},Us={__proto__:null,LonLat:jo,Mercator:fr,SphericalMercator:Fn},Ws=n({},Be,{code:"EPSG:3395",projection:fr,transformation:function(){var r=.5/(Math.PI*fr.R);return fn(r,.5,-r,.5)}()}),dr=n({},Be,{code:"EPSG:4326",projection:jo,transformation:fn(1/180,1,-1/180,.5)}),xs=n({},Mt,{projection:jo,transformation:fn(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,h){var y=h.lng-r.lng,M=h.lat-r.lat;return Math.sqrt(y*y+M*M)},infinite:!0});Mt.Earth=Be,Mt.EPSG3395=Ws,Mt.EPSG3857=B,Mt.EPSG900913=w,Mt.EPSG4326=dr,Mt.Simple=xs;var On=Ue.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[d(r)]=this,this},removeInteractiveTarget:function(r){return delete this._map._targets[d(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var h=r.target;if(h.hasLayer(this)){if(this._map=h,this._zoomAnimated=h._zoomAnimated,this.getEvents){var y=this.getEvents();h.on(y,this),this.once("remove",function(){h.off(y,this)},this)}this.onAdd(h),this.fire("add"),h.fire("layeradd",{layer:this})}}});me.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var h=d(r);return this._layers[h]?this:(this._layers[h]=r,r._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r),this)},removeLayer:function(r){var h=d(r);return this._layers[h]?(this._loaded&&r.onRemove(this),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null,this):this},hasLayer:function(r){return d(r)in this._layers},eachLayer:function(r,h){for(var y in this._layers)r.call(h,this._layers[y]);return this},_addLayers:function(r){r=r?F(r)?r:[r]:[];for(var h=0,y=r.length;h<y;h++)this.addLayer(r[h])},_addZoomLimit:function(r){(!isNaN(r.options.maxZoom)||!isNaN(r.options.minZoom))&&(this._zoomBoundLayers[d(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var h=d(r);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,h=-1/0,y=this._getZoomSpan();for(var M in this._zoomBoundLayers){var I=this._zoomBoundLayers[M].options;r=I.minZoom===void 0?r:Math.min(r,I.minZoom),h=I.maxZoom===void 0?h:Math.max(h,I.maxZoom)}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=r===1/0?void 0:r,y!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ki=On.extend({initialize:function(r,h){x(this,h),this._layers={};var y,M;if(r)for(y=0,M=r.length;y<M;y++)this.addLayer(r[y])},addLayer:function(r){var h=this.getLayerId(r);return this._layers[h]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var h=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this},hasLayer:function(r){var h=typeof r=="number"?r:this.getLayerId(r);return h in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var h=Array.prototype.slice.call(arguments,1),y,M;for(y in this._layers)M=this._layers[y],M[r]&&M[r].apply(M,h);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,h){for(var y in this._layers)r.call(h,this._layers[y]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return d(r)}}),vi=function(r,h){return new Ki(r,h)},sn=Ki.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),Ki.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),Ki.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new Et;for(var h in this._layers){var y=this._layers[h];r.extend(y.getBounds?y.getBounds():y.getLatLng())}return r}}),ws=function(r,h){return new sn(r,h)},xt=Re.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(r){x(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,h){var y=this._getIconUrl(r);if(!y){if(r==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var M=this._createImg(y,h&&h.tagName==="IMG"?h:null);return this._setIconStyles(M,r),(this.options.crossOrigin||this.options.crossOrigin==="")&&(M.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),M},_setIconStyles:function(r,h){var y=this.options,M=y[h+"Size"];typeof M=="number"&&(M=[M,M]);var I=Ne(M),W=Ne(h==="shadow"&&y.shadowAnchor||y.iconAnchor||I&&I.divideBy(2,!0));r.className="leaflet-marker-"+h+" "+(y.className||""),W&&(r.style.marginLeft=-W.x+"px",r.style.marginTop=-W.y+"px"),I&&(r.style.width=I.x+"px",r.style.height=I.y+"px")},_createImg:function(r,h){return h=h||document.createElement("img"),h.src=r,h},_getIconUrl:function(r){return je.retina&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}});function Ho(r){return new xt(r)}var Sn=xt.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return typeof Sn.imagePath!="string"&&(Sn.imagePath=this._detectIconPath()),(this.options.imagePath||Sn.imagePath)+xt.prototype._getIconUrl.call(this,r)},_stripUrl:function(r){var h=function(y,M,I){var W=M.exec(y);return W&&W[I]};return r=h(r,/^url\((['"])?(.+)\1\)$/,2),r&&h(r,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var r=vt("div","leaflet-default-icon-path",document.body),h=kr(r,"background-image")||kr(r,"backgroundImage");if(document.body.removeChild(r),h=this._stripUrl(h),h)return h;var y=document.querySelector('link[href$="leaflet.css"]');return y?y.href.substring(0,y.href.length-11-1):""}}),fi=Un.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new mn(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Je(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Gt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var h=this._marker,y=h._map,M=this._marker.options.autoPanSpeed,I=this._marker.options.autoPanPadding,W=Ni(h._icon),te=y.getPixelBounds(),se=y.getPixelOrigin(),de=Me(te.min._subtract(se).add(I),te.max._subtract(se).subtract(I));if(!de.contains(W)){var xe=Ne((Math.max(de.max.x,W.x)-de.max.x)/(te.max.x-de.max.x)-(Math.min(de.min.x,W.x)-de.min.x)/(te.min.x-de.min.x),(Math.max(de.max.y,W.y)-de.max.y)/(te.max.y-de.max.y)-(Math.min(de.min.y,W.y)-de.min.y)/(te.min.y-de.min.y)).multiplyBy(M);y.panBy(xe,{animate:!1}),this._draggable._newPos._add(xe),this._draggable._startPos._add(xe),Ht(h._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=X(this._adjustPan.bind(this,r))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(oe(this._panRequest),this._panRequest=X(this._adjustPan.bind(this,r)))},_onDrag:function(r){var h=this._marker,y=h._shadow,M=Ni(h._icon),I=h._map.layerPointToLatLng(M);y&&Ht(y,M),h._latlng=I,r.latlng=I,r.oldLatLng=this._oldLatLng,h.fire("move",r).fire("drag",r)},_onDragEnd:function(r){oe(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),pr=On.extend({options:{icon:new Sn,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,h){x(this,h),this._latlng=Ke(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var h=this._latlng;return this._latlng=Ke(r),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var r=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(r)}return this},_initIcon:function(){var r=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),y=r.icon.createIcon(this._icon),M=!1;y!==this._icon&&(this._icon&&this._removeIcon(),M=!0,r.title&&(y.title=r.title),y.tagName==="IMG"&&(y.alt=r.alt||"")),Je(y,h),r.keyboard&&(y.tabIndex="0",y.setAttribute("role","button")),this._icon=y,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rt(y,"focus",this._panOnFocus,this);var I=r.icon.createShadow(this._shadow),W=!1;I!==this._shadow&&(this._removeShadow(),W=!0),I&&(Je(I,h),I.alt=""),this._shadow=I,r.opacity<1&&this._updateOpacity(),M&&this.getPane().appendChild(this._icon),this._initInteraction(),I&&W&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Dt(this._icon,"focus",this._panOnFocus,this),At(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&At(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&Ht(this._icon,r),this._shadow&&Ht(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var h=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(h)},_initInteraction:function(){if(this.options.interactive&&(Je(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),fi)){var r=this.options.draggable;this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new fi(this),r&&this.dragging.enable()}},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&Cn(this._icon,r),this._shadow&&Cn(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var r=this._map;if(r){var h=this.options.icon.options,y=h.iconSize?Ne(h.iconSize):Ne(0,0),M=h.iconAnchor?Ne(h.iconAnchor):Ne(0,0);r.panInside(this._latlng,{paddingTopLeft:M,paddingBottomRight:y.subtract(M)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Uo(r,h){return new pr(r,h)}var ji=On.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return x(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),co=ji.extend({options:{fill:!0,radius:10},initialize:function(r,h){x(this,h),this._latlng=Ke(r),this._radius=this.options.radius},setLatLng:function(r){var h=this._latlng;return this._latlng=Ke(r),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var h=r&&r.radius||this._radius;return ji.prototype.setStyle.call(this,r),this.setRadius(h),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,h=this._radiusY||r,y=this._clickTolerance(),M=[r+y,h+y];this._pxBounds=new it(this._point.subtract(M),this._point.add(M))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Xi(r,h){return new co(r,h)}var jr=co.extend({initialize:function(r,h,y){if(typeof h=="number"&&(h=n({},y,{radius:h})),x(this,h),this._latlng=Ke(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new Et(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:ji.prototype.setStyle,_project:function(){var r=this._latlng.lng,h=this._latlng.lat,y=this._map,M=y.options.crs;if(M.distance===Be.distance){var I=Math.PI/180,W=this._mRadius/Be.R/I,te=y.project([h+W,r]),se=y.project([h-W,r]),de=te.add(se).divideBy(2),xe=y.unproject(de).lat,Ae=Math.acos((Math.cos(W*I)-Math.sin(h*I)*Math.sin(xe*I))/(Math.cos(h*I)*Math.cos(xe*I)))/I;(isNaN(Ae)||Ae===0)&&(Ae=W/Math.cos(Math.PI/180*h)),this._point=de.subtract(y.getPixelOrigin()),this._radius=isNaN(Ae)?0:de.x-y.project([xe,r-Ae]).x,this._radiusY=de.y-te.y}else{var tt=M.unproject(M.project(this._latlng).subtract([this._mRadius,0]));this._point=y.latLngToLayerPoint(this._latlng),this._radius=this._point.x-y.latLngToLayerPoint(tt).x}this._updateBounds()}});function Wo(r,h,y){return new jr(r,h,y)}var Wn=ji.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,h){x(this,h),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var h=1/0,y=null,M=hr,I,W,te=0,se=this._parts.length;te<se;te++)for(var de=this._parts[te],xe=1,Ae=de.length;xe<Ae;xe++){I=de[xe-1],W=de[xe];var tt=M(r,I,W,!0);tt<h&&(h=tt,y=M(r,I,W))}return y&&(y.distance=Math.sqrt(h)),y},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Yi(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(r,h){return h=h||this._defaultShape(),r=Ke(r),h.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new Et,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return An(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var h=[],y=An(r),M=0,I=r.length;M<I;M++)y?(h[M]=Ke(r[M]),this._bounds.extend(h[M])):h[M]=this._convertLatLngs(r[M]);return h},_project:function(){var r=new it;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),h=new Oe(r,r);this._rawPxBounds&&(this._pxBounds=new it([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)]))},_projectLatlngs:function(r,h,y){var M=r[0]instanceof et,I=r.length,W,te;if(M){for(te=[],W=0;W<I;W++)te[W]=this._map.latLngToLayerPoint(r[W]),y.extend(te[W]);h.push(te)}else for(W=0;W<I;W++)this._projectLatlngs(r[W],h,y)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}var h=this._parts,y,M,I,W,te,se,de;for(y=0,I=0,W=this._rings.length;y<W;y++)for(de=this._rings[y],M=0,te=de.length;M<te-1;M++)se=hi(de[M],de[M+1],r,M,!0),se&&(h[I]=h[I]||[],h[I].push(se[0]),(se[1]!==de[M+1]||M===te-2)&&(h[I].push(se[1]),I++))}},_simplifyPoints:function(){for(var r=this._parts,h=this.options.smoothFactor,y=0,M=r.length;y<M;y++)r[y]=Pi(r[y],h)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,h){var y,M,I,W,te,se,de=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(y=0,W=this._parts.length;y<W;y++)for(se=this._parts[y],M=0,te=se.length,I=te-1;M<te;I=M++)if(!(!h&&M===0)&&Ln(r,se[I],se[M])<=de)return!0;return!1}});function ho(r,h){return new Wn(r,h)}Wn._flat=ys;var Hi=Wn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return bs(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(r){var h=Wn.prototype._convertLatLngs.call(this,r),y=h.length;return y>=2&&h[0]instanceof et&&h[0].equals(h[y-1])&&h.pop(),h},_setLatLngs:function(r){Wn.prototype._setLatLngs.call(this,r),An(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return An(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var r=this._renderer._bounds,h=this.options.weight,y=new Oe(h,h);if(r=new it(r.min.subtract(y),r.max.add(y)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}for(var M=0,I=this._rings.length,W;M<I;M++)W=vs(this._rings[M],r,!0),W.length&&this._parts.push(W)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var h=!1,y,M,I,W,te,se,de,xe;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(W=0,de=this._parts.length;W<de;W++)for(y=this._parts[W],te=0,xe=y.length,se=xe-1;te<xe;se=te++)M=y[te],I=y[se],M.y>r.y!=I.y>r.y&&r.x<(I.x-M.x)*(r.y-M.y)/(I.y-M.y)+M.x&&(h=!h);return h||Wn.prototype._containsPoint.call(this,r,!0)}});function Vs(r,h){return new Hi(r,h)}var Jn=sn.extend({initialize:function(r,h){x(this,h),this._layers={},r&&this.addData(r)},addData:function(r){var h=F(r)?r:r.features,y,M,I;if(h){for(y=0,M=h.length;y<M;y++)I=h[y],(I.geometries||I.geometry||I.features||I.coordinates)&&this.addData(I);return this}var W=this.options;if(W.filter&&!W.filter(r))return this;var te=gr(r,W);return te?(te.feature=ue(r),te.defaultOptions=te.options,this.resetStyle(te),W.onEachFeature&&W.onEachFeature(r,te),this.addLayer(te)):this},resetStyle:function(r){return r===void 0?this.eachLayer(this.resetStyle,this):(r.options=n({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(h){this._setLayerStyle(h,r)},this)},_setLayerStyle:function(r,h){r.setStyle&&(typeof h=="function"&&(h=h(r.feature)),r.setStyle(h))}});function gr(r,h){var y=r.type==="Feature"?r.geometry:r,M=y?y.coordinates:null,I=[],W=h&&h.pointToLayer,te=h&&h.coordsToLatLng||fo,se,de,xe,Ae;if(!M&&!y)return null;switch(y.type){case"Point":return se=te(M),Hr(W,r,se,h);case"MultiPoint":for(xe=0,Ae=M.length;xe<Ae;xe++)se=te(M[xe]),I.push(Hr(W,r,se,h));return new sn(I);case"LineString":case"MultiLineString":return de=Y(M,y.type==="LineString"?0:1,te),new Wn(de,h);case"Polygon":case"MultiPolygon":return de=Y(M,y.type==="Polygon"?1:2,te),new Hi(de,h);case"GeometryCollection":for(xe=0,Ae=y.geometries.length;xe<Ae;xe++){var tt=gr({geometry:y.geometries[xe],type:"Feature",properties:r.properties},h);tt&&I.push(tt)}return new sn(I);case"FeatureCollection":for(xe=0,Ae=y.features.length;xe<Ae;xe++){var bt=gr(y.features[xe],h);bt&&I.push(bt)}return new sn(I);default:throw new Error("Invalid GeoJSON object.")}}function Hr(r,h,y,M){return r?r(h,y):new pr(y,M&&M.markersInheritOptions&&M)}function fo(r){return new et(r[1],r[0],r[2])}function Y(r,h,y){for(var M=[],I=0,W=r.length,te;I<W;I++)te=h?Y(r[I],h-1,y):(y||fo)(r[I]),M.push(te);return M}function ne(r,h){return r=Ke(r),r.alt!==void 0?[m(r.lng,h),m(r.lat,h),m(r.alt,h)]:[m(r.lng,h),m(r.lat,h)]}function re(r,h,y,M){for(var I=[],W=0,te=r.length;W<te;W++)I.push(h?re(r[W],An(r[W])?0:h-1,y,M):ne(r[W],M));return!h&&y&&I.push(I[0].slice()),I}function ce(r,h){return r.feature?n({},r.feature,{geometry:h}):ue(h)}function ue(r){return r.type==="Feature"||r.type==="FeatureCollection"?r:{type:"Feature",properties:{},geometry:r}}var ye={toGeoJSON:function(r){return ce(this,{type:"Point",coordinates:ne(this.getLatLng(),r)})}};pr.include(ye),jr.include(ye),co.include(ye),Wn.include({toGeoJSON:function(r){var h=!An(this._latlngs),y=re(this._latlngs,h?1:0,!1,r);return ce(this,{type:(h?"Multi":"")+"LineString",coordinates:y})}}),Hi.include({toGeoJSON:function(r){var h=!An(this._latlngs),y=h&&!An(this._latlngs[0]),M=re(this._latlngs,y?2:h?1:0,!0,r);return h||(M=[M]),ce(this,{type:(y?"Multi":"")+"Polygon",coordinates:M})}}),Ki.include({toMultiPoint:function(r){var h=[];return this.eachLayer(function(y){h.push(y.toGeoJSON(r).geometry.coordinates)}),ce(this,{type:"MultiPoint",coordinates:h})},toGeoJSON:function(r){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(h==="MultiPoint")return this.toMultiPoint(r);var y=h==="GeometryCollection",M=[];return this.eachLayer(function(I){if(I.toGeoJSON){var W=I.toGeoJSON(r);if(y)M.push(W.geometry);else{var te=ue(W);te.type==="FeatureCollection"?M.push.apply(M,te.features):M.push(te)}}}),y?ce(this,{geometries:M,type:"GeometryCollection"}):{type:"FeatureCollection",features:M}}});function ve(r,h){return new Jn(r,h)}var Te=ve,Fe=On.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,h,y){this._url=r,this._bounds=mt(h),x(this,y)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Je(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){At(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&Fi(this._image),this},bringToBack:function(){return this._map&&ur(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=mt(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r=this._url.tagName==="IMG",h=this._image=r?this._url:vt("img");if(Je(h,"leaflet-image-layer"),this._zoomAnimated&&Je(h,"leaflet-zoom-animated"),this.options.className&&Je(h,this.options.className),h.onselectstart=p,h.onmousemove=p,h.onload=a(this.fire,this,"load"),h.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r){this._url=h.src;return}h.src=this._url,h.alt=this.options.alt},_animateZoom:function(r){var h=this._map.getZoomScale(r.zoom),y=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;En(this._image,y,h)},_reset:function(){var r=this._image,h=new it(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),y=h.getSize();Ht(r,h.min),r.style.width=y.x+"px",r.style.height=y.y+"px"},_updateOpacity:function(){Cn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)},getCenter:function(){return this._bounds.getCenter()}}),st=function(r,h,y){return new Fe(r,h,y)},qe=Fe.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var r=this._url.tagName==="VIDEO",h=this._image=r?this._url:vt("video");if(Je(h,"leaflet-image-layer"),this._zoomAnimated&&Je(h,"leaflet-zoom-animated"),this.options.className&&Je(h,this.options.className),h.onselectstart=p,h.onmousemove=p,h.onloadeddata=a(this.fire,this,"load"),r){for(var y=h.getElementsByTagName("source"),M=[],I=0;I<y.length;I++)M.push(y[I].src);this._url=y.length>0?M:[h.src];return}F(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted,h.playsInline=!!this.options.playsInline;for(var W=0;W<this._url.length;W++){var te=vt("source");te.src=this._url[W],h.appendChild(te)}}});function Ye(r,h,y){return new qe(r,h,y)}var It=Fe.extend({_initImage:function(){var r=this._image=this._url;Je(r,"leaflet-image-layer"),this._zoomAnimated&&Je(r,"leaflet-zoom-animated"),this.options.className&&Je(r,this.options.className),r.onselectstart=p,r.onmousemove=p}});function gt(r,h,y){return new It(r,h,y)}var dt=On.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(r,h){r&&(r instanceof et||F(r))?(this._latlng=Ke(r),x(this,h)):(x(this,r),this._source=h),this.options.content&&(this._content=this.options.content)},openOn:function(r){return r=arguments.length?r:this._source._map,r.hasLayer(this)||r.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(r){return this._map?this.close():(arguments.length?this._source=r:r=this._source,this._prepareOpen(),this.openOn(r._map)),this},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&Cn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&Cn(this._container,1),this.bringToFront(),this.options.interactive&&(Je(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(r){r._fadeAnimated?(Cn(this._container,0),this._removeTimeout=setTimeout(a(At,void 0,this._container),200)):At(this._container),this.options.interactive&&(Gt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=Ke(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Fi(this._container),this},bringToBack:function(){return this._map&&ur(this._container),this},_prepareOpen:function(r){var h=this._source;if(!h._map)return!1;if(h instanceof sn){h=null;var y=this._source._layers;for(var M in y)if(y[M]._map){h=y[M];break}if(!h)return!1;this._source=h}if(!r)if(h.getCenter)r=h.getCenter();else if(h.getLatLng)r=h.getLatLng();else if(h.getBounds)r=h.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(r),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var r=this._contentNode,h=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof h=="string")r.innerHTML=h;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(h)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var r=this._map.latLngToLayerPoint(this._latlng),h=Ne(this.options.offset),y=this._getAnchor();this._zoomAnimated?Ht(this._container,r.add(y)):h=h.add(r).add(y);var M=this._containerBottom=-h.y,I=this._containerLeft=-Math.round(this._containerWidth/2)+h.x;this._container.style.bottom=M+"px",this._container.style.left=I+"px"}},_getAnchor:function(){return[0,0]}});me.include({_initOverlay:function(r,h,y,M){var I=h;return I instanceof r||(I=new r(M).setContent(h)),y&&I.setLatLng(y),I}}),On.include({_initOverlay:function(r,h,y,M){var I=y;return I instanceof r?(x(I,M),I._source=this):(I=h&&!M?h:new r(M,this),I.setContent(y)),I}});var $t=dt.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r=arguments.length?r:this._source._map,!r.hasLayer(this)&&r._popup&&r._popup.options.autoClose&&r.removeLayer(r._popup),r._popup=this,dt.prototype.openOn.call(this,r)},onAdd:function(r){dt.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ji||this._source.on("preclick",g))},onRemove:function(r){dt.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ji||this._source.off("preclick",g))},getEvents:function(){var r=dt.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this.close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_initLayout:function(){var r="leaflet-popup",h=this._container=vt("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),y=this._wrapper=vt("div",r+"-content-wrapper",h);if(this._contentNode=vt("div",r+"-content",y),T(h),C(this._contentNode),rt(h,"contextmenu",g),this._tipContainer=vt("div",r+"-tip-container",h),this._tip=vt("div",r+"-tip",this._tipContainer),this.options.closeButton){var M=this._closeButton=vt("a",r+"-close-button",h);M.setAttribute("role","button"),M.setAttribute("aria-label","Close popup"),M.href="#close",M.innerHTML='<span aria-hidden="true">&#215;</span>',rt(M,"click",function(I){k(I),this.close()},this)}},_updateLayout:function(){var r=this._contentNode,h=r.style;h.width="",h.whiteSpace="nowrap";var y=r.offsetWidth;y=Math.min(y,this.options.maxWidth),y=Math.max(y,this.options.minWidth),h.width=y+1+"px",h.whiteSpace="",h.height="";var M=r.offsetHeight,I=this.options.maxHeight,W="leaflet-popup-scrolled";I&&M>I?(h.height=I+"px",Je(r,W)):Gt(r,W),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var h=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),y=this._getAnchor();Ht(this._container,h.add(y))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var r=this._map,h=parseInt(kr(this._container,"marginBottom"),10)||0,y=this._container.offsetHeight+h,M=this._containerWidth,I=new Oe(this._containerLeft,-y-this._containerBottom);I._add(Ni(this._container));var W=r.layerPointToContainerPoint(I),te=Ne(this.options.autoPanPadding),se=Ne(this.options.autoPanPaddingTopLeft||te),de=Ne(this.options.autoPanPaddingBottomRight||te),xe=r.getSize(),Ae=0,tt=0;W.x+M+de.x>xe.x&&(Ae=W.x+M-xe.x+de.x),W.x-Ae-se.x<0&&(Ae=W.x-se.x),W.y+y+de.y>xe.y&&(tt=W.y+y-xe.y+de.y),W.y-tt-se.y<0&&(tt=W.y-se.y),(Ae||tt)&&(this.options.keepInView&&(this._autopanning=!0),r.fire("autopanstart").panBy([Ae,tt]))}},_getAnchor:function(){return Ne(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),an=function(r,h){return new $t(r,h)};me.mergeOptions({closePopupOnClick:!0}),me.include({openPopup:function(r,h,y){return this._initOverlay($t,r,h,y).openOn(this),this},closePopup:function(r){return r=arguments.length?r:this._popup,r&&r.close(),this}}),On.include({bindPopup:function(r,h){return this._popup=this._initOverlay($t,this._popup,r,h),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r){return this._popup&&(this instanceof sn||(this._popup._source=this),this._popup._prepareOpen(r||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){if(!(!this._popup||!this._map)){N(r);var h=r.layer||r.target;if(this._popup._source===h&&!(h instanceof ji)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(r.latlng);return}this._popup._source=h,this.openPopup(r.latlng)}},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){r.originalEvent.keyCode===13&&this._openPopup(r)}});var _n=dt.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(r){dt.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(r){dt.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var r=dt.prototype.getEvents.call(this);return this.options.permanent||(r.preclick=this.close),r},_initLayout:function(){var r="leaflet-tooltip",h=r+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=vt("div",h),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var h,y,M=this._map,I=this._container,W=M.latLngToContainerPoint(M.getCenter()),te=M.layerPointToContainerPoint(r),se=this.options.direction,de=I.offsetWidth,xe=I.offsetHeight,Ae=Ne(this.options.offset),tt=this._getAnchor();se==="top"?(h=de/2,y=xe):se==="bottom"?(h=de/2,y=0):se==="center"?(h=de/2,y=xe/2):se==="right"?(h=0,y=xe/2):se==="left"?(h=de,y=xe/2):te.x<W.x?(se="right",h=0,y=xe/2):(se="left",h=de+(Ae.x+tt.x)*2,y=xe/2),r=r.subtract(Ne(h,y,!0)).add(Ae).add(tt),Gt(I,"leaflet-tooltip-right"),Gt(I,"leaflet-tooltip-left"),Gt(I,"leaflet-tooltip-top"),Gt(I,"leaflet-tooltip-bottom"),Je(I,"leaflet-tooltip-"+se),Ht(I,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&Cn(this._container,r)},_animateZoom:function(r){var h=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(h)},_getAnchor:function(){return Ne(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),zt=function(r,h){return new _n(r,h)};me.include({openTooltip:function(r,h,y){return this._initOverlay(_n,r,h,y).openOn(this),this},closeTooltip:function(r){return r.close(),this}}),On.include({bindTooltip:function(r,h){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(_n,this._tooltip,r,h),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){if(!(!r&&this._tooltipHandlersAdded)){var h=r?"off":"on",y={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?y.add=this._openTooltip:(y.mouseover=this._openTooltip,y.mouseout=this.closeTooltip,y.click=this._openTooltip,this._map?this._addFocusListeners():y.add=this._addFocusListeners),this._tooltip.options.sticky&&(y.mousemove=this._moveTooltip),this[h](y),this._tooltipHandlersAdded=!r}},openTooltip:function(r){return this._tooltip&&(this instanceof sn||(this._tooltip._source=this),this._tooltip._prepareOpen(r)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(r){var h=r.getElement();h&&(rt(h,"focus",function(){this._tooltip._source=r,this.openTooltip()},this),rt(h,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(r){var h=r.getElement();h&&h.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(r){!this._tooltip||!this._map||this._map.dragging&&this._map.dragging.moving()||(this._tooltip._source=r.layer||r.target,this.openTooltip(this._tooltip.options.sticky?r.latlng:void 0))},_moveTooltip:function(r){var h=r.latlng,y,M;this._tooltip.options.sticky&&r.originalEvent&&(y=this._map.mouseEventToContainerPoint(r.originalEvent),M=this._map.containerPointToLayerPoint(y),h=this._map.layerPointToLatLng(M)),this._tooltip.setLatLng(h)}});var Qi=xt.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var h=r&&r.tagName==="DIV"?r:document.createElement("div"),y=this.options;if(y.html instanceof Element?(ro(h),h.appendChild(y.html)):h.innerHTML=y.html!==!1?y.html:"",y.bgPos){var M=Ne(y.bgPos);h.style.backgroundPosition=-M.x+"px "+-M.y+"px"}return this._setIconStyles(h,"icon"),h},createShadow:function(){return null}});function kn(r){return new Qi(r)}xt.Default=Sn;var Vo=On.extend({options:{tileSize:256,opacity:1,updateWhenIdle:je.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){x(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),At(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Fi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ur(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var r=this._clampZoom(this._map.getZoom());r!==this._tileZoom&&(this._tileZoom=r,this._updateLevels()),this._update()}return this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=l(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof Oe?r:new Oe(r,r)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var h=this.getPane().children,y=-r(-1/0,1/0),M=0,I=h.length,W;M<I;M++)W=h[M].style.zIndex,h[M]!==this._container&&W&&(y=r(y,+W));isFinite(y)&&(this.options.zIndex=y+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!je.ielt9){Cn(this._container,this.options.opacity);var r=+new Date,h=!1,y=!1;for(var M in this._tiles){var I=this._tiles[M];if(!(!I.current||!I.loaded)){var W=Math.min(1,(r-I.loaded)/200);Cn(I.el,W),W<1?h=!0:(I.active?y=!0:this._onOpaqueTile(I),I.active=!0)}}y&&!this._noPrune&&this._pruneTiles(),h&&(oe(this._fadeFrame),this._fadeFrame=X(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=vt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,h=this.options.maxZoom;if(r!==void 0){for(var y in this._levels)y=Number(y),this._levels[y].el.children.length||y===r?(this._levels[y].el.style.zIndex=h-Math.abs(r-y),this._onUpdateLevel(y)):(At(this._levels[y].el),this._removeTilesAtZoom(y),this._onRemoveLevel(y),delete this._levels[y]);var M=this._levels[r],I=this._map;return M||(M=this._levels[r]={},M.el=vt("div","leaflet-tile-container leaflet-zoom-animated",this._container),M.el.style.zIndex=h,M.origin=I.project(I.unproject(I.getPixelOrigin()),r).round(),M.zoom=r,this._setZoomTransform(M,I.getCenter(),I.getZoom()),p(M.el.offsetWidth),this._onCreateLevel(M)),this._level=M,M}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var r,h,y=this._map.getZoom();if(y>this.options.maxZoom||y<this.options.minZoom){this._removeAllTiles();return}for(r in this._tiles)h=this._tiles[r],h.retain=h.current;for(r in this._tiles)if(h=this._tiles[r],h.current&&!h.active){var M=h.coords;this._retainParent(M.x,M.y,M.z,M.z-5)||this._retainChildren(M.x,M.y,M.z,M.z+2)}for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}},_removeTilesAtZoom:function(r){for(var h in this._tiles)this._tiles[h].coords.z===r&&this._removeTile(h)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)At(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,h,y,M){var I=Math.floor(r/2),W=Math.floor(h/2),te=y-1,se=new Oe(+I,+W);se.z=+te;var de=this._tileCoordsToKey(se),xe=this._tiles[de];return xe&&xe.active?(xe.retain=!0,!0):(xe&&xe.loaded&&(xe.retain=!0),te>M?this._retainParent(I,W,te,M):!1)},_retainChildren:function(r,h,y,M){for(var I=2*r;I<2*r+2;I++)for(var W=2*h;W<2*h+2;W++){var te=new Oe(I,W);te.z=y+1;var se=this._tileCoordsToKey(te),de=this._tiles[se];if(de&&de.active){de.retain=!0;continue}else de&&de.loaded&&(de.retain=!0);y+1<M&&this._retainChildren(I,W,y+1,M)}},_resetView:function(r){var h=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var h=this.options;return h.minNativeZoom!==void 0&&r<h.minNativeZoom?h.minNativeZoom:h.maxNativeZoom!==void 0&&h.maxNativeZoom<r?h.maxNativeZoom:r},_setView:function(r,h,y,M){var I=Math.round(h);this.options.maxZoom!==void 0&&I>this.options.maxZoom||this.options.minZoom!==void 0&&I<this.options.minZoom?I=void 0:I=this._clampZoom(I);var W=this.options.updateWhenZooming&&I!==this._tileZoom;(!M||W)&&(this._tileZoom=I,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),I!==void 0&&this._update(r),y||this._pruneTiles(),this._noPrune=!!y),this._setZoomTransforms(r,h)},_setZoomTransforms:function(r,h){for(var y in this._levels)this._setZoomTransform(this._levels[y],r,h)},_setZoomTransform:function(r,h,y){var M=this._map.getZoomScale(y,r.zoom),I=r.origin.multiplyBy(M).subtract(this._map._getNewPixelOrigin(h,y)).round();je.any3d?En(r.el,I,M):Ht(r.el,I)},_resetGrid:function(){var r=this._map,h=r.options.crs,y=this._tileSize=this.getTileSize(),M=this._tileZoom,I=this._map.getPixelWorldBounds(this._tileZoom);I&&(this._globalTileRange=this._pxBoundsToTileRange(I)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,h.wrapLng[0]],M).x/y.x),Math.ceil(r.project([0,h.wrapLng[1]],M).x/y.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([h.wrapLat[0],0],M).y/y.x),Math.ceil(r.project([h.wrapLat[1],0],M).y/y.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(r){var h=this._map,y=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),M=h.getZoomScale(y,this._tileZoom),I=h.project(r,this._tileZoom).floor(),W=h.getSize().divideBy(M*2);return new it(I.subtract(W),I.add(W))},_update:function(r){var h=this._map;if(h){var y=this._clampZoom(h.getZoom());if(r===void 0&&(r=h.getCenter()),this._tileZoom!==void 0){var M=this._getTiledPixelBounds(r),I=this._pxBoundsToTileRange(M),W=I.getCenter(),te=[],se=this.options.keepBuffer,de=new it(I.getBottomLeft().subtract([se,-se]),I.getTopRight().add([se,-se]));if(!(isFinite(I.min.x)&&isFinite(I.min.y)&&isFinite(I.max.x)&&isFinite(I.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var xe in this._tiles){var Ae=this._tiles[xe].coords;(Ae.z!==this._tileZoom||!de.contains(new Oe(Ae.x,Ae.y)))&&(this._tiles[xe].current=!1)}if(Math.abs(y-this._tileZoom)>1){this._setView(r,y);return}for(var tt=I.min.y;tt<=I.max.y;tt++)for(var bt=I.min.x;bt<=I.max.x;bt++){var bi=new Oe(bt,tt);if(bi.z=this._tileZoom,!!this._isValidTile(bi)){var Vr=this._tiles[this._tileCoordsToKey(bi)];Vr?Vr.current=!0:te.push(bi)}}if(te.sort(function(di,Rn){return di.distanceTo(W)-Rn.distanceTo(W)}),te.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Cs=document.createDocumentFragment();for(bt=0;bt<te.length;bt++)this._addTile(te[bt],Cs);this._level.el.appendChild(Cs)}}}},_isValidTile:function(r){var h=this._map.options.crs;if(!h.infinite){var y=this._globalTileRange;if(!h.wrapLng&&(r.x<y.min.x||r.x>y.max.x)||!h.wrapLat&&(r.y<y.min.y||r.y>y.max.y))return!1}if(!this.options.bounds)return!0;var M=this._tileCoordsToBounds(r);return mt(this.options.bounds).overlaps(M)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var h=this._map,y=this.getTileSize(),M=r.scaleBy(y),I=M.add(y),W=h.unproject(M,r.z),te=h.unproject(I,r.z);return[W,te]},_tileCoordsToBounds:function(r){var h=this._tileCoordsToNwSe(r),y=new Et(h[0],h[1]);return this.options.noWrap||(y=this._map.wrapLatLngBounds(y)),y},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var h=r.split(":"),y=new Oe(+h[0],+h[1]);return y.z=+h[2],y},_removeTile:function(r){var h=this._tiles[r];h&&(At(h.el),delete this._tiles[r],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){Je(r,"leaflet-tile");var h=this.getTileSize();r.style.width=h.x+"px",r.style.height=h.y+"px",r.onselectstart=p,r.onmousemove=p,je.ielt9&&this.options.opacity<1&&Cn(r,this.options.opacity)},_addTile:function(r,h){var y=this._getTilePos(r),M=this._tileCoordsToKey(r),I=this.createTile(this._wrapCoords(r),a(this._tileReady,this,r));this._initTile(I),this.createTile.length<2&&X(a(this._tileReady,this,r,null,I)),Ht(I,y),this._tiles[M]={el:I,coords:r,current:!0},h.appendChild(I),this.fire("tileloadstart",{tile:I,coords:r})},_tileReady:function(r,h,y){h&&this.fire("tileerror",{error:h,tile:y,coords:r});var M=this._tileCoordsToKey(r);y=this._tiles[M],y&&(y.loaded=+new Date,this._map._fadeAnimated?(Cn(y.el,0),oe(this._fadeFrame),this._fadeFrame=X(this._updateOpacity,this)):(y.active=!0,this._pruneTiles()),h||(Je(y.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:y.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),je.ielt9||!this._map._fadeAnimated?X(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var h=new Oe(this._wrapX?f(r.x,this._wrapX):r.x,this._wrapY?f(r.y,this._wrapY):r.y);return h.z=r.z,h},_pxBoundsToTileRange:function(r){var h=this.getTileSize();return new it(r.min.unscaleBy(h).floor(),r.max.unscaleBy(h).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}});function Rl(r){return new Vo(r)}var Ur=Vo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(r,h){this._url=r,h=x(this,h),h.detectRetina&&je.retina&&h.maxZoom>0?(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom=Math.min(h.maxZoom,h.minZoom+1)):(h.zoomOffset++,h.maxZoom=Math.max(h.minZoom,h.maxZoom-1)),h.minZoom=Math.max(0,h.minZoom)):h.zoomReverse?h.minZoom=Math.min(h.maxZoom,h.minZoom):h.maxZoom=Math.max(h.minZoom,h.maxZoom),typeof h.subdomains=="string"&&(h.subdomains=h.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(r,h){return this._url===r&&h===void 0&&(h=!0),this._url=r,h||this.redraw(),this},createTile:function(r,h){var y=document.createElement("img");return rt(y,"load",a(this._tileOnLoad,this,h,y)),rt(y,"error",a(this._tileOnError,this,h,y)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(y.referrerPolicy=this.options.referrerPolicy),y.alt="",y.src=this.getTileUrl(r),y},getTileUrl:function(r){var h={r:je.retina?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var y=this._globalTileRange.max.y-r.y;this.options.tms&&(h.y=y),h["-y"]=y}return E(this._url,n(h,this.options))},_tileOnLoad:function(r,h){je.ielt9?setTimeout(a(r,this,null,h),0):r(null,h)},_tileOnError:function(r,h,y){var M=this.options.errorTileUrl;M&&h.getAttribute("src")!==M&&(h.src=M),r(y,h)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom,h=this.options.maxZoom,y=this.options.zoomReverse,M=this.options.zoomOffset;return y&&(r=h-r),r+M},_getSubdomain:function(r){var h=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[h]},_abortLoading:function(){var r,h;for(r in this._tiles)if(this._tiles[r].coords.z!==this._tileZoom&&(h=this._tiles[r].el,h.onload=p,h.onerror=p,!h.complete)){h.src=P;var y=this._tiles[r].coords;At(h),delete this._tiles[r],this.fire("tileabort",{tile:h,coords:y})}},_removeTile:function(r){var h=this._tiles[r];if(h)return h.el.setAttribute("src",P),Vo.prototype._removeTile.call(this,r)},_tileReady:function(r,h,y){if(!(!this._map||y&&y.getAttribute("src")===P))return Vo.prototype._tileReady.call(this,r,h,y)}});function Zs(r,h){return new Ur(r,h)}var Aa=Ur.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,h){this._url=r;var y=n({},this.defaultWmsParams);for(var M in h)M in this.options||(y[M]=h[M]);h=x(this,h);var I=h.detectRetina&&je.retina?2:1,W=this.getTileSize();y.width=W.x*I,y.height=W.y*I,this.wmsParams=y},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var h=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[h]=this._crs.code,Ur.prototype.onAdd.call(this,r)},getTileUrl:function(r){var h=this._tileCoordsToNwSe(r),y=this._crs,M=Me(y.project(h[0]),y.project(h[1])),I=M.min,W=M.max,te=(this._wmsVersion>=1.3&&this._crs===dr?[I.y,I.x,W.y,W.x]:[I.x,I.y,W.x,W.y]).join(","),se=Ur.prototype.getTileUrl.call(this,r);return se+A(this.wmsParams,se,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+te},setParams:function(r,h){return n(this.wmsParams,r),h||this.redraw(),this}});function Oa(r,h){return new Aa(r,h)}Ur.WMS=Aa,Zs.wms=Oa;var Ei=On.extend({options:{padding:.1},initialize:function(r){x(this,r),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&Je(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,h){var y=this._map.getZoomScale(h,this._zoom),M=this._map.getSize().multiplyBy(.5+this.options.padding),I=this._map.project(this._center,h),W=M.multiplyBy(-y).add(I).subtract(this._map._getNewPixelOrigin(r,h));je.any3d?En(this._container,W,y):Ht(this._container,W)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var r in this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,h=this._map.getSize(),y=this._map.containerPointToLayerPoint(h.multiplyBy(-r)).round();this._bounds=new it(y,y.add(h.multiplyBy(1+r*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),qs=Ei.extend({options:{tolerance:0},getEvents:function(){var r=Ei.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ei.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");rt(r,"mousemove",this._onMouseMove,this),rt(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),rt(r,"mouseout",this._handleMouseOut,this),r._leaflet_disable_events=!0,this._ctx=r.getContext("2d")},_destroyContainer:function(){oe(this._redrawRequest),delete this._ctx,At(this._container),Dt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var r;this._redrawBounds=null;for(var h in this._layers)r=this._layers[h],r._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ei.prototype._update.call(this);var r=this._bounds,h=this._container,y=r.getSize(),M=je.retina?2:1;Ht(h,r.min),h.width=M*y.x,h.height=M*y.y,h.style.width=y.x+"px",h.style.height=y.y+"px",je.retina&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update")}},_reset:function(){Ei.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),this._layers[d(r)]=r;var h=r._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var h=r._order,y=h.next,M=h.prev;y?y.prev=M:this._drawLast=M,M?M.next=y:this._drawFirst=y,delete r._order,delete this._layers[d(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if(typeof r.options.dashArray=="string"){var h=r.options.dashArray.split(/[, ]+/),y=[],M,I;for(I=0;I<h.length;I++){if(M=Number(h[I]),isNaN(M))return;y.push(M)}r.options._dashArray=y}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||X(this._redraw,this))},_extendRedrawBounds:function(r){if(r._pxBounds){var h=(r.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new it,this._redrawBounds.extend(r._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(r._pxBounds.max.add([h,h]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r=this._redrawBounds;if(r){var h=r.getSize();this._ctx.clearRect(r.min.x,r.min.y,h.x,h.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var r,h=this._redrawBounds;if(this._ctx.save(),h){var y=h.getSize();this._ctx.beginPath(),this._ctx.rect(h.min.x,h.min.y,y.x,y.y),this._ctx.clip()}this._drawing=!0;for(var M=this._drawFirst;M;M=M.next)r=M.layer,(!h||r._pxBounds&&r._pxBounds.intersects(h))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,h){if(this._drawing){var y,M,I,W,te=r._parts,se=te.length,de=this._ctx;if(se){for(de.beginPath(),y=0;y<se;y++){for(M=0,I=te[y].length;M<I;M++)W=te[y][M],de[M?"lineTo":"moveTo"](W.x,W.y);h&&de.closePath()}this._fillStroke(de,r)}}},_updateCircle:function(r){if(!(!this._drawing||r._empty())){var h=r._point,y=this._ctx,M=Math.max(Math.round(r._radius),1),I=(Math.max(Math.round(r._radiusY),1)||M)/M;I!==1&&(y.save(),y.scale(1,I)),y.beginPath(),y.arc(h.x,h.y/I,M,0,Math.PI*2,!1),I!==1&&y.restore(),this._fillStroke(y,r)}},_fillStroke:function(r,h){var y=h.options;y.fill&&(r.globalAlpha=y.fillOpacity,r.fillStyle=y.fillColor||y.color,r.fill(y.fillRule||"evenodd")),y.stroke&&y.weight!==0&&(r.setLineDash&&r.setLineDash(h.options&&h.options._dashArray||[]),r.globalAlpha=y.opacity,r.lineWidth=y.weight,r.strokeStyle=y.color,r.lineCap=y.lineCap,r.lineJoin=y.lineJoin,r.stroke())},_onClick:function(r){for(var h=this._map.mouseEventToLayerPoint(r),y,M,I=this._drawFirst;I;I=I.next)y=I.layer,y.options.interactive&&y._containsPoint(h)&&(!(r.type==="click"||r.type==="preclick")||!this._map._draggableMoved(y))&&(M=y);this._fireEvent(M?[M]:!1,r)},_onMouseMove:function(r){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var h=this._map.mouseEventToLayerPoint(r);this._handleMouseHover(r,h)}},_handleMouseOut:function(r){var h=this._hoveredLayer;h&&(Gt(this._container,"leaflet-interactive"),this._fireEvent([h],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,h){if(!this._mouseHoverThrottled){for(var y,M,I=this._drawFirst;I;I=I.next)y=I.layer,y.options.interactive&&y._containsPoint(h)&&(M=y);M!==this._hoveredLayer&&(this._handleMouseOut(r),M&&(Je(this._container,"leaflet-interactive"),this._fireEvent([M],r,"mouseover"),this._hoveredLayer=M)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,r),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,h,y){this._map._fireDOMEvent(h,y||h.type,r)},_bringToFront:function(r){var h=r._order;if(h){var y=h.next,M=h.prev;if(y)y.prev=M;else return;M?M.next=y:y&&(this._drawFirst=y),h.prev=this._drawLast,this._drawLast.next=h,h.next=null,this._drawLast=h,this._requestRedraw(r)}},_bringToBack:function(r){var h=r._order;if(h){var y=h.next,M=h.prev;if(M)M.next=y;else return;y?y.prev=M:M&&(this._drawLast=M),h.prev=null,h.next=this._drawFirst,this._drawFirst.prev=h,this._drawFirst=h,this._requestRedraw(r)}}});function mr(r){return je.canvas?new qs(r):null}var po=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{}return function(r){return document.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Bl={_initContainer:function(){this._container=vt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ei.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var h=r._container=po("shape");Je(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",r._path=po("path"),h.appendChild(r._path),this._updateStyle(r),this._layers[d(r)]=r},_addPath:function(r){var h=r._container;this._container.appendChild(h),r.options.interactive&&r.addInteractiveTarget(h)},_removePath:function(r){var h=r._container;At(h),r.removeInteractiveTarget(h),delete this._layers[d(r)]},_updateStyle:function(r){var h=r._stroke,y=r._fill,M=r.options,I=r._container;I.stroked=!!M.stroke,I.filled=!!M.fill,M.stroke?(h||(h=r._stroke=po("stroke")),I.appendChild(h),h.weight=M.weight+"px",h.color=M.color,h.opacity=M.opacity,M.dashArray?h.dashStyle=F(M.dashArray)?M.dashArray.join(" "):M.dashArray.replace(/( *, *)/g," "):h.dashStyle="",h.endcap=M.lineCap.replace("butt","flat"),h.joinstyle=M.lineJoin):h&&(I.removeChild(h),r._stroke=null),M.fill?(y||(y=r._fill=po("fill")),I.appendChild(y),y.color=M.fillColor||M.color,y.opacity=M.fillOpacity):y&&(I.removeChild(y),r._fill=null)},_updateCircle:function(r){var h=r._point.round(),y=Math.round(r._radius),M=Math.round(r._radiusY||y);this._setPath(r,r._empty()?"M0 0":"AL "+h.x+","+h.y+" "+y+","+M+" 0,"+65535*360)},_setPath:function(r,h){r._path.v=h},_bringToFront:function(r){Fi(r._container)},_bringToBack:function(r){ur(r._container)}},go=je.vml?po:R,Zo=Ei.extend({_initContainer:function(){this._container=go("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=go("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){At(this._container),Dt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ei.prototype._update.call(this);var r=this._bounds,h=r.getSize(),y=this._container;(!this._svgSize||!this._svgSize.equals(h))&&(this._svgSize=h,y.setAttribute("width",h.x),y.setAttribute("height",h.y)),Ht(y,r.min),y.setAttribute("viewBox",[r.min.x,r.min.y,h.x,h.y].join(" ")),this.fire("update")}},_initPath:function(r){var h=r._path=go("path");r.options.className&&Je(h,r.options.className),r.options.interactive&&Je(h,"leaflet-interactive"),this._updateStyle(r),this._layers[d(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){At(r._path),r.removeInteractiveTarget(r._path),delete this._layers[d(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var h=r._path,y=r.options;h&&(y.stroke?(h.setAttribute("stroke",y.color),h.setAttribute("stroke-opacity",y.opacity),h.setAttribute("stroke-width",y.weight),h.setAttribute("stroke-linecap",y.lineCap),h.setAttribute("stroke-linejoin",y.lineJoin),y.dashArray?h.setAttribute("stroke-dasharray",y.dashArray):h.removeAttribute("stroke-dasharray"),y.dashOffset?h.setAttribute("stroke-dashoffset",y.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),y.fill?(h.setAttribute("fill",y.fillColor||y.color),h.setAttribute("fill-opacity",y.fillOpacity),h.setAttribute("fill-rule",y.fillRule||"evenodd")):h.setAttribute("fill","none"))},_updatePoly:function(r,h){this._setPath(r,D(r._parts,h))},_updateCircle:function(r){var h=r._point,y=Math.max(Math.round(r._radius),1),M=Math.max(Math.round(r._radiusY),1)||y,I="a"+y+","+M+" 0 1,0 ",W=r._empty()?"M0 0":"M"+(h.x-y)+","+h.y+I+y*2+",0 "+I+-y*2+",0 ";this._setPath(r,W)},_setPath:function(r,h){r._path.setAttribute("d",h)},_bringToFront:function(r){Fi(r._path)},_bringToBack:function(r){ur(r._path)}});je.vml&&Zo.include(Bl);function Wr(r){return je.svg||je.vml?new Zo(r):null}me.include({getRenderer:function(r){var h=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer;return h||(h=this._renderer=this._createRenderer()),this.hasLayer(h)||this.addLayer(h),h},_getPaneRenderer:function(r){if(r==="overlayPane"||r===void 0)return!1;var h=this._paneRenderers[r];return h===void 0&&(h=this._createRenderer({pane:r}),this._paneRenderers[r]=h),h},_createRenderer:function(r){return this.options.preferCanvas&&mr(r)||Wr(r)}});var ka=Hi.extend({initialize:function(r,h){Hi.prototype.initialize.call(this,this._boundsToLatLngs(r),h)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return r=mt(r),[r.getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});function Dl(r,h){return new ka(r,h)}Zo.create=go,Zo.pointsToPath=D,Jn.geometryToLayer=gr,Jn.coordsToLatLng=fo,Jn.coordsToLatLngs=Y,Jn.latLngToCoords=ne,Jn.latLngsToCoords=re,Jn.getFeature=ce,Jn.asFeature=ue,me.mergeOptions({boxZoom:!0});var Gs=Un.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Dt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){At(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||r.which!==1&&r.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),zi(),Bo(),this._startPoint=this._map.mouseEventToContainerPoint(r),rt(document,{contextmenu:N,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=vt("div","leaflet-zoom-box",this._container),Je(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var h=new it(this._point,this._startPoint),y=h.getSize();Ht(this._box,h.min),this._box.style.width=y.x+"px",this._box.style.height=y.y+"px"},_finish:function(){this._moved&&(At(this._box),Gt(this._container,"leaflet-crosshair")),Br(),so(),Dt(document,{contextmenu:N,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){if(!(r.which!==1&&r.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var h=new Et(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h})}},_onKeyDown:function(r){r.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});me.addInitHook("addHandler","boxZoom",Gs),me.mergeOptions({doubleClickZoom:!0});var Ys=Un.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var h=this._map,y=h.getZoom(),M=h.options.zoomDelta,I=r.originalEvent.shiftKey?y-M:y+M;h.options.doubleClickZoom==="center"?h.setZoom(I):h.setZoomAround(r.containerPoint,I)}});me.addInitHook("addHandler","doubleClickZoom",Ys),me.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ra=Un.extend({addHooks:function(){if(!this._draggable){var r=this._map;this._draggable=new mn(r._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))}Je(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Gt(this._map._container,"leaflet-grab"),Gt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r=this._map;if(r._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var h=mt(this._map.options.maxBounds);this._offsetLimit=Me(this._map.latLngToContainerPoint(h.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(h.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;r.fire("movestart").fire("dragstart"),r.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){if(this._map.options.inertia){var h=this._lastTime=+new Date,y=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(y),this._times.push(h),this._prunePositions(h)}this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;this._positions.length>1&&r-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,h){return r-(r-h)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var r=this._draggable._newPos.subtract(this._draggable._startPos),h=this._offsetLimit;r.x<h.min.x&&(r.x=this._viscousLimit(r.x,h.min.x)),r.y<h.min.y&&(r.y=this._viscousLimit(r.y,h.min.y)),r.x>h.max.x&&(r.x=this._viscousLimit(r.x,h.max.x)),r.y>h.max.y&&(r.y=this._viscousLimit(r.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(r)}},_onPreDragWrap:function(){var r=this._worldWidth,h=Math.round(r/2),y=this._initialWorldOffset,M=this._draggable._newPos.x,I=(M-h+y)%r+h-y,W=(M+h+y)%r-h-y,te=Math.abs(I+y)<Math.abs(W+y)?I:W;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=te},_onDragEnd:function(r){var h=this._map,y=h.options,M=!y.inertia||r.noInertia||this._times.length<2;if(h.fire("dragend",r),M)h.fire("moveend");else{this._prunePositions(+new Date);var I=this._lastPos.subtract(this._positions[0]),W=(this._lastTime-this._times[0])/1e3,te=y.easeLinearity,se=I.multiplyBy(te/W),de=se.distanceTo([0,0]),xe=Math.min(y.inertiaMaxSpeed,de),Ae=se.multiplyBy(xe/de),tt=xe/(y.inertiaDeceleration*te),bt=Ae.multiplyBy(-tt/2).round();!bt.x&&!bt.y?h.fire("moveend"):(bt=h._limitOffset(bt,h.options.maxBounds),X(function(){h.panBy(bt,{duration:tt,easeLinearity:te,noMoveStart:!0,animate:!0})}))}}});me.addInitHook("addHandler","dragging",Ra),me.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ba=Un.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),rt(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Dt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var r=document.body,h=document.documentElement,y=r.scrollTop||h.scrollTop,M=r.scrollLeft||h.scrollLeft;this._map._container.focus(),window.scrollTo(M,y)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){var h=this._panKeys={},y=this.keyCodes,M,I;for(M=0,I=y.left.length;M<I;M++)h[y.left[M]]=[-1*r,0];for(M=0,I=y.right.length;M<I;M++)h[y.right[M]]=[r,0];for(M=0,I=y.down.length;M<I;M++)h[y.down[M]]=[0,r];for(M=0,I=y.up.length;M<I;M++)h[y.up[M]]=[0,-1*r]},_setZoomDelta:function(r){var h=this._zoomKeys={},y=this.keyCodes,M,I;for(M=0,I=y.zoomIn.length;M<I;M++)h[y.zoomIn[M]]=r;for(M=0,I=y.zoomOut.length;M<I;M++)h[y.zoomOut[M]]=-r},_addHooks:function(){rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Dt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var h=r.keyCode,y=this._map,M;if(h in this._panKeys){if(!y._panAnim||!y._panAnim._inProgress)if(M=this._panKeys[h],r.shiftKey&&(M=Ne(M).multiplyBy(3)),y.options.maxBounds&&(M=y._limitOffset(Ne(M),y.options.maxBounds)),y.options.worldCopyJump){var I=y.wrapLatLng(y.unproject(y.project(y.getCenter()).add(M)));y.panTo(I)}else y.panBy(M)}else if(h in this._zoomKeys)y.setZoom(y.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[h]);else if(h===27&&y._popup&&y._popup.options.closeOnEscapeKey)y.closePopup();else return;N(r)}}});me.addInitHook("addHandler","keyboard",Ba),me.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var qo=Un.extend({addHooks:function(){rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Dt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var h=ae(r),y=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var M=Math.max(y-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),M),N(r)},_performZoom:function(){var r=this._map,h=r.getZoom(),y=this._map.options.zoomSnap||0;r._stop();var M=this._delta/(this._map.options.wheelPxPerZoomLevel*4),I=4*Math.log(2/(1+Math.exp(-Math.abs(M))))/Math.LN2,W=y?Math.ceil(I/y)*y:I,te=r._limitZoom(h+(this._delta>0?W:-W))-h;this._delta=0,this._startTime=null,te&&(r.options.scrollWheelZoom==="center"?r.setZoom(h+te):r.setZoomAround(this._lastMousePos,h+te))}});me.addInitHook("addHandler","scrollWheelZoom",qo);var Il=600;me.mergeOptions({tapHold:je.touchNative&&je.safari&&je.mobile,tapTolerance:15});var Ks=Un.extend({addHooks:function(){rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Dt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(clearTimeout(this._holdTimeout),r.touches.length===1){var h=r.touches[0];this._startPos=this._newPos=new Oe(h.clientX,h.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(rt(document,"touchend",k),rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",h))},this),Il),rt(document,"touchend touchcancel contextmenu",this._cancel,this),rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function r(){Dt(document,"touchend",k),Dt(document,"touchend touchcancel",r)},_cancel:function(){clearTimeout(this._holdTimeout),Dt(document,"touchend touchcancel contextmenu",this._cancel,this),Dt(document,"touchmove",this._onMove,this)},_onMove:function(r){var h=r.touches[0];this._newPos=new Oe(h.clientX,h.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(r,h){var y=new MouseEvent(r,{bubbles:!0,cancelable:!0,view:window,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY});y._simulated=!0,h.target.dispatchEvent(y)}});me.addInitHook("addHandler","tapHold",Ks),me.mergeOptions({touchZoom:je.touch,bounceAtZoomLimits:!0});var Xs=Un.extend({addHooks:function(){Je(this._map._container,"leaflet-touch-zoom"),rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Gt(this._map._container,"leaflet-touch-zoom"),Dt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var h=this._map;if(!(!r.touches||r.touches.length!==2||h._animatingZoom||this._zooming)){var y=h.mouseEventToContainerPoint(r.touches[0]),M=h.mouseEventToContainerPoint(r.touches[1]);this._centerPoint=h.getSize()._divideBy(2),this._startLatLng=h.containerPointToLatLng(this._centerPoint),h.options.touchZoom!=="center"&&(this._pinchStartLatLng=h.containerPointToLatLng(y.add(M)._divideBy(2))),this._startDist=y.distanceTo(M),this._startZoom=h.getZoom(),this._moved=!1,this._zooming=!0,h._stop(),rt(document,"touchmove",this._onTouchMove,this),rt(document,"touchend touchcancel",this._onTouchEnd,this),k(r)}},_onTouchMove:function(r){if(!(!r.touches||r.touches.length!==2||!this._zooming)){var h=this._map,y=h.mouseEventToContainerPoint(r.touches[0]),M=h.mouseEventToContainerPoint(r.touches[1]),I=y.distanceTo(M)/this._startDist;if(this._zoom=h.getScaleZoom(I,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&I<1||this._zoom>h.getMaxZoom()&&I>1)&&(this._zoom=h._limitZoom(this._zoom)),h.options.touchZoom==="center"){if(this._center=this._startLatLng,I===1)return}else{var W=y._add(M)._divideBy(2)._subtract(this._centerPoint);if(I===1&&W.x===0&&W.y===0)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(W),this._zoom)}this._moved||(h._moveStart(!0,!1),this._moved=!0),oe(this._animRequest);var te=a(h._move,h,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=X(te,this,!0),k(r)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,oe(this._animRequest),Dt(document,"touchmove",this._onTouchMove,this),Dt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});me.addInitHook("addHandler","touchZoom",Xs),me.BoxZoom=Gs,me.DoubleClickZoom=Ys,me.Drag=Ra,me.Keyboard=Ba,me.ScrollWheelZoom=qo,me.TapHold=Ks,me.TouchZoom=Xs,t.Bounds=it,t.Browser=je,t.CRS=Mt,t.Canvas=qs,t.Circle=jr,t.CircleMarker=co,t.Class=Re,t.Control=Xe,t.DivIcon=Qi,t.DivOverlay=dt,t.DomEvent=he,t.DomUtil=zr,t.Draggable=mn,t.Evented=Ue,t.FeatureGroup=sn,t.GeoJSON=Jn,t.GridLayer=Vo,t.Handler=Un,t.Icon=xt,t.ImageOverlay=Fe,t.LatLng=et,t.LatLngBounds=Et,t.Layer=On,t.LayerGroup=Ki,t.LineUtil=js,t.Map=me,t.Marker=pr,t.Mixin=_i,t.Path=ji,t.Point=Oe,t.PolyUtil=Hs,t.Polygon=Hi,t.Polyline=Wn,t.Popup=$t,t.PosAnimation=Le,t.Projection=Us,t.Rectangle=ka,t.Renderer=Ei,t.SVG=Zo,t.SVGOverlay=It,t.TileLayer=Ur,t.Tooltip=_n,t.Transformation=gi,t.Util=_e,t.VideoOverlay=qe,t.bind=a,t.bounds=Me,t.canvas=mr,t.circle=Wo,t.circleMarker=Xi,t.control=Ve,t.divIcon=kn,t.extend=n,t.featureGroup=ws,t.geoJSON=ve,t.geoJson=Te,t.gridLayer=Rl,t.icon=Ho,t.imageOverlay=st,t.latLng=Ke,t.latLngBounds=mt,t.layerGroup=vi,t.map=Pe,t.marker=Uo,t.point=Ne,t.polygon=Vs,t.polyline=ho,t.popup=an,t.rectangle=Dl,t.setOptions=x,t.stamp=d,t.svg=Wr,t.svgOverlay=gt,t.tileLayer=Zs,t.tooltip=zt,t.transformation=fn,t.version=o,t.videoOverlay=Ye;var Fl=window.L;t.noConflict=function(){return window.L=Fl,this},window.L=t})})(ap,ya);const ha=ya;function tc(i,e,t){const o=i.slice();return o[10]=e[t],o}function nc(i){let e,t=i[10].name+"",o,n,s;function a(){return i[7](i[10])}return{c(){e=yt("li"),o=Ml(t),ct(e,"class","svelte-1dvnsjx")},m(c,d){Kt(c,e,d),$e(e,o),n||(s=is(e,"click",a),n=!0)},p(c,d){i=c,d&2&&t!==(t=i[10].name+"")&&Yd(o,t)},d(c){c&&qt(e),n=!1,s()}}}function lp(i){let e,t,o,n,s,a,c,d,l,f,p=i[1],m=[];for(let _=0;_<p.length;_+=1)m[_]=nc(tc(i,p,_));return{c(){e=yt("form"),t=yt("input"),o=St(),n=yt("ul");for(let _=0;_<m.length;_+=1)m[_].c();s=St(),a=yt("input"),c=St(),d=yt("a"),d.textContent="Reset Map",ct(t,"id","address"),ct(t,"placeholder","Enter a NYC Address"),ct(t,"type","text"),ct(t,"name","address"),ct(t,"autocomplete","off"),ct(t,"class","svelte-1dvnsjx"),ct(n,"class","svelte-1dvnsjx"),ct(a,"type","submit"),a.value="Search",ct(a,"class","svelte-1dvnsjx"),ct(d,"href","#"),ct(d,"class","reset_map svelte-1dvnsjx"),ct(e,"class","svelte-1dvnsjx")},m(_,b){Kt(_,e,b),$e(e,t),Ju(t,i[0]),$e(e,o),$e(e,n);for(let x=0;x<m.length;x+=1)m[x].m(n,null);$e(e,s),$e(e,a),$e(e,c),$e(e,d),l||(f=[is(t,"input",i[6]),is(t,"keyup",i[4]),is(d,"click",i[5]),is(e,"submit",qd(i[2]))],l=!0)},p(_,[b]){if(b&1&&t.value!==_[0]&&Ju(t,_[0]),b&10){p=_[1];let x;for(x=0;x<p.length;x+=1){const A=tc(_,p,x);m[x]?m[x].p(A,b):(m[x]=nc(A),m[x].c(),m[x].m(n,null))}for(;x<m.length;x+=1)m[x].d(1);m.length=p.length}},i:xn,o:xn,d(_){_&&qt(e),Oh(m,_),l=!1,Bs(f)}}}function up(i,e,t){let o;Sl(i,Rh,_=>t(9,o=_));let n="",s=[],a;function c(){t(1,s=[]),fetch(`https://geosearch.planninglabs.nyc/v2/search?text=${n}`).then(_=>_.json()).then(_=>{if(_.features.length){const b=_.features[0].geometry.coordinates.reverse();o.setView(b),a&&a.remove(),a=ha.marker(b).addTo(o).on("click",()=>a.remove()).setOpacity(.8)}})}function d(_){const{name:b,coords:x}=_;t(0,n=b),t(1,s=[]),o.setView(x),a&&a.remove(),a=ha.marker(x).addTo(o).on("click",()=>a.remove()).setOpacity(.8)}function l(){n.length>1?fetch(`https://geosearch.planninglabs.nyc/v2/search?text=${n}`).then(_=>_.json()).then(_=>t(1,s=_.features.map(b=>({name:b.properties.label.replace(", New York, NY, USA",""),coords:b.geometry.coordinates.reverse()})).slice(0,5))):t(1,s=[])}function f(){a&&a.remove(),o.setView([40.73,-74],17)}function p(){n=this.value,t(0,n)}return[n,s,c,d,l,f,p,_=>d(_)]}class cp extends li{constructor(e){super(),ai(this,e,up,lp,Vn,{})}}function hp(i){let e;return{c(){e=yt("div"),e.innerHTML=`<div class="spinner svelte-zrirrj"></div> 
  <p>loading layers..</p>`,ct(e,"class","loading-box svelte-zrirrj")},m(t,o){Kt(t,e,o)},p:xn,i:xn,o:xn,d(t){t&&qt(e)}}}class fp extends li{constructor(e){super(),ai(this,e,null,hp,Vn,{})}}function ic(i,e,t){const o=i.slice();return o[8]=e[t].image,o[9]=e[t].text,o}function dp(i){let e;return{c(){e=yt("em"),ct(e,"class","svelte-1jqby15")},m(t,o){Kt(t,e,o),e.innerHTML=i[2]},p:xn,d(t){t&&qt(e)}}}function pp(i){let e,t=i[3],o=[];for(let n=0;n<t.length;n+=1)o[n]=rc(ic(i,t,n));return{c(){e=yt("div");for(let n=0;n<o.length;n+=1)o[n].c();ct(e,"class","legend svelte-1jqby15")},m(n,s){Kt(n,e,s);for(let a=0;a<o.length;a+=1)o[a].m(e,null)},p(n,s){if(s&8){t=n[3];let a;for(a=0;a<t.length;a+=1){const c=ic(n,t,a);o[a]?o[a].p(c,s):(o[a]=rc(c),o[a].c(),o[a].m(e,null))}for(;a<o.length;a+=1)o[a].d(1);o.length=t.length}},d(n){n&&qt(e),Oh(o,n)}}}function rc(i){let e,t,o,n,s=i[9]+"",a;return{c(){e=yt("img"),o=St(),n=yt("p"),a=Ml(s),Hd(e.src,t=i[8])||ct(e,"src",t),ct(e,"alt","icon"),ct(e,"class","icon svelte-1jqby15")},m(c,d){Kt(c,e,d),Kt(c,o,d),Kt(c,n,d),$e(n,a)},p:xn,d(c){c&&qt(e),c&&qt(o),c&&qt(n)}}}function gp(i){let e;return{c(){e=yt("div"),ct(e,"class","legend svelte-1jqby15")},m(t,o){Kt(t,e,o),e.innerHTML=i[4]},p:xn,d(t){t&&qt(e)}}}function mp(i){let e,t,o,n,s,a,c,d,l,f,p,m,_,b=i[2]&&dp(i),x=i[3].length&&pp(i),A=i[4]&&gp(i);return{c(){e=yt("div"),t=yt("div"),o=yt("label"),n=yt("input"),s=St(),a=yt("span"),c=St(),d=yt("span"),d.textContent=`${i[1]}`,l=St(),b&&b.c(),f=St(),x&&x.c(),p=St(),A&&A.c(),ct(n,"type","checkbox"),ct(n,"class","svelte-1jqby15"),ct(a,"class","slider svelte-1jqby15"),ct(o,"class","switch svelte-1jqby15"),ct(d,"class","name svelte-1jqby15"),ct(t,"class","input svelte-1jqby15"),ct(e,"class","switch-box")},m(S,E){Kt(S,e,E),$e(e,t),$e(t,o),$e(o,n),n.checked=i[0],$e(o,s),$e(o,a),$e(t,c),$e(t,d),$e(e,l),b&&b.m(e,null),$e(e,f),x&&x.m(e,null),$e(e,p),A&&A.m(e,null),m||(_=is(n,"change",i[6]),m=!0)},p(S,[E]){E&1&&(n.checked=S[0]),S[2]&&b.p(S,E),S[3].length&&x.p(S,E),S[4]&&A.p(S,E)},i:xn,o:xn,d(S){S&&qt(e),b&&b.d(),x&&x.d(),A&&A.d(),m=!1,_()}}}function _p(i,e,t){let{layer:o}=e,{label:n,checked:s,notes:a,ref:c}=o,d="legend"in o?o.legend:[],l="legend_html"in o?o.legend_html:null;function f(){s=this.checked,t(0,s)}return i.$$set=p=>{"layer"in p&&t(5,o=p.layer)},i.$$.update=()=>{i.$$.dirty&1&&(s?c.show():c.hide())},[s,n,a,d,l,o,f]}class yp extends li{constructor(e){super(),ai(this,e,_p,mp,Vn,{layer:5})}}function oc(i,e,t){const o=i.slice();return o[2]=e[t],o}function sc(i){let e,t;return e=new fp({}),{c(){pi(e.$$.fragment)},m(o,n){ii(e,o,n),t=!0},i(o){t||(Vt(e.$$.fragment,o),t=!0)},o(o){en(e.$$.fragment,o),t=!1},d(o){ri(e,o)}}}function ac(i,e){let t,o,n;return o=new yp({props:{layer:e[2]}}),{key:i,first:null,c(){t=Zd(),pi(o.$$.fragment),this.first=t},m(s,a){Kt(s,t,a),ii(o,s,a),n=!0},p(s,a){e=s;const c={};a&1&&(c.layer=e[2]),o.$set(c)},i(s){n||(Vt(o.$$.fragment,s),n=!0)},o(s){en(o.$$.fragment,s),n=!1},d(s){s&&qt(t),ri(o,s)}}}function vp(i){let e,t,o,n,s,a,c,d,l,f,p,m,_,b,x=[],A=new Map,S,E,F,v,P,G,$,Z,ie,le,X,oe=i[0].length===0&&sc(),_e=i[0];const Re=Se=>Se[2].label;for(let Se=0;Se<_e.length;Se+=1){let we=oc(i,_e,Se),Ue=Re(we);A.set(Ue,x[Se]=ac(Ue,we))}return G=new cp({}),{c(){e=yt("div"),t=yt("h2"),t.textContent="SLA Mapper (SLAM)",o=St(),n=yt("div"),n.innerHTML=`<h5 class="lighter svelte-1qt73kx">Tool that aggregates data that community boards often have to gather in
      order to review liquor license applications and sidewalk café
      applications. Displaying this information in a unified view saves
      community boards considerable time and resources.</h5>`,s=St(),a=yt("div"),c=St(),d=yt("h4"),d.textContent="Instructions",l=St(),f=yt("h5"),f.textContent=`Click on a map feature to learn more about an establishment's liquor
    license, sidewalk café license, restaurant health grades, or 311 complaints.`,p=St(),m=yt("div"),_=St(),oe&&oe.c(),b=St();for(let Se=0;Se<x.length;Se+=1)x[Se].c();S=St(),E=yt("div"),F=St(),v=yt("h4"),v.textContent="Search",P=St(),pi(G.$$.fragment),$=St(),Z=yt("div"),ie=St(),le=yt("footer"),le.innerHTML=`<figure><img class="logo svelte-1qt73kx" alt="BetaNYC Logo" src="images/BetaNYC_short_white_on_blue.png"/> 
      <figcaption class="logo_caption svelte-1qt73kx">A BetaNYC Tool</figcaption></figure> 
    <div class="footer-links svelte-1qt73kx"><a href="https://github.com/BetaNYC/SLAM/blob/master/LICENSE">GNU General Public License</a> 
      <span>|</span> 
      <a href="https://github.com/BetaNYC/SLAM/issues">File a GitHub issue</a></div>`,ct(t,"class","svelte-1qt73kx"),ct(n,"class","about svelte-1qt73kx"),ct(a,"class","separator svelte-1qt73kx"),ct(d,"class","svelte-1qt73kx"),ct(f,"class","lighter svelte-1qt73kx"),ct(m,"class","separator svelte-1qt73kx"),ct(E,"class","separator svelte-1qt73kx"),ct(v,"class","svelte-1qt73kx"),ct(Z,"class","separator svelte-1qt73kx"),ct(e,"class","toolbox svelte-1qt73kx")},m(Se,we){Kt(Se,e,we),$e(e,t),$e(e,o),$e(e,n),$e(e,s),$e(e,a),$e(e,c),$e(e,d),$e(e,l),$e(e,f),$e(e,p),$e(e,m),$e(e,_),oe&&oe.m(e,null),$e(e,b);for(let Ue=0;Ue<x.length;Ue+=1)x[Ue].m(e,null);$e(e,S),$e(e,E),$e(e,F),$e(e,v),$e(e,P),ii(G,e,null),$e(e,$),$e(e,Z),$e(e,ie),$e(e,le),X=!0},p(Se,[we]){Se[0].length===0?oe?we&1&&Vt(oe,1):(oe=sc(),oe.c(),Vt(oe,1),oe.m(e,b)):oe&&(pl(),en(oe,1,1,()=>{oe=null}),gl()),we&1&&(_e=Se[0],pl(),x=tp(x,we,Re,1,Se,_e,A,e,ep,ac,S,oc),gl())},i(Se){if(!X){Vt(oe);for(let we=0;we<_e.length;we+=1)Vt(x[we]);Vt(G.$$.fragment,Se),X=!0}},o(Se){en(oe);for(let we=0;we<x.length;we+=1)en(x[we]);en(G.$$.fragment,Se),X=!1},d(Se){Se&&qt(e),oe&&oe.d();for(let we=0;we<x.length;we+=1)x[we].d();ri(G)}}}function bp(i,e,t){let o,n;return Sl(i,Sr,s=>t(1,n=s)),i.$$.update=()=>{i.$$.dirty&2&&t(0,o=n.sort((s,a)=>s.order-a.order))},[o,n]}class xp extends li{constructor(e){super(),ai(this,e,bp,vp,Vn,{})}}var lu={},wp={get exports(){return lu},set exports(i){lu=i}};/*!
Copyright (c) 2016 Dominik Moritz

This file is part of the leaflet locate control. It is licensed under the MIT license.
You can find the project at: https://github.com/domoritz/leaflet-locatecontrol
*/(function(i,e){(function(t,o){typeof o<"u"&&o.L?i.exports=t(L):i.exports=t(ya),typeof o<"u"&&o.L&&(o.L.Control.Locate=t(L))})(function(t){const o=(l,f,p)=>{p=p.split(" "),p.forEach(function(m){t.DomUtil[l].call(this,f,m)})},n=(l,f)=>o("addClass",l,f),s=(l,f)=>o("removeClass",l,f),a=t.Marker.extend({initialize(l,f){t.Util.setOptions(this,f),this._latlng=l,this.createIcon()},createIcon(){const l=this.options;let f="";l.color!==void 0&&(f+=`stroke:${l.color};`),l.weight!==void 0&&(f+=`stroke-width:${l.weight};`),l.fillColor!==void 0&&(f+=`fill:${l.fillColor};`),l.fillOpacity!==void 0&&(f+=`fill-opacity:${l.fillOpacity};`),l.opacity!==void 0&&(f+=`opacity:${l.opacity};`);const p=this._getIconSVG(l,f);this._locationIcon=t.divIcon({className:p.className,html:p.svg,iconSize:[p.w,p.h]}),this.setIcon(this._locationIcon)},_getIconSVG(l,f){const p=l.radius,m=l.weight,_=p+m,b=_*2;return{className:"leaflet-control-locate-location",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="${b}" height="${b}" version="1.1" viewBox="-${_} -${_} ${b} ${b}"><circle r="`+p+'" style="'+f+'" /></svg>',w:b,h:b}},setStyle(l){t.Util.setOptions(this,l),this.createIcon()}}),c=a.extend({initialize(l,f,p){t.Util.setOptions(this,p),this._latlng=l,this._heading=f,this.createIcon()},setHeading(l){this._heading=l},_getIconSVG(l,f){const p=l.radius,m=l.width+l.weight,_=(p+l.depth+l.weight)*2,b=`M0,0 l${l.width/2},${l.depth} l-${m},0 z`,x=`transform: rotate(${this._heading}deg)`;return{className:"leaflet-control-locate-heading",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="${m}" height="${_}" version="1.1" viewBox="-${m/2} 0 ${m} ${_}" style="${x}"><path d="`+b+'" style="'+f+'" /></svg>',w:m,h:_}}}),d=t.Control.extend({options:{position:"topleft",layer:void 0,setView:"untilPanOrZoom",keepCurrentZoomLevel:!1,initialZoomLevel:!1,getLocationBounds(l){return l.bounds},flyTo:!1,clickBehavior:{inView:"stop",outOfView:"setView",inViewNotFollowing:"inView"},returnToPrevBounds:!1,cacheLocation:!0,drawCircle:!0,drawMarker:!0,showCompass:!0,markerClass:a,compassClass:c,circleStyle:{className:"leaflet-control-locate-circle",color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:0},markerStyle:{className:"leaflet-control-locate-marker",color:"#fff",fillColor:"#2A93EE",fillOpacity:1,weight:3,opacity:1,radius:9},compassStyle:{fillColor:"#2A93EE",fillOpacity:1,weight:0,color:"#fff",opacity:1,radius:9,width:9,depth:6},followCircleStyle:{},followMarkerStyle:{},followCompassStyle:{},icon:"leaflet-control-locate-location-arrow",iconLoading:"leaflet-control-locate-spinner",iconElementTag:"span",textElementTag:"small",circlePadding:[0,0],metric:!0,createButtonCallback(l,f){const p=t.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",l);p.title=f.strings.title,p.href="#",p.setAttribute("role","button");const m=t.DomUtil.create(f.iconElementTag,f.icon,p);if(f.strings.text!==void 0){const _=t.DomUtil.create(f.textElementTag,"leaflet-locate-text",p);_.textContent=f.strings.text,p.classList.add("leaflet-locate-text-active"),p.parentNode.style.display="flex",f.icon.length>0&&m.classList.add("leaflet-locate-icon")}return{link:p,icon:m}},onLocationError(l,f){alert(l.message)},onLocationOutsideMapBounds(l){l.stop(),alert(l.options.strings.outsideMapBoundsMsg)},showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0,setView:!1}},initialize(l){for(const f in l)typeof this.options[f]=="object"?t.extend(this.options[f],l[f]):this.options[f]=l[f];this.options.followMarkerStyle=t.extend({},this.options.markerStyle,this.options.followMarkerStyle),this.options.followCircleStyle=t.extend({},this.options.circleStyle,this.options.followCircleStyle),this.options.followCompassStyle=t.extend({},this.options.compassStyle,this.options.followCompassStyle)},onAdd(l){const f=t.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");this._container=f,this._map=l,this._layer=this.options.layer||new t.LayerGroup,this._layer.addTo(l),this._event=void 0,this._compassHeading=null,this._prevBounds=null;const p=this.options.createButtonCallback(f,this.options);return this._link=p.link,this._icon=p.icon,t.DomEvent.on(this._link,"click",function(m){t.DomEvent.stopPropagation(m),t.DomEvent.preventDefault(m),this._onClick()},this).on(this._link,"dblclick",t.DomEvent.stopPropagation),this._resetVariables(),this._map.on("unload",this._unload,this),f},_onClick(){this._justClicked=!0;const l=this._isFollowing();if(this._userPanned=!1,this._userZoomed=!1,this._active&&!this._event)this.stop();else if(this._active){const f=this.options.clickBehavior;let p=f.outOfView;switch(this._map.getBounds().contains(this._event.latlng)&&(p=l?f.inView:f.inViewNotFollowing),f[p]&&(p=f[p]),p){case"setView":this.setView();break;case"stop":this.stop(),this.options.returnToPrevBounds&&(this.options.flyTo?this._map.flyToBounds:this._map.fitBounds).bind(this._map)(this._prevBounds);break}}else this.options.returnToPrevBounds&&(this._prevBounds=this._map.getBounds()),this.start();this._updateContainerStyle()},start(){this._activate(),this._event&&(this._drawMarker(this._map),this.options.setView&&this.setView()),this._updateContainerStyle()},stop(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this._removeMarker()},stopFollowing(){this._userPanned=!0,this._updateContainerStyle(),this._drawMarker()},_activate(){if(!(this._active||!this._map)&&(this._map.locate(this.options.locateOptions),this._map.fire("locateactivate",this),this._active=!0,this._map.on("locationfound",this._onLocationFound,this),this._map.on("locationerror",this._onLocationError,this),this._map.on("dragstart",this._onDrag,this),this._map.on("zoomstart",this._onZoom,this),this._map.on("zoomend",this._onZoomEnd,this),this.options.showCompass)){const l="ondeviceorientationabsolute"in window;if(l||"ondeviceorientation"in window){const f=this,p=function(){t.DomEvent.on(window,l?"deviceorientationabsolute":"deviceorientation",f._onDeviceOrientation,f)};DeviceOrientationEvent&&typeof DeviceOrientationEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(function(m){m==="granted"&&p()}):p()}}},_deactivate(){!this._active||!this._map||(this._map.stopLocate(),this._map.fire("locatedeactivate",this),this._active=!1,this.options.cacheLocation||(this._event=void 0),this._map.off("locationfound",this._onLocationFound,this),this._map.off("locationerror",this._onLocationError,this),this._map.off("dragstart",this._onDrag,this),this._map.off("zoomstart",this._onZoom,this),this._map.off("zoomend",this._onZoomEnd,this),this.options.showCompass&&(this._compassHeading=null,"ondeviceorientationabsolute"in window?t.DomEvent.off(window,"deviceorientationabsolute",this._onDeviceOrientation,this):"ondeviceorientation"in window&&t.DomEvent.off(window,"deviceorientation",this._onDeviceOrientation,this)))},setView(){if(this._drawMarker(),this._isOutsideMapBounds())this._event=void 0,this.options.onLocationOutsideMapBounds(this);else if(this._justClicked&&this.options.initialZoomLevel!==!1){var l=this.options.flyTo?this._map.flyTo:this._map.setView;l.bind(this._map)([this._event.latitude,this._event.longitude],this.options.initialZoomLevel)}else if(this.options.keepCurrentZoomLevel){var l=this.options.flyTo?this._map.flyTo:this._map.panTo;l.bind(this._map)([this._event.latitude,this._event.longitude])}else{var l=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;this._ignoreEvent=!0,l.bind(this._map)(this.options.getLocationBounds(this._event),{padding:this.options.circlePadding,maxZoom:this.options.initialZoomLevel||this.options.locateOptions.maxZoom}),t.Util.requestAnimFrame(function(){this._ignoreEvent=!1},this)}},_drawCompass(){if(!this._event)return;const l=this._event.latlng;if(this.options.showCompass&&l&&this._compassHeading!==null){const f=this._isFollowing()?this.options.followCompassStyle:this.options.compassStyle;this._compass?(this._compass.setLatLng(l),this._compass.setHeading(this._compassHeading),this._compass.setStyle&&this._compass.setStyle(f)):this._compass=new this.options.compassClass(l,this._compassHeading,f).addTo(this._layer)}this._compass&&(!this.options.showCompass||this._compassHeading===null)&&(this._compass.removeFrom(this._layer),this._compass=null)},_drawMarker(){this._event.accuracy===void 0&&(this._event.accuracy=0);const l=this._event.accuracy,f=this._event.latlng;if(this.options.drawCircle){const x=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle;this._circle?this._circle.setLatLng(f).setRadius(l).setStyle(x):this._circle=t.circle(f,l,x).addTo(this._layer)}let p,m;if(this.options.metric?(p=l.toFixed(0),m=this.options.strings.metersUnit):(p=(l*3.2808399).toFixed(0),m=this.options.strings.feetUnit),this.options.drawMarker){const x=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle;this._marker?(this._marker.setLatLng(f),this._marker.setStyle&&this._marker.setStyle(x)):this._marker=new this.options.markerClass(f,x).addTo(this._layer)}this._drawCompass();const _=this.options.strings.popup;function b(){return typeof _=="string"?t.Util.template(_,{distance:p,unit:m}):typeof _=="function"?_({distance:p,unit:m}):_}this.options.showPopup&&_&&this._marker&&this._marker.bindPopup(b())._popup.setLatLng(f),this.options.showPopup&&_&&this._compass&&this._compass.bindPopup(b())._popup.setLatLng(f)},_removeMarker(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},_unload(){this.stop(),this._map.off("unload",this._unload,this)},_setCompassHeading(l){!isNaN(parseFloat(l))&&isFinite(l)?(l=Math.round(l),this._compassHeading=l,t.Util.requestAnimFrame(this._drawCompass,this)):this._compassHeading=null},_onCompassNeedsCalibration(){this._setCompassHeading()},_onDeviceOrientation(l){this._active&&(l.webkitCompassHeading?this._setCompassHeading(l.webkitCompassHeading):l.absolute&&l.alpha&&this._setCompassHeading(360-l.alpha))},_onLocationError(l){l.code==3&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(l,this))},_onLocationFound(l){if(!(this._event&&this._event.latlng.lat===l.latlng.lat&&this._event.latlng.lng===l.latlng.lng&&this._event.accuracy===l.accuracy)&&this._active){switch(this._event=l,this._drawMarker(),this._updateContainerStyle(),this.options.setView){case"once":this._justClicked&&this.setView();break;case"untilPan":this._userPanned||this.setView();break;case"untilPanOrZoom":!this._userPanned&&!this._userZoomed&&this.setView();break;case"always":this.setView();break}this._justClicked=!1}},_onDrag(){this._event&&!this._ignoreEvent&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_onZoom(){this._event&&!this._ignoreEvent&&(this._userZoomed=!0,this._updateContainerStyle(),this._drawMarker())},_onZoomEnd(){this._event&&this._drawCompass(),this._event&&!this._ignoreEvent&&this._marker&&!this._map.getBounds().pad(-.3).contains(this._marker.getLatLng())&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_isFollowing(){if(!this._active)return!1;if(this.options.setView==="always")return!0;if(this.options.setView==="untilPan")return!this._userPanned;if(this.options.setView==="untilPanOrZoom")return!this._userPanned&&!this._userZoomed},_isOutsideMapBounds(){return this._event===void 0?!1:this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_updateContainerStyle(){this._container&&(this._active&&!this._event?this._setClasses("requesting"):this._isFollowing()?this._setClasses("following"):this._active?this._setClasses("active"):this._cleanClasses())},_setClasses(l){l=="requesting"?(s(this._container,"active following"),n(this._container,"requesting"),s(this._icon,this.options.icon),n(this._icon,this.options.iconLoading)):l=="active"?(s(this._container,"requesting following"),n(this._container,"active"),s(this._icon,this.options.iconLoading),n(this._icon,this.options.icon)):l=="following"&&(s(this._container,"requesting"),n(this._container,"active following"),s(this._icon,this.options.iconLoading),n(this._icon,this.options.icon))},_cleanClasses(){t.DomUtil.removeClass(this._container,"requesting"),t.DomUtil.removeClass(this._container,"active"),t.DomUtil.removeClass(this._container,"following"),s(this._icon,this.options.iconLoading),n(this._icon,this.options.icon)},_resetVariables(){this._active=!1,this._justClicked=!1,this._userPanned=!1,this._userZoomed=!1}});return t.control.locate=l=>new t.Control.Locate(l),d},window)})(wp);const Cp=lu;var uu={},Lp={get exports(){return uu},set exports(i){uu=i}};/*!
 * CARTO.js https://carto.com/
 * Version: 4.2.2
 * 
 */(function(i,e){(function(o,n){i.exports=n()})(window,function(){return function(t){var o={};function n(s){if(o[s])return o[s].exports;var a=o[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=o,n.d=function(s,a,c){n.o(s,a)||Object.defineProperty(s,a,{enumerable:!0,get:c})},n.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},n.t=function(s,a){if(a&1&&(s=n(s)),a&8||a&4&&typeof s=="object"&&s&&s.__esModule)return s;var c=Object.create(null);if(n.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:s}),a&2&&typeof s!="string")for(var d in s)n.d(c,d,function(l){return s[l]}.bind(null,d));return c},n.n=function(s){var a=s&&s.__esModule?function(){return s.default}:function(){return s};return n.d(a,"a",a),a},n.o=function(s,a){return Object.prototype.hasOwnProperty.call(s,a)},n.p="",n(n.s=150)}([function(t,o,n){var s,a;(function(){var c=this,d=c._,l=Array.prototype,f=Object.prototype,p=Function.prototype,m=l.push,_=l.slice,b=f.toString,x=f.hasOwnProperty,A=Array.isArray,S=Object.keys,E=p.bind,F=Object.create,v=function(){},P=function(B){if(B instanceof P)return B;if(!(this instanceof P))return new P(B);this._wrapped=B};typeof t<"u"&&t.exports&&(o=t.exports=P),o._=P,P.VERSION="1.8.3";var G=function(B,w,R){if(w===void 0)return B;switch(R??3){case 1:return function(D){return B.call(w,D)};case 2:return function(D,z){return B.call(w,D,z)};case 3:return function(D,z,j){return B.call(w,D,z,j)};case 4:return function(D,z,j,K){return B.call(w,D,z,j,K)}}return function(){return B.apply(w,arguments)}},$=function(B,w,R){return B==null?P.identity:P.isFunction(B)?G(B,w,R):P.isObject(B)?P.matcher(B):P.property(B)};P.iteratee=function(B,w){return $(B,w,1/0)};var Z=function(B,w){return function(R){var D=arguments.length;if(D<2||R==null)return R;for(var z=1;z<D;z++)for(var j=arguments[z],K=B(j),pe=K.length,be=0;be<pe;be++){var Ee=K[be];(!w||R[Ee]===void 0)&&(R[Ee]=j[Ee])}return R}},ie=function(B){if(!P.isObject(B))return{};if(F)return F(B);v.prototype=B;var w=new v;return v.prototype=null,w},le=function(B){return function(w){return w==null?void 0:w[B]}},X=Math.pow(2,53)-1,oe=le("length"),_e=function(B){var w=oe(B);return typeof w=="number"&&w>=0&&w<=X};P.each=P.forEach=function(B,w,R){w=G(w,R);var D,z;if(_e(B))for(D=0,z=B.length;D<z;D++)w(B[D],D,B);else{var j=P.keys(B);for(D=0,z=j.length;D<z;D++)w(B[j[D]],j[D],B)}return B},P.map=P.collect=function(B,w,R){w=$(w,R);for(var D=!_e(B)&&P.keys(B),z=(D||B).length,j=Array(z),K=0;K<z;K++){var pe=D?D[K]:K;j[K]=w(B[pe],pe,B)}return j};function Re(B){function w(R,D,z,j,K,pe){for(;K>=0&&K<pe;K+=B){var be=j?j[K]:K;z=D(z,R[be],be,R)}return z}return function(R,D,z,j){D=G(D,j,4);var K=!_e(R)&&P.keys(R),pe=(K||R).length,be=B>0?0:pe-1;return arguments.length<3&&(z=R[K?K[be]:be],be+=B),w(R,D,z,K,be,pe)}}P.reduce=P.foldl=P.inject=Re(1),P.reduceRight=P.foldr=Re(-1),P.find=P.detect=function(B,w,R){var D;if(_e(B)?D=P.findIndex(B,w,R):D=P.findKey(B,w,R),D!==void 0&&D!==-1)return B[D]},P.filter=P.select=function(B,w,R){var D=[];return w=$(w,R),P.each(B,function(z,j,K){w(z,j,K)&&D.push(z)}),D},P.reject=function(B,w,R){return P.filter(B,P.negate($(w)),R)},P.every=P.all=function(B,w,R){w=$(w,R);for(var D=!_e(B)&&P.keys(B),z=(D||B).length,j=0;j<z;j++){var K=D?D[j]:j;if(!w(B[K],K,B))return!1}return!0},P.some=P.any=function(B,w,R){w=$(w,R);for(var D=!_e(B)&&P.keys(B),z=(D||B).length,j=0;j<z;j++){var K=D?D[j]:j;if(w(B[K],K,B))return!0}return!1},P.contains=P.includes=P.include=function(B,w,R,D){return _e(B)||(B=P.values(B)),(typeof R!="number"||D)&&(R=0),P.indexOf(B,w,R)>=0},P.invoke=function(B,w){var R=_.call(arguments,2),D=P.isFunction(w);return P.map(B,function(z){var j=D?w:z[w];return j==null?j:j.apply(z,R)})},P.pluck=function(B,w){return P.map(B,P.property(w))},P.where=function(B,w){return P.filter(B,P.matcher(w))},P.findWhere=function(B,w){return P.find(B,P.matcher(w))},P.max=function(B,w,R){var D=-1/0,z=-1/0,j,K;if(w==null&&B!=null){B=_e(B)?B:P.values(B);for(var pe=0,be=B.length;pe<be;pe++)j=B[pe],j>D&&(D=j)}else w=$(w,R),P.each(B,function(Ee,We,ot){K=w(Ee,We,ot),(K>z||K===-1/0&&D===-1/0)&&(D=Ee,z=K)});return D},P.min=function(B,w,R){var D=1/0,z=1/0,j,K;if(w==null&&B!=null){B=_e(B)?B:P.values(B);for(var pe=0,be=B.length;pe<be;pe++)j=B[pe],j<D&&(D=j)}else w=$(w,R),P.each(B,function(Ee,We,ot){K=w(Ee,We,ot),(K<z||K===1/0&&D===1/0)&&(D=Ee,z=K)});return D},P.shuffle=function(B){for(var w=_e(B)?B:P.values(B),R=w.length,D=Array(R),z=0,j;z<R;z++)j=P.random(0,z),j!==z&&(D[z]=D[j]),D[j]=w[z];return D},P.sample=function(B,w,R){return w==null||R?(_e(B)||(B=P.values(B)),B[P.random(B.length-1)]):P.shuffle(B).slice(0,Math.max(0,w))},P.sortBy=function(B,w,R){return w=$(w,R),P.pluck(P.map(B,function(D,z,j){return{value:D,index:z,criteria:w(D,z,j)}}).sort(function(D,z){var j=D.criteria,K=z.criteria;if(j!==K){if(j>K||j===void 0)return 1;if(j<K||K===void 0)return-1}return D.index-z.index}),"value")};var Se=function(B){return function(w,R,D){var z={};return R=$(R,D),P.each(w,function(j,K){var pe=R(j,K,w);B(z,j,pe)}),z}};P.groupBy=Se(function(B,w,R){P.has(B,R)?B[R].push(w):B[R]=[w]}),P.indexBy=Se(function(B,w,R){B[R]=w}),P.countBy=Se(function(B,w,R){P.has(B,R)?B[R]++:B[R]=1}),P.toArray=function(B){return B?P.isArray(B)?_.call(B):_e(B)?P.map(B,P.identity):P.values(B):[]},P.size=function(B){return B==null?0:_e(B)?B.length:P.keys(B).length},P.partition=function(B,w,R){w=$(w,R);var D=[],z=[];return P.each(B,function(j,K,pe){(w(j,K,pe)?D:z).push(j)}),[D,z]},P.first=P.head=P.take=function(B,w,R){if(B!=null)return w==null||R?B[0]:P.initial(B,B.length-w)},P.initial=function(B,w,R){return _.call(B,0,Math.max(0,B.length-(w==null||R?1:w)))},P.last=function(B,w,R){if(B!=null)return w==null||R?B[B.length-1]:P.rest(B,Math.max(0,B.length-w))},P.rest=P.tail=P.drop=function(B,w,R){return _.call(B,w==null||R?1:w)},P.compact=function(B){return P.filter(B,P.identity)};var we=function(B,w,R,D){for(var z=[],j=0,K=D||0,pe=oe(B);K<pe;K++){var be=B[K];if(_e(be)&&(P.isArray(be)||P.isArguments(be))){w||(be=we(be,w,R));var Ee=0,We=be.length;for(z.length+=We;Ee<We;)z[j++]=be[Ee++]}else R||(z[j++]=be)}return z};P.flatten=function(B,w){return we(B,w,!1)},P.without=function(B){return P.difference(B,_.call(arguments,1))},P.uniq=P.unique=function(B,w,R,D){P.isBoolean(w)||(D=R,R=w,w=!1),R!=null&&(R=$(R,D));for(var z=[],j=[],K=0,pe=oe(B);K<pe;K++){var be=B[K],Ee=R?R(be,K,B):be;w?((!K||j!==Ee)&&z.push(be),j=Ee):R?P.contains(j,Ee)||(j.push(Ee),z.push(be)):P.contains(z,be)||z.push(be)}return z},P.union=function(){return P.uniq(we(arguments,!0,!0))},P.intersection=function(B){for(var w=[],R=arguments.length,D=0,z=oe(B);D<z;D++){var j=B[D];if(!P.contains(w,j)){for(var K=1;K<R&&P.contains(arguments[K],j);K++);K===R&&w.push(j)}}return w},P.difference=function(B){var w=we(arguments,!0,!0,1);return P.filter(B,function(R){return!P.contains(w,R)})},P.zip=function(){return P.unzip(arguments)},P.unzip=function(B){for(var w=B&&P.max(B,oe).length||0,R=Array(w),D=0;D<w;D++)R[D]=P.pluck(B,D);return R},P.object=function(B,w){for(var R={},D=0,z=oe(B);D<z;D++)w?R[B[D]]=w[D]:R[B[D][0]]=B[D][1];return R};function Ue(B){return function(w,R,D){R=$(R,D);for(var z=oe(w),j=B>0?0:z-1;j>=0&&j<z;j+=B)if(R(w[j],j,w))return j;return-1}}P.findIndex=Ue(1),P.findLastIndex=Ue(-1),P.sortedIndex=function(B,w,R,D){R=$(R,D,1);for(var z=R(w),j=0,K=oe(B);j<K;){var pe=Math.floor((j+K)/2);R(B[pe])<z?j=pe+1:K=pe}return j};function Oe(B,w,R){return function(D,z,j){var K=0,pe=oe(D);if(typeof j=="number")B>0?K=j>=0?j:Math.max(j+pe,K):pe=j>=0?Math.min(j+1,pe):j+pe+1;else if(R&&j&&pe)return j=R(D,z),D[j]===z?j:-1;if(z!==z)return j=w(_.call(D,K,pe),P.isNaN),j>=0?j+K:-1;for(j=B>0?K:pe-1;j>=0&&j<pe;j+=B)if(D[j]===z)return j;return-1}}P.indexOf=Oe(1,P.findIndex,P.sortedIndex),P.lastIndexOf=Oe(-1,P.findLastIndex),P.range=function(B,w,R){w==null&&(w=B||0,B=0),R=R||1;for(var D=Math.max(Math.ceil((w-B)/R),0),z=Array(D),j=0;j<D;j++,B+=R)z[j]=B;return z};var Ft=function(B,w,R,D,z){if(!(D instanceof w))return B.apply(R,z);var j=ie(B.prototype),K=B.apply(j,z);return P.isObject(K)?K:j};P.bind=function(B,w){if(E&&B.bind===E)return E.apply(B,_.call(arguments,1));if(!P.isFunction(B))throw new TypeError("Bind must be called on a function");var R=_.call(arguments,2),D=function(){return Ft(B,D,w,this,R.concat(_.call(arguments)))};return D},P.partial=function(B){var w=_.call(arguments,1),R=function(){for(var D=0,z=w.length,j=Array(z),K=0;K<z;K++)j[K]=w[K]===P?arguments[D++]:w[K];for(;D<arguments.length;)j.push(arguments[D++]);return Ft(B,R,this,this,j)};return R},P.bindAll=function(B){var w,R=arguments.length,D;if(R<=1)throw new Error("bindAll must be passed function names");for(w=1;w<R;w++)D=arguments[w],B[D]=P.bind(B[D],B);return B},P.memoize=function(B,w){var R=function(D){var z=R.cache,j=""+(w?w.apply(this,arguments):D);return P.has(z,j)||(z[j]=B.apply(this,arguments)),z[j]};return R.cache={},R},P.delay=function(B,w){var R=_.call(arguments,2);return setTimeout(function(){return B.apply(null,R)},w)},P.defer=P.partial(P.delay,P,1),P.throttle=function(B,w,R){var D,z,j,K=null,pe=0;R||(R={});var be=function(){pe=R.leading===!1?0:P.now(),K=null,j=B.apply(D,z),K||(D=z=null)};return function(){var Ee=P.now();!pe&&R.leading===!1&&(pe=Ee);var We=w-(Ee-pe);return D=this,z=arguments,We<=0||We>w?(K&&(clearTimeout(K),K=null),pe=Ee,j=B.apply(D,z),K||(D=z=null)):!K&&R.trailing!==!1&&(K=setTimeout(be,We)),j}},P.debounce=function(B,w,R){var D,z,j,K,pe,be=function(){var Ee=P.now()-K;Ee<w&&Ee>=0?D=setTimeout(be,w-Ee):(D=null,R||(pe=B.apply(j,z),D||(j=z=null)))};return function(){j=this,z=arguments,K=P.now();var Ee=R&&!D;return D||(D=setTimeout(be,w)),Ee&&(pe=B.apply(j,z),j=z=null),pe}},P.wrap=function(B,w){return P.partial(w,B)},P.negate=function(B){return function(){return!B.apply(this,arguments)}},P.compose=function(){var B=arguments,w=B.length-1;return function(){for(var R=w,D=B[w].apply(this,arguments);R--;)D=B[R].call(this,D);return D}},P.after=function(B,w){return function(){if(--B<1)return w.apply(this,arguments)}},P.before=function(B,w){var R;return function(){return--B>0&&(R=w.apply(this,arguments)),B<=1&&(w=null),R}},P.once=P.partial(P.before,2);var Ne=!{toString:null}.propertyIsEnumerable("toString"),it=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function Me(B,w){var R=it.length,D=B.constructor,z=P.isFunction(D)&&D.prototype||f,j="constructor";for(P.has(B,j)&&!P.contains(w,j)&&w.push(j);R--;)j=it[R],j in B&&B[j]!==z[j]&&!P.contains(w,j)&&w.push(j)}P.keys=function(B){if(!P.isObject(B))return[];if(S)return S(B);var w=[];for(var R in B)P.has(B,R)&&w.push(R);return Ne&&Me(B,w),w},P.allKeys=function(B){if(!P.isObject(B))return[];var w=[];for(var R in B)w.push(R);return Ne&&Me(B,w),w},P.values=function(B){for(var w=P.keys(B),R=w.length,D=Array(R),z=0;z<R;z++)D[z]=B[w[z]];return D},P.mapObject=function(B,w,R){w=$(w,R);for(var D=P.keys(B),z=D.length,j={},K,pe=0;pe<z;pe++)K=D[pe],j[K]=w(B[K],K,B);return j},P.pairs=function(B){for(var w=P.keys(B),R=w.length,D=Array(R),z=0;z<R;z++)D[z]=[w[z],B[w[z]]];return D},P.invert=function(B){for(var w={},R=P.keys(B),D=0,z=R.length;D<z;D++)w[B[R[D]]]=R[D];return w},P.functions=P.methods=function(B){var w=[];for(var R in B)P.isFunction(B[R])&&w.push(R);return w.sort()},P.extend=Z(P.allKeys),P.extendOwn=P.assign=Z(P.keys),P.findKey=function(B,w,R){w=$(w,R);for(var D=P.keys(B),z,j=0,K=D.length;j<K;j++)if(z=D[j],w(B[z],z,B))return z},P.pick=function(B,w,R){var D={},z=B,j,K;if(z==null)return D;P.isFunction(w)?(K=P.allKeys(z),j=G(w,R)):(K=we(arguments,!1,!1,1),j=function(ot,Ge,at){return Ge in at},z=Object(z));for(var pe=0,be=K.length;pe<be;pe++){var Ee=K[pe],We=z[Ee];j(We,Ee,z)&&(D[Ee]=We)}return D},P.omit=function(B,w,R){if(P.isFunction(w))w=P.negate(w);else{var D=P.map(we(arguments,!1,!1,1),String);w=function(z,j){return!P.contains(D,j)}}return P.pick(B,w,R)},P.defaults=Z(P.allKeys,!0),P.create=function(B,w){var R=ie(B);return w&&P.extendOwn(R,w),R},P.clone=function(B){return P.isObject(B)?P.isArray(B)?B.slice():P.extend({},B):B},P.tap=function(B,w){return w(B),B},P.isMatch=function(B,w){var R=P.keys(w),D=R.length;if(B==null)return!D;for(var z=Object(B),j=0;j<D;j++){var K=R[j];if(w[K]!==z[K]||!(K in z))return!1}return!0};var Et=function(B,w,R,D){if(B===w)return B!==0||1/B===1/w;if(B==null||w==null)return B===w;B instanceof P&&(B=B._wrapped),w instanceof P&&(w=w._wrapped);var z=b.call(B);if(z!==b.call(w))return!1;switch(z){case"[object RegExp]":case"[object String]":return""+B==""+w;case"[object Number]":return+B!=+B?+w!=+w:+B==0?1/+B===1/w:+B==+w;case"[object Date]":case"[object Boolean]":return+B==+w}var j=z==="[object Array]";if(!j){if(typeof B!="object"||typeof w!="object")return!1;var K=B.constructor,pe=w.constructor;if(K!==pe&&!(P.isFunction(K)&&K instanceof K&&P.isFunction(pe)&&pe instanceof pe)&&"constructor"in B&&"constructor"in w)return!1}R=R||[],D=D||[];for(var be=R.length;be--;)if(R[be]===B)return D[be]===w;if(R.push(B),D.push(w),j){if(be=B.length,be!==w.length)return!1;for(;be--;)if(!Et(B[be],w[be],R,D))return!1}else{var Ee=P.keys(B),We;if(be=Ee.length,P.keys(w).length!==be)return!1;for(;be--;)if(We=Ee[be],!(P.has(w,We)&&Et(B[We],w[We],R,D)))return!1}return R.pop(),D.pop(),!0};P.isEqual=function(B,w){return Et(B,w)},P.isEmpty=function(B){return B==null?!0:_e(B)&&(P.isArray(B)||P.isString(B)||P.isArguments(B))?B.length===0:P.keys(B).length===0},P.isElement=function(B){return!!(B&&B.nodeType===1)},P.isArray=A||function(B){return b.call(B)==="[object Array]"},P.isObject=function(B){var w=typeof B;return w==="function"||w==="object"&&!!B},P.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(B){P["is"+B]=function(w){return b.call(w)==="[object "+B+"]"}}),P.isArguments(arguments)||(P.isArguments=function(B){return P.has(B,"callee")}),typeof/./!="function"&&typeof Int8Array!="object"&&(P.isFunction=function(B){return typeof B=="function"||!1}),P.isFinite=function(B){return isFinite(B)&&!isNaN(parseFloat(B))},P.isNaN=function(B){return P.isNumber(B)&&B!==+B},P.isBoolean=function(B){return B===!0||B===!1||b.call(B)==="[object Boolean]"},P.isNull=function(B){return B===null},P.isUndefined=function(B){return B===void 0},P.has=function(B,w){return B!=null&&x.call(B,w)},P.noConflict=function(){return c._=d,this},P.identity=function(B){return B},P.constant=function(B){return function(){return B}},P.noop=function(){},P.property=le,P.propertyOf=function(B){return B==null?function(){}:function(w){return B[w]}},P.matcher=P.matches=function(B){return B=P.extendOwn({},B),function(w){return P.isMatch(w,B)}},P.times=function(B,w,R){var D=Array(Math.max(0,B));w=G(w,R,1);for(var z=0;z<B;z++)D[z]=w(z);return D},P.random=function(B,w){return w==null&&(w=B,B=0),B+Math.floor(Math.random()*(w-B+1))},P.now=Date.now||function(){return new Date().getTime()};var mt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},et=P.invert(mt),Ke=function(B){var w=function(j){return B[j]},R="(?:"+P.keys(B).join("|")+")",D=RegExp(R),z=RegExp(R,"g");return function(j){return j=j==null?"":""+j,D.test(j)?j.replace(z,w):j}};P.escape=Ke(mt),P.unescape=Ke(et),P.result=function(B,w,R){var D=B==null?void 0:B[w];return D===void 0&&(D=R),P.isFunction(D)?D.call(B):D};var Mt=0;P.uniqueId=function(B){var w=++Mt+"";return B?B+w:w},P.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Be=/(.)^/,Bt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Fn=/\\|'|\r|\n|\u2028|\u2029/g,gi=function(B){return"\\"+Bt[B]};P.template=function(B,w,R){!w&&R&&(w=R),w=P.defaults({},w,P.templateSettings);var D=RegExp([(w.escape||Be).source,(w.interpolate||Be).source,(w.evaluate||Be).source].join("|")+"|$","g"),z=0,j="__p+='";B.replace(D,function(Ee,We,ot,Ge,at){return j+=B.slice(z,at).replace(Fn,gi),z=at+Ee.length,We?j+=`'+
((__t=(`+We+`))==null?'':_.escape(__t))+
'`:ot?j+=`'+
((__t=(`+ot+`))==null?'':__t)+
'`:Ge&&(j+=`';
`+Ge+`
__p+='`),Ee}),j+=`';
`,w.variable||(j=`with(obj||{}){
`+j+`}
`),j=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+j+`return __p;
`;try{var K=new Function(w.variable||"obj","_",j)}catch(Ee){throw Ee.source=j,Ee}var pe=function(Ee){return K.call(this,Ee,P)},be=w.variable||"obj";return pe.source="function("+be+`){
`+j+"}",pe},P.chain=function(B){var w=P(B);return w._chain=!0,w};var fn=function(B,w){return B._chain?P(w).chain():w};P.mixin=function(B){P.each(P.functions(B),function(w){var R=P[w]=B[w];P.prototype[w]=function(){var D=[this._wrapped];return m.apply(D,arguments),fn(this,R.apply(P,D))}})},P.mixin(P),P.each(["pop","push","reverse","shift","sort","splice","unshift"],function(B){var w=l[B];P.prototype[B]=function(){var R=this._wrapped;return w.apply(R,arguments),(B==="shift"||B==="splice")&&R.length===0&&delete R[0],fn(this,R)}}),P.each(["concat","join","slice"],function(B){var w=l[B];P.prototype[B]=function(){return fn(this,w.apply(this._wrapped,arguments))}}),P.prototype.value=function(){return this._wrapped},P.prototype.valueOf=P.prototype.toJSON=P.prototype.value,P.prototype.toString=function(){return""+this._wrapped},s=[],a=function(){return P}.apply(o,s),a!==void 0&&(t.exports=a)}).call(this)},function(t,o,n){(function(s){var a,c;(function(d){var l=typeof self=="object"&&self.self==self&&self||typeof s=="object"&&s.global==s&&s;a=[n(0),n(17),o],c=function(f,p,m){l.Backbone=d(l,m,f,p)}.apply(o,a),c!==void 0&&(t.exports=c)})(function(d,l,f,p){var m=d.Backbone,_=Array.prototype.slice;l.VERSION="1.2.3",l.$=p,l.noConflict=function(){return d.Backbone=m,this},l.emulateHTTP=!1,l.emulateJSON=!1;var b=function(w,R,D){switch(w){case 1:return function(){return f[R](this[D])};case 2:return function(z){return f[R](this[D],z)};case 3:return function(z,j){return f[R](this[D],A(z,this),j)};case 4:return function(z,j,K){return f[R](this[D],A(z,this),j,K)};default:return function(){var z=_.call(arguments);return z.unshift(this[D]),f[R].apply(f,z)}}},x=function(w,R,D){f.each(R,function(z,j){f[j]&&(w.prototype[j]=b(z,j,D))})},A=function(w,R){return f.isFunction(w)?w:f.isObject(w)&&!R._isModel(w)?S(w):f.isString(w)?function(D){return D.get(w)}:w},S=function(w){var R=f.matches(w);return function(D){return R(D.attributes)}},E=l.Events={},F=/\s+/,v=function(w,R,D,z,j){var K=0,pe;if(D&&typeof D=="object")for(z!==void 0&&("context"in j)&&j.context===void 0&&(j.context=z),pe=f.keys(D);K<pe.length;K++)R=v(w,R,pe[K],D[pe[K]],j);else if(D&&F.test(D))for(pe=D.split(F);K<pe.length;K++)R=w(R,pe[K],z,j);else R=w(R,D,z,j);return R};E.on=function(w,R,D){return P(this,w,R,D)};var P=function(w,R,D,z,j){if(w._events=v(G,w._events||{},R,D,{context:z,ctx:w,listening:j}),j){var K=w._listeners||(w._listeners={});K[j.id]=j}return w};E.listenTo=function(w,R,D){if(!w)return this;var z=w._listenId||(w._listenId=f.uniqueId("l")),j=this._listeningTo||(this._listeningTo={}),K=j[z];if(!K){var pe=this._listenId||(this._listenId=f.uniqueId("l"));K=j[z]={obj:w,objId:z,id:pe,listeningTo:j,count:0}}return P(w,R,D,this,K),this};var G=function(w,R,D,z){if(D){var j=w[R]||(w[R]=[]),K=z.context,pe=z.ctx,be=z.listening;be&&be.count++,j.push({callback:D,context:K,ctx:K||pe,listening:be})}return w};E.off=function(w,R,D){return this._events?(this._events=v($,this._events,w,R,{context:D,listeners:this._listeners}),this):this},E.stopListening=function(w,R,D){var z=this._listeningTo;if(!z)return this;for(var j=w?[w._listenId]:f.keys(z),K=0;K<j.length;K++){var pe=z[j[K]];if(!pe)break;pe.obj.off(R,D,this)}return f.isEmpty(z)&&(this._listeningTo=void 0),this};var $=function(w,R,D,z){if(w){var j=0,K,pe=z.context,be=z.listeners;if(!R&&!D&&!pe){for(var Ee=f.keys(be);j<Ee.length;j++)K=be[Ee[j]],delete be[K.id],delete K.listeningTo[K.objId];return}for(var We=R?[R]:f.keys(w);j<We.length;j++){R=We[j];var ot=w[R];if(!ot)break;for(var Ge=[],at=0;at<ot.length;at++){var wn=ot[at];D&&D!==wn.callback&&D!==wn.callback._callback||pe&&pe!==wn.context?Ge.push(wn):(K=wn.listening,K&&--K.count===0&&(delete be[K.id],delete K.listeningTo[K.objId]))}Ge.length?w[R]=Ge:delete w[R]}if(f.size(w))return w}};E.once=function(w,R,D){var z=v(Z,{},w,R,f.bind(this.off,this));return this.on(z,void 0,D)},E.listenToOnce=function(w,R,D){var z=v(Z,{},R,D,f.bind(this.stopListening,this,w));return this.listenTo(w,z)};var Z=function(w,R,D,z){if(D){var j=w[R]=f.once(function(){z(R,j),D.apply(this,arguments)});j._callback=D}return w};E.trigger=function(w){if(!this._events)return this;for(var R=Math.max(0,arguments.length-1),D=Array(R),z=0;z<R;z++)D[z]=arguments[z+1];return v(ie,this._events,w,void 0,D),this};var ie=function(w,R,D,z){if(w){var j=w[R],K=w.all;j&&K&&(K=K.slice()),j&&le(j,z),K&&le(K,[R].concat(z))}return w},le=function(w,R){var D,z=-1,j=w.length,K=R[0],pe=R[1],be=R[2];switch(R.length){case 0:for(;++z<j;)(D=w[z]).callback.call(D.ctx);return;case 1:for(;++z<j;)(D=w[z]).callback.call(D.ctx,K);return;case 2:for(;++z<j;)(D=w[z]).callback.call(D.ctx,K,pe);return;case 3:for(;++z<j;)(D=w[z]).callback.call(D.ctx,K,pe,be);return;default:for(;++z<j;)(D=w[z]).callback.apply(D.ctx,R);return}};E.bind=E.on,E.unbind=E.off,f.extend(l,E);var X=l.Model=function(w,R){var D=w||{};R||(R={}),this.cid=f.uniqueId(this.cidPrefix),this.attributes={},R.collection&&(this.collection=R.collection),R.parse&&(D=this.parse(D,R)||{}),D=f.defaults({},D,f.result(this,"defaults")),this.set(D,R),this.changed={},this.initialize.apply(this,arguments)};f.extend(X.prototype,E,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(w){return f.clone(this.attributes)},sync:function(){return l.sync.apply(this,arguments)},get:function(w){return this.attributes[w]},escape:function(w){return f.escape(this.get(w))},has:function(w){return this.get(w)!=null},matches:function(w){return!!f.iteratee(w,this)(this.attributes)},set:function(w,R,D){if(w==null)return this;var z;if(typeof w=="object"?(z=w,D=R):(z={})[w]=R,D||(D={}),!this._validate(z,D))return!1;var j=D.unset,K=D.silent,pe=[],be=this._changing;this._changing=!0,be||(this._previousAttributes=f.clone(this.attributes),this.changed={});var Ee=this.attributes,We=this.changed,ot=this._previousAttributes;for(var Ge in z)R=z[Ge],f.isEqual(Ee[Ge],R)||pe.push(Ge),f.isEqual(ot[Ge],R)?delete We[Ge]:We[Ge]=R,j?delete Ee[Ge]:Ee[Ge]=R;if(this.id=this.get(this.idAttribute),!K){pe.length&&(this._pending=D);for(var at=0;at<pe.length;at++)this.trigger("change:"+pe[at],this,Ee[pe[at]],D)}if(be)return this;if(!K)for(;this._pending;)D=this._pending,this._pending=!1,this.trigger("change",this,D);return this._pending=!1,this._changing=!1,this},unset:function(w,R){return this.set(w,void 0,f.extend({},R,{unset:!0}))},clear:function(w){var R={};for(var D in this.attributes)R[D]=void 0;return this.set(R,f.extend({},w,{unset:!0}))},hasChanged:function(w){return w==null?!f.isEmpty(this.changed):f.has(this.changed,w)},changedAttributes:function(w){if(!w)return this.hasChanged()?f.clone(this.changed):!1;var R=this._changing?this._previousAttributes:this.attributes,D={};for(var z in w){var j=w[z];f.isEqual(R[z],j)||(D[z]=j)}return f.size(D)?D:!1},previous:function(w){return w==null||!this._previousAttributes?null:this._previousAttributes[w]},previousAttributes:function(){return f.clone(this._previousAttributes)},fetch:function(w){w=f.extend({parse:!0},w);var R=this,D=w.success;return w.success=function(z){var j=w.parse?R.parse(z,w):z;if(!R.set(j,w))return!1;D&&D.call(w.context,R,z,w),R.trigger("sync",R,z,w)},B(this,w),this.sync("read",this,w)},save:function(w,R,D){var z;w==null||typeof w=="object"?(z=w,D=R):(z={})[w]=R,D=f.extend({validate:!0,parse:!0},D);var j=D.wait;if(z&&!j){if(!this.set(z,D))return!1}else if(!this._validate(z,D))return!1;var K=this,pe=D.success,be=this.attributes;D.success=function(ot){K.attributes=be;var Ge=D.parse?K.parse(ot,D):ot;if(j&&(Ge=f.extend({},z,Ge)),Ge&&!K.set(Ge,D))return!1;pe&&pe.call(D.context,K,ot,D),K.trigger("sync",K,ot,D)},B(this,D),z&&j&&(this.attributes=f.extend({},be,z));var Ee=this.isNew()?"create":D.patch?"patch":"update";Ee==="patch"&&!D.attrs&&(D.attrs=z);var We=this.sync(Ee,this,D);return this.attributes=be,We},destroy:function(w){w=w?f.clone(w):{};var R=this,D=w.success,z=w.wait,j=function(){R.stopListening(),R.trigger("destroy",R,R.collection,w)};w.success=function(pe){z&&j(),D&&D.call(w.context,R,pe,w),R.isNew()||R.trigger("sync",R,pe,w)};var K=!1;return this.isNew()?f.defer(w.success):(B(this,w),K=this.sync("delete",this,w)),z||j(),K},url:function(){var w=f.result(this,"urlRoot")||f.result(this.collection,"url")||fn();if(this.isNew())return w;var R=this.get(this.idAttribute);return w.replace(/[^\/]$/,"$&/")+encodeURIComponent(R)},parse:function(w,R){return w},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(w){return this._validate({},f.defaults({validate:!0},w))},_validate:function(w,R){if(!R.validate||!this.validate)return!0;w=f.extend({},this.attributes,w);var D=this.validationError=this.validate(w,R)||null;return D?(this.trigger("invalid",this,D,f.extend(R,{validationError:D})),!1):!0}});var oe={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};x(X,oe,"attributes");var _e=l.Collection=function(w,R){R||(R={}),R.model&&(this.model=R.model),R.comparator!==void 0&&(this.comparator=R.comparator),this._reset(),this.initialize.apply(this,arguments),w&&this.reset(w,f.extend({silent:!0},R))},Re={add:!0,remove:!0,merge:!0},Se={add:!0,remove:!1},we=function(w,R,D){D=Math.min(Math.max(D,0),w.length);for(var z=Array(w.length-D),j=R.length,K=0;K<z.length;K++)z[K]=w[K+D];for(K=0;K<j;K++)w[K+D]=R[K];for(K=0;K<z.length;K++)w[K+j+D]=z[K]};f.extend(_e.prototype,E,{model:X,initialize:function(){},toJSON:function(w){return this.map(function(R){return R.toJSON(w)})},sync:function(){return l.sync.apply(this,arguments)},add:function(w,R){return this.set(w,f.extend({merge:!1},R,Se))},remove:function(w,R){R=f.extend({},R);var D=!f.isArray(w);w=D?[w]:f.clone(w);var z=this._removeModels(w,R);return!R.silent&&z&&this.trigger("update",this,R),D?z[0]:z},set:function(w,R){if(w!=null){R=f.defaults({},R,Re),R.parse&&!this._isModel(w)&&(w=this.parse(w,R));var D=!f.isArray(w);w=D?[w]:w.slice();var z=R.at;z!=null&&(z=+z),z<0&&(z+=this.length+1);for(var j=[],K=[],pe=[],be={},Ee=R.add,We=R.merge,ot=R.remove,Ge=!1,at=this.comparator&&z==null&&R.sort!==!1,wn=f.isString(this.comparator)?this.comparator:null,lt,dn=0;dn<w.length;dn++){lt=w[dn];var tn=this.get(lt);if(tn){if(We&&lt!==tn){var Vi=this._isModel(lt)?lt.attributes:lt;R.parse&&(Vi=tn.parse(Vi,R)),tn.set(Vi,R),at&&!Ge&&(Ge=tn.hasChanged(wn))}be[tn.cid]||(be[tn.cid]=!0,j.push(tn)),w[dn]=tn}else Ee&&(lt=w[dn]=this._prepareModel(lt,R),lt&&(K.push(lt),this._addReference(lt,R),be[lt.cid]=!0,j.push(lt)))}if(ot){for(dn=0;dn<this.length;dn++)lt=this.models[dn],be[lt.cid]||pe.push(lt);pe.length&&this._removeModels(pe,R)}var nn=!1,rn=!at&&Ee&&ot;if(j.length&&rn?(nn=this.length!=j.length||f.some(this.models,function(Mi,or){return Mi!==j[or]}),this.models.length=0,we(this.models,j,0),this.length=this.models.length):K.length&&(at&&(Ge=!0),we(this.models,K,z??this.length),this.length=this.models.length),Ge&&this.sort({silent:!0}),!R.silent){for(dn=0;dn<K.length;dn++)z!=null&&(R.index=z+dn),lt=K[dn],lt.trigger("add",lt,this,R);(Ge||nn)&&this.trigger("sort",this,R),(K.length||pe.length)&&this.trigger("update",this,R)}return D?w[0]:w}},reset:function(w,R){R=R?f.clone(R):{};for(var D=0;D<this.models.length;D++)this._removeReference(this.models[D],R);return R.previousModels=this.models,this._reset(),w=this.add(w,f.extend({silent:!0},R)),R.silent||this.trigger("reset",this,R),w},push:function(w,R){return this.add(w,f.extend({at:this.length},R))},pop:function(w){var R=this.at(this.length-1);return this.remove(R,w)},unshift:function(w,R){return this.add(w,f.extend({at:0},R))},shift:function(w){var R=this.at(0);return this.remove(R,w)},slice:function(){return _.apply(this.models,arguments)},get:function(w){if(w!=null){var R=this.modelId(this._isModel(w)?w.attributes:w);return this._byId[w]||this._byId[R]||this._byId[w.cid]}},at:function(w){return w<0&&(w+=this.length),this.models[w]},where:function(w,R){return this[R?"find":"filter"](w)},findWhere:function(w){return this.where(w,!0)},sort:function(w){var R=this.comparator;if(!R)throw new Error("Cannot sort a set without a comparator");w||(w={});var D=R.length;return f.isFunction(R)&&(R=f.bind(R,this)),D===1||f.isString(R)?this.models=this.sortBy(R):this.models.sort(R),w.silent||this.trigger("sort",this,w),this},pluck:function(w){return f.invoke(this.models,"get",w)},fetch:function(w){w=f.extend({parse:!0},w);var R=w.success,D=this;return w.success=function(z){var j=w.reset?"reset":"set";D[j](z,w),R&&R.call(w.context,D,z,w),D.trigger("sync",D,z,w)},B(this,w),this.sync("read",this,w)},create:function(w,R){R=R?f.clone(R):{};var D=R.wait;if(w=this._prepareModel(w,R),!w)return!1;D||this.add(w,R);var z=this,j=R.success;return R.success=function(K,pe,be){D&&z.add(K,be),j&&j.call(be.context,K,pe,be)},w.save(null,R),w},parse:function(w,R){return w},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(w){return w[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(w,R){if(this._isModel(w))return w.collection||(w.collection=this),w;R=R?f.clone(R):{},R.collection=this;var D=new this.model(w,R);return D.validationError?(this.trigger("invalid",this,D.validationError,R),!1):D},_removeModels:function(w,R){for(var D=[],z=0;z<w.length;z++){var j=this.get(w[z]);if(j){var K=this.indexOf(j);this.models.splice(K,1),this.length--,R.silent||(R.index=K,j.trigger("remove",j,this,R)),D.push(j),this._removeReference(j,R)}}return D.length?D:!1},_isModel:function(w){return w instanceof X},_addReference:function(w,R){this._byId[w.cid]=w;var D=this.modelId(w.attributes);D!=null&&(this._byId[D]=w),w.on("all",this._onModelEvent,this)},_removeReference:function(w,R){delete this._byId[w.cid];var D=this.modelId(w.attributes);D!=null&&delete this._byId[D],this===w.collection&&delete w.collection,w.off("all",this._onModelEvent,this)},_onModelEvent:function(w,R,D,z){if(!((w==="add"||w==="remove")&&D!==this)){if(w==="destroy"&&this.remove(R,z),w==="change"){var j=this.modelId(R.previousAttributes()),K=this.modelId(R.attributes);j!==K&&(j!=null&&delete this._byId[j],K!=null&&(this._byId[K]=R))}this.trigger.apply(this,arguments)}}});var Ue={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3};x(_e,Ue,"models");var Oe=l.View=function(w){this.cid=f.uniqueId("view"),f.extend(this,f.pick(w,Ne)),this._ensureElement(),this.initialize.apply(this,arguments)},Ft=/^(\S+)\s*(.*)$/,Ne=["model","collection","el","id","attributes","className","tagName","events"];f.extend(Oe.prototype,E,{tagName:"div",$:function(w){return this.$el.find(w)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(w){return this.undelegateEvents(),this._setElement(w),this.delegateEvents(),this},_setElement:function(w){this.$el=w instanceof l.$?w:l.$(w),this.el=this.$el[0]},delegateEvents:function(w){if(w||(w=f.result(this,"events")),!w)return this;this.undelegateEvents();for(var R in w){var D=w[R];if(f.isFunction(D)||(D=this[D]),!!D){var z=R.match(Ft);this.delegate(z[1],z[2],f.bind(D,this))}}return this},delegate:function(w,R,D){return this.$el.on(w+".delegateEvents"+this.cid,R,D),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(w,R,D){return this.$el.off(w+".delegateEvents"+this.cid,R,D),this},_createElement:function(w){return document.createElement(w)},_ensureElement:function(){if(this.el)this.setElement(f.result(this,"el"));else{var w=f.extend({},f.result(this,"attributes"));this.id&&(w.id=f.result(this,"id")),this.className&&(w.class=f.result(this,"className")),this.setElement(this._createElement(f.result(this,"tagName"))),this._setAttributes(w)}},_setAttributes:function(w){this.$el.attr(w)}}),l.sync=function(w,R,D){var z=it[w];f.defaults(D||(D={}),{emulateHTTP:l.emulateHTTP,emulateJSON:l.emulateJSON});var j={type:z,dataType:"json"};if(D.url||(j.url=f.result(R,"url")||fn()),D.data==null&&R&&(w==="create"||w==="update"||w==="patch")&&(j.contentType="application/json",j.data=JSON.stringify(D.attrs||R.toJSON(D))),D.emulateJSON&&(j.contentType="application/x-www-form-urlencoded",j.data=j.data?{model:j.data}:{}),D.emulateHTTP&&(z==="PUT"||z==="DELETE"||z==="PATCH")){j.type="POST",D.emulateJSON&&(j.data._method=z);var K=D.beforeSend;D.beforeSend=function(Ee){if(Ee.setRequestHeader("X-HTTP-Method-Override",z),K)return K.apply(this,arguments)}}j.type!=="GET"&&!D.emulateJSON&&(j.processData=!1);var pe=D.error;D.error=function(Ee,We,ot){D.textStatus=We,D.errorThrown=ot,pe&&pe.call(D.context,Ee,We,ot)};var be=D.xhr=l.ajax(f.extend(j,D));return R.trigger("request",R,be,D),be};var it={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};l.ajax=function(){return l.$.ajax.apply(l.$,arguments)};var Me=l.Router=function(w){w||(w={}),w.routes&&(this.routes=w.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},Et=/\((.*?)\)/g,mt=/(\(\?)?:\w+/g,et=/\*\w+/g,Ke=/[\-{}\[\]+?.,\\\^$|#\s]/g;f.extend(Me.prototype,E,{initialize:function(){},route:function(w,R,D){f.isRegExp(w)||(w=this._routeToRegExp(w)),f.isFunction(R)&&(D=R,R=""),D||(D=this[R]);var z=this;return l.history.route(w,function(j){var K=z._extractParameters(w,j);z.execute(D,K,R)!==!1&&(z.trigger.apply(z,["route:"+R].concat(K)),z.trigger("route",R,K),l.history.trigger("route",z,R,K))}),this},execute:function(w,R,D){w&&w.apply(this,R)},navigate:function(w,R){return l.history.navigate(w,R),this},_bindRoutes:function(){if(this.routes){this.routes=f.result(this,"routes");for(var w,R=f.keys(this.routes);(w=R.pop())!=null;)this.route(w,this.routes[w])}},_routeToRegExp:function(w){return w=w.replace(Ke,"\\$&").replace(Et,"(?:$1)?").replace(mt,function(R,D){return D?R:"([^/?]+)"}).replace(et,"([^?]*?)"),new RegExp("^"+w+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(w,R){var D=w.exec(R).slice(1);return f.map(D,function(z,j){return j===D.length-1?z||null:z?decodeURIComponent(z):null})}});var Mt=l.History=function(){this.handlers=[],this.checkUrl=f.bind(this.checkUrl,this),typeof window<"u"&&(this.location=window.location,this.history=window.history)},Be=/^[#\/]|\s+$/g,Bt=/^\/+|\/+$/g,Fn=/#.*$/;Mt.started=!1,f.extend(Mt.prototype,E,{interval:50,atRoot:function(){var w=this.location.pathname.replace(/[^\/]$/,"$&/");return w===this.root&&!this.getSearch()},matchRoot:function(){var w=this.decodeFragment(this.location.pathname),R=w.slice(0,this.root.length-1)+"/";return R===this.root},decodeFragment:function(w){return decodeURI(w.replace(/%25/g,"%2525"))},getSearch:function(){var w=this.location.href.replace(/#.*/,"").match(/\?.+/);return w?w[0]:""},getHash:function(w){var R=(w||this).location.href.match(/#(.*)$/);return R?R[1]:""},getPath:function(){var w=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return w.charAt(0)==="/"?w.slice(1):w},getFragment:function(w){return w==null&&(this._usePushState||!this._wantsHashChange?w=this.getPath():w=this.getHash()),w.replace(Be,"")},start:function(w){if(Mt.started)throw new Error("Backbone.history has already been started");if(Mt.started=!0,this.options=f.extend({root:"/"},this.options,w),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(document.documentMode===void 0||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.history&&this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(Bt,"/"),this._wantsHashChange&&this._wantsPushState)if(!this._hasPushState&&!this.atRoot()){var R=this.root.slice(0,-1)||"/";return this.location.replace(R+"#"+this.getPath()),!0}else this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0});if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var D=document.body,z=D.insertBefore(this.iframe,D.firstChild).contentWindow;z.document.open(),z.document.close(),z.location.hash="#"+this.fragment}var j=window.addEventListener||function(K,pe){return attachEvent("on"+K,pe)};if(this._usePushState?j("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?j("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var w=window.removeEventListener||function(R,D){return detachEvent("on"+R,D)};this._usePushState?w("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&w("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),Mt.started=!1},route:function(w,R){this.handlers.unshift({route:w,callback:R})},checkUrl:function(w){var R=this.getFragment();if(R===this.fragment&&this.iframe&&(R=this.getHash(this.iframe.contentWindow)),R===this.fragment)return!1;this.iframe&&this.navigate(R),this.loadUrl()},loadUrl:function(w){return this.matchRoot()?(w=this.fragment=this.getFragment(w),f.some(this.handlers,function(R){if(R.route.test(w))return R.callback(w),!0})):!1},navigate:function(w,R){if(!Mt.started)return!1;(!R||R===!0)&&(R={trigger:!!R}),w=this.getFragment(w||"");var D=this.root;(w===""||w.charAt(0)==="?")&&(D=D.slice(0,-1)||"/");var z=D+w;if(w=this.decodeFragment(w.replace(Fn,"")),this.fragment!==w){if(this.fragment=w,this._usePushState)this.history[R.replace?"replaceState":"pushState"]({},document.title,z);else if(this._wantsHashChange){if(this._updateHash(this.location,w,R.replace),this.iframe&&w!==this.getHash(this.iframe.contentWindow)){var j=this.iframe.contentWindow;R.replace||(j.document.open(),j.document.close()),this._updateHash(j.location,w,R.replace)}}else return this.location.assign(z);if(R.trigger)return this.loadUrl(w)}},_updateHash:function(w,R,D){if(D){var z=w.href.replace(/(javascript:|#).*$/,"");w.replace(z+"#"+R)}else w.hash="#"+R}}),l.history=new Mt;var gi=function(w,R){var D=this,z;w&&f.has(w,"constructor")?z=w.constructor:z=function(){return D.apply(this,arguments)},f.extend(z,D,R);var j=function(){this.constructor=z};return j.prototype=D.prototype,z.prototype=new j,w&&f.extend(z.prototype,w),z.__super__=D.prototype,z};X.extend=_e.extend=Me.extend=Oe.extend=Mt.extend=gi;var fn=function(){throw new Error('A "url" property or function must be specified')},B=function(w,R){var D=R.error;R.error=function(z){D&&D.call(R.context,w,z,R),w.trigger("error",w,z,R)}};return l})}).call(this,n(30))},function(t,o,n){var s=n(17),a=n(0),c=n(1),d=c.Model.extend({initialize:function(f){return a.bindAll(this,"fetch","save","retrigger"),c.Model.prototype.initialize.call(this,f)},fetch:function(f){var p=this;this.trigger("loadModelStarted"),s.when(c.Model.prototype.fetch.call(this,f)).done(function(m){p.trigger("loadModelCompleted",m,p)}).fail(function(m){p.trigger("loadModelFailed",m,p)})},setIdAttribute:function(f){this.idAttribute=f},retrigger:function(f,p,m){m||(m=f);var _=this;p.bind&&p.bind(f,function(){_.trigger(m)},_)},save:function(f,p){var m=this;(!p||!p.silent)&&this.trigger("saving");var _=c.Model.prototype.save.apply(this,arguments);return s.when(_).done(function(){(!p||!p.silent)&&m.trigger("saved")}).fail(function(){(!p||!p.silent)&&m.trigger("errorSaving")}),_}});t.exports=d},function(t,o,n){var s=n(4);function a(c,d,l){return new s({origin:"validation",type:c,message:d},l)}t.exports=a},function(t,o,n){var s=n(143),a=n(138),c="unexpected error",d="generic";function l(x,A){A=A||{};var S=Object.create(Error.prototype);S.message=x&&x.message||c,S.origin=x&&x.origin||d,S.type=x&&x.type||"",f(x)&&(S=m(x,A.layers,A.analysis)),p(x)&&(S=_(x));var E=s.getExtraFields(S);return S.message=E.friendlyMessage,S.errorCode=E.errorCode,S.name="CartoError",S.stack=new Error().stack,S.originalError=x,a.track(S),S}function f(x){return x&&x.origin==="windshaft"}function p(x){return x&&x.responseText}function m(x,A,S){var E=Object.create(Error.prototype);return E.message=x.message,E.origin=x.origin,E.type=x.type,x.type==="layer"&&A&&(E.layer=A.findById(x.layerId)),x.type==="analysis"&&(S&&(E.source=S,E.sourceId=S.getId&&S.getId()),x.analysisId&&(E.sourceId=x.analysisId)),E}function _(x){var A=Object.create(Error.prototype);return A.message=b(x),A.origin="ajax",A.type=x.statusText,A}function b(x){var A="";try{var S=JSON.parse(x.responseText);A=S.errors[0]}catch{}return A||c}t.exports=l},function(t,o,n){var s=n(0),a={COUNT:"count",SUM:"sum",AVG:"avg",MAX:"max",MIN:"min"};function c(m){return s.contains(a,m)}var d={NOT_LOADED:"notLoaded",LOADING:"loading",LOADED:"loaded",ERROR:"error"},l={AUTO:"auto",MILLENNIUM:"millennium",CENTURY:"century",DECADE:"decade",YEAR:"year",QUARTER:"quarter",MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTE:"minute"};function f(m){return s.contains(l,m)}var p='&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/about-carto/">CARTO</a>';t.exports={operation:a,status:d,timeAggregation:l,isValidOperation:c,isValidTimeAggregation:f,ATTRIBUTION:p}},function(t,o,n){var s=n(0),a=n(1),c=n(3);function d(){}s.extend(d.prototype,a.Events),d.prototype._getValidationError=function(l){return new c("filter",l)},t.exports=d},function(t,o,n){var s=n(0),a={};a.isCORSSupported=function(){return"withCredentials"in new XMLHttpRequest},a.array2hex=function(d){for(var l=[],f=0;f<d.length;++f)l.push(String.fromCharCode(d[f]+128));return a.btoa(l.join(""))},a.btoa=function(d){return typeof window.btoa=="function"?a.encodeBase64Native(d):a.encodeBase64(d)},a.encodeBase64Native=function(d){return btoa(d)},a.encodeBase64=function(d){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f,p,m,_,b,x,A,S,E=0,F=0,v="",P=[];if(!d)return d;do f=d.charCodeAt(E++),p=d.charCodeAt(E++),m=d.charCodeAt(E++),S=f<<16|p<<8|m,_=S>>18&63,b=S>>12&63,x=S>>6&63,A=S&63,P[F++]=l.charAt(_)+l.charAt(b)+l.charAt(x)+l.charAt(A);while(E<d.length);v=P.join("");var G=d.length%3;return(G?v.slice(0,G-3):v)+"===".slice(G||3)},a.uniqueCallbackName=function(d){return a._callback_c=a._callback_c||0,++a._callback_c,a.crc32(d)+"_"+a._callback_c},a.crc32=function(d){for(var l=a._crcTable||(a._crcTable=a._makeCRCTable()),f=-1,p=0,m=d.length;p<m;++p)f=f>>>8^l[(f^d.charCodeAt(p))&255];return(f^-1)>>>0},a._makeCRCTable=function(){for(var d,l=[],f=0;f<256;++f){d=f;for(var p=0;p<8;++p)d=d&1?3988292384^d>>>1:d>>>1;l[f]=d}return l},a._inferBrowser=function(d){var l={};d=d||typeof window<"u"&&window.navigator.userAgent||"";function f(){var m=d.indexOf("MSIE "),_=d.indexOf("Trident/");return m>-1||_>-1}function p(){return document.compatMode?window.XMLHttpRequest?document.querySelector?document.addEventListener?window.atob?document.all?10:11:9:8:7:6:5}return f()?l.ie={version:p()}:d.indexOf("Edge/")>-1?l.edge=d:d.indexOf("Chrome")>-1?l.chrome=d:d.indexOf("Firefox")>-1?l.firefox=d:d.indexOf("Opera")>-1?l.opera=d:d.indexOf("Safari")>-1&&(l.safari=d),l},a.browser=a._inferBrowser(),a.isMobileDevice=function(){return/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},a.supportsTouch=function(){return"ontouchstart"in window||navigator.msMaxTouchPoints};var c=null;a.isWebGLSupported=function(){if(c===null){var d=document.createElement("canvas");c=!!window.WebGLRenderingContext&&!!(d.getContext("webgl")||d.getContext("experimental-webgl"))}return c},a.endsWith=function(d,l){return d.indexOf(l,d.length-l.length)!==-1},a.checkRequiredOpts=function(d,l,f){s.each(l,function(p){if(s.isUndefined(d[p]))throw new Error(p+" is required"+(f?" to initialize "+f:""))})},a.isLeafletLoaded=function(){if(!window.L)throw new Error("Leaflet is required");if(window.L.version<"1.0.0")throw new Error("Leaflet +1.0 is required")},a.isGoogleMapsLoaded=function(){if(!window.google)throw new Error("Google Maps is required");if(!window.google.maps)throw new Error("Google Maps is required");if(window.google.maps.version<"3.31.0")throw new Error("Google Maps version should be >= 3.31")},t.exports=a},function(t,o,n){var s={BBOX:"bbox",CIRCLE:"circle",POLYGON:"polygon"};t.exports=s},function(t,o,n){var s=n(0),a=n(1),c=n(2),d=n(7),l=["camshaftReference","engine"],f={PENDING:"pending",WAITING:"waiting",RUNNING:"running",FAILED:"failed",READY:"ready"},p=c.extend({initialize:function(_,b){b=b||{},d.checkRequiredOpts(b,l,"AnalysisModel"),this._camshaftReference=b.camshaftReference,this._engine=b.engine,this._initBinds(),this._referencedBy={}},url:function(){var _=this.get("url");if(_){if(this.get("apiKey"))_+="?api_key="+this.get("apiKey");else if(this.get("authToken")){var b=this.get("authToken");if(b instanceof Array){var x=s.map(b,function(A){return"auth_token[]="+A});_+="?"+x.join("&")}else _+="?auth_token="+b}return _}},setOk:function(){this.unset("error")},setError:function(_){this.set({error:_,status:f.FAILED})},_initBinds:function(){this.bind("change:type",function(){this.unbind(null,null,this),this._initBinds(),this._reload()},this),s.each(this.getParamNames(),function(_){this.bind("change:"+_,this._reload,this)},this),this.bind("change:status",function(){this._hadStatus()&&this.isReady()&&this.isSourceOfAnyModel()&&this._reload()},this)},_hadStatus:function(){return this.previous("status")},_reload:function(){this._engine.reload({error:this._onMapReloadError.bind(this)})},_onMapReloadError:function(){this.set("status",f.FAILED)},remove:function(){this.trigger("destroy",this),this.stopListening()},findAnalysisById:function(_){if(this.get("id")===_)return this;var b=s.chain(this._getSourceNames()).map(function(x){var A=this.get(x);if(A)return A.findAnalysisById(_)},this).compact().value();return b[0]},_getSourceNames:function(){return this._camshaftReference.getSourceNamesForAnalysisType(this.get("type"))},isDone:function(){return this._hasStatus([f.READY,f.FAILED])},isLoading:function(){return this._hasStatus([f.PENDING,f.WAITING,f.RUNNING])},isReady:function(){return this._hasStatus(f.READY)},isFailed:function(){return this._hasStatus(f.FAILED)},_hasStatus:function(_){return s.isArray(_)||(_=[_]),s.contains(_,this._getStatus())},_getStatus:function(){return this.get("status")},toJSON:function(){var _=s.pick(this.attributes,"id","type");_.params=s.pick(this.attributes,this.getParamNames());var b=this._getSourceNames();return s.each(b,function(x){var A={},S=this.get(x);S&&(A[x]=S.toJSON(),s.extend(_.params,A))},this),_},getParamNames:function(){return this._camshaftReference.getParamNamesForAnalysisType(this.get("type"))},getNodes:function(){var _=[this];return this.get("type")!=="source"&&s.forEach(this._getSourceNames(),function(b){var x=this.get(b);x&&(_=_.concat(x.getNodes()))},this),_},getNodesCollection:function(){return new a.Collection(this.getNodes())},equals:function(_){return _ instanceof p?this.get("id")===_.get("id"):!1},markAsSourceOf:function(_){this._referencedBy[_.cid]=!0},isSourceOfAnyModel:function(){return Object.keys(this._referencedBy).length>0},isSourceOf:function(_){return!!this._referencedBy[_.cid]},unmarkAsSourceOf:function(_){delete this._referencedBy[_.cid]}},{STATUS:f});t.exports=p},function(t,o,n){var s=n(0),a=n(1),c=n(5).status,d=n(12),l=n(6),f=n(11),p=n(8),m=n(4),_=n(3);function b(){}s.extend(b.prototype,a.Events),b.prototype.getStatus=function(){return this._status},b.prototype.isLoading=function(){return this._status===c.LOADING},b.prototype.isLoaded=function(){return this._status===c.LOADED},b.prototype.hasError=function(){return this._status===c.ERROR},b.prototype.enable=function(){return this._setEnabled(!0)},b.prototype.disable=function(){return this._setEnabled(!1)},b.prototype.isEnabled=function(){return this._enabled},b.prototype.getSource=function(){return this._source},b.prototype.setColumn=function(x){return this._checkColumn(x),this._column=x,this._internalModel&&this._internalModel.set("column",this._column),this},b.prototype.getColumn=function(){return this._column},b.prototype.addFilter=function(x){return this._checkFilter(x),this._addSpatialFilter(x),this},b.prototype.removeFilter=function(x){return this._checkFilter(x),this._removeSpatialFilter(x),this},b.prototype.hasFilter=function(x){this._checkFilter(x);var A=x===this._boundingBoxFilter&&this._internalModel&&this._internalModel.get("sync_on_bbox_change"),S=x===this._circleFilter&&this._internalModel&&this._internalModel.get("sync_on_circle_change"),E=x===this._polygonFilter&&this._internalModel&&this._internalModel.get("sync_on_polygon_change");return A||S||E},b.prototype.getData=function(){throw new Error("getData must be implemented by the particular dataview.")},b.prototype.DEFAULTS={},b.prototype._initialize=function(x,A,S){S=s.defaults(S||{},this.DEFAULTS),this._checkSource(x),this._checkColumn(A),this._checkOptions(S),this._source=x,this._column=A,this._options=S,this._status=c.NOT_LOADED,this._enabled=!0,this._boundingBoxFilter=null},b.prototype._checkSource=function(x){if(!(x instanceof d))throw this._getValidationError("sourceRequired")},b.prototype._checkColumn=function(x){if(s.isUndefined(x))throw this._getValidationError("columnRequired");if(!s.isString(x))throw this._getValidationError("columnString");if(s.isEmpty(x))throw this._getValidationError("emptyColumn")},b.prototype._checkOptions=function(x){throw new Error("_checkOptions must be implemented by the particular dataview.")},b.prototype._checkFilter=function(x){if(!(x instanceof l)||x instanceof f)throw this._getValidationError("filterRequired")},b.prototype._createInternalModel=function(x){throw new Error("_createInternalModel must be implemented by the particular dataview.")},b.prototype._setEnabled=function(x){return this._enabled=x,this._internalModel&&this._internalModel.set("enabled",x),this},b.prototype._listenToInternalModelSharedEvents=function(){this._internalModel&&(this.listenTo(this._internalModel,"change:data",this._onDataChanged),this.listenTo(this._internalModel,"change:column",this._onColumnChanged),this.listenTo(this._internalModel,"loading",this._onStatusLoading),this.listenTo(this._internalModel,"loaded",this._onStatusLoaded),this.listenTo(this._internalModel,"statusError",this._onStatusError))},b.prototype._onDataChanged=function(){this.trigger("dataChanged",this.getData())},b.prototype._onColumnChanged=function(){this._internalModel&&(this._column=this._internalModel.get("column")),this.trigger("columnChanged",this._column)},b.prototype._onStatusLoading=function(){this._status=c.LOADING,this.trigger("statusChanged",this._status)},b.prototype._onStatusLoaded=function(){this._status=c.LOADED,this.trigger("statusChanged",this._status)},b.prototype._onStatusError=function(x,A){this._status=c.ERROR,this.trigger("statusChanged",this._status,A),this._triggerError(this,A)},b.prototype._changeProperty=function(x,A,S){var E=this["_"+x];this["_"+x]=A,E!==A&&(this._triggerChange(x,A),this._internalModel&&this._internalModel.set(S||x,A))},b.prototype._changeProperties=function(x){var A=this;s.each(x,function(S,E){var F=A["_"+E];F!==S&&(A["_"+E]=S,A._triggerChange(E,S))}),this._internalModel&&this._internalModel.set(x)},b.prototype._triggerChange=function(x,A){this.trigger(x+"Changed",A)},b.prototype._triggerError=function(x,A){this.trigger("error",new m(A))},b.prototype._addSpatialFilter=function(x){switch(x.type){case p.BBOX:this._addBoundingBoxFilter(x);break;case p.CIRCLE:this._addCircleFilter(x);break;case p.POLYGON:this._addPolygonFilter(x);break;default:throw new Error("The filter is not a valid spatial filter.")}},b.prototype._removeSpatialFilter=function(x){switch(x.type){case p.BBOX:x===this._boundingBoxFilter&&this._removeBoundingBoxFilter();break;case p.CIRCLE:x===this._circleFilter&&this._removeCircleFilter();break;case p.POLYGON:x===this._polygonFilter&&this._removePolygonFilter();break;default:throw new Error("The filter is not a valid spatial filter.")}},b.prototype._addBoundingBoxFilter=function(x){x!==this._boundingBoxFilter&&(this._boundingBoxFilter=x,this._internalModel&&(this._internalModel.addBBoxFilter(this._boundingBoxFilter.$getInternalModel()),this._internalModel.set("sync_on_bbox_change",!0)))},b.prototype._removeBoundingBoxFilter=function(){this._boundingBoxFilter=null,this._internalModel&&(this._internalModel.removeBBoxFilter(),this._internalModel.set("sync_on_bbox_change",!1))},b.prototype._addCircleFilter=function(x){x!==this._circleFilter&&(this._circleFilter=x,this._internalModel&&(this._internalModel.addCircleFilter(this._circleFilter.$getInternalModel()),this._internalModel.set("sync_on_circle_change",!0)))},b.prototype._removeCircleFilter=function(){this._circleFilter=null,this._internalModel&&(this._internalModel.removeCircleFilter(),this._internalModel.set("sync_on_circle_change",!1))},b.prototype._addPolygonFilter=function(x){x!==this._polygonFilter&&(this._polygonFilter=x,this._internalModel&&(this._internalModel.addPolygonFilter(this._polygonFilter.$getInternalModel()),this._internalModel.set("sync_on_polygon_change",!0)))},b.prototype._removePolygonFilter=function(){this._polygonFilter=null,this._internalModel&&(this._internalModel.removePolygonFilter(),this._internalModel.set("sync_on_polygon_change",!1))},b.prototype._getValidationError=function(x){return new _("dataview",x)},b.prototype.$setEngine=function(x){this._source.$setEngine(x),this._internalModel||(this._createInternalModel(x),this._listenToInternalModelSharedEvents())},b.prototype.$getInternalModel=function(){return this._internalModel},t.exports=b},function(t,o,n){var s=function(){function E(F,v){for(var P=0;P<v.length;P++){var G=v[P];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(F,G.key,G)}}return function(F,v,P){return v&&E(F.prototype,v),P&&E(F,P),F}}();function a(E,F,v){return F in E?Object.defineProperty(E,F,{value:v,enumerable:!0,configurable:!0,writable:!0}):E[F]=v,E}function c(E,F){if(!(E instanceof F))throw new TypeError("Cannot call a class as a function")}function d(E,F){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:E}function l(E,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);E.prototype=Object.create(F&&F.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(E,F):E.__proto__=F)}var f=n(0),p=n(6),m=n(95),_=["includeNull"],b="AND",x=function(E){l(F,E);function F(v){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c(this,F);var G=d(this,(F.__proto__||Object.getPrototypeOf(F)).call(this));return G._checkColumn(v),G._checkOptions(P),G._column=v,G._filters={},G._options=P,G}return s(F,[{key:"set",value:function(P,G){if(!(!P||!G||!f.isString(P))){var $=a({},P,G);this._checkFilters($),this._filters[P]=G,this.trigger("change:filters",$)}}},{key:"setFilters",value:function(P){!P||!f.isObject(P)||(this._checkFilters(P),this._filters=P,this.trigger("change:filters",P))}},{key:"resetFilters",value:function(){this.setFilters({})}},{key:"$getSQL",value:function(){var P=this,G=Object.keys(this._filters),$=G.map(function(Z){return P._interpolateFilter(Z,P._filters[Z])}).filter(function(Z){return Boolean(Z)}).join(" "+b+" ");return this._options.includeNull&&this._includeNullInQuery($),G.length>1?"("+$+")":$}},{key:"_checkColumn",value:function(P){if(f.isUndefined(P))throw this._getValidationError("columnRequired");if(!f.isString(P))throw this._getValidationError("columnString");if(f.isEmpty(P))throw this._getValidationError("emptyColumn")}},{key:"_checkFilters",value:function(P){var G=this;Object.keys(P).forEach(function($){var Z=f.contains(G.ALLOWED_FILTERS,$);if(!Z)throw G._getValidationError("invalidFilter"+$);var ie=G.PARAMETER_SPECIFICATION[$].parameters,le=ie.every(function(X){var oe=m(P,X.name);return X.allowedTypes.some(function(_e){return A(_e,oe)})});if(!le)throw G._getValidationError("invalidParameterType"+$)})}},{key:"_checkOptions",value:function(P){var G=this;Object.keys(P).forEach(function($){var Z=f.contains(_,$);if(!Z)throw G._getValidationError("invalidOption"+$)})}},{key:"_convertValueToSQLString",value:function(P){var G=this;return f.isDate(P)?"'"+P.toISOString()+"'":f.isArray(P)?P.map(function($){return G._convertValueToSQLString($)}).join(","):f.isObject(P)?(Object.keys(P).forEach(function($){$!=="query"&&(P[$]=G._convertValueToSQLString(P[$]))}),P):f.isNumber(P)?P:"'"+S(P.toString())+"'"}},{key:"_interpolateFilter",value:function(P,G){var $=f.template(this.SQL_TEMPLATES[P]),Z=this._convertValueToSQLString(G);return $({column:this._column,value:Z})}},{key:"_includeNullInQuery",value:function(P){var G=Object.keys(this._filters);return G.length>1&&(P="("+P+")"),"("+P+" OR "+this._column+" IS NULL)"}}]),F}(p),A=function(F,v){return f["is"+F](v)},S=function(F){return F.replace(/\n/g,"\\n").replace(/\"/g,'\\"').replace(/'/g,"''")};t.exports=x},function(t,o,n){var s=n(0),a=n(1),c=n(4),d=n(21),l=n(14);function f(){this._id=f.$generateId(),this._hasFiltersApplied=!1,this._appliedFilters=new d}s.extend(f.prototype,a.Events),f.$nextId=0,f.$generateId=function(){return"S"+ ++f.$nextId},f.prototype.getId=function(){return this._id},f.prototype._createInternalModel=function(p){throw new Error("_createInternalModel must be implemented by the particular source")},f.prototype._triggerError=function(p,m){this.trigger(l.ERROR,new c(m,{analysis:this}))},f.prototype.$setEngine=function(p){this._internalModel||(this._internalModel=this._createInternalModel(p),this._internalModel.on("change:error",this._triggerError,this))},f.prototype.$getEngine=function(p){if(this._internalModel)return this._internalModel._engine},f.prototype.$getInternalModel=function(){return this._internalModel},f.prototype.getFilters=function(){return this._appliedFilters.getFilters()},f.prototype.addFilter=function(p){this._hasFiltersApplied=!0,this._appliedFilters.addFilter(p)},f.prototype.addFilters=function(p){var m=this;p.forEach(function(_){return m.addFilter(_)})},f.prototype.removeFilter=function(p){this._appliedFilters.removeFilter(p),this._hasFiltersApplied=Boolean(this._appliedFilters.count())},f.prototype.removeFilters=function(p){var m=this;p.forEach(function(_){return m.removeFilter(_)})},t.exports=f},function(t,o,n){var s=n(0),a=n(1),c=n(44),d=["state","visible"],l=a.Model.extend({defaults:function(){return{visible:!1,title:"",preHTMLSnippet:"",postHTMLSnippet:"",state:this.constructor.STATE_LOADING}},initialize:function(p,m){if(!m.engine)throw new Error("engine is required");m.engine.on(c.Events.RELOAD_STARTED,this._onEngineReloadStarted,this)},_onEngineReloadStarted:function(){this.set("state",this.constructor.STATE_LOADING)},isLoading:function(){return this.get("state")===this.constructor.STATE_LOADING},isError:function(){return this.get("state")===this.constructor.STATE_ERROR},isSuccess:function(){return this.get("state")===this.constructor.STATE_SUCCESS},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},isVisible:function(){return this.get("visible")},update:function(p){this.set(p)},getNonResettableAttrs:function(){return d},reset:function(){var p=s.omit(this.defaults(),this.getNonResettableAttrs());this.set(p)},isAvailable:function(){return!1}},{STATE_LOADING:"loading",STATE_SUCCESS:"success",STATE_ERROR:"error"});t.exports=l},function(t,o,n){t.exports={SUCCESS:"success",ERROR:"error"}},function(t,o,n){var s=n(0),a="prop",c="mapping",d="range",l="category",f="default",p=function(_){this._rule=_};p.prototype.matchesAnyProperty=function(m){return this._matches(this._rule[a],m)},p.prototype.matchesAnyMapping=function(m){return this._matches(this._rule[c],m)},p.prototype._matches=function(m,_){return s.isString(_)&&(_=[_]),s.contains(_,m)},p.prototype.getBucketsWithRangeFilter=function(){return this._getBucketsByFilterType(d)},p.prototype.getBucketsWithCategoryFilter=function(){return this._getBucketsByFilterType(l)},p.prototype.getBucketsWithDefaultFilter=function(){return this._getBucketsByFilterType(f)},p.prototype._getBucketsByFilterType=function(m){return this._rule?s.select(this._rule.buckets,function(_){return _.filter.type===m}):[]},p.prototype.getColumn=function(){return this._rule.column},p.prototype.getMapping=function(){return this._rule.mapping},p.prototype.getProperty=function(){return this._rule.prop},p.prototype.getFilterAvg=function(){return this._rule.stats.filter_avg},t.exports=p},function(t,o,n){var s="Tiled",a="Plain",c="WMS",d="GMapsBase",l="CartoDB",f="torque",p=function(_,b){return _.get("type").toLowerCase()===b.toLowerCase()};t.exports={isTiledLayer:function(_){return p(_,s)},isPlainLayer:function(_){return p(_,a)},isWMSLayer:function(_){return p(_,c)},isGoogleMapsBaseLayer:function(_){return p(_,d)},isCartoDBLayer:function(_){return p(_,l)},isTorqueLayer:function(_){return p(_,f)}}},function(t,o,n){var s,a;/*!
* jQuery JavaScript Library v2.1.4
* http://jquery.com/
*
* Includes Sizzle.js
* http://sizzlejs.com/
*
* Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
* Released under the MIT license
* http://jquery.org/license
*
* Date: 2015-04-28T16:01Z
*/(function(c,d){typeof t=="object"&&typeof t.exports=="object"?t.exports=c.document?d(c,!0):function(l){if(!l.document)throw new Error("jQuery requires a window with a document");return d(l)}:d(c)})(typeof window<"u"?window:this,function(c,d){var l=[],f=l.slice,p=l.concat,m=l.push,_=l.indexOf,b={},x=b.toString,A=b.hasOwnProperty,S={},E=c.document,F="2.1.4",v=function(g,C){return new v.fn.init(g,C)},P=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,G=/^-ms-/,$=/-([\da-z])/gi,Z=function(g,C){return C.toUpperCase()};v.fn=v.prototype={jquery:F,constructor:v,selector:"",length:0,toArray:function(){return f.call(this)},get:function(g){return g!=null?g<0?this[g+this.length]:this[g]:f.call(this)},pushStack:function(g){var C=v.merge(this.constructor(),g);return C.prevObject=this,C.context=this.context,C},each:function(g,C){return v.each(this,g,C)},map:function(g){return this.pushStack(v.map(this,function(C,T){return g.call(C,T,C)}))},slice:function(){return this.pushStack(f.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(g){var C=this.length,T=+g+(g<0?C:0);return this.pushStack(T>=0&&T<C?[this[T]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:m,sort:l.sort,splice:l.splice},v.extend=v.fn.extend=function(){var g,C,T,k,N,U,V=arguments[0]||{},ee=1,ae=arguments.length,ge=!1;for(typeof V=="boolean"&&(ge=V,V=arguments[ee]||{},ee++),typeof V!="object"&&!v.isFunction(V)&&(V={}),ee===ae&&(V=this,ee--);ee<ae;ee++)if((g=arguments[ee])!=null)for(C in g)T=V[C],k=g[C],V!==k&&(ge&&k&&(v.isPlainObject(k)||(N=v.isArray(k)))?(N?(N=!1,U=T&&v.isArray(T)?T:[]):U=T&&v.isPlainObject(T)?T:{},V[C]=v.extend(ge,U,k)):k!==void 0&&(V[C]=k));return V},v.extend({expando:"jQuery"+(F+Math.random()).replace(/\D/g,""),isReady:!0,error:function(g){throw new Error(g)},noop:function(){},isFunction:function(g){return v.type(g)==="function"},isArray:Array.isArray,isWindow:function(g){return g!=null&&g===g.window},isNumeric:function(g){return!v.isArray(g)&&g-parseFloat(g)+1>=0},isPlainObject:function(g){return!(v.type(g)!=="object"||g.nodeType||v.isWindow(g)||g.constructor&&!A.call(g.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(g){var C;for(C in g)return!1;return!0},type:function(g){return g==null?g+"":typeof g=="object"||typeof g=="function"?b[x.call(g)]||"object":typeof g},globalEval:function(g){var C,T=eval;g=v.trim(g),g&&(g.indexOf("use strict")===1?(C=E.createElement("script"),C.text=g,E.head.appendChild(C).parentNode.removeChild(C)):T(g))},camelCase:function(g){return g.replace(G,"ms-").replace($,Z)},nodeName:function(g,C){return g.nodeName&&g.nodeName.toLowerCase()===C.toLowerCase()},each:function(g,C,T){var k,N=0,U=g.length,V=ie(g);if(T){if(V)for(;N<U&&(k=C.apply(g[N],T),k!==!1);N++);else for(N in g)if(k=C.apply(g[N],T),k===!1)break}else if(V)for(;N<U&&(k=C.call(g[N],N,g[N]),k!==!1);N++);else for(N in g)if(k=C.call(g[N],N,g[N]),k===!1)break;return g},trim:function(g){return g==null?"":(g+"").replace(P,"")},makeArray:function(g,C){var T=C||[];return g!=null&&(ie(Object(g))?v.merge(T,typeof g=="string"?[g]:g):m.call(T,g)),T},inArray:function(g,C,T){return C==null?-1:_.call(C,g,T)},merge:function(g,C){for(var T=+C.length,k=0,N=g.length;k<T;k++)g[N++]=C[k];return g.length=N,g},grep:function(g,C,T){for(var k,N=[],U=0,V=g.length,ee=!T;U<V;U++)k=!C(g[U],U),k!==ee&&N.push(g[U]);return N},map:function(g,C,T){var k,N=0,U=g.length,V=ie(g),ee=[];if(V)for(;N<U;N++)k=C(g[N],N,T),k!=null&&ee.push(k);else for(N in g)k=C(g[N],N,T),k!=null&&ee.push(k);return p.apply([],ee)},guid:1,proxy:function(g,C){var T,k,N;if(typeof C=="string"&&(T=g[C],C=g,g=T),!!v.isFunction(g))return k=f.call(arguments,2),N=function(){return g.apply(C||this,k.concat(f.call(arguments)))},N.guid=g.guid=g.guid||v.guid++,N},now:Date.now,support:S}),v.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(g,C){b["[object "+C+"]"]=C.toLowerCase()});function ie(g){var C="length"in g&&g.length,T=v.type(g);return T==="function"||v.isWindow(g)?!1:g.nodeType===1&&C?!0:T==="array"||C===0||typeof C=="number"&&C>0&&C-1 in g}var le=function(g){var C,T,k,N,U,V,ee,ae,ge,he,Le,me,Pe,Xe,Ve,ut,Yn,Yt,Ti,De="sizzle"+1*new Date,gn=g.document,ht=0,Ut=0,Hn=Ho(),Un=Ho(),_i=Ho(),Kn=function(Y,ne){return Y===ne&&(Le=!0),0},mn=1<<31,Pi={}.hasOwnProperty,Ln=[],Xn=Ln.pop,zs=Ln.push,yi=Ln.push,No=Ln.slice,ci=function(Y,ne){for(var re=0,ce=Y.length;re<ce;re++)if(Y[re]===ne)return re;return-1},hi="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Ct="[\\x20\\t\\r\\n\\f]",Qn="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",zo=Qn.replace("w","w#"),hr="\\["+Ct+"*("+Qn+")(?:"+Ct+"*([*^$|!~]?=)"+Ct+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+zo+"))|)"+Ct+"*\\]",An=":("+Qn+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+hr+")*)|.*)\\)|)",ys=new RegExp(Ct+"+","g"),Yi=new RegExp("^"+Ct+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Ct+"+$","g"),js=new RegExp("^"+Ct+"*,"+Ct+"*"),vs=new RegExp("^"+Ct+"*([>+~]|"+Ct+")"+Ct+"*"),bs=new RegExp("="+Ct+`*([^\\]'"]*?)`+Ct+"*\\]","g"),Hs=new RegExp(An),jo=new RegExp("^"+zo+"$"),fr={ID:new RegExp("^#("+Qn+")"),CLASS:new RegExp("^\\.("+Qn+")"),TAG:new RegExp("^("+Qn.replace("w","w*")+")"),ATTR:new RegExp("^"+hr),PSEUDO:new RegExp("^"+An),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Ct+"*(even|odd|(([+-]|)(\\d*)n|)"+Ct+"*(?:([+-]|)"+Ct+"*(\\d+)|))"+Ct+"*\\)|)","i"),bool:new RegExp("^(?:"+hi+")$","i"),needsContext:new RegExp("^"+Ct+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Ct+"*((?:-\\d)?\\d*)"+Ct+"*\\)|)(?=[^-]|$)","i")},Us=/^(?:input|select|textarea|button)$/i,Ws=/^h\d$/i,dr=/^[^{]+\{\s*\[native \w/,xs=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,On=/[+~]/,Ki=/'|\\/g,vi=new RegExp("\\\\([\\da-f]{1,6}"+Ct+"?|("+Ct+")|.)","ig"),sn=function(Y,ne,re){var ce="0x"+ne-65536;return ce!==ce||re?ne:ce<0?String.fromCharCode(ce+65536):String.fromCharCode(ce>>10|55296,ce&1023|56320)},ws=function(){me()};try{yi.apply(Ln=No.call(gn.childNodes),gn.childNodes),Ln[gn.childNodes.length].nodeType}catch{yi={apply:Ln.length?function(ne,re){zs.apply(ne,No.call(re))}:function(ne,re){for(var ce=ne.length,ue=0;ne[ce++]=re[ue++];);ne.length=ce-1}}}function xt(Y,ne,re,ce){var ue,ye,ve,Te,Fe,st,qe,Ye,It,gt;if((ne?ne.ownerDocument||ne:gn)!==Pe&&me(ne),ne=ne||Pe,re=re||[],Te=ne.nodeType,typeof Y!="string"||!Y||Te!==1&&Te!==9&&Te!==11)return re;if(!ce&&Ve){if(Te!==11&&(ue=xs.exec(Y)))if(ve=ue[1]){if(Te===9)if(ye=ne.getElementById(ve),ye&&ye.parentNode){if(ye.id===ve)return re.push(ye),re}else return re;else if(ne.ownerDocument&&(ye=ne.ownerDocument.getElementById(ve))&&Ti(ne,ye)&&ye.id===ve)return re.push(ye),re}else{if(ue[2])return yi.apply(re,ne.getElementsByTagName(Y)),re;if((ve=ue[3])&&T.getElementsByClassName)return yi.apply(re,ne.getElementsByClassName(ve)),re}if(T.qsa&&(!ut||!ut.test(Y))){if(Ye=qe=De,It=ne,gt=Te!==1&&Y,Te===1&&ne.nodeName.toLowerCase()!=="object"){for(st=V(Y),(qe=ne.getAttribute("id"))?Ye=qe.replace(Ki,"\\$&"):ne.setAttribute("id",Ye),Ye="[id='"+Ye+"'] ",Fe=st.length;Fe--;)st[Fe]=Ye+Wn(st[Fe]);It=On.test(Y)&&jr(ne.parentNode)||ne,gt=st.join(",")}if(gt)try{return yi.apply(re,It.querySelectorAll(gt)),re}catch{}finally{qe||ne.removeAttribute("id")}}}return ae(Y.replace(Yi,"$1"),ne,re,ce)}function Ho(){var Y=[];function ne(re,ce){return Y.push(re+" ")>k.cacheLength&&delete ne[Y.shift()],ne[re+" "]=ce}return ne}function Sn(Y){return Y[De]=!0,Y}function fi(Y){var ne=Pe.createElement("div");try{return!!Y(ne)}catch{return!1}finally{ne.parentNode&&ne.parentNode.removeChild(ne),ne=null}}function pr(Y,ne){for(var re=Y.split("|"),ce=Y.length;ce--;)k.attrHandle[re[ce]]=ne}function Uo(Y,ne){var re=ne&&Y,ce=re&&Y.nodeType===1&&ne.nodeType===1&&(~ne.sourceIndex||mn)-(~Y.sourceIndex||mn);if(ce)return ce;if(re){for(;re=re.nextSibling;)if(re===ne)return-1}return Y?1:-1}function ji(Y){return function(ne){var re=ne.nodeName.toLowerCase();return re==="input"&&ne.type===Y}}function co(Y){return function(ne){var re=ne.nodeName.toLowerCase();return(re==="input"||re==="button")&&ne.type===Y}}function Xi(Y){return Sn(function(ne){return ne=+ne,Sn(function(re,ce){for(var ue,ye=Y([],re.length,ne),ve=ye.length;ve--;)re[ue=ye[ve]]&&(re[ue]=!(ce[ue]=re[ue]))})})}function jr(Y){return Y&&typeof Y.getElementsByTagName<"u"&&Y}T=xt.support={},U=xt.isXML=function(Y){var ne=Y&&(Y.ownerDocument||Y).documentElement;return ne?ne.nodeName!=="HTML":!1},me=xt.setDocument=function(Y){var ne,re,ce=Y?Y.ownerDocument||Y:gn;return ce===Pe||ce.nodeType!==9||!ce.documentElement?Pe:(Pe=ce,Xe=ce.documentElement,re=ce.defaultView,re&&re!==re.top&&(re.addEventListener?re.addEventListener("unload",ws,!1):re.attachEvent&&re.attachEvent("onunload",ws)),Ve=!U(ce),T.attributes=fi(function(ue){return ue.className="i",!ue.getAttribute("className")}),T.getElementsByTagName=fi(function(ue){return ue.appendChild(ce.createComment("")),!ue.getElementsByTagName("*").length}),T.getElementsByClassName=dr.test(ce.getElementsByClassName),T.getById=fi(function(ue){return Xe.appendChild(ue).id=De,!ce.getElementsByName||!ce.getElementsByName(De).length}),T.getById?(k.find.ID=function(ue,ye){if(typeof ye.getElementById<"u"&&Ve){var ve=ye.getElementById(ue);return ve&&ve.parentNode?[ve]:[]}},k.filter.ID=function(ue){var ye=ue.replace(vi,sn);return function(ve){return ve.getAttribute("id")===ye}}):(delete k.find.ID,k.filter.ID=function(ue){var ye=ue.replace(vi,sn);return function(ve){var Te=typeof ve.getAttributeNode<"u"&&ve.getAttributeNode("id");return Te&&Te.value===ye}}),k.find.TAG=T.getElementsByTagName?function(ue,ye){if(typeof ye.getElementsByTagName<"u")return ye.getElementsByTagName(ue);if(T.qsa)return ye.querySelectorAll(ue)}:function(ue,ye){var ve,Te=[],Fe=0,st=ye.getElementsByTagName(ue);if(ue==="*"){for(;ve=st[Fe++];)ve.nodeType===1&&Te.push(ve);return Te}return st},k.find.CLASS=T.getElementsByClassName&&function(ue,ye){if(Ve)return ye.getElementsByClassName(ue)},Yn=[],ut=[],(T.qsa=dr.test(ce.querySelectorAll))&&(fi(function(ue){Xe.appendChild(ue).innerHTML="<a id='"+De+"'></a><select id='"+De+"-\f]' msallowcapture=''><option selected=''></option></select>",ue.querySelectorAll("[msallowcapture^='']").length&&ut.push("[*^$]="+Ct+`*(?:''|"")`),ue.querySelectorAll("[selected]").length||ut.push("\\["+Ct+"*(?:value|"+hi+")"),ue.querySelectorAll("[id~="+De+"-]").length||ut.push("~="),ue.querySelectorAll(":checked").length||ut.push(":checked"),ue.querySelectorAll("a#"+De+"+*").length||ut.push(".#.+[+~]")}),fi(function(ue){var ye=ce.createElement("input");ye.setAttribute("type","hidden"),ue.appendChild(ye).setAttribute("name","D"),ue.querySelectorAll("[name=d]").length&&ut.push("name"+Ct+"*[*^$|!~]?="),ue.querySelectorAll(":enabled").length||ut.push(":enabled",":disabled"),ue.querySelectorAll("*,:x"),ut.push(",.*:")})),(T.matchesSelector=dr.test(Yt=Xe.matches||Xe.webkitMatchesSelector||Xe.mozMatchesSelector||Xe.oMatchesSelector||Xe.msMatchesSelector))&&fi(function(ue){T.disconnectedMatch=Yt.call(ue,"div"),Yt.call(ue,"[s!='']:x"),Yn.push("!=",An)}),ut=ut.length&&new RegExp(ut.join("|")),Yn=Yn.length&&new RegExp(Yn.join("|")),ne=dr.test(Xe.compareDocumentPosition),Ti=ne||dr.test(Xe.contains)?function(ue,ye){var ve=ue.nodeType===9?ue.documentElement:ue,Te=ye&&ye.parentNode;return ue===Te||!!(Te&&Te.nodeType===1&&(ve.contains?ve.contains(Te):ue.compareDocumentPosition&&ue.compareDocumentPosition(Te)&16))}:function(ue,ye){if(ye){for(;ye=ye.parentNode;)if(ye===ue)return!0}return!1},Kn=ne?function(ue,ye){if(ue===ye)return Le=!0,0;var ve=!ue.compareDocumentPosition-!ye.compareDocumentPosition;return ve||(ve=(ue.ownerDocument||ue)===(ye.ownerDocument||ye)?ue.compareDocumentPosition(ye):1,ve&1||!T.sortDetached&&ye.compareDocumentPosition(ue)===ve?ue===ce||ue.ownerDocument===gn&&Ti(gn,ue)?-1:ye===ce||ye.ownerDocument===gn&&Ti(gn,ye)?1:he?ci(he,ue)-ci(he,ye):0:ve&4?-1:1)}:function(ue,ye){if(ue===ye)return Le=!0,0;var ve,Te=0,Fe=ue.parentNode,st=ye.parentNode,qe=[ue],Ye=[ye];if(!Fe||!st)return ue===ce?-1:ye===ce?1:Fe?-1:st?1:he?ci(he,ue)-ci(he,ye):0;if(Fe===st)return Uo(ue,ye);for(ve=ue;ve=ve.parentNode;)qe.unshift(ve);for(ve=ye;ve=ve.parentNode;)Ye.unshift(ve);for(;qe[Te]===Ye[Te];)Te++;return Te?Uo(qe[Te],Ye[Te]):qe[Te]===gn?-1:Ye[Te]===gn?1:0},ce)},xt.matches=function(Y,ne){return xt(Y,null,null,ne)},xt.matchesSelector=function(Y,ne){if((Y.ownerDocument||Y)!==Pe&&me(Y),ne=ne.replace(bs,"='$1']"),T.matchesSelector&&Ve&&(!Yn||!Yn.test(ne))&&(!ut||!ut.test(ne)))try{var re=Yt.call(Y,ne);if(re||T.disconnectedMatch||Y.document&&Y.document.nodeType!==11)return re}catch{}return xt(ne,Pe,null,[Y]).length>0},xt.contains=function(Y,ne){return(Y.ownerDocument||Y)!==Pe&&me(Y),Ti(Y,ne)},xt.attr=function(Y,ne){(Y.ownerDocument||Y)!==Pe&&me(Y);var re=k.attrHandle[ne.toLowerCase()],ce=re&&Pi.call(k.attrHandle,ne.toLowerCase())?re(Y,ne,!Ve):void 0;return ce!==void 0?ce:T.attributes||!Ve?Y.getAttribute(ne):(ce=Y.getAttributeNode(ne))&&ce.specified?ce.value:null},xt.error=function(Y){throw new Error("Syntax error, unrecognized expression: "+Y)},xt.uniqueSort=function(Y){var ne,re=[],ce=0,ue=0;if(Le=!T.detectDuplicates,he=!T.sortStable&&Y.slice(0),Y.sort(Kn),Le){for(;ne=Y[ue++];)ne===Y[ue]&&(ce=re.push(ue));for(;ce--;)Y.splice(re[ce],1)}return he=null,Y},N=xt.getText=function(Y){var ne,re="",ce=0,ue=Y.nodeType;if(ue){if(ue===1||ue===9||ue===11){if(typeof Y.textContent=="string")return Y.textContent;for(Y=Y.firstChild;Y;Y=Y.nextSibling)re+=N(Y)}else if(ue===3||ue===4)return Y.nodeValue}else for(;ne=Y[ce++];)re+=N(ne);return re},k=xt.selectors={cacheLength:50,createPseudo:Sn,match:fr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(Y){return Y[1]=Y[1].replace(vi,sn),Y[3]=(Y[3]||Y[4]||Y[5]||"").replace(vi,sn),Y[2]==="~="&&(Y[3]=" "+Y[3]+" "),Y.slice(0,4)},CHILD:function(Y){return Y[1]=Y[1].toLowerCase(),Y[1].slice(0,3)==="nth"?(Y[3]||xt.error(Y[0]),Y[4]=+(Y[4]?Y[5]+(Y[6]||1):2*(Y[3]==="even"||Y[3]==="odd")),Y[5]=+(Y[7]+Y[8]||Y[3]==="odd")):Y[3]&&xt.error(Y[0]),Y},PSEUDO:function(Y){var ne,re=!Y[6]&&Y[2];return fr.CHILD.test(Y[0])?null:(Y[3]?Y[2]=Y[4]||Y[5]||"":re&&Hs.test(re)&&(ne=V(re,!0))&&(ne=re.indexOf(")",re.length-ne)-re.length)&&(Y[0]=Y[0].slice(0,ne),Y[2]=re.slice(0,ne)),Y.slice(0,3))}},filter:{TAG:function(Y){var ne=Y.replace(vi,sn).toLowerCase();return Y==="*"?function(){return!0}:function(re){return re.nodeName&&re.nodeName.toLowerCase()===ne}},CLASS:function(Y){var ne=Hn[Y+" "];return ne||(ne=new RegExp("(^|"+Ct+")"+Y+"("+Ct+"|$)"))&&Hn(Y,function(re){return ne.test(typeof re.className=="string"&&re.className||typeof re.getAttribute<"u"&&re.getAttribute("class")||"")})},ATTR:function(Y,ne,re){return function(ce){var ue=xt.attr(ce,Y);return ue==null?ne==="!=":ne?(ue+="",ne==="="?ue===re:ne==="!="?ue!==re:ne==="^="?re&&ue.indexOf(re)===0:ne==="*="?re&&ue.indexOf(re)>-1:ne==="$="?re&&ue.slice(-re.length)===re:ne==="~="?(" "+ue.replace(ys," ")+" ").indexOf(re)>-1:ne==="|="?ue===re||ue.slice(0,re.length+1)===re+"-":!1):!0}},CHILD:function(Y,ne,re,ce,ue){var ye=Y.slice(0,3)!=="nth",ve=Y.slice(-4)!=="last",Te=ne==="of-type";return ce===1&&ue===0?function(Fe){return!!Fe.parentNode}:function(Fe,st,qe){var Ye,It,gt,dt,$t,an,_n=ye!==ve?"nextSibling":"previousSibling",zt=Fe.parentNode,Qi=Te&&Fe.nodeName.toLowerCase(),kn=!qe&&!Te;if(zt){if(ye){for(;_n;){for(gt=Fe;gt=gt[_n];)if(Te?gt.nodeName.toLowerCase()===Qi:gt.nodeType===1)return!1;an=_n=Y==="only"&&!an&&"nextSibling"}return!0}if(an=[ve?zt.firstChild:zt.lastChild],ve&&kn){for(It=zt[De]||(zt[De]={}),Ye=It[Y]||[],$t=Ye[0]===ht&&Ye[1],dt=Ye[0]===ht&&Ye[2],gt=$t&&zt.childNodes[$t];gt=++$t&&gt&&gt[_n]||(dt=$t=0)||an.pop();)if(gt.nodeType===1&&++dt&&gt===Fe){It[Y]=[ht,$t,dt];break}}else if(kn&&(Ye=(Fe[De]||(Fe[De]={}))[Y])&&Ye[0]===ht)dt=Ye[1];else for(;(gt=++$t&&gt&&gt[_n]||(dt=$t=0)||an.pop())&&!((Te?gt.nodeName.toLowerCase()===Qi:gt.nodeType===1)&&++dt&&(kn&&((gt[De]||(gt[De]={}))[Y]=[ht,dt]),gt===Fe)););return dt-=ue,dt===ce||dt%ce===0&&dt/ce>=0}}},PSEUDO:function(Y,ne){var re,ce=k.pseudos[Y]||k.setFilters[Y.toLowerCase()]||xt.error("unsupported pseudo: "+Y);return ce[De]?ce(ne):ce.length>1?(re=[Y,Y,"",ne],k.setFilters.hasOwnProperty(Y.toLowerCase())?Sn(function(ue,ye){for(var ve,Te=ce(ue,ne),Fe=Te.length;Fe--;)ve=ci(ue,Te[Fe]),ue[ve]=!(ye[ve]=Te[Fe])}):function(ue){return ce(ue,0,re)}):ce}},pseudos:{not:Sn(function(Y){var ne=[],re=[],ce=ee(Y.replace(Yi,"$1"));return ce[De]?Sn(function(ue,ye,ve,Te){for(var Fe,st=ce(ue,null,Te,[]),qe=ue.length;qe--;)(Fe=st[qe])&&(ue[qe]=!(ye[qe]=Fe))}):function(ue,ye,ve){return ne[0]=ue,ce(ne,null,ve,re),ne[0]=null,!re.pop()}}),has:Sn(function(Y){return function(ne){return xt(Y,ne).length>0}}),contains:Sn(function(Y){return Y=Y.replace(vi,sn),function(ne){return(ne.textContent||ne.innerText||N(ne)).indexOf(Y)>-1}}),lang:Sn(function(Y){return jo.test(Y||"")||xt.error("unsupported lang: "+Y),Y=Y.replace(vi,sn).toLowerCase(),function(ne){var re;do if(re=Ve?ne.lang:ne.getAttribute("xml:lang")||ne.getAttribute("lang"))return re=re.toLowerCase(),re===Y||re.indexOf(Y+"-")===0;while((ne=ne.parentNode)&&ne.nodeType===1);return!1}}),target:function(Y){var ne=g.location&&g.location.hash;return ne&&ne.slice(1)===Y.id},root:function(Y){return Y===Xe},focus:function(Y){return Y===Pe.activeElement&&(!Pe.hasFocus||Pe.hasFocus())&&!!(Y.type||Y.href||~Y.tabIndex)},enabled:function(Y){return Y.disabled===!1},disabled:function(Y){return Y.disabled===!0},checked:function(Y){var ne=Y.nodeName.toLowerCase();return ne==="input"&&!!Y.checked||ne==="option"&&!!Y.selected},selected:function(Y){return Y.parentNode&&Y.parentNode.selectedIndex,Y.selected===!0},empty:function(Y){for(Y=Y.firstChild;Y;Y=Y.nextSibling)if(Y.nodeType<6)return!1;return!0},parent:function(Y){return!k.pseudos.empty(Y)},header:function(Y){return Ws.test(Y.nodeName)},input:function(Y){return Us.test(Y.nodeName)},button:function(Y){var ne=Y.nodeName.toLowerCase();return ne==="input"&&Y.type==="button"||ne==="button"},text:function(Y){var ne;return Y.nodeName.toLowerCase()==="input"&&Y.type==="text"&&((ne=Y.getAttribute("type"))==null||ne.toLowerCase()==="text")},first:Xi(function(){return[0]}),last:Xi(function(Y,ne){return[ne-1]}),eq:Xi(function(Y,ne,re){return[re<0?re+ne:re]}),even:Xi(function(Y,ne){for(var re=0;re<ne;re+=2)Y.push(re);return Y}),odd:Xi(function(Y,ne){for(var re=1;re<ne;re+=2)Y.push(re);return Y}),lt:Xi(function(Y,ne,re){for(var ce=re<0?re+ne:re;--ce>=0;)Y.push(ce);return Y}),gt:Xi(function(Y,ne,re){for(var ce=re<0?re+ne:re;++ce<ne;)Y.push(ce);return Y})}},k.pseudos.nth=k.pseudos.eq;for(C in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})k.pseudos[C]=ji(C);for(C in{submit:!0,reset:!0})k.pseudos[C]=co(C);function Wo(){}Wo.prototype=k.filters=k.pseudos,k.setFilters=new Wo,V=xt.tokenize=function(Y,ne){var re,ce,ue,ye,ve,Te,Fe,st=Un[Y+" "];if(st)return ne?0:st.slice(0);for(ve=Y,Te=[],Fe=k.preFilter;ve;){(!re||(ce=js.exec(ve)))&&(ce&&(ve=ve.slice(ce[0].length)||ve),Te.push(ue=[])),re=!1,(ce=vs.exec(ve))&&(re=ce.shift(),ue.push({value:re,type:ce[0].replace(Yi," ")}),ve=ve.slice(re.length));for(ye in k.filter)(ce=fr[ye].exec(ve))&&(!Fe[ye]||(ce=Fe[ye](ce)))&&(re=ce.shift(),ue.push({value:re,type:ye,matches:ce}),ve=ve.slice(re.length));if(!re)break}return ne?ve.length:ve?xt.error(Y):Un(Y,Te).slice(0)};function Wn(Y){for(var ne=0,re=Y.length,ce="";ne<re;ne++)ce+=Y[ne].value;return ce}function ho(Y,ne,re){var ce=ne.dir,ue=re&&ce==="parentNode",ye=Ut++;return ne.first?function(ve,Te,Fe){for(;ve=ve[ce];)if(ve.nodeType===1||ue)return Y(ve,Te,Fe)}:function(ve,Te,Fe){var st,qe,Ye=[ht,ye];if(Fe){for(;ve=ve[ce];)if((ve.nodeType===1||ue)&&Y(ve,Te,Fe))return!0}else for(;ve=ve[ce];)if(ve.nodeType===1||ue){if(qe=ve[De]||(ve[De]={}),(st=qe[ce])&&st[0]===ht&&st[1]===ye)return Ye[2]=st[2];if(qe[ce]=Ye,Ye[2]=Y(ve,Te,Fe))return!0}}}function Hi(Y){return Y.length>1?function(ne,re,ce){for(var ue=Y.length;ue--;)if(!Y[ue](ne,re,ce))return!1;return!0}:Y[0]}function Vs(Y,ne,re){for(var ce=0,ue=ne.length;ce<ue;ce++)xt(Y,ne[ce],re);return re}function Jn(Y,ne,re,ce,ue){for(var ye,ve=[],Te=0,Fe=Y.length,st=ne!=null;Te<Fe;Te++)(ye=Y[Te])&&(!re||re(ye,ce,ue))&&(ve.push(ye),st&&ne.push(Te));return ve}function gr(Y,ne,re,ce,ue,ye){return ce&&!ce[De]&&(ce=gr(ce)),ue&&!ue[De]&&(ue=gr(ue,ye)),Sn(function(ve,Te,Fe,st){var qe,Ye,It,gt=[],dt=[],$t=Te.length,an=ve||Vs(ne||"*",Fe.nodeType?[Fe]:Fe,[]),_n=Y&&(ve||!ne)?Jn(an,gt,Y,Fe,st):an,zt=re?ue||(ve?Y:$t||ce)?[]:Te:_n;if(re&&re(_n,zt,Fe,st),ce)for(qe=Jn(zt,dt),ce(qe,[],Fe,st),Ye=qe.length;Ye--;)(It=qe[Ye])&&(zt[dt[Ye]]=!(_n[dt[Ye]]=It));if(ve){if(ue||Y){if(ue){for(qe=[],Ye=zt.length;Ye--;)(It=zt[Ye])&&qe.push(_n[Ye]=It);ue(null,zt=[],qe,st)}for(Ye=zt.length;Ye--;)(It=zt[Ye])&&(qe=ue?ci(ve,It):gt[Ye])>-1&&(ve[qe]=!(Te[qe]=It))}}else zt=Jn(zt===Te?zt.splice($t,zt.length):zt),ue?ue(null,Te,zt,st):yi.apply(Te,zt)})}function Hr(Y){for(var ne,re,ce,ue=Y.length,ye=k.relative[Y[0].type],ve=ye||k.relative[" "],Te=ye?1:0,Fe=ho(function(Ye){return Ye===ne},ve,!0),st=ho(function(Ye){return ci(ne,Ye)>-1},ve,!0),qe=[function(Ye,It,gt){var dt=!ye&&(gt||It!==ge)||((ne=It).nodeType?Fe(Ye,It,gt):st(Ye,It,gt));return ne=null,dt}];Te<ue;Te++)if(re=k.relative[Y[Te].type])qe=[ho(Hi(qe),re)];else{if(re=k.filter[Y[Te].type].apply(null,Y[Te].matches),re[De]){for(ce=++Te;ce<ue&&!k.relative[Y[ce].type];ce++);return gr(Te>1&&Hi(qe),Te>1&&Wn(Y.slice(0,Te-1).concat({value:Y[Te-2].type===" "?"*":""})).replace(Yi,"$1"),re,Te<ce&&Hr(Y.slice(Te,ce)),ce<ue&&Hr(Y=Y.slice(ce)),ce<ue&&Wn(Y))}qe.push(re)}return Hi(qe)}function fo(Y,ne){var re=ne.length>0,ce=Y.length>0,ue=function(ye,ve,Te,Fe,st){var qe,Ye,It,gt=0,dt="0",$t=ye&&[],an=[],_n=ge,zt=ye||ce&&k.find.TAG("*",st),Qi=ht+=_n==null?1:Math.random()||.1,kn=zt.length;for(st&&(ge=ve!==Pe&&ve);dt!==kn&&(qe=zt[dt])!=null;dt++){if(ce&&qe){for(Ye=0;It=Y[Ye++];)if(It(qe,ve,Te)){Fe.push(qe);break}st&&(ht=Qi)}re&&((qe=!It&&qe)&&gt--,ye&&$t.push(qe))}if(gt+=dt,re&&dt!==gt){for(Ye=0;It=ne[Ye++];)It($t,an,ve,Te);if(ye){if(gt>0)for(;dt--;)$t[dt]||an[dt]||(an[dt]=Xn.call(Fe));an=Jn(an)}yi.apply(Fe,an),st&&!ye&&an.length>0&&gt+ne.length>1&&xt.uniqueSort(Fe)}return st&&(ht=Qi,ge=_n),$t};return re?Sn(ue):ue}return ee=xt.compile=function(Y,ne){var re,ce=[],ue=[],ye=_i[Y+" "];if(!ye){for(ne||(ne=V(Y)),re=ne.length;re--;)ye=Hr(ne[re]),ye[De]?ce.push(ye):ue.push(ye);ye=_i(Y,fo(ue,ce)),ye.selector=Y}return ye},ae=xt.select=function(Y,ne,re,ce){var ue,ye,ve,Te,Fe,st=typeof Y=="function"&&Y,qe=!ce&&V(Y=st.selector||Y);if(re=re||[],qe.length===1){if(ye=qe[0]=qe[0].slice(0),ye.length>2&&(ve=ye[0]).type==="ID"&&T.getById&&ne.nodeType===9&&Ve&&k.relative[ye[1].type]){if(ne=(k.find.ID(ve.matches[0].replace(vi,sn),ne)||[])[0],ne)st&&(ne=ne.parentNode);else return re;Y=Y.slice(ye.shift().value.length)}for(ue=fr.needsContext.test(Y)?0:ye.length;ue--&&(ve=ye[ue],!k.relative[Te=ve.type]);)if((Fe=k.find[Te])&&(ce=Fe(ve.matches[0].replace(vi,sn),On.test(ye[0].type)&&jr(ne.parentNode)||ne))){if(ye.splice(ue,1),Y=ce.length&&Wn(ye),!Y)return yi.apply(re,ce),re;break}}return(st||ee(Y,qe))(ce,ne,!Ve,re,On.test(Y)&&jr(ne.parentNode)||ne),re},T.sortStable=De.split("").sort(Kn).join("")===De,T.detectDuplicates=!!Le,me(),T.sortDetached=fi(function(Y){return Y.compareDocumentPosition(Pe.createElement("div"))&1}),fi(function(Y){return Y.innerHTML="<a href='#'></a>",Y.firstChild.getAttribute("href")==="#"})||pr("type|href|height|width",function(Y,ne,re){if(!re)return Y.getAttribute(ne,ne.toLowerCase()==="type"?1:2)}),(!T.attributes||!fi(function(Y){return Y.innerHTML="<input/>",Y.firstChild.setAttribute("value",""),Y.firstChild.getAttribute("value")===""}))&&pr("value",function(Y,ne,re){if(!re&&Y.nodeName.toLowerCase()==="input")return Y.defaultValue}),fi(function(Y){return Y.getAttribute("disabled")==null})||pr(hi,function(Y,ne,re){var ce;if(!re)return Y[ne]===!0?ne.toLowerCase():(ce=Y.getAttributeNode(ne))&&ce.specified?ce.value:null}),xt}(c);v.find=le,v.expr=le.selectors,v.expr[":"]=v.expr.pseudos,v.unique=le.uniqueSort,v.text=le.getText,v.isXMLDoc=le.isXML,v.contains=le.contains;var X=v.expr.match.needsContext,oe=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,_e=/^.[^:#\[\.,]*$/;function Re(g,C,T){if(v.isFunction(C))return v.grep(g,function(k,N){return!!C.call(k,N,k)!==T});if(C.nodeType)return v.grep(g,function(k){return k===C!==T});if(typeof C=="string"){if(_e.test(C))return v.filter(C,g,T);C=v.filter(C,g)}return v.grep(g,function(k){return _.call(C,k)>=0!==T})}v.filter=function(g,C,T){var k=C[0];return T&&(g=":not("+g+")"),C.length===1&&k.nodeType===1?v.find.matchesSelector(k,g)?[k]:[]:v.find.matches(g,v.grep(C,function(N){return N.nodeType===1}))},v.fn.extend({find:function(g){var C,T=this.length,k=[],N=this;if(typeof g!="string")return this.pushStack(v(g).filter(function(){for(C=0;C<T;C++)if(v.contains(N[C],this))return!0}));for(C=0;C<T;C++)v.find(g,N[C],k);return k=this.pushStack(T>1?v.unique(k):k),k.selector=this.selector?this.selector+" "+g:g,k},filter:function(g){return this.pushStack(Re(this,g||[],!1))},not:function(g){return this.pushStack(Re(this,g||[],!0))},is:function(g){return!!Re(this,typeof g=="string"&&X.test(g)?v(g):g||[],!1).length}});var Se,we=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,Ue=v.fn.init=function(g,C){var T,k;if(!g)return this;if(typeof g=="string")if(g[0]==="<"&&g[g.length-1]===">"&&g.length>=3?T=[null,g,null]:T=we.exec(g),T&&(T[1]||!C))if(T[1]){if(C=C instanceof v?C[0]:C,v.merge(this,v.parseHTML(T[1],C&&C.nodeType?C.ownerDocument||C:E,!0)),oe.test(T[1])&&v.isPlainObject(C))for(T in C)v.isFunction(this[T])?this[T](C[T]):this.attr(T,C[T]);return this}else return k=E.getElementById(T[2]),k&&k.parentNode&&(this.length=1,this[0]=k),this.context=E,this.selector=g,this;else return!C||C.jquery?(C||Se).find(g):this.constructor(C).find(g);else{if(g.nodeType)return this.context=this[0]=g,this.length=1,this;if(v.isFunction(g))return typeof Se.ready<"u"?Se.ready(g):g(v)}return g.selector!==void 0&&(this.selector=g.selector,this.context=g.context),v.makeArray(g,this)};Ue.prototype=v.fn,Se=v(E);var Oe=/^(?:parents|prev(?:Until|All))/,Ft={children:!0,contents:!0,next:!0,prev:!0};v.extend({dir:function(g,C,T){for(var k=[],N=T!==void 0;(g=g[C])&&g.nodeType!==9;)if(g.nodeType===1){if(N&&v(g).is(T))break;k.push(g)}return k},sibling:function(g,C){for(var T=[];g;g=g.nextSibling)g.nodeType===1&&g!==C&&T.push(g);return T}}),v.fn.extend({has:function(g){var C=v(g,this),T=C.length;return this.filter(function(){for(var k=0;k<T;k++)if(v.contains(this,C[k]))return!0})},closest:function(g,C){for(var T,k=0,N=this.length,U=[],V=X.test(g)||typeof g!="string"?v(g,C||this.context):0;k<N;k++)for(T=this[k];T&&T!==C;T=T.parentNode)if(T.nodeType<11&&(V?V.index(T)>-1:T.nodeType===1&&v.find.matchesSelector(T,g))){U.push(T);break}return this.pushStack(U.length>1?v.unique(U):U)},index:function(g){return g?typeof g=="string"?_.call(v(g),this[0]):_.call(this,g.jquery?g[0]:g):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(g,C){return this.pushStack(v.unique(v.merge(this.get(),v(g,C))))},addBack:function(g){return this.add(g==null?this.prevObject:this.prevObject.filter(g))}});function Ne(g,C){for(;(g=g[C])&&g.nodeType!==1;);return g}v.each({parent:function(g){var C=g.parentNode;return C&&C.nodeType!==11?C:null},parents:function(g){return v.dir(g,"parentNode")},parentsUntil:function(g,C,T){return v.dir(g,"parentNode",T)},next:function(g){return Ne(g,"nextSibling")},prev:function(g){return Ne(g,"previousSibling")},nextAll:function(g){return v.dir(g,"nextSibling")},prevAll:function(g){return v.dir(g,"previousSibling")},nextUntil:function(g,C,T){return v.dir(g,"nextSibling",T)},prevUntil:function(g,C,T){return v.dir(g,"previousSibling",T)},siblings:function(g){return v.sibling((g.parentNode||{}).firstChild,g)},children:function(g){return v.sibling(g.firstChild)},contents:function(g){return g.contentDocument||v.merge([],g.childNodes)}},function(g,C){v.fn[g]=function(T,k){var N=v.map(this,C,T);return g.slice(-5)!=="Until"&&(k=T),k&&typeof k=="string"&&(N=v.filter(k,N)),this.length>1&&(Ft[g]||v.unique(N),Oe.test(g)&&N.reverse()),this.pushStack(N)}});var it=/\S+/g,Me={};function Et(g){var C=Me[g]={};return v.each(g.match(it)||[],function(T,k){C[k]=!0}),C}v.Callbacks=function(g){g=typeof g=="string"?Me[g]||Et(g):v.extend({},g);var C,T,k,N,U,V,ee=[],ae=!g.once&&[],ge=function(Le){for(C=g.memory&&Le,T=!0,V=N||0,N=0,U=ee.length,k=!0;ee&&V<U;V++)if(ee[V].apply(Le[0],Le[1])===!1&&g.stopOnFalse){C=!1;break}k=!1,ee&&(ae?ae.length&&ge(ae.shift()):C?ee=[]:he.disable())},he={add:function(){if(ee){var Le=ee.length;(function me(Pe){v.each(Pe,function(Xe,Ve){var ut=v.type(Ve);ut==="function"?(!g.unique||!he.has(Ve))&&ee.push(Ve):Ve&&Ve.length&&ut!=="string"&&me(Ve)})})(arguments),k?U=ee.length:C&&(N=Le,ge(C))}return this},remove:function(){return ee&&v.each(arguments,function(Le,me){for(var Pe;(Pe=v.inArray(me,ee,Pe))>-1;)ee.splice(Pe,1),k&&(Pe<=U&&U--,Pe<=V&&V--)}),this},has:function(Le){return Le?v.inArray(Le,ee)>-1:!!(ee&&ee.length)},empty:function(){return ee=[],U=0,this},disable:function(){return ee=ae=C=void 0,this},disabled:function(){return!ee},lock:function(){return ae=void 0,C||he.disable(),this},locked:function(){return!ae},fireWith:function(Le,me){return ee&&(!T||ae)&&(me=me||[],me=[Le,me.slice?me.slice():me],k?ae.push(me):ge(me)),this},fire:function(){return he.fireWith(this,arguments),this},fired:function(){return!!T}};return he},v.extend({Deferred:function(g){var C=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],T="pending",k={state:function(){return T},always:function(){return N.done(arguments).fail(arguments),this},then:function(){var U=arguments;return v.Deferred(function(V){v.each(C,function(ee,ae){var ge=v.isFunction(U[ee])&&U[ee];N[ae[1]](function(){var he=ge&&ge.apply(this,arguments);he&&v.isFunction(he.promise)?he.promise().done(V.resolve).fail(V.reject).progress(V.notify):V[ae[0]+"With"](this===k?V.promise():this,ge?[he]:arguments)})}),U=null}).promise()},promise:function(U){return U!=null?v.extend(U,k):k}},N={};return k.pipe=k.then,v.each(C,function(U,V){var ee=V[2],ae=V[3];k[V[1]]=ee.add,ae&&ee.add(function(){T=ae},C[U^1][2].disable,C[2][2].lock),N[V[0]]=function(){return N[V[0]+"With"](this===N?k:this,arguments),this},N[V[0]+"With"]=ee.fireWith}),k.promise(N),g&&g.call(N,N),N},when:function(g){var C=0,T=f.call(arguments),k=T.length,N=k!==1||g&&v.isFunction(g.promise)?k:0,U=N===1?g:v.Deferred(),V=function(he,Le,me){return function(Pe){Le[he]=this,me[he]=arguments.length>1?f.call(arguments):Pe,me===ee?U.notifyWith(Le,me):--N||U.resolveWith(Le,me)}},ee,ae,ge;if(k>1)for(ee=new Array(k),ae=new Array(k),ge=new Array(k);C<k;C++)T[C]&&v.isFunction(T[C].promise)?T[C].promise().done(V(C,ge,T)).fail(U.reject).progress(V(C,ae,ee)):--N;return N||U.resolveWith(ge,T),U.promise()}});var mt;v.fn.ready=function(g){return v.ready.promise().done(g),this},v.extend({isReady:!1,readyWait:1,holdReady:function(g){g?v.readyWait++:v.ready(!0)},ready:function(g){(g===!0?--v.readyWait:v.isReady)||(v.isReady=!0,!(g!==!0&&--v.readyWait>0)&&(mt.resolveWith(E,[v]),v.fn.triggerHandler&&(v(E).triggerHandler("ready"),v(E).off("ready"))))}});function et(){E.removeEventListener("DOMContentLoaded",et,!1),c.removeEventListener("load",et,!1),v.ready()}v.ready.promise=function(g){return mt||(mt=v.Deferred(),E.readyState==="complete"?setTimeout(v.ready):(E.addEventListener("DOMContentLoaded",et,!1),c.addEventListener("load",et,!1))),mt.promise(g)},v.ready.promise();var Ke=v.access=function(g,C,T,k,N,U,V){var ee=0,ae=g.length,ge=T==null;if(v.type(T)==="object"){N=!0;for(ee in T)v.access(g,C,ee,T[ee],!0,U,V)}else if(k!==void 0&&(N=!0,v.isFunction(k)||(V=!0),ge&&(V?(C.call(g,k),C=null):(ge=C,C=function(he,Le,me){return ge.call(v(he),me)})),C))for(;ee<ae;ee++)C(g[ee],T,V?k:k.call(g[ee],ee,C(g[ee],T)));return N?g:ge?C.call(g):ae?C(g[0],T):U};v.acceptData=function(g){return g.nodeType===1||g.nodeType===9||!+g.nodeType};function Mt(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=v.expando+Mt.uid++}Mt.uid=1,Mt.accepts=v.acceptData,Mt.prototype={key:function(g){if(!Mt.accepts(g))return 0;var C={},T=g[this.expando];if(!T){T=Mt.uid++;try{C[this.expando]={value:T},Object.defineProperties(g,C)}catch{C[this.expando]=T,v.extend(g,C)}}return this.cache[T]||(this.cache[T]={}),T},set:function(g,C,T){var k,N=this.key(g),U=this.cache[N];if(typeof C=="string")U[C]=T;else if(v.isEmptyObject(U))v.extend(this.cache[N],C);else for(k in C)U[k]=C[k];return U},get:function(g,C){var T=this.cache[this.key(g)];return C===void 0?T:T[C]},access:function(g,C,T){var k;return C===void 0||C&&typeof C=="string"&&T===void 0?(k=this.get(g,C),k!==void 0?k:this.get(g,v.camelCase(C))):(this.set(g,C,T),T!==void 0?T:C)},remove:function(g,C){var T,k,N,U=this.key(g),V=this.cache[U];if(C===void 0)this.cache[U]={};else for(v.isArray(C)?k=C.concat(C.map(v.camelCase)):(N=v.camelCase(C),C in V?k=[C,N]:(k=N,k=k in V?[k]:k.match(it)||[])),T=k.length;T--;)delete V[k[T]]},hasData:function(g){return!v.isEmptyObject(this.cache[g[this.expando]]||{})},discard:function(g){g[this.expando]&&delete this.cache[g[this.expando]]}};var Be=new Mt,Bt=new Mt,Fn=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,gi=/([A-Z])/g;function fn(g,C,T){var k;if(T===void 0&&g.nodeType===1)if(k="data-"+C.replace(gi,"-$1").toLowerCase(),T=g.getAttribute(k),typeof T=="string"){try{T=T==="true"?!0:T==="false"?!1:T==="null"?null:+T+""===T?+T:Fn.test(T)?v.parseJSON(T):T}catch{}Bt.set(g,C,T)}else T=void 0;return T}v.extend({hasData:function(g){return Bt.hasData(g)||Be.hasData(g)},data:function(g,C,T){return Bt.access(g,C,T)},removeData:function(g,C){Bt.remove(g,C)},_data:function(g,C,T){return Be.access(g,C,T)},_removeData:function(g,C){Be.remove(g,C)}}),v.fn.extend({data:function(g,C){var T,k,N,U=this[0],V=U&&U.attributes;if(g===void 0){if(this.length&&(N=Bt.get(U),U.nodeType===1&&!Be.get(U,"hasDataAttrs"))){for(T=V.length;T--;)V[T]&&(k=V[T].name,k.indexOf("data-")===0&&(k=v.camelCase(k.slice(5)),fn(U,k,N[k])));Be.set(U,"hasDataAttrs",!0)}return N}return typeof g=="object"?this.each(function(){Bt.set(this,g)}):Ke(this,function(ee){var ae,ge=v.camelCase(g);if(U&&ee===void 0)return ae=Bt.get(U,g),ae!==void 0||(ae=Bt.get(U,ge),ae!==void 0)||(ae=fn(U,ge,void 0),ae!==void 0)?ae:void 0;this.each(function(){var he=Bt.get(this,ge);Bt.set(this,ge,ee),g.indexOf("-")!==-1&&he!==void 0&&Bt.set(this,g,ee)})},null,C,arguments.length>1,null,!0)},removeData:function(g){return this.each(function(){Bt.remove(this,g)})}}),v.extend({queue:function(g,C,T){var k;if(g)return C=(C||"fx")+"queue",k=Be.get(g,C),T&&(!k||v.isArray(T)?k=Be.access(g,C,v.makeArray(T)):k.push(T)),k||[]},dequeue:function(g,C){C=C||"fx";var T=v.queue(g,C),k=T.length,N=T.shift(),U=v._queueHooks(g,C),V=function(){v.dequeue(g,C)};N==="inprogress"&&(N=T.shift(),k--),N&&(C==="fx"&&T.unshift("inprogress"),delete U.stop,N.call(g,V,U)),!k&&U&&U.empty.fire()},_queueHooks:function(g,C){var T=C+"queueHooks";return Be.get(g,T)||Be.access(g,T,{empty:v.Callbacks("once memory").add(function(){Be.remove(g,[C+"queue",T])})})}}),v.fn.extend({queue:function(g,C){var T=2;return typeof g!="string"&&(C=g,g="fx",T--),arguments.length<T?v.queue(this[0],g):C===void 0?this:this.each(function(){var k=v.queue(this,g,C);v._queueHooks(this,g),g==="fx"&&k[0]!=="inprogress"&&v.dequeue(this,g)})},dequeue:function(g){return this.each(function(){v.dequeue(this,g)})},clearQueue:function(g){return this.queue(g||"fx",[])},promise:function(g,C){var T,k=1,N=v.Deferred(),U=this,V=this.length,ee=function(){--k||N.resolveWith(U,[U])};for(typeof g!="string"&&(C=g,g=void 0),g=g||"fx";V--;)T=Be.get(U[V],g+"queueHooks"),T&&T.empty&&(k++,T.empty.add(ee));return ee(),N.promise(C)}});var B=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=["Top","Right","Bottom","Left"],R=function(g,C){return g=C||g,v.css(g,"display")==="none"||!v.contains(g.ownerDocument,g)},D=/^(?:checkbox|radio)$/i;(function(){var g=E.createDocumentFragment(),C=g.appendChild(E.createElement("div")),T=E.createElement("input");T.setAttribute("type","radio"),T.setAttribute("checked","checked"),T.setAttribute("name","t"),C.appendChild(T),S.checkClone=C.cloneNode(!0).cloneNode(!0).lastChild.checked,C.innerHTML="<textarea>x</textarea>",S.noCloneChecked=!!C.cloneNode(!0).lastChild.defaultValue})();var z="undefined";S.focusinBubbles="onfocusin"in c;var j=/^key/,K=/^(?:mouse|pointer|contextmenu)|click/,pe=/^(?:focusinfocus|focusoutblur)$/,be=/^([^.]*)(?:\.(.+)|)$/;function Ee(){return!0}function We(){return!1}function ot(){try{return E.activeElement}catch{}}v.event={global:{},add:function(g,C,T,k,N){var U,V,ee,ae,ge,he,Le,me,Pe,Xe,Ve,ut=Be.get(g);if(ut)for(T.handler&&(U=T,T=U.handler,N=U.selector),T.guid||(T.guid=v.guid++),(ae=ut.events)||(ae=ut.events={}),(V=ut.handle)||(V=ut.handle=function(Yn){return typeof v!==z&&v.event.triggered!==Yn.type?v.event.dispatch.apply(g,arguments):void 0}),C=(C||"").match(it)||[""],ge=C.length;ge--;)ee=be.exec(C[ge])||[],Pe=Ve=ee[1],Xe=(ee[2]||"").split(".").sort(),Pe&&(Le=v.event.special[Pe]||{},Pe=(N?Le.delegateType:Le.bindType)||Pe,Le=v.event.special[Pe]||{},he=v.extend({type:Pe,origType:Ve,data:k,handler:T,guid:T.guid,selector:N,needsContext:N&&v.expr.match.needsContext.test(N),namespace:Xe.join(".")},U),(me=ae[Pe])||(me=ae[Pe]=[],me.delegateCount=0,(!Le.setup||Le.setup.call(g,k,Xe,V)===!1)&&g.addEventListener&&g.addEventListener(Pe,V,!1)),Le.add&&(Le.add.call(g,he),he.handler.guid||(he.handler.guid=T.guid)),N?me.splice(me.delegateCount++,0,he):me.push(he),v.event.global[Pe]=!0)},remove:function(g,C,T,k,N){var U,V,ee,ae,ge,he,Le,me,Pe,Xe,Ve,ut=Be.hasData(g)&&Be.get(g);if(!(!ut||!(ae=ut.events))){for(C=(C||"").match(it)||[""],ge=C.length;ge--;){if(ee=be.exec(C[ge])||[],Pe=Ve=ee[1],Xe=(ee[2]||"").split(".").sort(),!Pe){for(Pe in ae)v.event.remove(g,Pe+C[ge],T,k,!0);continue}for(Le=v.event.special[Pe]||{},Pe=(k?Le.delegateType:Le.bindType)||Pe,me=ae[Pe]||[],ee=ee[2]&&new RegExp("(^|\\.)"+Xe.join("\\.(?:.*\\.|)")+"(\\.|$)"),V=U=me.length;U--;)he=me[U],(N||Ve===he.origType)&&(!T||T.guid===he.guid)&&(!ee||ee.test(he.namespace))&&(!k||k===he.selector||k==="**"&&he.selector)&&(me.splice(U,1),he.selector&&me.delegateCount--,Le.remove&&Le.remove.call(g,he));V&&!me.length&&((!Le.teardown||Le.teardown.call(g,Xe,ut.handle)===!1)&&v.removeEvent(g,Pe,ut.handle),delete ae[Pe])}v.isEmptyObject(ae)&&(delete ut.handle,Be.remove(g,"events"))}},trigger:function(g,C,T,k){var N,U,V,ee,ae,ge,he,Le=[T||E],me=A.call(g,"type")?g.type:g,Pe=A.call(g,"namespace")?g.namespace.split("."):[];if(U=V=T=T||E,!(T.nodeType===3||T.nodeType===8)&&!pe.test(me+v.event.triggered)&&(me.indexOf(".")>=0&&(Pe=me.split("."),me=Pe.shift(),Pe.sort()),ae=me.indexOf(":")<0&&"on"+me,g=g[v.expando]?g:new v.Event(me,typeof g=="object"&&g),g.isTrigger=k?2:3,g.namespace=Pe.join("."),g.namespace_re=g.namespace?new RegExp("(^|\\.)"+Pe.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,g.result=void 0,g.target||(g.target=T),C=C==null?[g]:v.makeArray(C,[g]),he=v.event.special[me]||{},!(!k&&he.trigger&&he.trigger.apply(T,C)===!1))){if(!k&&!he.noBubble&&!v.isWindow(T)){for(ee=he.delegateType||me,pe.test(ee+me)||(U=U.parentNode);U;U=U.parentNode)Le.push(U),V=U;V===(T.ownerDocument||E)&&Le.push(V.defaultView||V.parentWindow||c)}for(N=0;(U=Le[N++])&&!g.isPropagationStopped();)g.type=N>1?ee:he.bindType||me,ge=(Be.get(U,"events")||{})[g.type]&&Be.get(U,"handle"),ge&&ge.apply(U,C),ge=ae&&U[ae],ge&&ge.apply&&v.acceptData(U)&&(g.result=ge.apply(U,C),g.result===!1&&g.preventDefault());return g.type=me,!k&&!g.isDefaultPrevented()&&(!he._default||he._default.apply(Le.pop(),C)===!1)&&v.acceptData(T)&&ae&&v.isFunction(T[me])&&!v.isWindow(T)&&(V=T[ae],V&&(T[ae]=null),v.event.triggered=me,T[me](),v.event.triggered=void 0,V&&(T[ae]=V)),g.result}},dispatch:function(g){g=v.event.fix(g);var C,T,k,N,U,V=[],ee=f.call(arguments),ae=(Be.get(this,"events")||{})[g.type]||[],ge=v.event.special[g.type]||{};if(ee[0]=g,g.delegateTarget=this,!(ge.preDispatch&&ge.preDispatch.call(this,g)===!1)){for(V=v.event.handlers.call(this,g,ae),C=0;(N=V[C++])&&!g.isPropagationStopped();)for(g.currentTarget=N.elem,T=0;(U=N.handlers[T++])&&!g.isImmediatePropagationStopped();)(!g.namespace_re||g.namespace_re.test(U.namespace))&&(g.handleObj=U,g.data=U.data,k=((v.event.special[U.origType]||{}).handle||U.handler).apply(N.elem,ee),k!==void 0&&(g.result=k)===!1&&(g.preventDefault(),g.stopPropagation()));return ge.postDispatch&&ge.postDispatch.call(this,g),g.result}},handlers:function(g,C){var T,k,N,U,V=[],ee=C.delegateCount,ae=g.target;if(ee&&ae.nodeType&&(!g.button||g.type!=="click")){for(;ae!==this;ae=ae.parentNode||this)if(ae.disabled!==!0||g.type!=="click"){for(k=[],T=0;T<ee;T++)U=C[T],N=U.selector+" ",k[N]===void 0&&(k[N]=U.needsContext?v(N,this).index(ae)>=0:v.find(N,this,null,[ae]).length),k[N]&&k.push(U);k.length&&V.push({elem:ae,handlers:k})}}return ee<C.length&&V.push({elem:this,handlers:C.slice(ee)}),V},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(g,C){return g.which==null&&(g.which=C.charCode!=null?C.charCode:C.keyCode),g}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(g,C){var T,k,N,U=C.button;return g.pageX==null&&C.clientX!=null&&(T=g.target.ownerDocument||E,k=T.documentElement,N=T.body,g.pageX=C.clientX+(k&&k.scrollLeft||N&&N.scrollLeft||0)-(k&&k.clientLeft||N&&N.clientLeft||0),g.pageY=C.clientY+(k&&k.scrollTop||N&&N.scrollTop||0)-(k&&k.clientTop||N&&N.clientTop||0)),!g.which&&U!==void 0&&(g.which=U&1?1:U&2?3:U&4?2:0),g}},fix:function(g){if(g[v.expando])return g;var C,T,k,N=g.type,U=g,V=this.fixHooks[N];for(V||(this.fixHooks[N]=V=K.test(N)?this.mouseHooks:j.test(N)?this.keyHooks:{}),k=V.props?this.props.concat(V.props):this.props,g=new v.Event(U),C=k.length;C--;)T=k[C],g[T]=U[T];return g.target||(g.target=E),g.target.nodeType===3&&(g.target=g.target.parentNode),V.filter?V.filter(g,U):g},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ot()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===ot()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&v.nodeName(this,"input"))return this.click(),!1},_default:function(g){return v.nodeName(g.target,"a")}},beforeunload:{postDispatch:function(g){g.result!==void 0&&g.originalEvent&&(g.originalEvent.returnValue=g.result)}}},simulate:function(g,C,T,k){var N=v.extend(new v.Event,T,{type:g,isSimulated:!0,originalEvent:{}});k?v.event.trigger(N,null,C):v.event.dispatch.call(C,N),N.isDefaultPrevented()&&T.preventDefault()}},v.removeEvent=function(g,C,T){g.removeEventListener&&g.removeEventListener(C,T,!1)},v.Event=function(g,C){if(!(this instanceof v.Event))return new v.Event(g,C);g&&g.type?(this.originalEvent=g,this.type=g.type,this.isDefaultPrevented=g.defaultPrevented||g.defaultPrevented===void 0&&g.returnValue===!1?Ee:We):this.type=g,C&&v.extend(this,C),this.timeStamp=g&&g.timeStamp||v.now(),this[v.expando]=!0},v.Event.prototype={isDefaultPrevented:We,isPropagationStopped:We,isImmediatePropagationStopped:We,preventDefault:function(){var g=this.originalEvent;this.isDefaultPrevented=Ee,g&&g.preventDefault&&g.preventDefault()},stopPropagation:function(){var g=this.originalEvent;this.isPropagationStopped=Ee,g&&g.stopPropagation&&g.stopPropagation()},stopImmediatePropagation:function(){var g=this.originalEvent;this.isImmediatePropagationStopped=Ee,g&&g.stopImmediatePropagation&&g.stopImmediatePropagation(),this.stopPropagation()}},v.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(g,C){v.event.special[g]={delegateType:C,bindType:C,handle:function(T){var k,N=this,U=T.relatedTarget,V=T.handleObj;return(!U||U!==N&&!v.contains(N,U))&&(T.type=V.origType,k=V.handler.apply(this,arguments),T.type=C),k}}}),S.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(g,C){var T=function(k){v.event.simulate(C,k.target,v.event.fix(k),!0)};v.event.special[C]={setup:function(){var k=this.ownerDocument||this,N=Be.access(k,C);N||k.addEventListener(g,T,!0),Be.access(k,C,(N||0)+1)},teardown:function(){var k=this.ownerDocument||this,N=Be.access(k,C)-1;N?Be.access(k,C,N):(k.removeEventListener(g,T,!0),Be.remove(k,C))}}}),v.fn.extend({on:function(g,C,T,k,N){var U,V;if(typeof g=="object"){typeof C!="string"&&(T=T||C,C=void 0);for(V in g)this.on(V,C,T,g[V],N);return this}if(T==null&&k==null?(k=C,T=C=void 0):k==null&&(typeof C=="string"?(k=T,T=void 0):(k=T,T=C,C=void 0)),k===!1)k=We;else if(!k)return this;return N===1&&(U=k,k=function(ee){return v().off(ee),U.apply(this,arguments)},k.guid=U.guid||(U.guid=v.guid++)),this.each(function(){v.event.add(this,g,k,T,C)})},one:function(g,C,T,k){return this.on(g,C,T,k,1)},off:function(g,C,T){var k,N;if(g&&g.preventDefault&&g.handleObj)return k=g.handleObj,v(g.delegateTarget).off(k.namespace?k.origType+"."+k.namespace:k.origType,k.selector,k.handler),this;if(typeof g=="object"){for(N in g)this.off(N,C,g[N]);return this}return(C===!1||typeof C=="function")&&(T=C,C=void 0),T===!1&&(T=We),this.each(function(){v.event.remove(this,g,T,C)})},trigger:function(g,C){return this.each(function(){v.event.trigger(g,C,this)})},triggerHandler:function(g,C){var T=this[0];if(T)return v.event.trigger(g,C,T,!0)}});var Ge=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,at=/<([\w:]+)/,wn=/<|&#?\w+;/,lt=/<(?:script|style|link)/i,dn=/checked\s*(?:[^=]|=\s*.checked.)/i,tn=/^$|\/(?:java|ecma)script/i,Vi=/^true\/(.*)/,nn=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,rn={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};rn.optgroup=rn.option,rn.tbody=rn.tfoot=rn.colgroup=rn.caption=rn.thead,rn.th=rn.td;function Mi(g,C){return v.nodeName(g,"table")&&v.nodeName(C.nodeType!==11?C:C.firstChild,"tr")?g.getElementsByTagName("tbody")[0]||g.appendChild(g.ownerDocument.createElement("tbody")):g}function or(g){return g.type=(g.getAttribute("type")!==null)+"/"+g.type,g}function Ds(g){var C=Vi.exec(g.type);return C?g.type=C[1]:g.removeAttribute("type"),g}function ui(g,C){for(var T=0,k=g.length;T<k;T++)Be.set(g[T],"globalEval",!C||Be.get(C[T],"globalEval"))}function fs(g,C){var T,k,N,U,V,ee,ae,ge;if(C.nodeType===1){if(Be.hasData(g)&&(U=Be.access(g),V=Be.set(C,U),ge=U.events,ge)){delete V.handle,V.events={};for(N in ge)for(T=0,k=ge[N].length;T<k;T++)v.event.add(C,N,ge[N][T])}Bt.hasData(g)&&(ee=Bt.access(g),ae=v.extend({},ee),Bt.set(C,ae))}}function Tn(g,C){var T=g.getElementsByTagName?g.getElementsByTagName(C||"*"):g.querySelectorAll?g.querySelectorAll(C||"*"):[];return C===void 0||C&&v.nodeName(g,C)?v.merge([g],T):T}function Mo(g,C){var T=C.nodeName.toLowerCase();T==="input"&&D.test(g.type)?C.checked=g.checked:(T==="input"||T==="textarea")&&(C.defaultValue=g.defaultValue)}v.extend({clone:function(g,C,T){var k,N,U,V,ee=g.cloneNode(!0),ae=v.contains(g.ownerDocument,g);if(!S.noCloneChecked&&(g.nodeType===1||g.nodeType===11)&&!v.isXMLDoc(g))for(V=Tn(ee),U=Tn(g),k=0,N=U.length;k<N;k++)Mo(U[k],V[k]);if(C)if(T)for(U=U||Tn(g),V=V||Tn(ee),k=0,N=U.length;k<N;k++)fs(U[k],V[k]);else fs(g,ee);return V=Tn(ee,"script"),V.length>0&&ui(V,!ae&&Tn(g,"script")),ee},buildFragment:function(g,C,T,k){for(var N,U,V,ee,ae,ge,he=C.createDocumentFragment(),Le=[],me=0,Pe=g.length;me<Pe;me++)if(N=g[me],N||N===0)if(v.type(N)==="object")v.merge(Le,N.nodeType?[N]:N);else if(!wn.test(N))Le.push(C.createTextNode(N));else{for(U=U||he.appendChild(C.createElement("div")),V=(at.exec(N)||["",""])[1].toLowerCase(),ee=rn[V]||rn._default,U.innerHTML=ee[1]+N.replace(Ge,"<$1></$2>")+ee[2],ge=ee[0];ge--;)U=U.lastChild;v.merge(Le,U.childNodes),U=he.firstChild,U.textContent=""}for(he.textContent="",me=0;N=Le[me++];)if(!(k&&v.inArray(N,k)!==-1)&&(ae=v.contains(N.ownerDocument,N),U=Tn(he.appendChild(N),"script"),ae&&ui(U),T))for(ge=0;N=U[ge++];)tn.test(N.type||"")&&T.push(N);return he},cleanData:function(g){for(var C,T,k,N,U=v.event.special,V=0;(T=g[V])!==void 0;V++){if(v.acceptData(T)&&(N=T[Be.expando],N&&(C=Be.cache[N]))){if(C.events)for(k in C.events)U[k]?v.event.remove(T,k):v.removeEvent(T,k,C.handle);Be.cache[N]&&delete Be.cache[N]}delete Bt.cache[T[Bt.expando]]}}}),v.fn.extend({text:function(g){return Ke(this,function(C){return C===void 0?v.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=C)})},null,g,arguments.length)},append:function(){return this.domManip(arguments,function(g){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var C=Mi(this,g);C.appendChild(g)}})},prepend:function(){return this.domManip(arguments,function(g){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var C=Mi(this,g);C.insertBefore(g,C.firstChild)}})},before:function(){return this.domManip(arguments,function(g){this.parentNode&&this.parentNode.insertBefore(g,this)})},after:function(){return this.domManip(arguments,function(g){this.parentNode&&this.parentNode.insertBefore(g,this.nextSibling)})},remove:function(g,C){for(var T,k=g?v.filter(g,this):this,N=0;(T=k[N])!=null;N++)!C&&T.nodeType===1&&v.cleanData(Tn(T)),T.parentNode&&(C&&v.contains(T.ownerDocument,T)&&ui(Tn(T,"script")),T.parentNode.removeChild(T));return this},empty:function(){for(var g,C=0;(g=this[C])!=null;C++)g.nodeType===1&&(v.cleanData(Tn(g,!1)),g.textContent="");return this},clone:function(g,C){return g=g??!1,C=C??g,this.map(function(){return v.clone(this,g,C)})},html:function(g){return Ke(this,function(C){var T=this[0]||{},k=0,N=this.length;if(C===void 0&&T.nodeType===1)return T.innerHTML;if(typeof C=="string"&&!lt.test(C)&&!rn[(at.exec(C)||["",""])[1].toLowerCase()]){C=C.replace(Ge,"<$1></$2>");try{for(;k<N;k++)T=this[k]||{},T.nodeType===1&&(v.cleanData(Tn(T,!1)),T.innerHTML=C);T=0}catch{}}T&&this.empty().append(C)},null,g,arguments.length)},replaceWith:function(){var g=arguments[0];return this.domManip(arguments,function(C){g=this.parentNode,v.cleanData(Tn(this)),g&&g.replaceChild(C,this)}),g&&(g.length||g.nodeType)?this:this.remove()},detach:function(g){return this.remove(g,!0)},domManip:function(g,C){g=p.apply([],g);var T,k,N,U,V,ee,ae=0,ge=this.length,he=this,Le=ge-1,me=g[0],Pe=v.isFunction(me);if(Pe||ge>1&&typeof me=="string"&&!S.checkClone&&dn.test(me))return this.each(function(Xe){var Ve=he.eq(Xe);Pe&&(g[0]=me.call(this,Xe,Ve.html())),Ve.domManip(g,C)});if(ge&&(T=v.buildFragment(g,this[0].ownerDocument,!1,this),k=T.firstChild,T.childNodes.length===1&&(T=k),k)){for(N=v.map(Tn(T,"script"),or),U=N.length;ae<ge;ae++)V=T,ae!==Le&&(V=v.clone(V,!0,!0),U&&v.merge(N,Tn(V,"script"))),C.call(this[ae],V,ae);if(U)for(ee=N[N.length-1].ownerDocument,v.map(N,Ds),ae=0;ae<U;ae++)V=N[ae],tn.test(V.type||"")&&!Be.access(V,"globalEval")&&v.contains(ee,V)&&(V.src?v._evalUrl&&v._evalUrl(V.src):v.globalEval(V.textContent.replace(nn,"")))}return this}}),v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(g,C){v.fn[g]=function(T){for(var k,N=[],U=v(T),V=U.length-1,ee=0;ee<=V;ee++)k=ee===V?this:this.clone(!0),v(U[ee])[C](k),m.apply(N,k.get());return this.pushStack(N)}});var sr,Mr={};function on(g,C){var T,k=v(C.createElement(g)).appendTo(C.body),N=c.getDefaultComputedStyle&&(T=c.getDefaultComputedStyle(k[0]))?T.display:v.css(k[0],"display");return k.detach(),N}function Tr(g){var C=E,T=Mr[g];return T||(T=on(g,C),(T==="none"||!T)&&(sr=(sr||v("<iframe frameborder='0' width='0' height='0'/>")).appendTo(C.documentElement),C=sr[0].contentDocument,C.write(),C.close(),T=on(g,C),sr.detach()),Mr[g]=T),T}var To=/^margin/,Pn=new RegExp("^("+B+")(?!px)[a-z%]+$","i"),Pr=function(g){return g.ownerDocument.defaultView.opener?g.ownerDocument.defaultView.getComputedStyle(g,null):c.getComputedStyle(g,null)};function Zi(g,C,T){var k,N,U,V,ee=g.style;return T=T||Pr(g),T&&(V=T.getPropertyValue(C)||T[C]),T&&(V===""&&!v.contains(g.ownerDocument,g)&&(V=v.style(g,C)),Pn.test(V)&&To.test(C)&&(k=ee.width,N=ee.minWidth,U=ee.maxWidth,ee.minWidth=ee.maxWidth=ee.width=V,V=T.width,ee.width=k,ee.minWidth=N,ee.maxWidth=U)),V!==void 0?V+"":V}function Er(g,C){return{get:function(){if(g()){delete this.get;return}return(this.get=C).apply(this,arguments)}}}(function(){var g,C,T=E.documentElement,k=E.createElement("div"),N=E.createElement("div");if(!N.style)return;N.style.backgroundClip="content-box",N.cloneNode(!0).style.backgroundClip="",S.clearCloneStyle=N.style.backgroundClip==="content-box",k.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",k.appendChild(N);function U(){N.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",N.innerHTML="",T.appendChild(k);var V=c.getComputedStyle(N,null);g=V.top!=="1%",C=V.width==="4px",T.removeChild(k)}c.getComputedStyle&&v.extend(S,{pixelPosition:function(){return U(),g},boxSizingReliable:function(){return C==null&&U(),C},reliableMarginRight:function(){var V,ee=N.appendChild(E.createElement("div"));return ee.style.cssText=N.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",ee.style.marginRight=ee.style.width="0",N.style.width="1px",T.appendChild(k),V=!parseFloat(c.getComputedStyle(ee,null).marginRight),T.removeChild(k),N.removeChild(ee),V}})})(),v.swap=function(g,C,T,k){var N,U,V={};for(U in C)V[U]=g.style[U],g.style[U]=C[U];N=T.apply(g,k||[]);for(U in C)g.style[U]=V[U];return N};var Po=/^(none|table(?!-c[ea]).+)/,mi=new RegExp("^("+B+")(.*)$","i"),Is=new RegExp("^([+-])=("+B+")","i"),ds={position:"absolute",visibility:"hidden",display:"block"},Zn={letterSpacing:"0",fontWeight:"400"},je=["Webkit","O","Moz","ms"];function Di(g,C){if(C in g)return C;for(var T=C[0].toUpperCase()+C.slice(1),k=C,N=je.length;N--;)if(C=je[N]+T,C in g)return C;return k}function Eo(g,C,T){var k=mi.exec(C);return k?Math.max(0,k[1]-(T||0))+(k[2]||"px"):C}function Ao(g,C,T,k,N){for(var U=T===(k?"border":"content")?4:C==="width"?1:0,V=0;U<4;U+=2)T==="margin"&&(V+=v.css(g,T+w[U],!0,N)),k?(T==="content"&&(V-=v.css(g,"padding"+w[U],!0,N)),T!=="margin"&&(V-=v.css(g,"border"+w[U]+"Width",!0,N))):(V+=v.css(g,"padding"+w[U],!0,N),T!=="padding"&&(V+=v.css(g,"border"+w[U]+"Width",!0,N)));return V}function Ar(g,C,T){var k=!0,N=C==="width"?g.offsetWidth:g.offsetHeight,U=Pr(g),V=v.css(g,"boxSizing",!1,U)==="border-box";if(N<=0||N==null){if(N=Zi(g,C,U),(N<0||N==null)&&(N=g.style[C]),Pn.test(N))return N;k=V&&(S.boxSizingReliable()||N===g.style[C]),N=parseFloat(N)||0}return N+Ao(g,C,T||(V?"border":"content"),k,U)+"px"}function to(g,C){for(var T,k,N,U=[],V=0,ee=g.length;V<ee;V++)k=g[V],k.style&&(U[V]=Be.get(k,"olddisplay"),T=k.style.display,C?(!U[V]&&T==="none"&&(k.style.display=""),k.style.display===""&&R(k)&&(U[V]=Be.access(k,"olddisplay",Tr(k.nodeName)))):(N=R(k),(T!=="none"||!N)&&Be.set(k,"olddisplay",N?T:v.css(k,"display"))));for(V=0;V<ee;V++)k=g[V],k.style&&(!C||k.style.display==="none"||k.style.display==="")&&(k.style.display=C?U[V]||"":"none");return g}v.extend({cssHooks:{opacity:{get:function(g,C){if(C){var T=Zi(g,"opacity");return T===""?"1":T}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(g,C,T,k){if(!(!g||g.nodeType===3||g.nodeType===8||!g.style)){var N,U,V,ee=v.camelCase(C),ae=g.style;if(C=v.cssProps[ee]||(v.cssProps[ee]=Di(ae,ee)),V=v.cssHooks[C]||v.cssHooks[ee],T!==void 0){if(U=typeof T,U==="string"&&(N=Is.exec(T))&&(T=(N[1]+1)*N[2]+parseFloat(v.css(g,C)),U="number"),T==null||T!==T)return;U==="number"&&!v.cssNumber[ee]&&(T+="px"),!S.clearCloneStyle&&T===""&&C.indexOf("background")===0&&(ae[C]="inherit"),(!V||!("set"in V)||(T=V.set(g,T,k))!==void 0)&&(ae[C]=T)}else return V&&"get"in V&&(N=V.get(g,!1,k))!==void 0?N:ae[C]}},css:function(g,C,T,k){var N,U,V,ee=v.camelCase(C);return C=v.cssProps[ee]||(v.cssProps[ee]=Di(g.style,ee)),V=v.cssHooks[C]||v.cssHooks[ee],V&&"get"in V&&(N=V.get(g,!0,T)),N===void 0&&(N=Zi(g,C,k)),N==="normal"&&C in Zn&&(N=Zn[C]),T===""||T?(U=parseFloat(N),T===!0||v.isNumeric(U)?U||0:N):N}}),v.each(["height","width"],function(g,C){v.cssHooks[C]={get:function(T,k,N){if(k)return Po.test(v.css(T,"display"))&&T.offsetWidth===0?v.swap(T,ds,function(){return Ar(T,C,N)}):Ar(T,C,N)},set:function(T,k,N){var U=N&&Pr(T);return Eo(T,k,N?Ao(T,C,N,v.css(T,"boxSizing",!1,U)==="border-box",U):0)}}}),v.cssHooks.marginRight=Er(S.reliableMarginRight,function(g,C){if(C)return v.swap(g,{display:"inline-block"},Zi,[g,"marginRight"])}),v.each({margin:"",padding:"",border:"Width"},function(g,C){v.cssHooks[g+C]={expand:function(T){for(var k=0,N={},U=typeof T=="string"?T.split(" "):[T];k<4;k++)N[g+w[k]+C]=U[k]||U[k-2]||U[0];return N}},To.test(g)||(v.cssHooks[g+C].set=Eo)}),v.fn.extend({css:function(g,C){return Ke(this,function(T,k,N){var U,V,ee={},ae=0;if(v.isArray(k)){for(U=Pr(T),V=k.length;ae<V;ae++)ee[k[ae]]=v.css(T,k[ae],!1,U);return ee}return N!==void 0?v.style(T,k,N):v.css(T,k)},g,C,arguments.length>1)},show:function(){return to(this,!0)},hide:function(){return to(this)},toggle:function(g){return typeof g=="boolean"?g?this.show():this.hide():this.each(function(){R(this)?v(this).show():v(this).hide()})}});function pn(g,C,T,k,N){return new pn.prototype.init(g,C,T,k,N)}v.Tween=pn,pn.prototype={constructor:pn,init:function(g,C,T,k,N,U){this.elem=g,this.prop=T,this.easing=N||"swing",this.options=C,this.start=this.now=this.cur(),this.end=k,this.unit=U||(v.cssNumber[T]?"":"px")},cur:function(){var g=pn.propHooks[this.prop];return g&&g.get?g.get(this):pn.propHooks._default.get(this)},run:function(g){var C,T=pn.propHooks[this.prop];return this.options.duration?this.pos=C=v.easing[this.easing](g,this.options.duration*g,0,1,this.options.duration):this.pos=C=g,this.now=(this.end-this.start)*C+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),T&&T.set?T.set(this):pn.propHooks._default.set(this),this}},pn.prototype.init.prototype=pn.prototype,pn.propHooks={_default:{get:function(g){var C;return g.elem[g.prop]!=null&&(!g.elem.style||g.elem.style[g.prop]==null)?g.elem[g.prop]:(C=v.css(g.elem,g.prop,""),!C||C==="auto"?0:C)},set:function(g){v.fx.step[g.prop]?v.fx.step[g.prop](g):g.elem.style&&(g.elem.style[v.cssProps[g.prop]]!=null||v.cssHooks[g.prop])?v.style(g.elem,g.prop,g.now+g.unit):g.elem[g.prop]=g.now}}},pn.propHooks.scrollTop=pn.propHooks.scrollLeft={set:function(g){g.elem.nodeType&&g.elem.parentNode&&(g.elem[g.prop]=g.now)}},v.easing={linear:function(g){return g},swing:function(g){return .5-Math.cos(g*Math.PI)/2}},v.fx=pn.prototype.init,v.fx.step={};var qn,ar,ps=/^(?:toggle|show|hide)$/,Oo=new RegExp("^(?:([+-])=|)("+B+")([a-z%]*)$","i"),gs=/queueHooks$/,no=[Fs],Ii={"*":[function(g,C){var T=this.createTween(g,C),k=T.cur(),N=Oo.exec(C),U=N&&N[3]||(v.cssNumber[g]?"":"px"),V=(v.cssNumber[g]||U!=="px"&&+k)&&Oo.exec(v.css(T.elem,g)),ee=1,ae=20;if(V&&V[3]!==U){U=U||V[3],N=N||[],V=+k||1;do ee=ee||".5",V=V/ee,v.style(T.elem,g,V+U);while(ee!==(ee=T.cur()/k)&&ee!==1&&--ae)}return N&&(V=T.start=+V||+k||0,T.unit=U,T.end=N[1]?V+(N[1]+1)*N[2]:+N[2]),T}]};function Or(){return setTimeout(function(){qn=void 0}),qn=v.now()}function qi(g,C){var T,k=0,N={height:g};for(C=C?1:0;k<4;k+=2-C)T=w[k],N["margin"+T]=N["padding"+T]=g;return C&&(N.opacity=N.width=g),N}function lr(g,C,T){for(var k,N=(Ii[C]||[]).concat(Ii["*"]),U=0,V=N.length;U<V;U++)if(k=N[U].call(T,C,g))return k}function Fs(g,C,T){var k,N,U,V,ee,ae,ge,he,Le=this,me={},Pe=g.style,Xe=g.nodeType&&R(g),Ve=Be.get(g,"fxshow");T.queue||(ee=v._queueHooks(g,"fx"),ee.unqueued==null&&(ee.unqueued=0,ae=ee.empty.fire,ee.empty.fire=function(){ee.unqueued||ae()}),ee.unqueued++,Le.always(function(){Le.always(function(){ee.unqueued--,v.queue(g,"fx").length||ee.empty.fire()})})),g.nodeType===1&&("height"in C||"width"in C)&&(T.overflow=[Pe.overflow,Pe.overflowX,Pe.overflowY],ge=v.css(g,"display"),he=ge==="none"?Be.get(g,"olddisplay")||Tr(g.nodeName):ge,he==="inline"&&v.css(g,"float")==="none"&&(Pe.display="inline-block")),T.overflow&&(Pe.overflow="hidden",Le.always(function(){Pe.overflow=T.overflow[0],Pe.overflowX=T.overflow[1],Pe.overflowY=T.overflow[2]}));for(k in C)if(N=C[k],ps.exec(N)){if(delete C[k],U=U||N==="toggle",N===(Xe?"hide":"show"))if(N==="show"&&Ve&&Ve[k]!==void 0)Xe=!0;else continue;me[k]=Ve&&Ve[k]||v.style(g,k)}else ge=void 0;if(v.isEmptyObject(me))(ge==="none"?Tr(g.nodeName):ge)==="inline"&&(Pe.display=ge);else{Ve?"hidden"in Ve&&(Xe=Ve.hidden):Ve=Be.access(g,"fxshow",{}),U&&(Ve.hidden=!Xe),Xe?v(g).show():Le.done(function(){v(g).hide()}),Le.done(function(){var ut;Be.remove(g,"fxshow");for(ut in me)v.style(g,ut,me[ut])});for(k in me)V=lr(Xe?Ve[k]:0,k,Le),k in Ve||(Ve[k]=V.start,Xe&&(V.end=V.start,V.start=k==="width"||k==="height"?1:0))}}function Ns(g,C){var T,k,N,U,V;for(T in g)if(k=v.camelCase(T),N=C[k],U=g[T],v.isArray(U)&&(N=U[1],U=g[T]=U[0]),T!==k&&(g[k]=U,delete g[T]),V=v.cssHooks[k],V&&"expand"in V){U=V.expand(U),delete g[k];for(T in U)T in g||(g[T]=U[T],C[T]=N)}else C[k]=N}function ko(g,C,T){var k,N,U=0,V=no.length,ee=v.Deferred().always(function(){delete ae.elem}),ae=function(){if(N)return!1;for(var Le=qn||Or(),me=Math.max(0,ge.startTime+ge.duration-Le),Pe=me/ge.duration||0,Xe=1-Pe,Ve=0,ut=ge.tweens.length;Ve<ut;Ve++)ge.tweens[Ve].run(Xe);return ee.notifyWith(g,[ge,Xe,me]),Xe<1&&ut?me:(ee.resolveWith(g,[ge]),!1)},ge=ee.promise({elem:g,props:v.extend({},C),opts:v.extend(!0,{specialEasing:{}},T),originalProperties:C,originalOptions:T,startTime:qn||Or(),duration:T.duration,tweens:[],createTween:function(Le,me){var Pe=v.Tween(g,ge.opts,Le,me,ge.opts.specialEasing[Le]||ge.opts.easing);return ge.tweens.push(Pe),Pe},stop:function(Le){var me=0,Pe=Le?ge.tweens.length:0;if(N)return this;for(N=!0;me<Pe;me++)ge.tweens[me].run(1);return Le?ee.resolveWith(g,[ge,Le]):ee.rejectWith(g,[ge,Le]),this}}),he=ge.props;for(Ns(he,ge.opts.specialEasing);U<V;U++)if(k=no[U].call(ge,g,he,ge.opts),k)return k;return v.map(he,lr,ge),v.isFunction(ge.opts.start)&&ge.opts.start.call(g,ge),v.fx.timer(v.extend(ae,{elem:g,anim:ge,queue:ge.opts.queue})),ge.progress(ge.opts.progress).done(ge.opts.done,ge.opts.complete).fail(ge.opts.fail).always(ge.opts.always)}v.Animation=v.extend(ko,{tweener:function(g,C){v.isFunction(g)?(C=g,g=["*"]):g=g.split(" ");for(var T,k=0,N=g.length;k<N;k++)T=g[k],Ii[T]=Ii[T]||[],Ii[T].unshift(C)},prefilter:function(g,C){C?no.unshift(g):no.push(g)}}),v.speed=function(g,C,T){var k=g&&typeof g=="object"?v.extend({},g):{complete:T||!T&&C||v.isFunction(g)&&g,duration:g,easing:T&&C||C&&!v.isFunction(C)&&C};return k.duration=v.fx.off?0:typeof k.duration=="number"?k.duration:k.duration in v.fx.speeds?v.fx.speeds[k.duration]:v.fx.speeds._default,(k.queue==null||k.queue===!0)&&(k.queue="fx"),k.old=k.complete,k.complete=function(){v.isFunction(k.old)&&k.old.call(this),k.queue&&v.dequeue(this,k.queue)},k},v.fn.extend({fadeTo:function(g,C,T,k){return this.filter(R).css("opacity",0).show().end().animate({opacity:C},g,T,k)},animate:function(g,C,T,k){var N=v.isEmptyObject(g),U=v.speed(C,T,k),V=function(){var ee=ko(this,v.extend({},g),U);(N||Be.get(this,"finish"))&&ee.stop(!0)};return V.finish=V,N||U.queue===!1?this.each(V):this.queue(U.queue,V)},stop:function(g,C,T){var k=function(N){var U=N.stop;delete N.stop,U(T)};return typeof g!="string"&&(T=C,C=g,g=void 0),C&&g!==!1&&this.queue(g||"fx",[]),this.each(function(){var N=!0,U=g!=null&&g+"queueHooks",V=v.timers,ee=Be.get(this);if(U)ee[U]&&ee[U].stop&&k(ee[U]);else for(U in ee)ee[U]&&ee[U].stop&&gs.test(U)&&k(ee[U]);for(U=V.length;U--;)V[U].elem===this&&(g==null||V[U].queue===g)&&(V[U].anim.stop(T),N=!1,V.splice(U,1));(N||!T)&&v.dequeue(this,g)})},finish:function(g){return g!==!1&&(g=g||"fx"),this.each(function(){var C,T=Be.get(this),k=T[g+"queue"],N=T[g+"queueHooks"],U=v.timers,V=k?k.length:0;for(T.finish=!0,v.queue(this,g,[]),N&&N.stop&&N.stop.call(this,!0),C=U.length;C--;)U[C].elem===this&&U[C].queue===g&&(U[C].anim.stop(!0),U.splice(C,1));for(C=0;C<V;C++)k[C]&&k[C].finish&&k[C].finish.call(this);delete T.finish})}}),v.each(["toggle","show","hide"],function(g,C){var T=v.fn[C];v.fn[C]=function(k,N,U){return k==null||typeof k=="boolean"?T.apply(this,arguments):this.animate(qi(C,!0),k,N,U)}}),v.each({slideDown:qi("show"),slideUp:qi("hide"),slideToggle:qi("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(g,C){v.fn[g]=function(T,k,N){return this.animate(C,T,k,N)}}),v.timers=[],v.fx.tick=function(){var g,C=0,T=v.timers;for(qn=v.now();C<T.length;C++)g=T[C],!g()&&T[C]===g&&T.splice(C--,1);T.length||v.fx.stop(),qn=void 0},v.fx.timer=function(g){v.timers.push(g),g()?v.fx.start():v.timers.pop()},v.fx.interval=13,v.fx.start=function(){ar||(ar=setInterval(v.fx.tick,v.fx.interval))},v.fx.stop=function(){clearInterval(ar),ar=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fn.delay=function(g,C){return g=v.fx&&v.fx.speeds[g]||g,C=C||"fx",this.queue(C,function(T,k){var N=setTimeout(T,g);k.stop=function(){clearTimeout(N)}})},function(){var g=E.createElement("input"),C=E.createElement("select"),T=C.appendChild(E.createElement("option"));g.type="checkbox",S.checkOn=g.value!=="",S.optSelected=T.selected,C.disabled=!0,S.optDisabled=!T.disabled,g=E.createElement("input"),g.value="t",g.type="radio",S.radioValue=g.value==="t"}();var ms,io,Nn=v.expr.attrHandle;v.fn.extend({attr:function(g,C){return Ke(this,v.attr,g,C,arguments.length>1)},removeAttr:function(g){return this.each(function(){v.removeAttr(this,g)})}}),v.extend({attr:function(g,C,T){var k,N,U=g.nodeType;if(!(!g||U===3||U===8||U===2)){if(typeof g.getAttribute===z)return v.prop(g,C,T);if((U!==1||!v.isXMLDoc(g))&&(C=C.toLowerCase(),k=v.attrHooks[C]||(v.expr.match.bool.test(C)?io:ms)),T!==void 0)if(T===null)v.removeAttr(g,C);else return k&&"set"in k&&(N=k.set(g,T,C))!==void 0?N:(g.setAttribute(C,T+""),T);else return k&&"get"in k&&(N=k.get(g,C))!==null?N:(N=v.find.attr(g,C),N??void 0)}},removeAttr:function(g,C){var T,k,N=0,U=C&&C.match(it);if(U&&g.nodeType===1)for(;T=U[N++];)k=v.propFix[T]||T,v.expr.match.bool.test(T)&&(g[k]=!1),g.removeAttribute(T)},attrHooks:{type:{set:function(g,C){if(!S.radioValue&&C==="radio"&&v.nodeName(g,"input")){var T=g.value;return g.setAttribute("type",C),T&&(g.value=T),C}}}}}),io={set:function(g,C,T){return C===!1?v.removeAttr(g,T):g.setAttribute(T,T),T}},v.each(v.expr.match.bool.source.match(/\w+/g),function(g,C){var T=Nn[C]||v.find.attr;Nn[C]=function(k,N,U){var V,ee;return U||(ee=Nn[N],Nn[N]=V,V=T(k,N,U)!=null?N.toLowerCase():null,Nn[N]=ee),V}});var zn=/^(?:input|select|textarea|button)$/i;v.fn.extend({prop:function(g,C){return Ke(this,v.prop,g,C,arguments.length>1)},removeProp:function(g){return this.each(function(){delete this[v.propFix[g]||g]})}}),v.extend({propFix:{for:"htmlFor",class:"className"},prop:function(g,C,T){var k,N,U,V=g.nodeType;if(!(!g||V===3||V===8||V===2))return U=V!==1||!v.isXMLDoc(g),U&&(C=v.propFix[C]||C,N=v.propHooks[C]),T!==void 0?N&&"set"in N&&(k=N.set(g,T,C))!==void 0?k:g[C]=T:N&&"get"in N&&(k=N.get(g,C))!==null?k:g[C]},propHooks:{tabIndex:{get:function(g){return g.hasAttribute("tabindex")||zn.test(g.nodeName)||g.href?g.tabIndex:-1}}}}),S.optSelected||(v.propHooks.selected={get:function(g){var C=g.parentNode;return C&&C.parentNode&&C.parentNode.selectedIndex,null}}),v.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){v.propFix[this.toLowerCase()]=this});var Qe=/[\t\r\n\f]/g;v.fn.extend({addClass:function(g){var C,T,k,N,U,V,ee=typeof g=="string"&&g,ae=0,ge=this.length;if(v.isFunction(g))return this.each(function(he){v(this).addClass(g.call(this,he,this.className))});if(ee){for(C=(g||"").match(it)||[];ae<ge;ae++)if(T=this[ae],k=T.nodeType===1&&(T.className?(" "+T.className+" ").replace(Qe," "):" "),k){for(U=0;N=C[U++];)k.indexOf(" "+N+" ")<0&&(k+=N+" ");V=v.trim(k),T.className!==V&&(T.className=V)}}return this},removeClass:function(g){var C,T,k,N,U,V,ee=arguments.length===0||typeof g=="string"&&g,ae=0,ge=this.length;if(v.isFunction(g))return this.each(function(he){v(this).removeClass(g.call(this,he,this.className))});if(ee){for(C=(g||"").match(it)||[];ae<ge;ae++)if(T=this[ae],k=T.nodeType===1&&(T.className?(" "+T.className+" ").replace(Qe," "):""),k){for(U=0;N=C[U++];)for(;k.indexOf(" "+N+" ")>=0;)k=k.replace(" "+N+" "," ");V=g?v.trim(k):"",T.className!==V&&(T.className=V)}}return this},toggleClass:function(g,C){var T=typeof g;return typeof C=="boolean"&&T==="string"?C?this.addClass(g):this.removeClass(g):v.isFunction(g)?this.each(function(k){v(this).toggleClass(g.call(this,k,this.className,C),C)}):this.each(function(){if(T==="string")for(var k,N=0,U=v(this),V=g.match(it)||[];k=V[N++];)U.hasClass(k)?U.removeClass(k):U.addClass(k);else(T===z||T==="boolean")&&(this.className&&Be.set(this,"__className__",this.className),this.className=this.className||g===!1?"":Be.get(this,"__className__")||"")})},hasClass:function(g){for(var C=" "+g+" ",T=0,k=this.length;T<k;T++)if(this[T].nodeType===1&&(" "+this[T].className+" ").replace(Qe," ").indexOf(C)>=0)return!0;return!1}});var kr=/\r/g;v.fn.extend({val:function(g){var C,T,k,N=this[0];return arguments.length?(k=v.isFunction(g),this.each(function(U){var V;this.nodeType===1&&(k?V=g.call(this,U,v(this).val()):V=g,V==null?V="":typeof V=="number"?V+="":v.isArray(V)&&(V=v.map(V,function(ee){return ee==null?"":ee+""})),C=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()],(!C||!("set"in C)||C.set(this,V,"value")===void 0)&&(this.value=V))})):N?(C=v.valHooks[N.type]||v.valHooks[N.nodeName.toLowerCase()],C&&"get"in C&&(T=C.get(N,"value"))!==void 0?T:(T=N.value,typeof T=="string"?T.replace(kr,""):T??"")):void 0}}),v.extend({valHooks:{option:{get:function(g){var C=v.find.attr(g,"value");return C??v.trim(v.text(g))}},select:{get:function(g){for(var C,T,k=g.options,N=g.selectedIndex,U=g.type==="select-one"||N<0,V=U?null:[],ee=U?N+1:k.length,ae=N<0?ee:U?N:0;ae<ee;ae++)if(T=k[ae],(T.selected||ae===N)&&(S.optDisabled?!T.disabled:T.getAttribute("disabled")===null)&&(!T.parentNode.disabled||!v.nodeName(T.parentNode,"optgroup"))){if(C=v(T).val(),U)return C;V.push(C)}return V},set:function(g,C){for(var T,k,N=g.options,U=v.makeArray(C),V=N.length;V--;)k=N[V],(k.selected=v.inArray(k.value,U)>=0)&&(T=!0);return T||(g.selectedIndex=-1),U}}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]={set:function(g,C){if(v.isArray(C))return g.checked=v.inArray(v(g).val(),C)>=0}},S.checkOn||(v.valHooks[this].get=function(g){return g.getAttribute("value")===null?"on":g.value})}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(g,C){v.fn[C]=function(T,k){return arguments.length>0?this.on(C,null,T,k):this.trigger(C)}}),v.fn.extend({hover:function(g,C){return this.mouseenter(g).mouseleave(C||g)},bind:function(g,C,T){return this.on(g,null,C,T)},unbind:function(g,C){return this.off(g,null,C)},delegate:function(g,C,T,k){return this.on(C,g,T,k)},undelegate:function(g,C,T){return arguments.length===1?this.off(g,"**"):this.off(C,g||"**",T)}});var vt=v.now(),At=/\?/;v.parseJSON=function(g){return JSON.parse(g+"")},v.parseXML=function(g){var C,T;if(!g||typeof g!="string")return null;try{T=new DOMParser,C=T.parseFromString(g,"text/xml")}catch{C=void 0}return(!C||C.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+g),C};var ro=/#.*$/,Fi=/([?&])_=[^&]*/,ur=/^(.*?):[ \t]*([^\r\n]*)$/mg,oo=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Je=/^(?:GET|HEAD)$/,Gt=/^\/\//,jn=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Rr={},Cn={},_s="*/".concat("*"),Gi=c.location.href,En=jn.exec(Gi.toLowerCase())||[];function Ht(g){return function(C,T){typeof C!="string"&&(T=C,C="*");var k,N=0,U=C.toLowerCase().match(it)||[];if(v.isFunction(T))for(;k=U[N++];)k[0]==="+"?(k=k.slice(1)||"*",(g[k]=g[k]||[]).unshift(T)):(g[k]=g[k]||[]).push(T)}}function Ni(g,C,T,k){var N={},U=g===Cn;function V(ee){var ae;return N[ee]=!0,v.each(g[ee]||[],function(ge,he){var Le=he(C,T,k);if(typeof Le=="string"&&!U&&!N[Le])return C.dataTypes.unshift(Le),V(Le),!1;if(U)return!(ae=Le)}),ae}return V(C.dataTypes[0])||!N["*"]&&V("*")}function zi(g,C){var T,k,N=v.ajaxSettings.flatOptions||{};for(T in C)C[T]!==void 0&&((N[T]?g:k||(k={}))[T]=C[T]);return k&&v.extend(!0,g,k),g}function Br(g,C,T){for(var k,N,U,V,ee=g.contents,ae=g.dataTypes;ae[0]==="*";)ae.shift(),k===void 0&&(k=g.mimeType||C.getResponseHeader("Content-Type"));if(k){for(N in ee)if(ee[N]&&ee[N].test(k)){ae.unshift(N);break}}if(ae[0]in T)U=ae[0];else{for(N in T){if(!ae[0]||g.converters[N+" "+ae[0]]){U=N;break}V||(V=N)}U=U||V}if(U)return U!==ae[0]&&ae.unshift(U),T[U]}function Ro(g,C,T,k){var N,U,V,ee,ae,ge={},he=g.dataTypes.slice();if(he[1])for(V in g.converters)ge[V.toLowerCase()]=g.converters[V];for(U=he.shift();U;)if(g.responseFields[U]&&(T[g.responseFields[U]]=C),!ae&&k&&g.dataFilter&&(C=g.dataFilter(C,g.dataType)),ae=U,U=he.shift(),U){if(U==="*")U=ae;else if(ae!=="*"&&ae!==U){if(V=ge[ae+" "+U]||ge["* "+U],!V){for(N in ge)if(ee=N.split(" "),ee[1]===U&&(V=ge[ae+" "+ee[0]]||ge["* "+ee[0]],V)){V===!0?V=ge[N]:ge[N]!==!0&&(U=ee[0],he.unshift(ee[1]));break}}if(V!==!0)if(V&&g.throws)C=V(C);else try{C=V(C)}catch(Le){return{state:"parsererror",error:V?Le:"No conversion from "+ae+" to "+U}}}}return{state:"success",data:C}}v.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Gi,type:"GET",isLocal:oo.test(En[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":_s,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(g,C){return C?zi(zi(g,v.ajaxSettings),C):zi(v.ajaxSettings,g)},ajaxPrefilter:Ht(Rr),ajaxTransport:Ht(Cn),ajax:function(g,C){typeof g=="object"&&(C=g,g=void 0),C=C||{};var T,k,N,U,V,ee,ae,ge,he=v.ajaxSetup({},C),Le=he.context||he,me=he.context&&(Le.nodeType||Le.jquery)?v(Le):v.event,Pe=v.Deferred(),Xe=v.Callbacks("once memory"),Ve=he.statusCode||{},ut={},Yn={},Yt=0,Ti="canceled",De={readyState:0,getResponseHeader:function(ht){var Ut;if(Yt===2){if(!U)for(U={};Ut=ur.exec(N);)U[Ut[1].toLowerCase()]=Ut[2];Ut=U[ht.toLowerCase()]}return Ut??null},getAllResponseHeaders:function(){return Yt===2?N:null},setRequestHeader:function(ht,Ut){var Hn=ht.toLowerCase();return Yt||(ht=Yn[Hn]=Yn[Hn]||ht,ut[ht]=Ut),this},overrideMimeType:function(ht){return Yt||(he.mimeType=ht),this},statusCode:function(ht){var Ut;if(ht)if(Yt<2)for(Ut in ht)Ve[Ut]=[Ve[Ut],ht[Ut]];else De.always(ht[De.status]);return this},abort:function(ht){var Ut=ht||Ti;return T&&T.abort(Ut),gn(0,Ut),this}};if(Pe.promise(De).complete=Xe.add,De.success=De.done,De.error=De.fail,he.url=((g||he.url||Gi)+"").replace(ro,"").replace(Gt,En[1]+"//"),he.type=C.method||C.type||he.method||he.type,he.dataTypes=v.trim(he.dataType||"*").toLowerCase().match(it)||[""],he.crossDomain==null&&(ee=jn.exec(he.url.toLowerCase()),he.crossDomain=!!(ee&&(ee[1]!==En[1]||ee[2]!==En[2]||(ee[3]||(ee[1]==="http:"?"80":"443"))!==(En[3]||(En[1]==="http:"?"80":"443"))))),he.data&&he.processData&&typeof he.data!="string"&&(he.data=v.param(he.data,he.traditional)),Ni(Rr,he,C,De),Yt===2)return De;ae=v.event&&he.global,ae&&v.active++===0&&v.event.trigger("ajaxStart"),he.type=he.type.toUpperCase(),he.hasContent=!Je.test(he.type),k=he.url,he.hasContent||(he.data&&(k=he.url+=(At.test(k)?"&":"?")+he.data,delete he.data),he.cache===!1&&(he.url=Fi.test(k)?k.replace(Fi,"$1_="+vt++):k+(At.test(k)?"&":"?")+"_="+vt++)),he.ifModified&&(v.lastModified[k]&&De.setRequestHeader("If-Modified-Since",v.lastModified[k]),v.etag[k]&&De.setRequestHeader("If-None-Match",v.etag[k])),(he.data&&he.hasContent&&he.contentType!==!1||C.contentType)&&De.setRequestHeader("Content-Type",he.contentType),De.setRequestHeader("Accept",he.dataTypes[0]&&he.accepts[he.dataTypes[0]]?he.accepts[he.dataTypes[0]]+(he.dataTypes[0]!=="*"?", "+_s+"; q=0.01":""):he.accepts["*"]);for(ge in he.headers)De.setRequestHeader(ge,he.headers[ge]);if(he.beforeSend&&(he.beforeSend.call(Le,De,he)===!1||Yt===2))return De.abort();Ti="abort";for(ge in{success:1,error:1,complete:1})De[ge](he[ge]);if(T=Ni(Cn,he,C,De),!T)gn(-1,"No Transport");else{De.readyState=1,ae&&me.trigger("ajaxSend",[De,he]),he.async&&he.timeout>0&&(V=setTimeout(function(){De.abort("timeout")},he.timeout));try{Yt=1,T.send(ut,gn)}catch(ht){if(Yt<2)gn(-1,ht);else throw ht}}function gn(ht,Ut,Hn,Un){var _i,Kn,mn,Pi,Ln,Xn=Ut;Yt!==2&&(Yt=2,V&&clearTimeout(V),T=void 0,N=Un||"",De.readyState=ht>0?4:0,_i=ht>=200&&ht<300||ht===304,Hn&&(Pi=Br(he,De,Hn)),Pi=Ro(he,Pi,De,_i),_i?(he.ifModified&&(Ln=De.getResponseHeader("Last-Modified"),Ln&&(v.lastModified[k]=Ln),Ln=De.getResponseHeader("etag"),Ln&&(v.etag[k]=Ln)),ht===204||he.type==="HEAD"?Xn="nocontent":ht===304?Xn="notmodified":(Xn=Pi.state,Kn=Pi.data,mn=Pi.error,_i=!mn)):(mn=Xn,(ht||!Xn)&&(Xn="error",ht<0&&(ht=0))),De.status=ht,De.statusText=(Ut||Xn)+"",_i?Pe.resolveWith(Le,[Kn,Xn,De]):Pe.rejectWith(Le,[De,Xn,mn]),De.statusCode(Ve),Ve=void 0,ae&&me.trigger(_i?"ajaxSuccess":"ajaxError",[De,he,_i?Kn:mn]),Xe.fireWith(Le,[De,Xn]),ae&&(me.trigger("ajaxComplete",[De,he]),--v.active||v.event.trigger("ajaxStop")))}return De},getJSON:function(g,C,T){return v.get(g,C,T,"json")},getScript:function(g,C){return v.get(g,void 0,C,"script")}}),v.each(["get","post"],function(g,C){v[C]=function(T,k,N,U){return v.isFunction(k)&&(U=U||N,N=k,k=void 0),v.ajax({url:T,type:C,dataType:U,data:k,success:N})}}),v._evalUrl=function(g){return v.ajax({url:g,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},v.fn.extend({wrapAll:function(g){var C;return v.isFunction(g)?this.each(function(T){v(this).wrapAll(g.call(this,T))}):(this[0]&&(C=v(g,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&C.insertBefore(this[0]),C.map(function(){for(var T=this;T.firstElementChild;)T=T.firstElementChild;return T}).append(this)),this)},wrapInner:function(g){return v.isFunction(g)?this.each(function(C){v(this).wrapInner(g.call(this,C))}):this.each(function(){var C=v(this),T=C.contents();T.length?T.wrapAll(g):C.append(g)})},wrap:function(g){var C=v.isFunction(g);return this.each(function(T){v(this).wrapAll(C?g.call(this,T):g)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()}}),v.expr.filters.hidden=function(g){return g.offsetWidth<=0&&g.offsetHeight<=0},v.expr.filters.visible=function(g){return!v.expr.filters.hidden(g)};var Dr=/%20/g,Bo=/\[\]$/,so=/\r?\n/g,Ir=/^(?:submit|button|image|reset|file)$/i,cr=/^(?:input|select|textarea|keygen)/i;function Fr(g,C,T,k){var N;if(v.isArray(C))v.each(C,function(U,V){T||Bo.test(g)?k(g,V):Fr(g+"["+(typeof V=="object"?U:"")+"]",V,T,k)});else if(!T&&v.type(C)==="object")for(N in C)Fr(g+"["+N+"]",C[N],T,k);else k(g,C)}v.param=function(g,C){var T,k=[],N=function(U,V){V=v.isFunction(V)?V():V??"",k[k.length]=encodeURIComponent(U)+"="+encodeURIComponent(V)};if(C===void 0&&(C=v.ajaxSettings&&v.ajaxSettings.traditional),v.isArray(g)||g.jquery&&!v.isPlainObject(g))v.each(g,function(){N(this.name,this.value)});else for(T in g)Fr(T,g[T],C,N);return k.join("&").replace(Dr,"+")},v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var g=v.prop(this,"elements");return g?v.makeArray(g):this}).filter(function(){var g=this.type;return this.name&&!v(this).is(":disabled")&&cr.test(this.nodeName)&&!Ir.test(g)&&(this.checked||!D.test(g))}).map(function(g,C){var T=v(this).val();return T==null?null:v.isArray(T)?v.map(T,function(k){return{name:C.name,value:k.replace(so,`\r
`)}}):{name:C.name,value:T.replace(so,`\r
`)}}).get()}}),v.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch{}};var ao=0,Nr={},Do={0:200,1223:204},zr=v.ajaxSettings.xhr();c.attachEvent&&c.attachEvent("onunload",function(){for(var g in Nr)Nr[g]()}),S.cors=!!zr&&"withCredentials"in zr,S.ajax=zr=!!zr,v.ajaxTransport(function(g){var C;if(S.cors||zr&&!g.crossDomain)return{send:function(T,k){var N,U=g.xhr(),V=++ao;if(U.open(g.type,g.url,g.async,g.username,g.password),g.xhrFields)for(N in g.xhrFields)U[N]=g.xhrFields[N];g.mimeType&&U.overrideMimeType&&U.overrideMimeType(g.mimeType),!g.crossDomain&&!T["X-Requested-With"]&&(T["X-Requested-With"]="XMLHttpRequest");for(N in T)U.setRequestHeader(N,T[N]);C=function(ee){return function(){C&&(delete Nr[V],C=U.onload=U.onerror=null,ee==="abort"?U.abort():ee==="error"?k(U.status,U.statusText):k(Do[U.status]||U.status,U.statusText,typeof U.responseText=="string"?{text:U.responseText}:void 0,U.getAllResponseHeaders()))}},U.onload=C(),U.onerror=C("error"),C=Nr[V]=C("abort");try{U.send(g.hasContent&&g.data||null)}catch(ee){if(C)throw ee}},abort:function(){C&&C()}}}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(g){return v.globalEval(g),g}}}),v.ajaxPrefilter("script",function(g){g.cache===void 0&&(g.cache=!1),g.crossDomain&&(g.type="GET")}),v.ajaxTransport("script",function(g){if(g.crossDomain){var C,T;return{send:function(k,N){C=v("<script>").prop({async:!0,charset:g.scriptCharset,src:g.url}).on("load error",T=function(U){C.remove(),T=null,U&&N(U.type==="error"?404:200,U.type)}),E.head.appendChild(C[0])},abort:function(){T&&T()}}}});var rt=[],Gn=/(=)\?(?=&|$)|\?\?/;v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var g=rt.pop()||v.expando+"_"+vt++;return this[g]=!0,g}}),v.ajaxPrefilter("json jsonp",function(g,C,T){var k,N,U,V=g.jsonp!==!1&&(Gn.test(g.url)?"url":typeof g.data=="string"&&!(g.contentType||"").indexOf("application/x-www-form-urlencoded")&&Gn.test(g.data)&&"data");if(V||g.dataTypes[0]==="jsonp")return k=g.jsonpCallback=v.isFunction(g.jsonpCallback)?g.jsonpCallback():g.jsonpCallback,V?g[V]=g[V].replace(Gn,"$1"+k):g.jsonp!==!1&&(g.url+=(At.test(g.url)?"&":"?")+g.jsonp+"="+k),g.converters["script json"]=function(){return U||v.error(k+" was not called"),U[0]},g.dataTypes[0]="json",N=c[k],c[k]=function(){U=arguments},T.always(function(){c[k]=N,g[k]&&(g.jsonpCallback=C.jsonpCallback,rt.push(k)),U&&v.isFunction(N)&&N(U[0]),U=N=void 0}),"script"}),v.parseHTML=function(g,C,T){if(!g||typeof g!="string")return null;typeof C=="boolean"&&(T=C,C=!1),C=C||E;var k=oe.exec(g),N=!T&&[];return k?[C.createElement(k[1])]:(k=v.buildFragment([g],C,N),N&&N.length&&v(N).remove(),v.merge([],k.childNodes))};var Dt=v.fn.load;v.fn.load=function(g,C,T){if(typeof g!="string"&&Dt)return Dt.apply(this,arguments);var k,N,U,V=this,ee=g.indexOf(" ");return ee>=0&&(k=v.trim(g.slice(ee)),g=g.slice(0,ee)),v.isFunction(C)?(T=C,C=void 0):C&&typeof C=="object"&&(N="POST"),V.length>0&&v.ajax({url:g,type:N,dataType:"html",data:C}).done(function(ae){U=arguments,V.html(k?v("<div>").append(v.parseHTML(ae)).find(k):ae)}).complete(T&&function(ae,ge){V.each(T,U||[ae.responseText,ge,ae])}),this},v.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(g,C){v.fn[C]=function(T){return this.on(C,T)}}),v.expr.filters.animated=function(g){return v.grep(v.timers,function(C){return g===C.elem}).length};var lo=c.document.documentElement;function uo(g){return v.isWindow(g)?g:g.nodeType===9&&g.defaultView}v.offset={setOffset:function(g,C,T){var k,N,U,V,ee,ae,ge,he=v.css(g,"position"),Le=v(g),me={};he==="static"&&(g.style.position="relative"),ee=Le.offset(),U=v.css(g,"top"),ae=v.css(g,"left"),ge=(he==="absolute"||he==="fixed")&&(U+ae).indexOf("auto")>-1,ge?(k=Le.position(),V=k.top,N=k.left):(V=parseFloat(U)||0,N=parseFloat(ae)||0),v.isFunction(C)&&(C=C.call(g,T,ee)),C.top!=null&&(me.top=C.top-ee.top+V),C.left!=null&&(me.left=C.left-ee.left+N),"using"in C?C.using.call(g,me):Le.css(me)}},v.fn.extend({offset:function(g){if(arguments.length)return g===void 0?this:this.each(function(V){v.offset.setOffset(this,g,V)});var C,T,k=this[0],N={top:0,left:0},U=k&&k.ownerDocument;if(U)return C=U.documentElement,v.contains(C,k)?(typeof k.getBoundingClientRect!==z&&(N=k.getBoundingClientRect()),T=uo(U),{top:N.top+T.pageYOffset-C.clientTop,left:N.left+T.pageXOffset-C.clientLeft}):N},position:function(){if(this[0]){var g,C,T=this[0],k={top:0,left:0};return v.css(T,"position")==="fixed"?C=T.getBoundingClientRect():(g=this.offsetParent(),C=this.offset(),v.nodeName(g[0],"html")||(k=g.offset()),k.top+=v.css(g[0],"borderTopWidth",!0),k.left+=v.css(g[0],"borderLeftWidth",!0)),{top:C.top-k.top-v.css(T,"marginTop",!0),left:C.left-k.left-v.css(T,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var g=this.offsetParent||lo;g&&!v.nodeName(g,"html")&&v.css(g,"position")==="static";)g=g.offsetParent;return g||lo})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(g,C){var T=C==="pageYOffset";v.fn[g]=function(k){return Ke(this,function(N,U,V){var ee=uo(N);if(V===void 0)return ee?ee[C]:N[U];ee?ee.scrollTo(T?c.pageXOffset:V,T?V:c.pageYOffset):N[U]=V},g,k,arguments.length,null)}}),v.each(["top","left"],function(g,C){v.cssHooks[C]=Er(S.pixelPosition,function(T,k){if(k)return k=Zi(T,C),Pn.test(k)?v(T).position()[C]+"px":k})}),v.each({Height:"height",Width:"width"},function(g,C){v.each({padding:"inner"+g,content:C,"":"outer"+g},function(T,k){v.fn[k]=function(N,U){var V=arguments.length&&(T||typeof N!="boolean"),ee=T||(N===!0||U===!0?"margin":"border");return Ke(this,function(ae,ge,he){var Le;return v.isWindow(ae)?ae.document.documentElement["client"+g]:ae.nodeType===9?(Le=ae.documentElement,Math.max(ae.body["scroll"+g],Le["scroll"+g],ae.body["offset"+g],Le["offset"+g],Le["client"+g])):he===void 0?v.css(ae,ge,ee):v.style(ae,ge,he,ee)},C,V?N:void 0,V,null)}})}),v.fn.size=function(){return this.length},v.fn.andSelf=v.fn.addBack,s=[],a=function(){return v}.apply(o,s),a!==void 0&&(t.exports=a);var Io=c.jQuery,Fo=c.$;return v.noConflict=function(g){return c.$===v&&(c.$=Fo),g&&c.jQuery===v&&(c.jQuery=Io),v},typeof d===z&&(c.jQuery=c.$=v),v})},function(t,o,n){var s=n(0),a=n(2),c=350;t.exports=a.extend({initialize:function(l){this._bounds={},l&&(this._mapAdapter=l,this.setBounds(this._mapAdapter.getBounds()),this._initBinds())},_initBinds:function(){this.listenTo(this._mapAdapter,"boundsChanged",s.debounce(this._boundsChanged,c))},_stopBinds:function(){this._mapAdapter&&this.stopListening(this._mapAdapter,"boundsChanged")},_boundsChanged:function(l){this.setBounds(l)},setBounds:function(l){this._bounds=l,this.trigger("boundsChanged",l)},getBounds:function(){return this._bounds},areBoundsAvailable:function(){return s.isFinite(this._bounds.west)},serialize:function(){return[this._bounds.west,this._bounds.south,this._bounds.east,this._bounds.north].join(",")},clean:function(){this._stopBinds()}})},function(t,o,n){var s=n(1);t.exports=function(a,c,d){var l=arguments[1];return this._xhr&&this._xhr.abort(),this._xhr=s.sync.apply(this,arguments),this._xhr.always(function(){l._xhr=null}),this._xhr}},function(t,o,n){var s=n(0),a=n(2),c=n(19),d=n(9),l=n(7),f=n(25),p="unfetched",m="fetching",_="fetched",b="error",x=2083,A=["engine"];t.exports=a.extend({defaults:{url:"",data:[],sync_on_bbox_change:!0,sync_on_circle_change:!0,sync_on_polygon_change:!0,enabled:!0,status:p},url:function(){var E=s.union([this._getSpatialFilterParam()],this._getDataviewSpecificURLParams());this._addAuthTo(E);var F=this.get("url")+"?"+E.join("&");if(F.length>x)throw new Error("URL length is longer than allowed ("+x+" chars). Check your filters (eg. if using a Polygon filter, reduce the number of vertices).");return F},_addAuthTo:function(E){if(this._engine.getApiKey())E.push("api_key="+this._engine.getApiKey());else if(this._engine.getAuthToken()){var F=this._engine.getAuthToken();F instanceof Array?s.each(F,function(v){E.push("auth_token[]="+v)}):E.push("auth_token="+F)}},_getSpatialFilterParam:function(){if(this._bboxFilter)return this._getBoundingBoxFilterParam();if(this._circleFilter)return this._getCircleFilterParam();if(this._polygonFilter)return this._getPolygonFilterParam()},_getBoundingBoxFilterParam:function(){var E="";return this._checkBBoxFilter(),this.syncsOnBoundingBoxChanges()&&(E="bbox="+this._bboxFilter.serialize()),E},_getCircleFilterParam:function(){var E="";return this._checkCircleFilter(),this.syncsOnCircleChanges()&&(E="circle="+this._circleFilter.serialize()),E},_getPolygonFilterParam:function(){var E="";return this._checkPolygonFilter(),this.syncsOnPolygonChanges()&&(E="polygon="+this._polygonFilter.serialize()),E},_getDataviewSpecificURLParams:function(){return[]},initialize:function(E,F){if(E=E||{},F=F||{},l.checkRequiredOpts(F,A,"DataviewModelBase"),this._hasBinds=!1,this._engine=F.engine,!E.source)throw new Error("source is a required attr");this._checkSourceAttribute(this.getSource()),this.getSource().markAsSourceOf(this),E.id||this.set("id",this.defaults.type+"-"+this.cid),this.sync=c.bind(this),this.filter=F.filter,this.filter&&this.filter.set("dataviewId",this.id),this._addSpatialFilterFrom(F),this._initBinds()},_addSpatialFilterFrom:function(E){E.bboxFilter&&this.addBBoxFilter(E.bboxFilter),E.circleFilter&&this.addCircleFilter(E.circleFilter),E.polygonFilter&&this.addPolygonFilter(E.polygonFilter)},_initBinds:function(){this.listenToOnce(this,"change:url",function(){this._checkBBoxFilter(),this.syncsOnBoundingBoxChanges()&&!this._bboxFilter.areBoundsAvailable()?this.listenTo(this._bboxFilter,"boundsChanged",this._fetch):this._fetch()}),this.filter&&this.listenTo(this.filter,"change",this._onFilterChanged),this.getSource().on("change:status",this._onAnalysisStatusChange,this)},_onChangeBinds:function(){this.on("change:sync_on_bbox_change",function(){this.refresh()},this),this.on("change:url",function(E,F,v){this._newDataAvailable=!0,this._shouldFetchOnURLChange(v&&s.pick(v,["forceFetch","sourceId"]))&&this.refresh()},this),this.on("change:enabled",function(E,F){F&&this._newDataAvailable&&(this.refresh(),this._newDataAvailable=!1)},this)},_onMapBoundsChanged:function(){this._shouldFetchOnBoundingBoxChange()&&this._fetch(),this.syncsOnBoundingBoxChanges()&&(this._newDataAvailable=!0)},_onCircleChanged:function(){this._shouldFetchOnCircleChange()&&this._fetch(),this.syncsOnCircleChanges()&&(this._newDataAvailable=!0)},_onPolygonChanged:function(){this._shouldFetchOnPolygonChange()&&this._fetch(),this.syncsOnPolygonChanges()&&(this._newDataAvailable=!0)},_fetch:function(){this.fetch({success:function(){this._hasBinds||(this._hasBinds=!0,this._onChangeBinds())}.bind(this)})},_onAnalysisStatusChange:function(E,F){E.isLoading()?this._triggerLoading():E.isFailed()&&this._triggerStatusError(E.get("error"))},_triggerLoading:function(){this.trigger("loading",this)},_triggerStatusError:function(E){this.trigger("statusError",this,E)},_onFilterChanged:function(E){this._reload({sourceId:this.getSourceId()})},_reloadAndForceFetch:function(){this._reload({sourceId:this.getSourceId(),forceFetch:!0})},_reload:function(E){E=E||{},this._engine.reload(E)},_shouldFetchOnURLChange:function(E){E=E||{};var F=E.sourceId,v=E.forceFetch;return v?!0:this.isEnabled()&&this._sourceAffectsMyOwnSource(F)},_sourceAffectsMyOwnSource:function(E){if(!E)return!0;var F=this.getSource();return F&&F.findAnalysisById(E)},_shouldFetchOnBoundingBoxChange:function(){return this.isEnabled()&&this.syncsOnBoundingBoxChanges()},_shouldFetchOnCircleChange:function(){return this.isEnabled()&&this.syncsOnCircleChanges()},_shouldFetchOnPolygonChange:function(){return this.isEnabled()&&this.syncsOnPolygonChanges()},refresh:function(){this.fetch()},addBBoxFilter:function(E){E&&(this._stopListeningBBoxChanges(),this._bboxFilter=E,this._listenToBBoxChanges())},removeBBoxFilter:function(){this._stopListeningBBoxChanges(),this._bboxFilter=null},addCircleFilter:function(E){E&&(this._stopListeningCircleChanges(),this._circleFilter=E,this._listenToCircleChanges())},removeCircleFilter:function(){this._stopListeningCircleChanges(),this._circleFilter=null},addPolygonFilter:function(E){E&&(this._stopListeningPolygonChanges(),this._polygonFilter=E,this._listenToPolygonChanges())},removePolygonFilter:function(){this._stopListeningPolygonChanges(),this._polygonFilter=null},update:function(E){if(s.has(E,"source"))throw new Error("Source of dataviews cannot be updated");E=s.pick(E,this.constructor.ATTRS_NAMES),this.set(E)},getData:function(){return this.get("data")},getPreviousData:function(){return this.previous("data")},fetch:function(E){if(E=E||{},this.set("status",m),this._triggerLoading(),E.success)var F=E&&E.success;return a.prototype.fetch.call(this,s.extend(E,{success:function(){this.set("status",_),F&&F(arguments),this.trigger("loaded",this)}.bind(this),error:function(v,P){if(!P||P&&P.statusText!=="abort"){this.set("status",b),this._errorWithBigPolygonFilter(v)&&(P.statusText="error in the dataview request. Check the Polygon filter size (reduce the number of vertices and retry).");var G=this._parseError(P);this._triggerStatusError(G)}}.bind(this)}))},_errorWithBigPolygonFilter:function(E){var F=E&&E.attributes&&E.attributes.sync_on_polygon_change;return!!(F&&this.url().length>x)},toJSON:function(){throw new Error("toJSON should be defined for each dataview")},getSourceType:function(){return this.getSource().get("type")},getSourceId:function(){var E=this.getSource();return E&&E.id},getSource:function(){return this.get("source")},isSourceType:function(){return this.getSourceType()==="source"},isFiltered:function(){var E=!1;return this.filter&&(E=!this.filter.isEmpty()),E},remove:function(){this._removeExistingAnalysisBindings(),this.getSource().unmarkAsSourceOf(this),this.trigger("destroy",this),this.stopListening()},_removeExistingAnalysisBindings:function(){this.getSource().off("change:status",this._onAnalysisStatusChange,this)},isFetched:function(){return this.get("status")===_},isUnavailable:function(){return this.get("status")===b},isEnabled:function(){return this.get("enabled")},setUnavailable:function(){return this.set("status",b)},syncsOnBoundingBoxChanges:function(){return this.get("sync_on_bbox_change")},syncsOnCircleChanges:function(){return this.get("sync_on_circle_change")},syncsOnPolygonChanges:function(){return this.get("sync_on_polygon_change")},_checkSourceAttribute:function(E){if(!(E instanceof d))throw new Error("Source must be an instance of AnalysisModel")},_checkBBoxFilter:function(){if(this.syncsOnBoundingBoxChanges()&&!this._bboxFilter)throw new Error("Cannot sync on bounding box changes. There is no bounding box filter.")},_checkCircleFilter:function(){if(this.syncsOnCircleChanges()&&!this._circleFilter)throw new Error("Cannot sync on circle filter changes. There is no circle filter.")},_checkPolygonFilter:function(){if(this.syncsOnPolygonChanges()&&!this._polygonFilter)throw new Error("Cannot sync on polygon filter changes. There is no polygon filter.")},_listenToBBoxChanges:function(){this._bboxFilter&&this.listenTo(this._bboxFilter,"boundsChanged",this._onMapBoundsChanged)},_stopListeningBBoxChanges:function(){this._bboxFilter&&this.stopListening(this._bboxFilter,"boundsChanged")},_listenToCircleChanges:function(){this._circleFilter&&this.listenTo(this._circleFilter,"circleChanged",this._onCircleChanged)},_stopListeningCircleChanges:function(){this._circleFilter&&this.stopListening(this._circleFilter,"circleChanged")},_listenToPolygonChanges:function(){this._polygonFilter&&this.listenTo(this._polygonFilter,"polygonChanged",this._onPolygonChanged)},_stopListeningPolygonChanges:function(){this._polygonFilter&&this.stopListening(this._polygonFilter,"polygonChanged")},_parseError:function(E){var F={},v=f(E,"dataview");return v.length>0&&(F=v[0]),F}},{ATTRS_NAMES:["id","sync_on_bbox_change","sync_on_circle_change","sync_on_polygon_change","enabled","source"]})},function(t,o,n){var s=function(){function b(x,A){for(var S=0;S<A.length;S++){var E=A[S];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(x,E.key,E)}}return function(x,A,S){return A&&b(x.prototype,A),S&&b(x,S),x}}();function a(b,x){if(!(b instanceof x))throw new TypeError("Cannot call a class as a function")}function c(b,x){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:b}function d(b,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);b.prototype=Object.create(x&&x.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(b,x):b.__proto__=x)}var l=n(0),f=n(6),p=n(11),m="AND",_=function(b){d(x,b);function x(A){a(this,x);var S=c(this,(x.__proto__||Object.getPrototypeOf(x)).call(this));return S._initialize(A),S}return s(x,[{key:"_initialize",value:function(S){var E=this;this._filters=[],S&&S.length&&S.map(function(F){return E.addFilter(F)})}},{key:"addFilter",value:function(S){var E=this;if(!(S instanceof p)&&!(S instanceof x))throw this._getValidationError("wrongFilterType");l.contains(this._filters,S)||(this.listenTo(S,"change:filters",function(F){return E._triggerFilterChange(F)}),this._filters.push(S),this._triggerFilterChange())}},{key:"removeFilter",value:function(S){var E=l.indexOf(this._filters,S);if(E!==-1){var F=this._filters.splice(E,1)[0];return F.off("change:filters",null,this),this._triggerFilterChange(),F}}},{key:"count",value:function(){return this._filters.length}},{key:"getFilters",value:function(){return this._filters}},{key:"$getSQL",value:function(){var S=this._filters.map(function(F){return F.$getSQL()}).filter(function(F){return Boolean(F)}),E=S.join(" "+(this.JOIN_OPERATOR||m)+" ");return S.length>1?"("+E+")":E}},{key:"_triggerFilterChange",value:function(S){this.trigger("change:filters",S)}}]),x}(f);t.exports=_},function(t,o,n){var s=n(0),a=n(13),c=a.extend({defaults:function(){return s.extend(a.prototype.defaults.apply(this),{state:a.STATE_SUCCESS})},_onEngineReloadStarted:function(){},isAvailable:function(){return!0}});t.exports=c},function(t,o,n){var s=n(109),a=n(91),c=n(90);t.exports={Aggregation:c,Layer:s,events:a}},function(t,o,n){t.exports={OVERLAY_TYPES:{ATTRIBUTION:"attribution",HEADER:"header",LIMITS:"limits",TILES:"tiles",LOADER:"loader",LOGO:"logo",SEARCH:"search",ZOOM:"zoom"},MAP_PROVIDER_TYPES:{GMAPS:"googlemaps",LEAFLET:"leaflet"},GMAPS_BASE_LAYER_TYPES:["roadmap","gray_roadmap","dark_roadmap","hybrid","satellite","terrain"],WINDSHAFT_ERRORS:{ANALYSIS:"analysis",LAYER:"layer",LIMIT:"limit",TILE:"tile",GENERIC:"generic",UNKNOWN:"unknown"}}},function(t,o,n){var s=n(0),a=n(41),c=function(l,f){if(l=l||{},l.responseJSON&&(l=l.responseJSON),l.errors_with_context)return s.map(l.errors_with_context,function(m){return new a(m,f)});if(l.errors){var p=typeof l.errors[0]=="string"?{message:l.errors[0]}:l.errors[0];return[new a(p,f)]}return l.statusText?[new a({message:l.statusText},f,"ajax")]:[]};t.exports=c},function(t){t.exports={name:"internal-carto.js",version:"4.2.2",description:"CARTO javascript library",repository:{type:"git",url:"https://github.com/CartoDB/carto.js.git"},author:{name:"CARTO",url:"https://carto.com/"},contributors:["Javier Álvarez <jmedina@carto.com>","Javier Álvarez <xabel@vizzuality.com>","Javier Arce <javierarce@carto.com>","Javier Santana <jsantana@carto.com>","Raul Ochoa <rochoa@carto.com>","Carlos Matallín <matallo@carto.com>","Jaime Chapinal <jaime.chapinal@carto.com>","Nicklas Gummesson <nicklas@carto.com>","Francisco Dans <francisco@carto.com>","Emilio García <emilio@carto.com>","Ivan Malagon <ivan@carto.com>","Ruben Moya <ruben@carto.com>","Jesus Arroyo Torrens <jarroyo@carto.com>","Iago Lastra <iago@carto.com>","Elena Torró <elena@carto.com>","Jesús Botella <jbotella@carto.com>","Víctor Velarde <victor.velarde@gmail.com","Alejandra Arri <alejandraarri@carto.com>"],private:!0,license:"BSD-3-Clause",dependencies:{backbone:"1.2.3","backbone-poller":"^1.1.3","camshaft-reference":"0.34.0",carto:"cartodb/carto#master","@carto/zera":"1.0.7","clip-path-polygon":"0.1.12","d3-array":"1.2.1","d3-format":"1.2.0","d3-time-format":"2.1.0",jquery:"2.1.4",mustache:"1.1.0","perfect-scrollbar":"https://github.com/CartoDB/perfect-scrollbar.git#master",postcss:"5.0.19","promise-polyfill":"^6.1.0","torque.js":"CartoDB/torque#master",underscore:"1.8.3","whatwg-fetch":"^2.0.3"},devDependencies:{"babel-core":"^6.26.3","babel-loader":"^7.1.4","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-preset-env":"^1.7.0","babel-preset-es2015":"~6.24.1",babelify:"^7.3.0",browserify:"13.0.0","browserify-shim":"3.8.12",cartoassets:"CartoDB/CartoAssets#master",eslint:"~4.18.2","eslint-config-semistandard":"~11.0.0","eslint-config-standard":"~10.2.1","eslint-plugin-import":"~2.7.0","eslint-plugin-node":"~5.2.0","eslint-plugin-promise":"~3.5.0","eslint-plugin-standard":"~3.0.1","findup-sync":"0.1.3",grunt:"0.4.5","grunt-aws":"^0.4.0","grunt-banner":"^0.6.0","grunt-browserify":"5.0.0","grunt-contrib-clean":"~0.5.0","grunt-contrib-concat":"~0.3.0","grunt-contrib-connect":"~0.11.2","grunt-contrib-copy":"~0.7.0","grunt-contrib-cssmin":"~0.7.0","grunt-contrib-imagemin":"~1.0.0","grunt-contrib-jasmine":"1.1.0","grunt-contrib-watch":"https://github.com/gruntjs/grunt-contrib-watch.git#b884948805940c663b1cbb91a3c28ba8afdebf78","grunt-eslint":"~20.1.0","grunt-exorcise":"2.1.0","grunt-fastly":"~0.1.3","grunt-gitinfo":"~0.1.7","grunt-prompt":"~1.3.0","grunt-replace":"0.6.2","grunt-sass":"2.0.0","grunt-terser":"^1.0.0",gulp:"3.8.10","gulp-iconfont":"1.0.0","gulp-iconfont-css":"0.0.9","gulp-install":"0.2.0","gulp-sketch":"0.0.7","jasmine-ajax":"https://github.com/nobuti/jasmine-ajax.git#master",jsdoc:"~3.5.5",jstify:"0.12.0",leaflet:"1.3.1","load-grunt-tasks":"~0.6.0","npm-watch":"^0.3.0",semver:"~5.4.0","source-map-support":"CartoDB/node-source-map-support#0.4.6-cdb1","time-grunt":"~0.3.1","uglifyjs-webpack-plugin":"^1.1.2",watchify:"3.4.0",webpack:"4.12.1","webpack-cli":"^3.0.4"},browserify:{transform:["browserify-shim","jstify"]},browser:{cdb:"./src/cdb.js","cdb.config":"./src/cdb.config.js","cdb.core.util":"./src/core/util.js","cdb.core.Profiler":"./src/core/profiler.js","cdb.log":"./src/cdb.log.js","cdb.errors":"./src/cdb.errors.js","cdb.templates":"./src/cdb.templates.js",geojson:"./vendor/GeoJSON.js","html-css-sanitizer":"./vendor/html-css-sanitizer-bundle.js",mousewheel:"./vendor/mousewheel.js",mwheelIntent:"./vendor/mwheelIntent.js"},"browserify-shim":{geojson:"GeoJSON","html-css-sanitizer":"html",mousewheel:{depends:["jquery:jQuery"]},mwheelIntent:{depends:["jquery:jQuery"]}},files:["dist","node_modules/cdb","src","themes","vendor"],main:"src/index.js",config:{root:"."},scripts:{test:"grunt test","test:browser":"grunt dev",lint:"eslint .","lint:fix":"eslint . --fix",build:"rm -rf dist/public; NODE_ENV=production webpack --progress --config webpack/webpack.config.js && NODE_ENV=production webpack --progress --config webpack/webpack.min.config.js","build:watch":"NODE_ENV=development webpack --progress -w --config webpack/webpack.config.js","build:internal":"grunt build",docs:"rm -rf docs/public; jsdoc --configure config/jsdoc/public-conf.json","docs:internal":"rm -rf docs/internal; jsdoc --configure config/jsdoc/internal-conf.json",bump:"npm version prerelease","bump:patch":"npm version patch","bump:minor":"npm version minor",postversion:"git push origin HEAD --follow-tags",release:"./scripts/release.sh"},watch:{docs:"src/**/*.js"}}},function(t,o,n){var s=n(122);t.exports={error:function(){console.error.apply(console,arguments)},log:function(){console.log.apply(console,arguments)},info:function(){console.log.apply(console,arguments)},debug:function(){s.DEBUG&&console.log.apply(console,arguments)}}},function(t,o,n){var s=n(133).getVersion("latest"),a={NODE:"node",NUMBER:"number",STRING:"string",ENUM:"enum"},c="source",d={};d[c]=[];var l={},f=s.analyses;if(!f)throw new Error("Error loading the reference for Camshaft analyses");for(var p in f){var m=f[p].params;for(var _ in m){l[p]=l[p]||[],l[p].push(_),d[p]=d[p]||[];var b=m[_].type;b===a.NODE&&d[p].push(_)}}t.exports={getSourceNamesForAnalysisType:function(A){var S=d[A];if(!S)throw new Error("source names for analysis of type "+A+" couldn't be found");return S},getParamNamesForAnalysisType:function(A){var S=l[A];if(!S)throw new Error("param names for analysis of type "+A+" couldn't be found");return S}}},function(t,o,n){var s=n(0),a=n(1),c=n(9),d=n(28),l=n(16),f=function(x){if(x=x||{},!x.engine)throw new Error("engine is required");this._engine=x.engine,this._apiKey=x.apiKey,this._authToken=x.authToken,this._camshaftReference=x.camshaftReference||d,this._analysisNodes=new a.Collection};f.prototype.analyse=function(b){b=s.clone(b);var x=this.findNodeById(b.id),A=this._getAnalysisAttributesFromAnalysisDefinition(b);return x?x.set(A):(this._apiKey&&(A.apiKey=this._apiKey),this._authToken&&(A.authToken=this._authToken),x=new c(A,{camshaftReference:this._camshaftReference,engine:this._engine}),this._analysisNodes.add(x),x.bind("destroy",this._onAnalysisRemoved,this)),x},f.prototype._getAnalysisAttributesFromAnalysisDefinition=function(b){var x={},A=b.type,S=this._camshaftReference.getSourceNamesForAnalysisType(A);return s.each(S,function(E){var F=b.params[E];F&&(x[E]=this.analyse(F))},this),s.omit(s.extend(b,b.params,x),"params")},f.prototype.createAnalysisForLayer=function(b,x){return this.analyse({id:b,type:"source",params:{query:x}})},f.prototype.findNodeById=function(b){return this._analysisNodes.get(b)},f.prototype._onAnalysisRemoved=function(b){this._analysisNodes.remove(b),b.unbind("destroy",this._onAnalysisRemoved)},f.getUniqueAnalysisNodes=function(b,x){var A={},S=f.getAnalysisList(b,x);return s.each(S,function(E){E.getNodesCollection().each(function(F){A[F.get("id")]=F})}),s.map(A,function(E){return E},this)},f.getAnalysisList=function(b,x){var A=p(b),S=m(x);return A.concat(S)};function p(b){var x=_(b);return s.chain(x).map(function(A){return A.getSource()}).compact().value()}function m(b){return b.chain().map(function(x){return x.getSource()}).compact().value()}function _(b){return b.filter(function(x){return l.isCartoDBLayer(x)||l.isTorqueLayer(x)})}t.exports=f},function(t,o){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch{typeof window=="object"&&(n=window)}t.exports=n},function(t,o,n){var s=n(0),a={second:{unit:"second",factor:1},minute:{unit:"minute",factor:1},hour:{unit:"hour",factor:1},day:{unit:"day",factor:1},week:{unit:"day",factor:7},month:{unit:"month",factor:1},quarter:{unit:"month",factor:3},year:{unit:"month",factor:12},decade:{unit:"month",factor:120},century:{unit:"month",factor:1200},millennium:{unit:"month",factor:12e3}},c={};function d(p,m,_){for(var b=null,x=!0,A=m.length-1;A>=0&&x&&(!s.isFinite(_)||A>=_);A--)m[A]?x=!1:b=A;return b!==null?p.slice(0,b):p}c.fillTimestampBuckets=function(p,m,_,b,x,A){for(var S=[],E=!1,F=0;F<b;F++){E=p[F]!==void 0,S.push(E);var v=this.add(m,F,_),P=this.add(m,F+1,_);p[F]=s.extend({bin:F,start:v,end:P-1,next:P,freq:0},p[F]),delete p[F].timestamp}return x==="totals"?p:d(p,S,A)},c.fillNumericBuckets=function(p,m,_,b){for(var x=0;x<b;x++){var A=m+x*_,S=m+(x+1)*_,E=x+1===b,F=E&&p[x]?p[x].max:S,v=s.extend({},{bin:x,start:A,end:F,freq:0},p[x]);p[x]=v}},c.hasChangedSomeOf=function(p,m){return s.some(s.keys(m),function(_){return s.contains(p,_)})},c.add=function(p,m,_){if(!a.hasOwnProperty(_))throw Error('aggregation "'+_+'" is not defined');var b=new Date(p*1e3),x=a[_].unit,A=a[_].factor,S=m*A;switch(x){case"second":return b.setUTCSeconds(b.getUTCSeconds()+S)/1e3;case"minute":return b.setUTCMinutes(b.getUTCMinutes()+S)/1e3;case"hour":return b.setUTCHours(b.getUTCHours()+S)/1e3;case"day":return b.setUTCDate(b.getUTCDate()+S)/1e3;case"month":var E=b.getUTCDate();return b.setUTCDate(1),b.setUTCMonth(b.getUTCMonth()+S),b.setUTCDate(Math.min(E,l(b.getUTCFullYear(),b.getUTCMonth()))),b.getTime()/1e3;default:return 0}};function l(p,m){return[31,f(p)?29:28,31,30,31,30,31,31,30,31,30,31][m]}function f(p){return p%4===0&&p%100!==0||p%400===0}t.exports=c},function(t,o,n){var s=n(0),a=n(1),c=n(45),d=n(20),l=n(64),f=n(31),p=n(63);t.exports=d.extend({defaults:s.extend({type:"histogram",totalAmount:0,filteredAmount:0,hasNulls:!1,localTimezone:!1},d.prototype.defaults),_getDataviewSpecificURLParams:function(){var _=[];if(s.isNumber(this.get("own_filter")))_.push("own_filter="+this.get("own_filter")),this.get("column_type")==="number"&&this.get("bins")&&_.push("bins="+this.get("bins"));else{var b=this.getCurrentOffset();this.get("column_type")==="number"&&this.get("bins")?_.push("bins="+this.get("bins")):this.get("column_type")==="date"&&(_.push("aggregation="+(this.get("aggregation")||"auto")),s.isFinite(b)&&_.push("offset="+b));var x=this.get("start"),A=this.get("end");s.isFinite(x)&&s.isFinite(A)&&(_.push("start="+x),_.push("end="+A))}return _},initialize:function(_,b){this._localOffset=p.getLocalOffset(),this._totals=new l({bins:this.get("bins"),aggregation:this.get("aggregation"),offset:this.get("offset"),column_type:this.get("column_type"),apiKey:b&&b.engine&&b.engine.getApiKey(),authToken:b&&b.engine&&b.engine.getAuthToken(),localTimezone:this.get("localTimezone"),localOffset:this._localOffset,start:this.get("start"),end:this.get("end")}),d.prototype.initialize.apply(this,arguments),this._data=new a.Collection(this.get("data")),_&&(_.min||_.max)&&this.filter&&this.filter.setRange(this.get("min"),this.get("max"))},_initBinds:function(){d.prototype._initBinds.apply(this),this._updateURLBinding(),this._totals.bind("loadModelCompleted",this._onTotalsDataFetched,this),this._totals.once("loadModelCompleted",this._updateBindings,this),this._totals.bind("error",this.setUnavailable,this),this._totals.bind("error",this._onTotalsError,this),this.on("change:column",this._onColumnChanged,this),this.on("change:localTimezone",this._onLocalTimezoneChanged,this),this.on("change",this._onFieldsChanged,this),this.on("change:column_type",this._onColumnTypeChanged,this)},_onLocalTimezoneChanged:function(){this._totals.set("localTimezone",this.get("localTimezone"))},_updateURLBinding:function(){this.off("change:url"),this.on("change:url",this._onUrlChanged,this)},_updateBindings:function(){this._onChangeBinds(),this._updateURLBinding()},enableFilter:function(){this.set("own_filter",1)},disableFilter:function(){this.unset("own_filter")},getData:function(){return this._data.toJSON()},getUnfilteredData:function(){return this._totals.get("data")},getUnfilteredDataModel:function(){return this._totals},getSize:function(){return this._data.size()},getColumnType:function(){return this.get("column_type")},hasNulls:function(){return this.get("hasNulls")},parse:function(_){var b=_.aggregation||this._totals&&this._totals.get("aggregation"),x=s.isFinite(_.bins_count)?_.bins_count:this.get("bins"),A=_.bin_width,S=this.get("column_type")==="date"?_.timestamp_start:_.bins_start,E={data:[],filteredAmount:0,nulls:0,totalAmount:0};return this.has("error")||(E.data=new Array(x),s.each(_.bins,function(F){E.data[F.bin]=F}),this.set({aggregation:b},{silent:!0}),this.get("column_type")==="date"?(E.data=f.fillTimestampBuckets(E.data,S,b,x,"filtered",this._totals.get("data").length),x=E.data.length):f.fillNumericBuckets(E.data,S,A,x),this._data&&this._data.reset(E.data),E.totalAmount=this._calculateTotalAmount(E.data),E.filteredAmount=this._calculateFilteredAmount(this.filter,this._data),E.nulls=_.nulls,E.bins=x,_.nulls!=null&&(E=s.extend({},E,{nulls:_.nulls,hasNulls:!0}))),E},_onFilterChanged:function(_){this.set("filteredAmount",this._calculateFilteredAmount(_,this._data)),d.prototype._onFilterChanged.apply(this,arguments)},_onColumnChanged:function(){this._totals.set({column_type:this.get("column_type"),column:this.get("column"),start:null,end:null}),this.set("aggregation",void 0,{silent:!0}),this._reloadAndForceFetch()},_calculateTotalAmount:function(_){return s.reduce(_,function(b,x){var A=x&&x.freq?x.freq:0;return b+A},0)},_calculateFilteredAmount:function(_,b){var x=0;if(_&&_.get("min")!==void 0&&_.get("max")!==void 0){var A=this._findBinsIndexes(b,_.get("min"),_.get("max"));x=this._sumBinsFreq(b,A.start,A.end)}return x},_findBinsIndexes:function(_,b,x){var A=_.findWhere({start:Math.min(b,x)}),S=_.findWhere({end:Math.max(b,x)});return{start:A&&A.get("bin"),end:S&&S.get("bin")}},_sumBinsFreq:function(_,b,x){return s.reduce(_.slice(b,x+1),function(A,S){return(S.get("freq")||0)+A},0)},getDistributionType:function(_){var b=_||this.get("data"),x=function(X){return X.freq},A=c.max(b,x)-c.min(b,x),S=c.mean(b,x);if(A<S*.1)return"F";var E=c.sum(b,x),F=b.map(function(le){return 100*le.freq/E}),v=F.map(function(le,X){var oe=F[X+1];return le>oe?-1:Math.abs(le-oe)<=.05?0:1});v.pop();var P=c.max(v),G=c.min(v);if(G===0&&P===0)return"F";if(P<1)return"L";if(G>-1)return"J";var $=s.uniq(v),Z=[[1,-1],[1,0,-1],[1,-1,0],[0,1,-1]],ie=[[-1,1],[-1,0,1],[-1,1,0],[0,-1,1]];return Z.some(function(le){return s.isEqual(le,$)})?"A":ie.some(function(le){return s.isEqual(le,$)})?"U":"S"},toJSON:function(_){var b=this.get("column_type"),x=this.get("offset"),A={column:this.get("column")};return b==="number"&&this.get("bins")?A.bins=this.get("bins"):b==="date"&&(A.aggregation=this.get("aggregation")||"auto",s.isFinite(x)&&(A.offset=x)),{type:"histogram",source:{id:this.getSourceId()},options:A}},_onColumnTypeChanged:function(){this.filter&&this.filter.set("column_type",this.get("column_type"))},_onChangeBinds:function(){d.prototype._onChangeBinds.call(this)},_onUrlChanged:function(){this._totals.set({offset:this.get("offset"),bins:this.get("bins")},{silent:!0}),this._totals.setUrl(this.get("url"))},_onTotalsDataFetched:function(_,b){var x=b.get("start"),A=b.get("end");s.isFinite(x)&&s.isFinite(A)&&this.set({start:x,end:A}),this.set({aggregation:b.get("aggregation")||"auto",offset:b.get("offset")||0,bins:b.get("bins"),error:b.get("error")},{silent:!0});var S=!1;(this.get("column_type")==="date"&&(s.has(this.changed,"aggregation")||s.has(this.changed,"offset"))||this.get("column_type")==="number"&&s.has(this.changed,"bins"))&&(S=!0),S?this._resetFilterAndFetch():this.fetch()},_onFieldsChanged:function(){if(this._setTotalsStartEnd(),!!f.hasChangedSomeOf(["bins","aggregation","offset"],this.changed)){var _=s.has(this.changed,"aggregation")&&s.isUndefined(this.changed.aggregation);this.get("column_type")==="number"&&!_&&this._totals.set("bins",this.get("bins")),this.get("column_type")==="date"&&(this.hasChanged("aggregation")&&this._resetFilter(),this._totals.set({offset:this.get("offset"),aggregation:this.get("aggregation")}))}},_setTotalsStartEnd:function(){var _=this.get("start"),b=this.get("end"),x=f.hasChangedSomeOf(["start","end"],this.changed),A=s.isFinite(_)&&s.isFinite(b),S=this._totals.get("start")!==_||this._totals.get("end")!==b;x&&A&&S&&(this._totals.set({start:_,end:b}),this._totals.refresh())},_resetFilterAndFetch:function(){this._resetFilter(),this.fetch()},_resetFilter:function(){this.disableFilter(),this.filter&&this.filter.unsetRange()},_onTotalsError:function(_,b){var x=b&&this._parseError(b);x&&x.message!=="abort"&&this._triggerStatusError(x)},getCurrentOffset:function(){return this.get("localTimezone")?this._localOffset:this.get("offset")}},{ATTRS_NAMES:d.ATTRS_NAMES.concat(["column","column_type","bins","min","max","aggregation","offset"])})},function(t,o,n){var s=n(1),a=n(0),c=n(73),d="count";t.exports=s.Collection.extend({model:c,initialize:function(f,p){this.aggregationModel=p.aggregationModel,this.aggregation=p.aggregationModel.get("aggregation")},reset:function(f,p){this.aggregationModel.get("aggregation")!==d&&(f=a.filter(f,function(m){var _=m instanceof s.Model,b=_?m.get("value"):m.value;return b!=null})),s.Collection.prototype.reset.call(this,f,p)},comparator:function(f,p){return f.get("name")==="Other"?1:p.get("name")==="Other"?-1:f.get("value")===p.get("value")?f.get("selected")<p.get("selected")?1:-1:f.get("value")<p.get("value")?1:-1},isOtherAvailable:function(){return this.where({agg:!0,name:"Other"}).length>0}})},function(t,o,n){(function(a,c){t.exports=c()})(this,function(){return function(s){var a={};function c(d){if(a[d])return a[d].exports;var l=a[d]={i:d,l:!1,exports:{}};return s[d].call(l.exports,l,l.exports,c),l.l=!0,l.exports}return c.m=s,c.c=a,c.d=function(d,l,f){c.o(d,l)||Object.defineProperty(d,l,{configurable:!1,enumerable:!0,get:f})},c.n=function(d){var l=d&&d.__esModule?function(){return d.default}:function(){return d};return c.d(l,"a",l),l},c.o=function(d,l){return Object.prototype.hasOwnProperty.call(d,l)},c.p="",c(c.s=0)}([function(s,a,c){var d=function(){function b(x,A){for(var S=0;S<A.length;S++){var E=A[S];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(x,E.key,E)}}return function(x,A,S){return A&&b(x.prototype,A),S&&b(x,S),x}}();function l(b,x){if(!(b instanceof x))throw new TypeError("Cannot call a class as a function")}var f=c(1),p=c(4),m=c(5),_=function(){function b(x,A){l(this,b),x&&this._bindMap(x),this._tileLoader=new m(A),this._tileSize=256,this._eventEmitter=new p}return d(b,[{key:"tilejson",value:function(A){return this._tileLoader.setUrl(A.grids[0]),this}},{key:"map",value:function(A){return this._bindMap(A),this}},{key:"_bindMap",value:function(A){this._map=new f(A),this._map.on("click",this._onMapClick.bind(this)),this._map.on("mousemove",this._onMapMouseMove.bind(this))}},{key:"on",value:function(A,S){switch(A){case"on":this._eventEmitter.addEventListener("mousemove",S),this._eventEmitter.addEventListener("click",S);break;case"off":this._eventEmitter.addEventListener("featureout",S);break;case"error":this._eventEmitter.addEventListener("error",S);break}return this}},{key:"_onMapClick",value:function(A){var S=this,E=this._map.cloneEvent(A),F=this._getTileCoordsFromMouseEvent(E);this._tileLoader.loadTile(F.z,F.x,F.y).then(function(v){if(v!=="fetching")return S._objectForEvent(v,E,"click")}).catch(function(v){S._eventEmitter.dispatchEvent("error",v)})}},{key:"_onMapMouseMove",value:function(A){var S=this,E=this._map.cloneEvent(A),F=this._getTileCoordsFromMouseEvent(E);this._tileLoader.loadTile(F.z,F.x,F.y).then(function(v){if(v!=="fetching")return S._objectForEvent(v,E,"mousemove")}).catch(function(v){S._eventEmitter.dispatchEvent("error",v)})}},{key:"_getTileCoordsFromMouseEvent",value:function(A){var S=this._map.project(A),E=this._unscale(S,this._tileSize);return E.z=Math.round(this._map.getZoom()),E}},{key:"_unscale",value:function(A,S){return{x:Math.floor(A.x/S),y:Math.floor(A.y/S)}}},{key:"_objectForEvent",value:function(A,S,E){var F=this._map.project(S),v=4,P=this._unscale(F,this._tileSize),G=P.x,$=P.y,Z=Math.pow(2,this._map.getZoom());if(G=(G+Z)%Z,$=($+Z)%Z,A&&A.grid){var ie=Math.floor((F.x-G*this._tileSize)/v),le=Math.floor((F.y-$*this._tileSize)/v),X=this._utfDecode(A.grid[le].charCodeAt(ie)),oe=A.keys[X];A.data.hasOwnProperty(oe)&&(S.data=A.data[oe])}S.e=S.originalEvent||{type:E},this._triggerEvent(E,S)}},{key:"_triggerEvent",value:function(A,S){if(!S.data){this._eventEmitter.dispatchEvent("featureout",{});return}if(A==="mousemove"){this._eventEmitter.dispatchEvent("mousemove",S);return}A==="click"&&(this._eventEmitter.dispatchEvent("featureout",{}),this._eventEmitter.dispatchEvent("click",S))}},{key:"remove",value:function(){this._eventEmitter.clear(),this._map.off("click"),this._map.off("mousemove")}},{key:"_utfDecode",value:function(A){return A>=93&&A--,A>=35&&A--,A-32}}]),b}();s.exports={Interactive:_}},function(s,a,c){var d=c(2),l=c(3);function f(p){return p.__gm?new d(p):new l(p)}s.exports=f},function(s,a,c){var d=function(){function p(m,_){for(var b=0;b<_.length;b++){var x=_[b];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(m,x.key,x)}}return function(m,_,b){return _&&p(m.prototype,_),b&&p(m,b),m}}();function l(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}var f=function(){function p(m){l(this,p),this._map=m,this._listeners={}}return d(p,[{key:"project",value:function(_){var b=_.latLng,x=this._map.getProjection().fromLatLngToPoint(b),A=Math.pow(2,this.getZoom());return{x:Math.floor(A*x.x),y:Math.floor(A*x.y)}}},{key:"getZoom",value:function(){return this._map.getZoom()}},{key:"on",value:function(_,b){this._listeners[_]=this._map.addListener(_,b)}},{key:"off",value:function(_){this._listeners[_]&&this._listeners[_].remove()}},{key:"cloneEvent",value:function(_){return{da:_.da,latLng:_.latLng,pixel:_.pixel}}}]),p}();s.exports=f},function(s,a,c){var d=function(){function p(m,_){for(var b=0;b<_.length;b++){var x=_[b];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(m,x.key,x)}}return function(m,_,b){return _&&p(m.prototype,_),b&&p(m,b),m}}();function l(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}var f=function(){function p(m){l(this,p),this._map=m,this._listeners={}}return d(p,[{key:"project",value:function(_){var b=_.latlng.wrap();return this._map.project(b,this._map.getZoom()).floor()}},{key:"getZoom",value:function(){return this._map.getZoom()}},{key:"on",value:function(_,b){return this._listeners[_]=b,this._map.on(_,b)}},{key:"off",value:function(_){return this._map.off(_,this._listeners[_])}},{key:"cloneEvent",value:function(_){return{containerPoint:_.containerPoint,latlng:_.latlng,layerPoint:_.layerPoint,originalEvent:_.originalEvent,target:_.target,type:_.type}}}]),p}();s.exports=f},function(s,a,c){var d=function(){function p(m,_){for(var b=0;b<_.length;b++){var x=_[b];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(m,x.key,x)}}return function(m,_,b){return _&&p(m.prototype,_),b&&p(m,b),m}}();function l(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}var f=function(){function p(){l(this,p),this._listeners={click:void 0,move:void 0,out:void 0,error:void 0}}return d(p,[{key:"dispatchEvent",value:function(_,b){switch(_){case"mousemove":this._listeners.move&&this._listeners.move(b);break;case"click":this._listeners.click&&this._listeners.click(b);break;case"featureout":this._listeners.out&&this._listeners.out();break;case"error":this._listeners.error&&this._listeners.error(b)}}},{key:"addEventListener",value:function(_,b){switch(_){case"mousemove":this._listeners.move=b;break;case"click":this._listeners.click=b;break;case"featureout":this._listeners.out=b;break;case"error":this._listeners.error=b}}},{key:"removeEventListener",value:function(_){switch(_){case"mousemove":delete this._listeners.move;break;case"click":delete this._listeners.click;break;case"featureout":delete this._listeners.out;break;case"error":delete this._listeners.error}}},{key:"clear",value:function(){this._listeners={click:void 0,move:void 0,out:void 0,error:void 0}}}]),p}();s.exports=f},function(s,a,c){var d=function(){function p(m,_){for(var b=0;b<_.length;b++){var x=_[b];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(m,x.key,x)}}return function(m,_,b){return _&&p(m.prototype,_),b&&p(m,b),m}}();function l(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}var f=function(){function p(m){l(this,p),this._url=m,this._cache={}}return d(p,[{key:"setUrl",value:function(_){this._url=_}},{key:"loadTile",value:function(_,b,x){var A=this;return this._cache[_+"_"+b+"_"+x]?Promise.resolve(this._cache[_+"_"+b+"_"+x]):(this._cache[_+"_"+b+"_"+x]="fetching",fetch(this._buildTileUrl(_,b,x)).then(this._handleLimitErrors).then(function(S){return A._cache[_+"_"+b+"_"+x]=S,S}))}},{key:"_buildTileUrl",value:function(_,b,x){var A=this._url;return A=A.replace(/{z}/,_),A=A.replace(/{x}/,b),A=A.replace(/{y}/,x),A}},{key:"_handleLimitErrors",value:function(_){return _.status===429?_.json().then(function(b){return Promise.reject(b)}):_.json()}}]),p}();s.exports=f}])})},function(t,o,n){var s=n(25);function a(c,d){d=d||{},this.interaction=[],this.nativeMap=d.nativeMap,this._mapModel=d.mapModel,c.on("change:urls",this._reload,this),c.onLayerVisibilityChanged(this._reload.bind(this)),this._reload()}a.prototype={_reload:function(){throw new Error("_reload must be implemented")},_reloadInteraction:function(){this._clearInteraction(),this.model.forEachGroupedLayer(function(d,l){d.isVisible()&&(d.isInteractive()||this._mapModel&&this._mapModel.isFeatureInteractivityEnabled())&&this._enableInteraction(l)},this)},_clearInteraction:function(){for(var d in this.interaction)this.interaction.hasOwnProperty(d)&&this.interaction[d]&&(this.interaction[d].remove(),this.interaction[d]=null)},_enableInteraction:function(d){var l=this,f=this._generateTileJSON(d);if(f){var p=this.interaction[d];p&&p.remove(),this.interaction[d]=new this.interactionClass().map(this.nativeMap).tilejson(f).on("on",function(m){l._interactionDisabled||(m.layer=d,l._manageOnEvents(l.nativeMap,m))}).on("off",function(m){l._interactionDisabled||(m=m||{},m.errors!=null&&l._manageInteractivityErrors(m),m.layer=d,l._manageOffEvents(l.nativeMap,m))})}},_manageInteractivityErrors:function(d){var l=s(d);l.length>0&&this.trigger("featureError",l[0])},_generateTileJSON:function(d){if(this.model.hasURLs())return{tilejson:"2.0.0",scheme:"xyz",grids:this.model.getGridURLTemplatesWithSubdomains(d),tiles:this.model.getTileURLTemplatesWithSubdomains(),formatter:function(f,p){return p}}},error:function(d){},tilesOk:function(){}},t.exports=a},function(t,o,n){t.exports=function(s,a,c){if(c){var d={data:void 0,latLng:void 0};a.feature&&(d.data=a.feature),a.latlng&&(d.latLng={lat:a.latlng[0],lng:a.latlng[1]}),a.position&&(d.position={x:a.position.x,y:a.position.y}),c.trigger(s,d)}}},function(t,o,n){function s(a,c){this._type=a||"",this._column=c.getColumn(),this._mapping=c.getMapping(),this._property=c.getProperty()}s.prototype.getType=function(){return this._type},s.prototype.getColumn=function(){return this._column},s.prototype.getMapping=function(){return this._mapping},s.prototype.getProperty=function(){return this._property},t.exports=s},function(t,o,n){var s=n(0),a=n(1);function c(){}s.extend(c.prototype,a.Events),c.prototype.$setError=function(d){this._error=d,this.trigger("error",d)},c.prototype.$setEngine=function(d){if(this._engine&&this._engine!==d)throw new Error("CartoCSS engine cannot be changed");this._engine=d},c.prototype.$getEngine=function(){return this._engine},t.exports=c},function(t,o,n){var s=n(0),a=n(1),c=function(f){return s.map(f,function(p){var m={};return m[p.name]=p.title,m})},d=a.Collection.extend({equals:function(f){var p=this.toJSON();return s.isEqual(c(p),c(f))}});t.exports=d},function(t,o,n){var s=n(0),a=n(1);function c(d,l,f){f=f||{},this._id=f.id||c.$generateId()}s.extend(c.prototype,a.Events),c.prototype.getId=function(){return this._id},c.$nextId=0,c.$generateId=function(){return"L"+ ++c.$nextId},c.prototype.$getInternalModel=function(){return this._internalModel},t.exports=c},function(t,o,n){var s=n(24).WINDSHAFT_ERRORS,a=function(f,p,m){this._error=f,this.origin=m||"windshaft",this.type=d(f.type,p,s.GENERIC),this.subtype=f.subtype,this.message=c(f.message),this.context=f.context,this.isLayerError(f.type)&&(this.context=f.layer&&f.layer.context,this.layerId=f.layer&&f.layer.id),this.isAnalysisError(f.type)&&f.analysis&&(this.context=f.analysis.context,this.analysisId=f.analysis.node_id||f.analysis.id)};a.prototype.isGlobalError=function(l){return!this.isLayerError(l)&&!this.isAnalysisError(l)},a.prototype.isLayerError=function(l){return l=l||this._error.type,l===s.LAYER},a.prototype.isAnalysisError=function(l){return l=l||this._error.type,l===s.ANALYSIS};function c(l){var f=256;return l&&l.length>f?l.substring(0,f):l}function d(l,f,p){return!l||l===s.UNKNOWN?f||(l!==s.UNKNOWN?p:s.UNKNOWN):l}t.exports=a},function(t,o,n){t.exports={MAPS_API_BASE_URL:"api/v1/map"}},function(t,o,n){var s=n(132);t.exports.getVersion=function(a){if(a==="latest")a=s.target;else if(!s.versions.includes(a))throw new Error('Invalid camshaft-reference version: "'+a+'". Valid versions are: '+s.versions.join(", ")+".");return n(131)("./"+a+"/reference.json")},t.exports.versions=s.versions},function(t,o,n){var s=n(0),a=n(137),c=n(135),d=n(1),l=n(126),f=n(125),p=n(124),m=n(123),_=n(117),b=n(116),x=n(115),A=n(114),S=n(29),E=n(41),F=100;function v(P){if(!P)throw new Error("new Engine() called with no parameters");this._isNamedMap=P.templateName!==void 0,this._timeout=null,this._stackCalls=[],this._batchOptions={},this._windshaftSettings={urlTemplate:P.serverUrl,userName:P.username,client:P.client,apiKey:P.apiKey,authToken:P.authToken,templateName:P.templateName},this._windshaftClient=new A(this._windshaftSettings),this._eventEmmitter=s.extend({},d.Events),this._analysisPoller=new a,this._layersCollection=new p,this._dataviewsCollection=new f,this._cartoLayerGroup=new l({apiKey:P.apiKey,authToken:P.authToken},{layersCollection:this._layersCollection}),this._bindCartoLayerGroupError(),this._modelUpdater=new m({dataviewsCollection:this._dataviewsCollection,layerGroupModel:this._cartoLayerGroup,layersCollection:this._layersCollection})}v.prototype.getLayerGroup=function(){return this._cartoLayerGroup},v.prototype.getApiKey=function(){return this._windshaftSettings&&this._windshaftSettings.apiKey},v.prototype.getAuthToken=function(){return this._windshaftSettings&&this._windshaftSettings.authToken},v.prototype.on=function(P,G,$){this._eventEmmitter.on(P,G,$)},v.prototype.off=function(P,G,$){this._eventEmmitter.off(P,G,$)},v.prototype.reload=function(P){return P=P||{},new Promise(function(G,$){this._batchOptions=s.pick({sourceId:P.sourceId,forceFetch:this._batchOptions.forceFetch||P.forceFetch,includeFilters:P.includeFilters},s.negate(s.isUndefined)),this._stackCalls.push({success:P.success,error:P.error,resolve:G,reject:$});var Z=function(){this._timeout=null,this._performReload(this._batchOptions).then(function(){this._stackCalls.forEach(function(ie){ie.success&&ie.success(),ie.resolve()}),this._stackCalls=[],this._batchOptions={}}.bind(this)).catch(function(ie){this._stackCalls.forEach(function(le){le.error&&le.error(ie),le.reject(ie)}),this._stackCalls=[],this._batchOptions={}}.bind(this))}.bind(this);clearTimeout(this._timeout),this._timeout=setTimeout(Z,F)}.bind(this))},v.prototype._performReload=function(P){return new Promise(function(G,$){var Z=this._buildWindshaftOptions(P,function(_e){this._onReloadSuccess(_e,P.sourceId,P.forceFetch),G()}.bind(this),function(_e){var Re=this._onReloadError(_e);$(Re)}.bind(this));try{var ie=this._buildParams(Z.includeFilters),le=this._getSerializer().serialize(this._layersCollection,this._dataviewsCollection),X=new b(le,ie,Z);this._eventEmmitter.trigger(v.Events.RELOAD_STARTED),this._windshaftClient.instantiateMap(X)}catch(_e){var oe=new E({message:_e.message});this._manageClientError(oe,Z)}}.bind(this))},v.prototype.addLayer=function(P){this._layersCollection.add(P)},v.prototype.removeLayer=function(P){this._layersCollection.remove(P)},v.prototype.moveLayer=function(P,G){var $=this._layersCollection.indexOf(P);$>=0&&$!==G&&this._layersCollection.models.splice(G,0,this._layersCollection.models.splice($,1)[0])},v.prototype.addDataview=function(P){this._dataviewsCollection.add(P)},v.prototype.removeDataview=function(P){this._dataviewsCollection.remove(P)},v.prototype._onReloadSuccess=function(P,G,$){var Z=new x(this._windshaftSettings,P);this._modelUpdater.updateModels(Z,G,$),this._restartAnalysisPolling(),this._eventEmmitter.trigger(v.Events.RELOAD_SUCCESS)},v.prototype._onReloadError=function(P){var G=this._getSimpleWindshaftError(P);return this._modelUpdater.setErrors(P),this._eventEmmitter.trigger(v.Events.RELOAD_ERROR,G),G},v.prototype._buildWindshaftOptions=function(P,G,$){return s.extend({includeFilters:!0,success:G,error:$},s.pick(P,"sourceId","forceFetch","includeFilters"))},v.prototype._buildParams=function(P){var G={};if(G.client=this._windshaftSettings.client,P&&!s.isEmpty(this._dataviewsCollection.getFilters())&&(G.filters=this._dataviewsCollection.getFilters()),this._windshaftSettings.apiKey)return G.api_key=this._windshaftSettings.apiKey,G;if(this._windshaftSettings.authToken)return G.auth_token=this._windshaftSettings.authToken,G;console.warn("Engine initialized with no apiKeys neither authToken")},v.prototype._restartAnalysisPolling=function(){var P=S.getUniqueAnalysisNodes(this._layersCollection,this._dataviewsCollection);this._analysisPoller.resetAnalysisNodes(P)},v.prototype._getSerializer=function(){return this._isNamedMap?_:c},v.prototype._manageClientError=function(P,G){this._modelUpdater.setErrors([P]),G.error&&G.error([P])},v.prototype._bindCartoLayerGroupError=function(){this._cartoLayerGroup.on("all",function(P,G){P.lastIndexOf("error:",0)===0&&(G=new E(G),this._eventEmmitter.trigger(v.Events.LAYER_ERROR,G))},this)},v.prototype._getSimpleWindshaftError=function(P){var G=s.find(P,function($){return $.isGlobalError()});return!G&&P&&P.length>0&&(G=P[0]),G},v.Events={RELOAD_STARTED:"reload-started",RELOAD_SUCCESS:"reload-success",RELOAD_ERROR:"reload-error",LAYER_ERROR:"layer-error"},t.exports=v},function(t,o,n){n.r(o);var s=function(B,w){return B<w?-1:B>w?1:B>=w?0:NaN},a=function(B){return B.length===1&&(B=c(B)),{left:function(w,R,D,z){for(D==null&&(D=0),z==null&&(z=w.length);D<z;){var j=D+z>>>1;B(w[j],R)<0?D=j+1:z=j}return D},right:function(w,R,D,z){for(D==null&&(D=0),z==null&&(z=w.length);D<z;){var j=D+z>>>1;B(w[j],R)>0?z=j:D=j+1}return D}}};function c(B){return function(w,R){return s(B(w),R)}}var d=a(s),l=d.right,f=d.left,p=l,m=function(B,w){w==null&&(w=_);for(var R=0,D=B.length-1,z=B[0],j=new Array(D<0?0:D);R<D;)j[R]=w(z,z=B[++R]);return j};function _(B,w){return[B,w]}var b=function(B,w,R){var D=B.length,z=w.length,j=new Array(D*z),K,pe,be,Ee;for(R==null&&(R=_),K=be=0;K<D;++K)for(Ee=B[K],pe=0;pe<z;++pe,++be)j[be]=R(Ee,w[pe]);return j},x=function(B,w){return w<B?-1:w>B?1:w>=B?0:NaN},A=function(B){return B===null?NaN:+B},S=function(B,w){var R=B.length,D=0,z=-1,j=0,K,pe,be=0;if(w==null)for(;++z<R;)isNaN(K=A(B[z]))||(pe=K-j,j+=pe/++D,be+=pe*(K-j));else for(;++z<R;)isNaN(K=A(w(B[z],z,B)))||(pe=K-j,j+=pe/++D,be+=pe*(K-j));if(D>1)return be/(D-1)},E=function(B,w){var R=S(B,w);return R&&Math.sqrt(R)},F=function(B,w){var R=B.length,D=-1,z,j,K;if(w==null){for(;++D<R;)if((z=B[D])!=null&&z>=z)for(j=K=z;++D<R;)(z=B[D])!=null&&(j>z&&(j=z),K<z&&(K=z))}else for(;++D<R;)if((z=w(B[D],D,B))!=null&&z>=z)for(j=K=z;++D<R;)(z=w(B[D],D,B))!=null&&(j>z&&(j=z),K<z&&(K=z));return[j,K]},v=Array.prototype,P=v.slice,G=v.map,$=function(B){return function(){return B}},Z=function(B){return B},ie=function(B,w,R){B=+B,w=+w,R=(z=arguments.length)<2?(w=B,B=0,1):z<3?1:+R;for(var D=-1,z=Math.max(0,Math.ceil((w-B)/R))|0,j=new Array(z);++D<z;)j[D]=B+D*R;return j},le=Math.sqrt(50),X=Math.sqrt(10),oe=Math.sqrt(2),_e=function(B,w,R){var D,z=-1,j,K,pe;if(w=+w,B=+B,R=+R,B===w&&R>0)return[B];if((D=w<B)&&(j=B,B=w,w=j),(pe=Re(B,w,R))===0||!isFinite(pe))return[];if(pe>0)for(B=Math.ceil(B/pe),w=Math.floor(w/pe),K=new Array(j=Math.ceil(w-B+1));++z<j;)K[z]=(B+z)*pe;else for(B=Math.floor(B*pe),w=Math.ceil(w*pe),K=new Array(j=Math.ceil(B-w+1));++z<j;)K[z]=(B-z)/pe;return D&&K.reverse(),K};function Re(B,w,R){var D=(w-B)/Math.max(0,R),z=Math.floor(Math.log(D)/Math.LN10),j=D/Math.pow(10,z);return z>=0?(j>=le?10:j>=X?5:j>=oe?2:1)*Math.pow(10,z):-Math.pow(10,-z)/(j>=le?10:j>=X?5:j>=oe?2:1)}function Se(B,w,R){var D=Math.abs(w-B)/Math.max(0,R),z=Math.pow(10,Math.floor(Math.log(D)/Math.LN10)),j=D/z;return j>=le?z*=10:j>=X?z*=5:j>=oe&&(z*=2),w<B?-z:z}var we=function(B){return Math.ceil(Math.log(B.length)/Math.LN2)+1},Ue=function(){var B=Z,w=F,R=we;function D(z){var j,K=z.length,pe,be=new Array(K);for(j=0;j<K;++j)be[j]=B(z[j],j,z);var Ee=w(be),We=Ee[0],ot=Ee[1],Ge=R(be,We,ot);Array.isArray(Ge)||(Ge=Se(We,ot,Ge),Ge=ie(Math.ceil(We/Ge)*Ge,Math.floor(ot/Ge)*Ge,Ge));for(var at=Ge.length;Ge[0]<=We;)Ge.shift(),--at;for(;Ge[at-1]>ot;)Ge.pop(),--at;var wn=new Array(at+1),lt;for(j=0;j<=at;++j)lt=wn[j]=[],lt.x0=j>0?Ge[j-1]:We,lt.x1=j<at?Ge[j]:ot;for(j=0;j<K;++j)pe=be[j],We<=pe&&pe<=ot&&wn[p(Ge,pe,0,at)].push(z[j]);return wn}return D.value=function(z){return arguments.length?(B=typeof z=="function"?z:$(z),D):B},D.domain=function(z){return arguments.length?(w=typeof z=="function"?z:$([z[0],z[1]]),D):w},D.thresholds=function(z){return arguments.length?(R=typeof z=="function"?z:Array.isArray(z)?$(P.call(z)):$(z),D):R},D},Oe=function(B,w,R){if(R==null&&(R=A),!!(D=B.length)){if((w=+w)<=0||D<2)return+R(B[0],0,B);if(w>=1)return+R(B[D-1],D-1,B);var D,z=(D-1)*w,j=Math.floor(z),K=+R(B[j],j,B),pe=+R(B[j+1],j+1,B);return K+(pe-K)*(z-j)}},Ft=function(B,w,R){return B=G.call(B,A).sort(s),Math.ceil((R-w)/(2*(Oe(B,.75)-Oe(B,.25))*Math.pow(B.length,-1/3)))},Ne=function(B,w,R){return Math.ceil((R-w)/(3.5*E(B)*Math.pow(B.length,-1/3)))},it=function(B,w){var R=B.length,D=-1,z,j;if(w==null){for(;++D<R;)if((z=B[D])!=null&&z>=z)for(j=z;++D<R;)(z=B[D])!=null&&z>j&&(j=z)}else for(;++D<R;)if((z=w(B[D],D,B))!=null&&z>=z)for(j=z;++D<R;)(z=w(B[D],D,B))!=null&&z>j&&(j=z);return j},Me=function(B,w){var R=B.length,D=R,z=-1,j,K=0;if(w==null)for(;++z<R;)isNaN(j=A(B[z]))?--D:K+=j;else for(;++z<R;)isNaN(j=A(w(B[z],z,B)))?--D:K+=j;if(D)return K/D},Et=function(B,w){var R=B.length,D=-1,z,j=[];if(w==null)for(;++D<R;)isNaN(z=A(B[D]))||j.push(z);else for(;++D<R;)isNaN(z=A(w(B[D],D,B)))||j.push(z);return Oe(j.sort(s),.5)},mt=function(B){for(var w=B.length,R,D=-1,z=0,j,K;++D<w;)z+=B[D].length;for(j=new Array(z);--w>=0;)for(K=B[w],R=K.length;--R>=0;)j[--z]=K[R];return j},et=function(B,w){var R=B.length,D=-1,z,j;if(w==null){for(;++D<R;)if((z=B[D])!=null&&z>=z)for(j=z;++D<R;)(z=B[D])!=null&&j>z&&(j=z)}else for(;++D<R;)if((z=w(B[D],D,B))!=null&&z>=z)for(j=z;++D<R;)(z=w(B[D],D,B))!=null&&j>z&&(j=z);return j},Ke=function(B,w){for(var R=w.length,D=new Array(R);R--;)D[R]=B[w[R]];return D},Mt=function(B,w){if(R=B.length){var R,D=0,z=0,j,K=B[z];for(w==null&&(w=s);++D<R;)(w(j=B[D],K)<0||w(K,K)!==0)&&(K=j,z=D);if(w(K,K)===0)return z}},Be=function(B,w,R){for(var D=(R??B.length)-(w=w==null?0:+w),z,j;D;)j=Math.random()*D--|0,z=B[D+w],B[D+w]=B[j+w],B[j+w]=z;return B},Bt=function(B,w){var R=B.length,D=-1,z,j=0;if(w==null)for(;++D<R;)(z=+B[D])&&(j+=z);else for(;++D<R;)(z=+w(B[D],D,B))&&(j+=z);return j},Fn=function(B){if(!(j=B.length))return[];for(var w=-1,R=et(B,gi),D=new Array(R);++w<R;)for(var z=-1,j,K=D[w]=new Array(j);++z<j;)K[z]=B[z][w];return D};function gi(B){return B.length}var fn=function(){return Fn(arguments)};n.d(o,"bisect",function(){return p}),n.d(o,"bisectRight",function(){return l}),n.d(o,"bisectLeft",function(){return f}),n.d(o,"ascending",function(){return s}),n.d(o,"bisector",function(){return a}),n.d(o,"cross",function(){return b}),n.d(o,"descending",function(){return x}),n.d(o,"deviation",function(){return E}),n.d(o,"extent",function(){return F}),n.d(o,"histogram",function(){return Ue}),n.d(o,"thresholdFreedmanDiaconis",function(){return Ft}),n.d(o,"thresholdScott",function(){return Ne}),n.d(o,"thresholdSturges",function(){return we}),n.d(o,"max",function(){return it}),n.d(o,"mean",function(){return Me}),n.d(o,"median",function(){return Et}),n.d(o,"merge",function(){return mt}),n.d(o,"min",function(){return et}),n.d(o,"pairs",function(){return m}),n.d(o,"permute",function(){return Ke}),n.d(o,"quantile",function(){return Oe}),n.d(o,"range",function(){return ie}),n.d(o,"scan",function(){return Mt}),n.d(o,"shuffle",function(){return Be}),n.d(o,"sum",function(){return Bt}),n.d(o,"ticks",function(){return _e}),n.d(o,"tickIncrement",function(){return Re}),n.d(o,"tickStep",function(){return Se}),n.d(o,"transpose",function(){return Fn}),n.d(o,"variance",function(){return S}),n.d(o,"zip",function(){return fn})},function(t,o,n){function s(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function a(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function c(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=n(21),l=function(f){c(p,f);function p(m){s(this,p);var _=a(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,m));return _.JOIN_OPERATOR="OR",_}return p}(d);t.exports=l},function(t,o,n){function s(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function a(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function c(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=n(21),l=function(f){c(p,f);function p(m){s(this,p);var _=a(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,m));return _.JOIN_OPERATOR="AND",_}return p}(d);t.exports=l},function(t,o,n){var s=function(){function _(b,x){for(var A=0;A<x.length;A++){var S=x[A];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(b,S.key,S)}}return function(b,x,A){return x&&_(b.prototype,x),A&&_(b,A),b}}();function a(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}function c(_,b){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:_}function d(_,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);_.prototype=Object.create(b&&b.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(_,b):_.__proto__=b)}var l=n(11),f={lt:{parameters:[{name:"lt",allowedTypes:["Number","Date","Object"]}]},lte:{parameters:[{name:"lte",allowedTypes:["Number","Date","Object"]}]},gt:{parameters:[{name:"gt",allowedTypes:["Number","Date","Object"]}]},gte:{parameters:[{name:"gte",allowedTypes:["Number","Date","Object"]}]},between:{parameters:[{name:"between.min",allowedTypes:["Number","Date"]},{name:"between.max",allowedTypes:["Number","Date"]}]},notBetween:{parameters:[{name:"notBetween.min",allowedTypes:["Number","Date"]},{name:"notBetween.max",allowedTypes:["Number","Date"]}]},betweenSymmetric:{parameters:[{name:"betweenSymmetric.min",allowedTypes:["Number","Date"]},{name:"betweenSymmetric.max",allowedTypes:["Number","Date"]}]},notBetweenSymmetric:{parameters:[{name:"notBetweenSymmetric.min",allowedTypes:["Number","Date"]},{name:"notBetweenSymmetric.max",allowedTypes:["Number","Date"]}]}},p=Object.freeze(Object.keys(f)),m=function(_){d(b,_);function b(x){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},S=arguments[2];a(this,b);var E=c(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,x,S));return E.SQL_TEMPLATES=E._getSQLTemplates(),E.ALLOWED_FILTERS=p,E.PARAMETER_SPECIFICATION=f,E._checkFilters(A),E._filters=A,E}return s(b,[{key:"_getSQLTemplates",value:function(){return{lt:'<%= column %> < <%= value.query ? "(" + value.query + ")" : value %>',lte:'<%= column %> <= <%= value.query ? "(" + value.query + ")" : value %>',gt:'<%= column %> > <%= value.query ? "(" + value.query + ")" : value %>',gte:'<%= column %> >= <%= value.query ? "(" + value.query + ")" : value %>',between:"<%= column %> BETWEEN <%= value.min %> AND <%= value.max %>",notBetween:"<%= column %> NOT BETWEEN <%= value.min %> AND <%= value.max %>",betweenSymmetric:"<%= column %> BETWEEN SYMMETRIC <%= value.min %> AND <%= value.max %>",notBetweenSymmetric:"<%= column %> NOT BETWEEN SYMMETRIC <%= value.min %> AND <%= value.max %>"}}}]),b}(l);t.exports=m},function(t,o,n){var s=function(){function _(b,x){for(var A=0;A<x.length;A++){var S=x[A];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(b,S.key,S)}}return function(b,x,A){return x&&_(b.prototype,x),A&&_(b,A),b}}();function a(_,b){if(!(_ instanceof b))throw new TypeError("Cannot call a class as a function")}function c(_,b){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:_}function d(_,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);_.prototype=Object.create(b&&b.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(_,b):_.__proto__=b)}var l=n(11),f={in:{parameters:[{name:"in",allowedTypes:["Array","String","Object"]}]},notIn:{parameters:[{name:"notIn",allowedTypes:["Array","String","Object"]}]},eq:{parameters:[{name:"eq",allowedTypes:["String","Number","Date","Object"]}]},notEq:{parameters:[{name:"notEq",allowedTypes:["String","Number","Date","Object"]}]},like:{parameters:[{name:"like",allowedTypes:["String"]}]},similarTo:{parameters:[{name:"similarTo",allowedTypes:["String"]}]}},p=Object.freeze(Object.keys(f)),m=function(_){d(b,_);function b(x){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},S=arguments[2];a(this,b);var E=c(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,x,S));return E.SQL_TEMPLATES=E._getSQLTemplates(),E.ALLOWED_FILTERS=p,E.PARAMETER_SPECIFICATION=f,E._checkFilters(A),E._filters=A,E}return s(b,[{key:"_getSQLTemplates",value:function(){return{in:"<% if (value) { %><%= column %> IN (<%= value.query || value %>)<% } else { %>true = false<% } %>",notIn:"<% if (value) { %><%= column %> NOT IN (<%= value.query || value %>)<% } %>",eq:'<%= column %> = <%= value.query ? "(" + value.query + ")" : value %>',notEq:'<%= column %> != <%= value.query ? "(" + value.query + ")" : value %>',like:"<%= column %> LIKE <%= value %>",similarTo:"<%= column %> SIMILAR TO <%= value %>"}}}]),b}(l);t.exports=m},function(t,o,n){var s=n(2);t.exports=s.extend({initialize:function(){this._polygon={}},setPolygon:function(c){this._polygon=c,this.trigger("polygonChanged",c)},getPolygon:function(){return this._polygon},serialize:function(){return encodeURIComponent(JSON.stringify(this.getPolygon()))}})},function(t,o,n){var s=n(0),a=n(6),c=n(50),d=n(3),l=n(8);function f(){this._internalModel=new c,this.type=l.POLYGON}f.prototype=Object.create(a.prototype),f.prototype.setPolygon=function(p){return this._checkPolygon(p),this._internalModel.setPolygon(p),this.trigger("polygonChanged",p),this},f.prototype.resetPolygon=function(){return this.setPolygon({type:"Polygon",coordinates:[]})},f.prototype.getPolygon=function(){return this._internalModel.getPolygon()},f.prototype._checkPolygon=function(p){if(s.isUndefined(p)||s.isUndefined(p.type)||s.isUndefined(p.coordinates)||!s.isString(p.type)||!s.isArray(p.coordinates)||p.type!=="Polygon")throw new d("filter","invalidPolygonObject")},f.prototype.$getInternalModel=function(){return this._internalModel},t.exports=f},function(t,o,n){var s=n(2);t.exports=s.extend({initialize:function(){this._circle={}},setCircle:function(c){this._circle=c,this.trigger("circleChanged",c)},getCircle:function(){return this._circle},serialize:function(){return encodeURIComponent(JSON.stringify(this.getCircle()))}})},function(t,o,n){var s=n(0),a=n(6),c=n(52),d=n(3),l=n(8);function f(){this._internalModel=new c,this.type=l.CIRCLE}f.prototype=Object.create(a.prototype),f.prototype.setCircle=function(p){return this._checkCircle(p),this._internalModel.setCircle(p),this.trigger("circleChanged",p),this},f.prototype.resetCircle=function(){return this.setCircle({lat:0,lng:0,radius:0})},f.prototype.getCircle=function(){return this._internalModel.getCircle()},f.prototype._checkCircle=function(p){if(s.isUndefined(p)||s.isUndefined(p.lat)||s.isUndefined(p.lng)||s.isUndefined(p.radius)||!s.isNumber(p.lat)||!s.isNumber(p.lng)||!s.isNumber(p.radius))throw new d("filter","invalidCircleObject")},f.prototype.$getInternalModel=function(){return this._internalModel},t.exports=f},function(t,o,n){var s=n(0),a=n(2);t.exports=a.extend({initialize:function(d){this._isReady=!1,this._map=d,this._debouncedTriggerBoundsChanged=s.debounce(this._triggerBoundsChanged,200),google.maps.event.addListener(this._map,"bounds_changed",this._debouncedTriggerBoundsChanged.bind(this))},getBounds:function(){if(this._isReady){var d=this._map.getBounds(),l=d.getSouthWest(),f=d.getNorthEast();return{west:l.lng(),south:l.lat(),east:f.lng(),north:f.lat()}}return{west:0,south:0,east:0,north:0}},clean:function(){google.maps.event.clearListeners(this._map,"bounds_changed")},_triggerBoundsChanged:function(){this._isReady=!0,this.trigger("boundsChanged",this.getBounds())}})},function(t,o,n){var s=n(6),a=n(54),c=n(18),d=n(7),l=n(8);function f(m){if(!p(m))throw new Error("Bounding box requires a Google Maps map but got: "+m);this.type=l.BBOX;var _=new a(m);this._internalModel=new c(_),this.listenTo(this._internalModel,"boundsChanged",this._onBoundsChanged)}f.prototype=Object.create(s.prototype),f.prototype.getBounds=function(){return this._internalModel.getBounds()},f.prototype._onBoundsChanged=function(m){this.trigger("boundsChanged",m)},f.prototype.$getInternalModel=function(){return this._internalModel};function p(m){return d.isGoogleMapsLoaded(),m instanceof google.maps.Map}t.exports=f},function(t,o,n){var s=n(0),a=n(2);t.exports=a.extend({initialize:function(d){this._map=d,this._debouncedTriggerBoundsChanged=s.debounce(this._triggerBoundsChanged,200),this._map.on("move zoom",this._debouncedTriggerBoundsChanged,this)},getBounds:function(){var d=this._map.getBounds(),l=d.getSouthWest(),f=d.getNorthEast();return{west:l.lng,south:l.lat,east:f.lng,north:f.lat}},clean:function(){this._map.off("move zoom")},_triggerBoundsChanged:function(){this.trigger("boundsChanged",this.getBounds())}})},function(t,o,n){var s=n(6),a=n(56),c=n(18),d=n(7),l=n(8);function f(m){if(!p(m))throw new Error("Bounding box requires a Leaflet map but got: "+m);this.type=l.BBOX;var _=new a(m);this._internalModel=new c(_),this.listenTo(this._internalModel,"boundsChanged",this._onBoundsChanged)}f.prototype=Object.create(s.prototype),f.prototype.getBounds=function(){return this._internalModel.getBounds()},f.prototype._onBoundsChanged=function(m){this.trigger("boundsChanged",m)},f.prototype.$getInternalModel=function(){return this._internalModel};function p(m){return d.isLeafletLoaded(),m instanceof L.Map}t.exports=f},function(t,o,n){var s=n(0),a=n(6),c=n(18),d=n(3),l=n(8);function f(){this._internalModel=new c,this.type=l.BBOX}f.prototype=Object.create(a.prototype),f.prototype.setBounds=function(p){return this._checkBounds(p),this._internalModel.setBounds(p),this.trigger("boundsChanged",p),this},f.prototype.resetBounds=function(){return this.setBounds({west:0,south:0,east:0,north:0})},f.prototype.getBounds=function(){return this._internalModel.getBounds()},f.prototype._checkBounds=function(p){if(s.isUndefined(p)||s.isUndefined(p.west)||s.isUndefined(p.south)||s.isUndefined(p.east)||s.isUndefined(p.north)||!s.isNumber(p.west)||!s.isNumber(p.south)||!s.isNumber(p.east)||!s.isNumber(p.north))throw new d("filter","invalidBoundsObject")},f.prototype.$getInternalModel=function(){return this._internalModel},t.exports=f},function(t,o,n){var s=n(58),a=n(57),c=n(55),d=n(53),l=n(51),f=n(49),p=n(48),m=n(47),_=n(46);t.exports={BoundingBox:s,BoundingBoxLeaflet:a,BoundingBoxGoogleMaps:c,Circle:d,Polygon:l,Category:f,Range:p,AND:m,OR:_}},function(t,o,n){var s=n(0);function a(l){return l/3600}function c(l,f,p,m){if(!l)return null;var _=s.compact(l),b=s.max(_,function(A){return A.freq||0}),x=s.isFinite(b.freq)&&b.freq!==0?b.freq:null;return{bins:d(_,x),nulls:f||0,offset:a(m),totalAmount:p}}function d(l,f){return l.map(function(p){return{index:p.bin,start:p.start,end:p.end,min:p.min,max:p.max,freq:p.freq,normalized:s.isFinite(p.freq)&&f>0?p.freq/f:0}})}t.exports=c},function(t,o,n){var s=n(0),a=n(10),c=n(32),d=n(60),l=n(5).timeAggregation,f=n(5).isValidTimeAggregation;function p(b,x,A){this._initialize(b,x,A),this._aggregation=this._options.aggregation,this._offset=m(this._options.offset),this._localTimezone=this._options.useLocalTimezone}p.prototype=Object.create(a.prototype),p.prototype.DEFAULTS={aggregation:l.AUTO,offset:0,useLocalTimezone:!1},p.prototype.getData=function(){return this._internalModel?d(this._internalModel.get("data"),this._internalModel.get("nulls"),this._internalModel.get("totalAmount"),this._internalModel.getCurrentOffset()):null},p.prototype.setAggregation=function(b){return this._validateAggregation(b),this._changeProperty("aggregation",b),this},p.prototype.getAggregation=function(){return this._aggregation},p.prototype.setOffset=function(b){return this._validateOffset(b),this._changeProperty("offset",m(b)),this},p.prototype.getOffset=function(){return _(this._offset)},p.prototype.useLocalTimezone=function(b){return this._validateLocalTimezone(b),this._changeProperty("localTimezone",b),this},p.prototype.isUsingLocalTimezone=function(){return this._localTimezone},p.prototype._checkOptions=function(b){if(s.isUndefined(b))throw this._getValidationError("timeSeriesOptionsRequired");this._validateAggregation(b.aggregation),this._validateOffset(b.offset),this._validateLocalTimezone(b.useLocalTimezone)},p.prototype._validateAggregation=function(b){if(!f(b))throw this._getValidationError("timeSeriesInvalidAggregation")},p.prototype._validateOffset=function(b){if(!s.isFinite(b)||Math.floor(b)!==b||b<-12||b>14)throw this._getValidationError("timeSeriesInvalidOffset")},p.prototype._validateLocalTimezone=function(b){if(!s.isBoolean(b))throw this._getValidationError("timeSeriesInvalidUselocaltimezone")},p.prototype._createInternalModel=function(b){this._internalModel=new c({source:this._source.$getInternalModel(),column:this._column,aggregation:this._aggregation,offset:this._offset,localTimezone:this._localTimezone,sync_on_bbox_change:!!this._boundingBoxFilter,sync_on_circle_change:!!this._circleFilter,sync_on_polygon_change:!!this._polygonFilter,enabled:this._enabled,column_type:"date"},{engine:b,bboxFilter:this._boundingBoxFilter&&this._boundingBoxFilter.$getInternalModel(),circleFilter:this._circleFilter&&this._circleFilter.$getInternalModel(),polygonFilter:this._polygonFilter&&this._polygonFilter.$getInternalModel()})};function m(b){return b*3600}function _(b){return b/3600}t.exports=p},function(t,o,n){var s=n(0);function a(d,l,f){if(!d)return null;var p=s.compact(d),m=s.max(p,function(b){return b.freq||0}),_=s.isFinite(m.freq)&&m.freq!==0?m.freq:null;return{bins:c(p,_),nulls:l||0,totalAmount:f}}function c(d,l){return d.map(function(f){return s.extend(f,{normalized:s.isFinite(f.freq)&&l>0?f.freq/l:0})})}t.exports=a},function(t,o,n){var s={};s.getLocalOffset=function(){var a=new Date;return a.getTimezoneOffset()*-60},t.exports=s},function(t,o,n){var s=n(0),a=n(19),c=n(2),d=n(31);t.exports=c.extend({defaults:{url:"",data:[],localTimezone:!1,localOffset:0,hasBeenFetched:!1},url:function(){var f=[],p=this.get("column_type"),m=this._getCurrentOffset(),_=this.get("aggregation")||"auto";if(f.push("no_filters=1"),p==="number"&&this.get("bins")?f.push("bins="+this.get("bins")):p==="date"&&(f.push("aggregation="+_),s.isFinite(m)&&f.push("offset="+m)),this.get("apiKey"))f.push("api_key="+this.get("apiKey"));else if(this.get("authToken")){var b=this.get("authToken");b instanceof Array?s.each(b,function(S){f.push("auth_token[]="+S)}):f.push("auth_token="+b)}var x=this.get("start"),A=this.get("end");return s.isFinite(x)&&s.isFinite(A)&&(f.push("start="+x),f.push("end="+A)),this.get("url")+"?"+f.join("&")},initialize:function(){this.sync=a.bind(this),this._initBinds()},_initBinds:function(){this.on("change:url",function(){this.refresh()},this),this.on("change:aggregation change:offset",function(){this.get("column_type")==="date"&&this.get("aggregation")&&this.refresh()},this),this.on("change:bins",function(){this.get("column_type")==="number"&&this.refresh()},this),this.on("change:localTimezone",function(){this.refresh()},this),this.on("change:column",function(){this.set("aggregation","auto",{silent:!0})}),this.on("sync",function(){this.set("hasBeenFetched",!0)})},setUrl:function(f){if(!f)throw new Error("url not specified");this.set("url",f)},setBins:function(f){this.set("bins",f,{silent:f===void 0})},getData:function(){return this.get("data")},parse:function(f){var p=f.aggregation||this.get("aggregation"),m=f.bins_count||0,_=f.bin_width,b=this.get("column_type")==="date"?f.timestamp_start:f.bins_start,x={};return x.data=new Array(m),p&&(x.aggregation=p,this.set("aggregation",p,{silent:!0})),s.each(f.bins,function(A){x.data[A.bin]=A}),this.get("column_type")==="date"?(x.data=d.fillTimestampBuckets(x.data,b,p,m,"totals"),m=x.data.length):d.fillNumericBuckets(x.data,b,_,m),x.data.length>0&&(x.start=x.data[0].start,x.end=x.data[x.data.length-1].end),x.bins=m,x},refresh:function(){this.fetch()},_getCurrentOffset:function(){return this.get("localTimezone")?this.get("localOffset"):this.get("offset")}})},function(t,o,n){var s=n(0),a=n(10),c=n(32),d=n(62);function l(f,p,m){this._initialize(f,p,m),this._bins=this._options.bins,this._start=this._options.start,this._end=this._options.end}l.prototype=Object.create(a.prototype),l.prototype.DEFAULTS={bins:10},l.prototype.getData=function(){return this._internalModel?d(this._internalModel.get("data"),this._internalModel.get("nulls"),this._internalModel.get("totalAmount")):null},l.prototype.setColumn=function(f){a.prototype.setColumn.apply(this,arguments),this._start=null,this._end=null},l.prototype.setBins=function(f){return this._validateBins(f),this._changeProperty("bins",f),this},l.prototype.getBins=function(){return this._bins},l.prototype.setStartEnd=function(f,p){return this._validateStartEnd(f,p),this._changeProperties({start:f,end:p}),this},l.prototype.getStart=function(){return this._start||this._internalModel.get("start")},l.prototype.getEnd=function(){return this._end||this._internalModel.get("end")},l.prototype.getDistributionType=function(){if(this._internalModel){var f=this._internalModel.getData();return this._internalModel.getDistributionType(f)}return null},l.prototype._validateBins=function(f){if(!s.isFinite(f)||f<1||Math.floor(f)!==f)throw this._getValidationError("histogramInvalidBins")},l.prototype._validateStartEnd=function(f,p){var m=[f,p];if(!s.every(m,s.isUndefined)){var _=s.every(m,function(x){return s.isNumber(x)&&!s.isNaN(x)}),b=s.every(m,s.isNull);if(!_&&!b)throw this._getValidationError("histogramInvalidStartEnd")}},l.prototype._checkOptions=function(f){if(s.isUndefined(f))throw this._getValidationError("histogramOptionsRequired");this._validateBins(f.bins),this._validateStartEnd(f.start,f.end)},l.prototype._createInternalModel=function(f){this._internalModel=new c({source:this._source.$getInternalModel(),column:this._column,bins:this._bins,start:this._start,end:this._end,sync_on_bbox_change:!!this._boundingBoxFilter,sync_on_circle_change:!!this._circleFilter,sync_on_polygon_change:!!this._polygonFilter,enabled:this._enabled,column_type:"number"},{engine:f,bboxFilter:this._boundingBoxFilter&&this._boundingBoxFilter.$getInternalModel(),circleFilter:this._circleFilter&&this._circleFilter.$getInternalModel(),polygonFilter:this._polygonFilter&&this._polygonFilter.$getInternalModel()})},t.exports=l},function(t,o,n){function s(a,c,d){return{nulls:a,operation:c,result:d}}t.exports=s},function(t,o,n){var s=n(0),a=n(20);t.exports=a.extend({defaults:s.extend({type:"formula",data:""},a.prototype.defaults),initialize:function(){a.prototype.initialize.apply(this,arguments),this.on("change:column change:operation",this._reloadAndForceFetch,this)},parse:function(d){return{data:d.result,nulls:d.nulls}},toJSON:function(){return{type:"formula",source:{id:this.getSourceId()},options:{column:this.get("column"),operation:this.get("operation")}}}},{ATTRS_NAMES:a.ATTRS_NAMES.concat(["column","operation"])})},function(t,o,n){var s=n(0),a=n(10),c=n(5),d=n(67),l=n(66);function f(p,m,_){this._initialize(p,m,_),this._operation=this._options.operation}f.prototype=Object.create(a.prototype),f.prototype.setOperation=function(p){return this._checkOperation(p),this._changeProperty("operation",p),this},f.prototype.getOperation=function(){return this._operation},f.prototype.getData=function(){return this._internalModel?l(this._internalModel.get("nulls"),this._operation,this._internalModel.get("data")):null},f.prototype.DEFAULTS={operation:c.operation.COUNT},f.prototype._checkOptions=function(p){if(s.isUndefined(p))throw this._getValidationError("formulaOptionsRequired");this._checkOperation(p.operation)},f.prototype._checkOperation=function(p){if(s.isUndefined(p)||!c.isValidOperation(p))throw this._getValidationError("formulaInvalidOperation")},f.prototype._createInternalModel=function(p){this._internalModel=new d({source:this._source.$getInternalModel(),column:this._column,operation:this._operation,sync_on_bbox_change:!!this._boundingBoxFilter,sync_on_circle_change:!!this._circleFilter,sync_on_polygon_change:!!this._polygonFilter,enabled:this._enabled},{engine:p,bboxFilter:this._boundingBoxFilter&&this._boundingBoxFilter.$getInternalModel(),circleFilter:this._circleFilter&&this._circleFilter.$getInternalModel(),polygonFilter:this._polygonFilter&&this._polygonFilter.$getInternalModel()})},t.exports=f},function(t,o,n){var s=n(0);function a(d,l,f,p,m,_){return d?{count:l,max:f,min:p,nulls:m,operation:_,categories:c(d)}:null}function c(d){return s.map(d,function(l){return{group:l.agg,name:l.name,value:l.value}})}t.exports=a},function(t,o,n){var s=n(2);t.exports=s.extend({isEmpty:function(){throw new Error("Filters must implement the .isEmpty method")},toJSON:function(){throw new Error("Filters must implement the .toJSON method")},remove:function(){this.trigger("destroy",this),this.stopListening()}})},function(t,o,n){var s=n(0),a=n(1),c=n(70);t.exports=c.extend({defaults:{rejectAll:!1},initialize:function(){this.rejectedCategories=new a.Collection,this.acceptedCategories=new a.Collection,this._initBinds()},_initBinds:function(){this.listenTo(this.rejectedCategories,"add remove",function(){this.set("rejectAll",!1)}),this.listenTo(this.acceptedCategories,"add remove",function(){this.set("rejectAll",!1)})},isEmpty:function(){return this.rejectedCategories.size()===0&&this.acceptedCategories.size()===0&&!this.get("rejectAll")},accept:function(l,f){l=s.isArray(l)?l:[l],s.each(l,function(p){var m={name:p},_=this.rejectedCategories.where(m),b=this.acceptedCategories.where(m);_.length>0?this.rejectedCategories.remove(_):b.length||this.acceptedCategories.add(m)},this),f!==!1&&this.applyFilter()},acceptAll:function(){this.set("rejectAll",!1),this.cleanFilter()},isAccepted:function(l){return this.acceptedCategories.where({name:l}).length>0},reject:function(l,f){l=s.isArray(l)?l:[l],s.each(l,function(p){var m={name:p},_=this.acceptedCategories.where(m),b=this.rejectedCategories.where(m);_.length>0?this.acceptedCategories.remove(_):b.length||this.rejectedCategories.add(m)},this),f!==!1&&this.applyFilter()},isRejected:function(l){var f=this.acceptedCategories.size();return this.rejectedCategories.where({name:l}).length>0||f>0&&this.acceptedCategories.where({name:l}).length===0?!0:!!this.get("rejectAll")},rejectAll:function(){this.set("rejectAll",!0),this.cleanFilter()},cleanFilter:function(l){this.acceptedCategories.reset(),this.rejectedCategories.reset(),l!==!1&&this.applyFilter()},applyFilter:function(){this.trigger("change",this)},areAllRejected:function(){return this.get("rejectAll")},toJSON:function(){var l={},f=this.rejectedCategories.size(),p=this.acceptedCategories.size(),m={accept:s.pluck(this.acceptedCategories.toJSON(),"name")},_={reject:s.pluck(this.rejectedCategories.toJSON(),"name")};this.get("rejectAll")?l={accept:[]}:p>0?l=m:f>0&&p===0&&(l=_);var b={};return b[this.get("dataviewId")]=l,b},getAcceptedCategoryNames:function(){return this.acceptedCategories.map(function(l){return l.get("name")})},getRejectedCategoryNames:function(){return this.rejectedCategories.map(function(l){return l.get("name")})}})},function(t,o,n){var s=n(0),a=n(2);t.exports=a.extend({defaults:{url:"",totalCount:0,categoriesCount:0},url:function(){var d=this.get("url"),l=[];if(this.get("apiKey"))d+="?api_key="+this.get("apiKey");else if(this.get("authToken")){var f=this.get("authToken");f instanceof Array?s.each(f,function(p){l.push("auth_token[]="+p)}):l.push("auth_token="+f),d+="?"+l.join("&")}return d},initialize:function(){this.bind("change:url",function(){this.fetch()},this)},setUrl:function(d){this.set("url",d)},parse:function(d){return{categoriesCount:d.categoriesCount,totalCount:s.reduce(s.pluck(d.categories,"value"),function(l,f){return l+f},0)}}})},function(t,o,n){var s=n(2);t.exports=s.extend({defaults:{name:"",agg:!1,value:0}})},function(t,o,n){var s=n(0),a=n(2),c=n(19),d=n(33);t.exports=a.extend({defaults:{q:"",data:[],url:""},url:function(){var f=this.get("url")+"/search?q="+encodeURIComponent(this.get("q"));if(this.get("apiKey"))f+="&api_key="+this.get("apiKey");else if(this.get("authToken")){var p=this.get("authToken");p instanceof Array?s.each(p,function(m){f+="&auth_token[]="+m}):f+="&auth_token="+p}return f},initialize:function(f,p){this._data=new d(null,{aggregationModel:p.aggregationModel}),this.sync=c.bind(this)},fetchIfSearchIsApplied:function(){this.isSearchApplied()&&this.fetch()},setData:function(f){var p=this._parseData(f);this._data.reset(p),this.set("data",p)},getData:function(){return this._data},getSize:function(){return this._data.size()},getCount:function(){return this.getSize()},isValid:function(){var f=this.get("q");return!!f},resetData:function(){this.setData([]),this.set("q","")},getSearchQuery:function(){return this.get("q")},isSearchApplied:function(){return this.isValid()&&this.getSize()>0},_parseData:function(f){var p=[];return s.each(f,function(m){m.agg||p.push({selected:!1,name:(m.category||m.name).toString(),agg:m.agg,value:m.value})},this),p},parse:function(f){var p=this._parseData(f.categories);return this._data.reset(p),{data:p}},fetch:function(f){if(f=f||{},this.trigger("loading",this),f.success)var p=f&&f.success;return a.prototype.fetch.call(this,s.extend(f,{success:function(){p&&p(arguments),this.trigger("loaded",this)}.bind(this),error:function(m,_){(!_||_&&_.statusText!=="abort")&&this.trigger("error",m,_)}.bind(this)}))}})},function(t,o,n){var s=n(0),a=n(20),c=n(74),d=n(72),l=n(33);t.exports=a.extend({defaults:s.extend({type:"category",filterEnabled:!1,categories:6,allCategoryNames:[]},a.prototype.defaults),_getDataviewSpecificURLParams:function(){var p=["own_filter="+(this.get("filterEnabled")?1:0),"categories="+this.get("categories")];return p},initialize:function(p,m){a.prototype.initialize.call(this,p,m),this._rangeModel=new d({apiKey:this._engine.getApiKey(),authToken:this._engine.getAuthToken()}),this._data=new l(null,{aggregationModel:this}),this._searchModel=new c({apiKey:this._engine.getApiKey(),authToken:this._engine.getAuthToken()},{aggregationModel:this}),this.on("change:column change:aggregation change:aggregation_column",this._reloadAndForceFetch,this),this.on("change:categories",this.refresh,this),this.bind("change:url",function(){this._searchModel.set({url:this.get("url")})},this),this.once("change:url",function(){this._rangeModel.setUrl(this.get("url"))},this),this._rangeModel.bind("change:totalCount change:categoriesCount",function(){this.set({totalCount:this._rangeModel.get("totalCount"),categoriesCount:this._rangeModel.get("categoriesCount")})},this),this._bindSearchModelEvents(),p&&p.acceptedCategories&&this.filter.accept(p.acceptedCategories)},_onMapBoundsChanged:function(){a.prototype._onMapBoundsChanged.apply(this,arguments),this._searchModel.fetchIfSearchIsApplied()},_onCircleChanged:function(){a.prototype._onCircleChanged.apply(this,arguments),this._searchModel.fetchIfSearchIsApplied()},_onPolygonChanged:function(){a.prototype._onPolygonChanged.apply(this,arguments),this._searchModel.fetchIfSearchIsApplied()},_bindSearchModelEvents:function(){this.listenTo(this._searchModel,"loading",function(){this.trigger("loading",this)},this),this.listenTo(this._searchModel,"loaded",function(){this.trigger("loaded",this)},this),this.listenTo(this._searchModel,"error",function(p,m){(!m||m&&m.statusText!=="abort")&&this.trigger("error",p,m)},this),this.listenTo(this._searchModel,"change:data",this._onSearchDataChange,this)},_onSearchDataChange:function(){this.getSearchResult().each(function(p){var m=this.filter.isAccepted(p.get("name"));p.set("selected",m)},this),this.trigger("change:searchData",this)},_shouldFetchOnBoundingBoxChange:function(){return a.prototype._shouldFetchOnBoundingBoxChange.call(this)&&!this.isSearchApplied()},_shouldFetchOnCircleChange:function(){return a.prototype._shouldFetchOnCircleChange.call(this)&&!this.isSearchApplied()},_shouldFetchOnPolygonChange:function(){return a.prototype._shouldFetchOnPolygonChange.call(this)&&!this.isSearchApplied()},enableFilter:function(){this.set("filterEnabled",!0)},disableFilter:function(){this.set("filterEnabled",!1)},getSearchQuery:function(){return this._searchModel.getSearchQuery()},setSearchQuery:function(p){this._searchModel.set("q",p)},isSearchValid:function(){return this._searchModel.isValid()},getSearchResult:function(){return this._searchModel.getData()},getSearchCount:function(){return this._searchModel.getCount()},applySearch:function(){this._searchModel.fetch()},isSearchApplied:function(){return this._searchModel.isSearchApplied()},cleanSearch:function(){this._searchModel.resetData()},setupSearch:function(){this.isSearchApplied()||this._searchModel.setData(this._data.toJSON())},getData:function(){return this._data},getSize:function(){return this._data.size()},getCount:function(){return this.get("categoriesCount")},isOtherAvailable:function(){return this._data.isOtherAvailable()},numberOfAcceptedCategories:function(){var p=this.filter.acceptedCategories,m=this.numberOfRejectedCategories(),_=this.getData(),b=_.size(),x=_.reduce(function(A,S){var E=p.where({name:S.get("name")}).length>0;return A+(E?1:0)},0);return m?b-m:x},numberOfRejectedCategories:function(){var p=this.filter.rejectedCategories,m=this.getData();return m.reduce(function(_,b){var x=p.where({name:b.get("name")}).length>0;return _+(x?1:0)},0)},refresh:function(){this.isSearchApplied()?this._searchModel.fetch():this.fetch()},parse:function(p){var m=[],_={},b=p.categories,x=[],A=[];return s.each(b,function(S){var E=S.category;x.push(E);var F=this.filter.isRejected(E);_[E]=!0,m.push({selected:!F,name:E,agg:S.agg,value:S.value})},this),this.get("filterEnabled")&&this.filter.acceptedCategories.each(function(S){var E=S.get("name");A.push(E),_[E]||m.push({selected:!0,name:E,agg:!1,value:0})},this),this._data.reset(m),{allCategoryNames:s.chain(x).union(A).unique().value(),data:m,nulls:p.nulls,min:p.min,max:p.max,count:p.count}},toJSON:function(){return{type:"aggregation",source:{id:this.getSourceId()},options:{column:this.get("column"),aggregation:this.get("aggregation"),aggregationColumn:this.get("aggregation_column")}}}},{ATTRS_NAMES:a.ATTRS_NAMES.concat(["column","aggregation","aggregation_column","acceptedCategories","categories"])})},function(t,o,n){var s=n(0),a=n(10),c=n(5),d=n(75),l=n(71),f=n(69);function p(m,_,b){this.DEFAULTS.operationColumn=_,this._initialize(m,_,b),this._limit=this._options.limit,this._operation=this._options.operation,this._operationColumn=this._options.operationColumn}p.prototype=Object.create(a.prototype),p.prototype.setLimit=function(m){return this._checkLimit(m),this._changeProperty("limit",m,"categories"),this},p.prototype.getLimit=function(){return this._limit},p.prototype.setOperation=function(m){return this._checkOperation(m),this._changeProperty("operation",m,"aggregation"),this},p.prototype.getOperation=function(){return this._operation},p.prototype.setOperationColumn=function(m){return this._checkOperationColumn(m),this._changeProperty("operationColumn",m,"aggregation_column"),this},p.prototype.getOperationColumn=function(){return this._operationColumn},p.prototype.getData=function(){return this._internalModel?f(this._internalModel.get("data"),this._internalModel.get("count"),this._internalModel.get("max"),this._internalModel.get("min"),this._internalModel.get("nulls"),this._operation):null},p.prototype.DEFAULTS={limit:6,operation:c.operation.COUNT},p.prototype._checkOptions=function(m){if(s.isUndefined(m))throw this._getValidationError("categoryOptionsRequired");this._checkLimit(m.limit),this._checkOperation(m.operation),this._checkOperationColumn(m.operationColumn)},p.prototype._checkLimit=function(m){if(s.isUndefined(m))throw this._getValidationError("categoryLimitRequired");if(!s.isNumber(m))throw this._getValidationError("categoryLimitNumber");if(m<=0)throw this._getValidationError("categoryLimitPositive")},p.prototype._checkOperation=function(m){if(s.isUndefined(m)||!c.isValidOperation(m))throw this._getValidationError("categoryInvalidOperation")},p.prototype._checkOperationColumn=function(m){if(s.isUndefined(m))throw this._getValidationError("categoryOperationRequired");if(!s.isString(m))throw this._getValidationError("categoryOperationString");if(s.isEmpty(m))throw this._getValidationError("categoryOperationEmpty")},p.prototype._createInternalModel=function(m){this._internalModel=new d({source:this._source.$getInternalModel(),column:this._column,aggregation:this._operation,aggregation_column:this._operationColumn,categories:this._limit,sync_on_bbox_change:!!this._boundingBoxFilter,sync_on_circle_change:!!this._circleFilter,sync_on_polygon_change:!!this._polygonFilter,enabled:this._enabled},{engine:m,filter:new l,bboxFilter:this._boundingBoxFilter&&this._boundingBoxFilter.$getInternalModel(),circleFilter:this._circleFilter&&this._circleFilter.$getInternalModel(),polygonFilter:this._polygonFilter&&this._polygonFilter.$getInternalModel()})},t.exports=p},function(t,o,n){var s=n(76),a=n(68),c=n(65),d=n(61),l=n(5).status,f=n(5).timeAggregation;t.exports={Category:s,Formula:a,Histogram:c,TimeSeries:d,status:l,timeAggregation:f}},function(t,o,n){var s=n(0),a=n(38),c=n(3),d=n(4),l="contentChanged";function f(_){m(_),this._content=_}f.prototype=Object.create(a.prototype),f.prototype.getContent=function(){return this._content},f.prototype.setContent=function(_){return m(_),this._content=_,this.trigger("$changed",this),this._engine?this._engine.reload().then(function(){return p.call(this,_)}.bind(this)).catch(function(b){return Promise.reject(new d(b))}):p.call(this,_)};function p(_){return this.trigger(l,this._content),Promise.resolve(this._content)}function m(_){if(!_)throw new c("style","requiredCSS");if(!s.isString(_))throw new c("style","requiredCSSString")}t.exports=f},function(t,o,n){var s=n(78);t.exports={CartoCSS:s}},function(t,o,n){var s=n(0),a=n(12),c=n(9),d=n(28),l=n(3),f=n(4);function p(_){var b=this;m(_),this._query=_,a.apply(this,arguments),this._appliedFilters.on("change:filters",function(){return b._updateInternalModelQuery(b._getQueryToApply())})}p.prototype=Object.create(a.prototype),p.prototype.setQuery=function(_){m(_),this._query=_;var b=this._getQueryToApply();return this._internalModel?this._updateInternalModelQuery(b):(this._triggerQueryChanged(this,b),Promise.resolve())},p.prototype.getQuery=function(){return this._query},p.prototype._createInternalModel=function(_){var b=new c({id:this.getId(),type:"source",query:this._getQueryToApply()},{camshaftReference:d,engine:_});return b.on("change:query",this._triggerQueryChanged,this),b},p.prototype._updateInternalModelQuery=function(_){var b=this;if(this._internalModel)return this._internalModel.set("query",_,{silent:!0}),this._internalModel._engine.reload().then(function(){return b._triggerQueryChanged(b,_)}).catch(function(x){return Promise.reject(new f(x))})},p.prototype._getQueryToApply=function(){var _=this._appliedFilters.$getSQL();return!this._hasFiltersApplied||s.isEmpty(_)?this._query:"SELECT * FROM ("+this._query+") as originalQuery WHERE "+_},p.prototype.addFilter=function(_){a.prototype.addFilter.apply(this,arguments),this._updateInternalModelQuery(this._getQueryToApply())},p.prototype.removeFilter=function(_){a.prototype.removeFilter.apply(this,arguments),this._updateInternalModelQuery(this._getQueryToApply())},p.prototype._triggerQueryChanged=function(_,b){this.trigger("queryChanged",b)};function m(_){if(!_)throw new l("source","requiredQuery");if(!s.isString(_))throw new l("source","requiredString")}t.exports=p},function(t,o,n){var s=n(0),a=n(12),c=n(9),d=n(28),l=n(3),f=n(4);function p(_){var b=this;m(_),this._tableName=_,a.apply(this,arguments),this._appliedFilters.on("change:filters",function(){return b._updateInternalModelQuery(b._getQueryToApply())})}p.prototype=Object.create(a.prototype),p.prototype.setTableName=function(_){return m(_),this._tableName=_,this._internalModel?this._updateInternalModelQuery(this._getQueryToApply()):(this._triggerTableNameChanged(this,_),Promise.resolve())},p.prototype.getTableName=function(){return this._tableName},p.prototype._createInternalModel=function(_){var b=new c({id:this.getId(),type:"source",query:this._getQueryToApply()},{camshaftReference:d,engine:_});return b},p.prototype._updateInternalModelQuery=function(_){var b=this;if(this._internalModel)return this._internalModel.set("query",_,{silent:!0}),this._internalModel._engine.reload().then(function(){return b._triggerTableNameChanged(b,b._tableName)}).catch(function(x){return Promise.reject(new f(x))})},p.prototype._getQueryToApply=function(){var _=this._appliedFilters.$getSQL(),b="SELECT * from "+this._tableName;return s.isEmpty(_)?b:"SELECT * FROM ("+b+") as datasetQuery WHERE "+_},p.prototype.addFilter=function(_){a.prototype.addFilter.apply(this,arguments),this._updateInternalModelQuery(this._getQueryToApply())},p.prototype.removeFilter=function(_){a.prototype.removeFilter.apply(this,arguments),this._updateInternalModelQuery(this._getQueryToApply())},p.prototype._triggerTableNameChanged=function(_,b){this.trigger("tableNameChanged",b)};function m(_){if(s.isUndefined(_))throw new l("source","noDatasetName");if(!s.isString(_))throw new l("source","requiredDatasetString");if(s.isEmpty(_))throw new l("source","requiredDataset")}t.exports=p},function(t,o,n){var s=n(81),a=n(80);t.exports={Dataset:s,SQL:a}},function(t,o,n){var s=1024;function a(){}a.metrics={},a._backend=null,a.get=function(d){return a.metrics[d]||{max:0,min:Number.MAX_VALUE,avg:0,total:0,count:0,last:0,history:typeof Float32Array<"u"?new Float32Array(s):[]}},a.backend=function(d){a._backend=d},a.new_value=function(d,l,f,p){f=f||"i";var m=a.metrics[d]=a.get(d);if(m.max=Math.max(m.max,l),m.min=Math.min(m.min,l),m.total+=l,++m.count,m.avg=m.total/m.count,m.history[m.count%s]=l,!p)a._backend&&a._backend([f,d,l]);else{var _=performance.now();_-m.last>1e3&&(a._backend&&a._backend([f,d,m.avg]),m.last=_)}},a.print_stats=function(){for(var d in a.metrics){var l=a.metrics[d];console.log(" === "+d+" === "),console.log(" max: "+l.max),console.log(" min: "+l.min),console.log(" avg: "+l.avg),console.log(" count: "+l.count),console.log(" total: "+l.total)}};function c(d){this.t0=null,this.name=d,this.count=0}c.prototype={start:function(){return this.t0=performance.now(),this},_elapsed:function(){return performance.now()-this.t0},end:function(l){this.t0!==null&&(a.new_value(this.name,this._elapsed(),"t",l),this.t0=null)},inc:function(l){l=l===void 0?1:l,a.new_value(this.name,l,"i")},dec:function(l){l=l===void 0?1:l,a.new_value(this.name,l,"d")},mark:function(){if(++this.count,this.t0===null){this.start();return}var l=this._elapsed();l>1&&(a.new_value(this.name,this.count),this.count=0,this.start())}},a.metric=function(d){return new c(d)},t.exports=a},function(t,o,n){function s(a){this.setMap(a)}s.prototype=new google.maps.OverlayView,s.prototype.draw=function(){},s.prototype.latLngToPixel=function(a){var c=this.getProjection();return c?c.fromLatLngToContainerPixel(a):(console.warn("Projector has no projection"),new google.maps.Point(0,0))},s.prototype.pixelToLatLng=function(a){var c=this.getProjection();return c?c.fromContainerPixelToLatLng(a):(console.warn("Projector has no projection"),new google.maps.LatLng(0,0))},t.exports=s},function(t,o,n){var s=n(0),a=n(1),c=function(l,f){f=f||{},this.model=l,this.model.bind("change",this._onModelUpdated,this),this.mapModel=f.mapModel,this.gmapsMap=f.nativeMap,this.showLimitErrors=f.showLimitErrors};s.extend(c.prototype,a.Events),s.extend(c.prototype,{addToMap:function(){throw new Error("Subclasses of GMapsLayerView must implement addToMap")},remove:function(){throw new Error("Subclasses of GMapsLayerView must implement remove")},_onModelUpdated:function(){}}),t.exports=c},function(t,o,n){var s=n(0),a=n(85),c=n(34),d=n(24),l=n(84),f=n(35),p=n(83),m="progid:DXImageTransform.Microsoft.gradient(startColorstr=#00FFFFFF,endColorstr=#00FFFFFF)",_="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function b(S,E){var F=Math.round(E*100);F>=99?S.style.filter=m:S.style.filter="alpha(opacity="+E+");"}function x(){return((1+Math.random())*4294967296|0).toString(16).substring(1)}var A=function(E,F){var v=this,P=[],G=F.nativeMap;s.bindAll(this,"featureOut","featureOver","featureClick");var $=s.clone(E.attributes);$.map=G;var Z=$.featureOver,ie=$.featureOut,le=$.featureClick,X,oe=-1;$.featureOver=function(_e,Re,Se,we,Ue){P[Ue]||v.trigger("layerenter",_e,Re,Se,we,Ue),P[Ue]=1,Z&&Z.apply(this,arguments),v.featureOver&&v.featureOver.apply(this,arguments),_e.timeStamp===X&&clearTimeout(oe),oe=setTimeout(function(){v.trigger("mouseover",_e,Re,Se,we,Ue),v.trigger("layermouseover",_e,Re,Se,we,Ue)},0),X=_e.timeStamp},$.featureOut=function(_e,Re){P[Re]&&v.trigger("layermouseout",Re),P[Re]=0,s.any(P)||v.trigger("mouseout"),ie&&ie.apply(this,arguments),v.featureOut&&v.featureOut.apply(this,arguments)},$.featureClick=s.debounce(function(){le&&le.apply(this,arguments),v.featureClick&&v.featureClick.apply($,arguments)},10),this.tiles=0,this.options={tiles:F.tiles,scheme:F.scheme||"xyz",blankImage:F.blankImage||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},this._id=x(),this.interactive=!0,this.tileSize=new google.maps.Size(256,256),this.cache={},s.extend(this.options,$),a.apply(this,arguments),this.projector=new l($.map),f.apply(this,arguments)};A.prototype.interactionClass=c.Interactive,s.extend(A.prototype,f.prototype,a.prototype,{addToMap:function(){this.gmapsMap.overlayMapTypes.setAt(0,this)},remove:function(){var E=this._getOverlayIndex();E>=0&&this.gmapsMap.overlayMapTypes.removeAt(E),this._clearInteraction(),this.finishLoading&&this.finishLoading()},reload:function(){this.model.invalidate()},featureOver:function(E,F,v,P,G){var $=this.model.getLayerInLayerGroupAt(G);$&&this.trigger("featureOver",{layer:$,layerIndex:G,latlng:[F.lat(),F.lng()],position:{x:v.x,y:v.y},feature:P})},featureOut:function(E,F){var v=this.model.getLayerInLayerGroupAt(F);v&&this.trigger("featureOut",{layer:v,layerIndex:F})},featureClick:function(E,F,v,P,G){var $=this.model.getLayerInLayerGroupAt(G);$&&this.trigger("featureClick",{layer:$,layerIndex:G,latlng:[F.lat(),F.lng()],position:{x:v.x,y:v.y},feature:P})},error:function(E){this.model&&(this.model.trigger("error",E?E.errors:"unknown error"),this.model.trigger("tileError",E?E.errors:"unknown error"))},ok:function(E){this.model.trigger("tileOk")},tilesOk:function(E){this.model.trigger("tileOk")},loading:function(){this.trigger("loading")},finishLoading:function(){this.trigger("load")},setOpacity:function(E){if(isNaN(E)||E>1||E<0)throw new Error(E+" is not a valid value, should be in [0, 1] range");this.opacity=this.options.opacity=E;for(var F in this.cache){var v=this.cache[F];v.style.opacity=E,b(v,E)}},getTile:function(E,F,v){var P=this,G="ActiveXObject"in window,$=G&&!document.addEventListener;if(this.options.added=!0,!this.model.hasTileURLTemplates()){var Z=F+"/"+E.x+"/"+E.y,ie=this.cache[Z]=new Image(256,256);return ie.src=_,ie.setAttribute("gTileKey",Z),ie.style.opacity=this.options.opacity,ie}var le=this._getTile(E,F,v);$&&b(le,this.options.opacity),le.style.opacity=this.options.opacity,this.tiles===0&&this.loading&&this.loading(),this.tiles++;var X=p.metric("cartodb-js.tile.png.load.time").start(),oe=function(){X.end(),P.tiles--,P.tiles===0&&P.finishLoading&&P.finishLoading()};return le.onload=oe,le.onerror=function(){p.metric("cartodb-js.tile.png.error").inc(),P.model.addError({type:d.WINDSHAFT_ERRORS.TILE}),oe()},le},_getTile:function(E,F,v){var P=F+"/"+E.x+"/"+E.y;if(!this.cache[P]){var G=this.cache[P]=new Image(256,256);this.cache[P].src=this._getTileUrl(E,F),this.cache[P].setAttribute("gTileKey",P),this.cache[P].onerror=function(){G.style.display="none"}}return this.cache[P]},_getTileUrl:function(E,F){var v=Math.pow(2,F),P=this.options.scheme==="tms"?v-1-E.y:E.y,G=E.x%v;return G=G<0?E.x%v+v:G,P<0?this.options.blankImage:this.options.tiles[parseInt(G+P,10)%this.options.tiles.length].replace(/\{z\}/g,F).replace(/\{x\}/g,G).replace(/\{y\}/g,P)},_reload:function(){var E;this.model.hasTileURLTemplates()?E=[this.model.getTileURLTemplatesWithSubdomains()[0]]:E=[_],this.options.tiles=E,this.tiles=0,this.cache={},this._reloadInteraction(),this._refreshView()},_refreshView:function(){var E=this.gmapsMap.overlayMapTypes,F=this._getOverlayIndex();F>=0&&E.setAt(F,E.getAt(F))},_checkLayer:function(){if(!this.options.added)throw new Error("the layer is not still added to the map")},_getOverlayIndex:function(){var E=this.gmapsMap.overlayMapTypes.getArray();return s.findIndex(E,function(F){return F&&F._id===this._id},this)},_newPoint:function(E,F){return new google.maps.Point(E,F)},_manageOffEvents:function(E,F){if(this.options.featureOut)return this.options.featureOut&&this.options.featureOut(F.e,F.layer)},_manageOnEvents:function(E,F){var v=F.pixel,P=this.projector.pixelToLatLng(v),G=F.e.type.toLowerCase();switch(G){case"mousemove":if(this.options.featureOver)return this.options.featureOver(F.e,P,v,F.data,F.layer);break;case"click":case"touchend":case"touchmove":case"mspointerup":case"pointerup":case"pointermove":this.options.featureClick&&this.options.featureClick(F.e,P,v,F.data,F.layer);break}}}),t.exports=A},function(t,o,n){var s=n(0),a=n(23),c=n(36),d=n(86),l=n(4);function f(p,m,_){this._layers=p,this._engine=m,this._map=_,this._hoveredLayers=[],this.tileSize=new google.maps.Size(256,256),this._internalView=new d(this._engine._cartoLayerGroup,{nativeMap:_}),this._id=this._internalView._id,this._internalView.on("featureClick",this._onFeatureClick,this),this._internalView.on("featureOver",this._onFeatureOver,this),this._internalView.on("featureOut",this._onFeatureOut,this),this._internalView.on("featureError",this._onFeatureError,this)}f.prototype.getTile=function(p,m,_){return this._internalView.getTile(p,m,_)},f.prototype._onFeatureClick=function(p){var m=this._layers.findById(p.layer.id);c(a.events.FEATURE_CLICKED,p,m)},f.prototype._onFeatureOver=function(p){var m=this._layers.findById(p.layer.id);m.isInteractive()&&(this._hoveredLayers[p.layerIndex]=!0,this._map.setOptions({draggableCursor:"pointer"})),c(a.events.FEATURE_OVER,p,m)},f.prototype._onFeatureOut=function(p){var m=this._layers.findById(p.layer.id);this._hoveredLayers[p.layerIndex]=!1,s.any(this._hoveredLayers)?this._map.setOptions({draggableCursor:"pointer"}):this._map.setOptions({draggableCursor:"auto"}),c(a.events.FEATURE_OUT,p,m)},f.prototype._onFeatureError=function(p){var m=new l(p);s.each(this._layers.toArray(),function(_){_.isInteractive()&&_.trigger(a.events.TILE_ERROR,m)})},t.exports=f},function(t,o,n){var s=n(0),a=n(1),c=function(l,f){f=f||{},this.model=l,this.mapModel=f.mapModel,this.leafletMap=f.nativeMap,this.leafletLayer=f.nativeLayer||this._createLeafletLayer(),this.showLimitErrors=f.showLimitErrors,this.setModel(l);var p=l.get("type")||l.get("kind");this.type=p&&p.toLowerCase()};s.extend(c.prototype,a.Events),s.extend(c.prototype,{setZIndex:function(l){this.leafletLayer.setZIndex(l)},setModel:function(l){this.model&&this.model.unbind("change",this._modelUpdated,this),this.model=l,this.model.bind("change",this._modelUpdated,this)},remove:function(){this.leafletMap.removeLayer(this.leafletLayer),this.notifyRemove()},notifyRemove:function(){this.trigger("remove",this),this.model.unbind(null,null,this),this.unbind()},reload:function(){this.leafletLayer.redraw()},_createLeafletLayer:function(){throw new Error("subclasses of LeafletLayerView must implement _createLeafletLayer")}}),t.exports=c},function(t,o,n){var s=n(0),a=n(24),c=n(88),d=n(35),l=n(34),f="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",p=function(_,b){c.apply(this,arguments),d.apply(this,arguments),this.leafletLayer.on("load",function(){this.trigger("load")}.bind(this)),this.leafletLayer.on("loading",function(){this.trigger("loading")}.bind(this)),this.leafletLayer.on("tileerror",function(x){this.model.addError({type:a.WINDSHAFT_ERRORS.TILE})}.bind(this))};p.prototype=s.extend({},c.prototype,d.prototype,{interactionClass:l.Interactive,_createLeafletLayer:function(){var _=new L.TileLayer(null,{opacity:.99,maxZoom:30});return _._setUrl=function(b,x){return L.TileLayer.prototype.setUrl.call(this,b,x)},_},_reload:function(){var _=this.model.getTileURLTemplate(),b=this.model.getSubdomains();_||(_=f),b&&L.Util.setOptions(this.leafletLayer,{subdomains:b}),this.leafletLayer._setUrl(_),this._reloadInteraction()},_manageOffEvents:function(_,b){this._onFeatureOut(b.layer)},_manageOnEvents:function(_,b){var x=_.layerPointToContainerPoint(b.layerPoint);if(!x||isNaN(x.x)||isNaN(x.y))return!1;var A=_.containerPointToLatLng(x),S=b.e.type.toLowerCase();switch(S){case"mousemove":this._onFeatureOver(A,x,b.data,b.layer);break;case"click":this._onFeatureClicked(A,x,b.data,b.layer);break}},_onFeatureClicked:function(_,b,x,A){var S=this.model.getLayerInLayerGroupAt(A);S&&this.trigger("featureClick",{layer:S,layerIndex:A,latlng:[_.lat,_.lng],position:b,feature:x})},_onFeatureOver:function(_,b,x,A){var S=this.model.getLayerInLayerGroupAt(A);S&&this.trigger("featureOver",{layer:S,layerIndex:A,latlng:[_.lat,_.lng],position:b,feature:x})},_onFeatureOut:function(_){var b=this.model.getLayerInLayerGroupAt(_);b&&this.trigger("featureOut",{layer:b,layerIndex:_})}}),p.prototype.constructor=c,t.exports=p},function(t,o,n){var s=n(0),a=n(3),c={AVG:"avg",SUM:"sum",MIN:"min",MAX:"max",MODE:"mode"},d={SAMPLE:"point-sample",GRID:"point-grid",CENTROID:"centroid"},l=[.5,1,2,4,8,16,32,64,128,256];function f(S){if(!s.isFinite(S.threshold))throw _("thresholdRequired");if(!s.isFinite(S.threshold)||S.threshold<1||Math.floor(S.threshold)!==S.threshold)throw _("invalidThreshold");if(!s.isFinite(S.resolution))throw _("resolutionRequired");if(!s.contains(l,S.resolution))throw _("invalidResolution");A(S.placement);var E=b(S.columns),F={threshold:S.threshold,resolution:S.resolution,placement:S.placement,columns:E};return s.pick(F,s.identity)}f.operation=c,f.placement=d;function p(S){Object.keys(S).forEach(function(E){m(S,E)})}function m(S,E){if(!S[E].aggregatedColumn)throw _("columnAggregatedColumnRequired"+E);if(!s.isString(S[E].aggregatedColumn))throw _("invalidColumnAggregatedColumn"+E);if(!S[E].aggregateFunction)throw _("columnFunctionRequired"+E);if(!s.contains(s.values(c),S[E].aggregateFunction))throw _("invalidColumnFunction"+E)}function _(S){return new a("aggregation",S)}function b(S){var E=null;return S&&(p(S),E={},Object.keys(S).forEach(function(F){E[F]=x(S[F])})),E}function x(S){return{aggregate_function:S.aggregateFunction,aggregated_column:S.aggregatedColumn}}function A(S){if(S&&!s.contains(s.values(d),S))throw _("invalidPlacement")}t.exports=f},function(t,o,n){var s={FEATURE_CLICKED:"featureClicked",FEATURE_OVER:"featureOver",FEATURE_OUT:"featureOut",TILE_ERROR:"featureError"};t.exports=s},function(t,o,n){var s=n(37);function a(c){var d=c.getBucketsWithCategoryFilter(),l=c.getBucketsWithDefaultFilter();this._categories=d.map(function(f){return{name:f.filter.name,value:f.value}}),this._defaultValue=l.length>0?l[0].value:void 0,s.call(this,"categories",c)}a.prototype=Object.create(s.prototype),a.prototype.getCategories=function(){return this._categories},a.prototype.getDefaultValue=function(){return this._defaultValue},t.exports=a},function(t,o,n){var s=n(37);function a(c){var d=c.getBucketsWithRangeFilter();this._buckets=d.map(function(l){return{min:l.filter.start,max:l.filter.end,value:l.value}}),this._avg=c.getFilterAvg(),this._min=d.length>0?d[0].filter.start:void 0,this._max=d.length>0?d[d.length-1].filter.end:void 0,s.call(this,"buckets",c)}a.prototype=Object.create(s.prototype),a.prototype.getBuckets=function(){return this._buckets},a.prototype.getAverage=function(){return this._avg},a.prototype.getMin=function(){return this._min},a.prototype.getMax=function(){return this._max},t.exports=a},function(t,o,n){var s=n(93),a=n(92),c=n(15);function d(p){var m=[];return p.forEach(function(_){var b=new c(_);l(b)?m.push(new s(b)):f(b)&&m.push(new a(b))}),m}function l(p){return p.getBucketsWithRangeFilter().length>0}function f(p){return p.getBucketsWithCategoryFilter().length>0}t.exports={getMetadataFromRules:d}},function(t,o,n){var s=n(0);t.exports=function(a,c,d){var l=c.split("."),f=l.reduce(function(p,m){return(p||{})[m]},a);return s.isUndefined(f)?d:f}},function(t,o,n){var s=n(0),a=n(22),c=a.extend({defaults:function(){return s.extend(a.prototype.defaults.apply(this),{type:"torque",items:[],html:""})}});t.exports=c},function(t,o,n){var s=n(0),a=n(22),c=a.extend({defaults:function(){return s.extend(a.prototype.defaults.apply(this),{type:"custom_choropleth",prefix:"",suffix:"",leftLabel:"",rightLabel:"",colors:[]})}});t.exports=c},function(t,o,n){var s=n(0),a=n(22),c=a.extend({defaults:function(){return s.extend(a.prototype.defaults.apply(this),{type:"custom",items:[],html:""})}});t.exports=c},function(t,o,n){var s=n(0),a=n(13),c=a.extend({defaults:function(){return s.extend(a.prototype.defaults.apply(this),{type:"choropleth",prefix:"",suffix:"",leftLabel:"",rightLabel:"",colors:[]})},getNonResettableAttrs:function(){return s.union(a.prototype.getNonResettableAttrs.apply(this),["colors"])},isAvailable:function(){return this.get("colors")&&this.get("colors").length>0}});t.exports=c},function(t,o,n){var s=n(0),a=n(13),c=a.extend({defaults:function(){return s.extend(a.prototype.defaults.apply(this),{type:"bubble",fillColor:"",prefix:"",suffix:"",values:[]})},getNonResettableAttrs:function(){return s.union(a.prototype.getNonResettableAttrs.apply(this),["values"])},isAvailable:function(){return this.get("values")&&this.get("values").length>0}});t.exports=c},function(t,o,n){var s=n(0),a=n(13),c=a.extend({defaults:function(){return s.extend(a.prototype.defaults.apply(this),{type:"category",categories:[]})},getNonResettableAttrs:function(){return s.union(a.prototype.getNonResettableAttrs.apply(this),["categories"])},isAvailable:function(){return this.get("categories")&&this.get("categories").length>0}});t.exports=c},function(t,o,n){var s=n(0),a=n(101),c=n(100),d=n(99),l=n(98),f=n(97),p=n(96),m={bubble:{modelClass:c,definitionAttrs:[{fillColor:"color"},{topLabel:"top_label"},{bottomLabel:"bottom_label"}],dynamic:!0},category:{modelClass:a,definitionAttrs:["prefix","suffix"],dynamic:!0},choropleth:{modelClass:d,definitionAttrs:["prefix","suffix",{leftLabel:"left_label"},{rightLabel:"right_label"}],dynamic:!0},custom:{modelClass:l,definitionAttrs:[{items:"categories"},"html"]},html:{modelClass:l,definitionAttrs:[{items:"categories"},"html"]},custom_choropleth:{modelClass:f,definitionAttrs:["prefix","suffix",{leftLabel:"left_label"},{rightLabel:"right_label"},"colors"]},torque:{modelClass:p,definitionAttrs:[{items:"categories"},"html"]}},_=["title",{preHTMLSnippet:"pre_html"},{postHTMLSnippet:"post_html"}],b=function(A,S){if(!S.engine)throw new Error("engine is required");this._legendsData=A||[],this._engine=S.engine,s.each(m,function(F,v){this[v]=this._createLegendModel(v,F)},this);var E=this._findDataForLegend("html");E&&(this.custom=this.html),delete this.html};b.prototype._createLegendModel=function(x,A){var S=A.modelClass,E=_.concat(A.definitionAttrs),F=this._findDataForLegend(x);F=F&&s.extend({},s.omit(F,"definition"),F.definition);var v={};s.each(E,function(G){var $=G,Z=G;s.isObject(G)&&(Z=Object.keys(G)[0],$=G[Z]),v[Z]=F&&F[$]});var P=new S(v,{engine:this._engine});return F&&P.show(),P},b.prototype._findDataForLegend=function(x){return s.find(this._legendsData,{type:x})},b.prototype.hasAnyLegend=function(){var x=s.keys(m);return s.some(x,function(A){var S=this[A];return S&&S.isVisible()},this)},t.exports=b},function(t,o,n){var s=n(0),a=n(1),c=n(39),d=a.Model.extend({defaults:{vertical_offset:0,horizontal_offset:0,position:"top|center",template:"",alternative_names:{}},initialize:function(f){f=f||{},this.fields=new c(f.fields||[]),this.unset("fields")},update:function(f){f=s.clone(f),this.fields.equals(f.fields)||this.fields.reset(f.fields),delete f.fields,f.alternative_names&&(f.alternative_names=JSON.parse(JSON.stringify(f.alternative_names))),this.set(f)},getFieldNames:function(){return this.fields.pluck("name")},hasFields:function(){return!this.fields.isEmpty()},hasTemplate:function(){return!!this.get("template")}});t.exports=d},function(t,o,n){var s=n(0),a=n(1),c=n(39),d=a.Model.extend({defaults:{offset:[28,0],maxHeight:180,alternative_names:{},template_type:"mustache"},initialize:function(f){f=f||{},this.fields=new c(f.fields||[]),this.unset("fields")},update:function(f){f=s.clone(f),this.fields.equals(f.fields)||this.fields.reset(f.fields),delete f.fields,f.alternative_names&&(f.alternative_names=JSON.parse(JSON.stringify(f.alternative_names))),this.set(f)},getFieldNames:function(){return this.fields.pluck("name")},hasFields:function(){return!this.fields.isEmpty()},hasTemplate:function(){return!!this.get("template")}});t.exports=d},function(t,o,n){var s=n(27),a=n(2),c=a.extend({initialize:function(){this.bind("change:type",function(){s.error("changing layer type is not allowed, remove it and add a new one instead")})},remove:function(l){l=l||{},this.trigger("destroy",this,this.collection,l)},update:function(l,f){f=f||{},this.set(l,{silent:f.silent})},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},isVisible:function(){return!!this.get("visible")},isHidden:function(){return!this.isVisible()},toggle:function(){this.set("visible",!this.get("visible"))},setOk:function(){this.unset("error")},setError:function(l){this.set("error",l)},getSourceId:function(){throw new Error(".getSourceId called on a non torque/cartodb layer.")},hasSource:function(l){return!1}});t.exports=c},function(t,o,n){var s=n(1),a=s.Model.extend({VERSION:4,initialize:function(){},REPORT_ERROR_URL:"/api/v0/error",ERROR_TRACK_ENABLED:!1});t.exports=a},function(t,o,n){var s=n(106),a=new s;a.set({cartodb_attributions:'© <a href="https://carto.com/about-carto/" target="_blank">CARTO</a>',cartodb_logo_link:"http://www.carto.com"}),t.exports=a},function(t,o,n){var s=n(0),a=n(107),c=n(105),d=n(104),l=n(103),f=n(102),p=n(9),m=["sql","source","sql_wrap","cartocss"],_=c.extend({defaults:{type:"CartoDB",attribution:a.get("cartodb_attributions"),visible:!0},initialize:function(x,A){if(x=x||{},A=A||{},!A.engine)throw new Error("engine is required");this._engine=A.engine,x&&x.cartocss&&this.set("initialStyle",x.cartocss),x.source&&this.setSource(x.source),this.infowindow=new d(x.infowindow),this.tooltip=new l(x.tooltip),this.unset("infowindow"),this.unset("tooltip"),this.legends=new f(x.legends,{engine:this._engine}),this.unset("legends"),this.bind("change",this._onAttributeChanged,this),this.infowindow.fields.bind("reset add remove",this._reload,this),this.tooltip.fields.bind("reset add remove",this._reload,this),this.aggregation=A.aggregation,c.prototype.initialize.apply(this,arguments)},_onAttributeChanged:function(){var x=s.any(m,function(A){if(this.hasChanged(A))return!0},this);x&&this._reload()},_reload:function(){this._engine.reload({sourceId:this.get("id")})},restoreCartoCSS:function(){this.set("cartocss",this.get("initialStyle"))},isVisible:function(){return this.get("visible")},isInteractive:function(){return this._hasInfowindowFields()||this._hasTooltipFields()},_hasInfowindowFields:function(){return this.infowindow.hasFields()},_hasTooltipFields:function(){return this.tooltip.hasFields()},getInteractiveColumnNames:function(){return s.chain(["cartodb_id"]).union(this.infowindow.getFieldNames()).union(this.tooltip.getFieldNames()).uniq().value()},isInfowindowEnabled:function(){return this.infowindow.hasTemplate()},isTooltipEnabled:function(){return this.tooltip.hasTemplate()},getName:function(){return this.get("layer_name")},getEstimatedFeatureCount:function(){var x=this.get("meta"),A=x&&x.stats;return A&&A.estimatedFeatureCount},getSourceId:function(){var x=this.getSource();return x&&x.id},getSource:function(){return this.get("source")},setSource:function(x,A){this.getSource()&&this.getSource().unmarkAsSourceOf(this),x.markAsSourceOf(this),this.set("source",x,A)},hasSource:function(x){return this.getSource().equals(x)},update:function(x){if(x.source)throw new Error(`Use ".setSource" to update a layer's source instead of the update method`);c.prototype.update.apply(this,arguments)},remove:function(){this.getSource().unmarkAsSourceOf(this),c.prototype.remove.apply(this,arguments)},getTableName:function(){if(this.get("source").has("options"))return this.get("source").get("options").table_name},getApiKey:function(){return this._engine.getApiKey()}},{_checkSourceAttribute:function(x){if(!(x instanceof p))throw new Error("Source must be an instance of AnalysisModel")}});t.exports=_},function(t,o,n){var s=n(0),a=n(40),c=n(108),d=n(12),l=n(38),f=n(4),p=n(3),m=n(14),_=n(94);function b(Z,ie){var le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};a.apply(this,arguments),S(Z),A(ie),this._client=void 0,this._engine=void 0,this._internalModel=void 0,this._source=Z,this._style=ie,this._visible=s.isBoolean(le.visible)?le.visible:!0,this._featureClickColumns=le.featureClickColumns||[],this._featureOverColumns=le.featureOverColumns||[],this._minzoom=le.minzoom||0,this._maxzoom=le.maxzoom||void 0,this._aggregation=le.aggregation||{},G(this._aggregation.columns,this._featureClickColumns,this._featureOverColumns)}b.prototype=Object.create(a.prototype),b.prototype.setStyle=function(Z,ie){var le=this._style;if(A(Z),le===Z)return Promise.resolve();if(!this._internalModel)return this._style=Z,this.trigger("styleChanged",this),Promise.resolve();if(Z.$getEngine()&&Z.$getEngine()!==this._internalModel._engine)throw new p("layer","differentStyleClient");return Z.$getEngine()||Z.$setEngine(this._engine),this._internalModel.set("cartocss",Z.getContent(),{silent:!0}),this._engine.reload().then(function(){this._style=Z,this.trigger("styleChanged",this)}.bind(this)).catch(v.bind(this))},b.prototype.getStyle=function(){return this._style},b.prototype.setSource=function(Z){var ie=this._source;if(S(Z),ie===Z)return Promise.resolve();if(!this._internalModel)return this._source=Z,this.trigger("sourceChanged",this),Promise.resolve();if(Z.$getEngine()&&Z.$getEngine()!==this._internalModel._engine)throw new p("layer","differentSourceClient");return Z.$getEngine()||Z.$setEngine(this._engine),this._internalModel.set("source",Z.$getInternalModel(),{silent:!0}),this._engine.reload().then(function(){this._source=Z,this.trigger("sourceChanged",this)}.bind(this)).catch(v.bind(this))},b.prototype.getSource=function(){return this._source},b.prototype.setFeatureClickColumns=function(Z){var ie=this._featureClickColumns;return E(Z),P(Z,ie)?Promise.resolve():this._internalModel?(this._internalModel.infowindow.fields.set(x(Z).fields,{silent:!0}),this._engine.reload().then(function(){this._featureClickColumns=Z}.bind(this)).catch(v.bind(this))):(this._featureClickColumns=Z,Promise.resolve())},b.prototype.getFeatureClickColumns=function(){return this._featureClickColumns},b.prototype.setFeatureOverColumns=function(Z){var ie=this._featureOverColumns;return E(Z),P(Z,ie)?Promise.resolve():this._internalModel?(this._internalModel.tooltip.fields.set(x(Z).fields,{silent:!0}),this._engine.reload().then(function(){this._featureOverColumns=Z}.bind(this)).catch(v.bind(this))):(this._featureOverColumns=Z,Promise.resolve())},b.prototype.getFeatureOverColumns=function(){return this._featureOverColumns},b.prototype.hide=function(){var Z=this._visible;return this._visible=!1,this._internalModel&&this._internalModel.set("visible",!1),Z&&this.trigger("visibilityChanged",!1),this},b.prototype.show=function(){var Z=this._visible;return this._visible=!0,this._internalModel&&this._internalModel.set("visible",!0),Z||this.trigger("visibilityChanged",!1),this},b.prototype.toggle=function(){return this.isVisible()?this.hide():this.show()},b.prototype.isVisible=function(){return this._visible},b.prototype.isHidden=function(){return!this.isVisible()},b.prototype.isInteractive=function(){return this.getFeatureClickColumns().length>0||this.getFeatureOverColumns().length>0},b.prototype.setOrder=function(Z){return this._client?this._client.moveLayer(this,Z):Promise.resolve()},b.prototype.bringToBack=function(){return this.setOrder(0)},b.prototype.bringToFront=function(){return this.setOrder(this._client._layers.size()-1)},b.prototype._createInternalModel=function(Z){var ie=new c({id:this._id,source:this._source.$getInternalModel(),cartocss:this._style.getContent(),visible:this._visible,infowindow:x(this._featureClickColumns),tooltip:x(this._featureOverColumns),minzoom:this._minzoom,maxzoom:this._maxzoom},{engine:Z,aggregation:this._aggregation});return ie.on("change:meta",function(le,X){var oe=X.cartocss_meta.rules,_e=_.getMetadataFromRules(oe),Re={styles:_e};this.trigger("metadataChanged",Re)},this),ie.on("change:error",function(le,X){X&&F(X)?this._style.$setError(new f(X)):X&&this.trigger(m.ERROR,new f(X))},this),ie},b.prototype.$setClient=function(Z){this._client||this._engine&&Z._engine!==this._engine||(this._client=Z)},b.prototype.$setEngine=function(Z){this._engine||(this._engine=Z,this._source.$setEngine(Z),this._style.$setEngine(Z),this._internalModel||(this._internalModel=this._createInternalModel(Z),this._style.on("$changed",function(ie){this._internalModel.set("cartocss",ie.getContent(),{silent:!0})},this)))};function x(Z){var ie=Z.map(function(le,X){return{name:le,title:!0,position:X}});return{fields:ie}}function A(Z){if(!(Z instanceof l))throw new p("layer","nonValidStyle")}function S(Z){if(!(Z instanceof d))throw new p("layer","nonValidSource")}function E(Z){if(s.any(Z,function(ie){return!s.isString(ie)}))throw new p("layer","nonValidColumns")}function F(Z){return Z.message&&Z.message.indexOf("style")>=0}function v(Z){var ie=new f(Z);return this.trigger(m.ERROR,ie),Promise.reject(ie)}function P(Z,ie){return Z.length===ie.length&&s.isEmpty(s.difference(Z,ie))}function G(Z,ie,le){var X=Z&&Object.keys(Z)||[];$(X,ie,"featureClick"),$(X,le,"featureOver")}function $(Z,ie,le){if(ie.length>0&&Z.length>0){var X=s.filter(ie,function(oe){return!s.contains(Z,oe)});if(X.length>0)throw new p("layer","wrongInteractivityColumns["+X.join(", ")+"]#"+le)}}t.exports=b},function(t,o,n){var s=n(0),a=n(23),c=n(5),d=n(36),l=n(89),f=n(4),p=L.TileLayer.extend({options:{opacity:.99,maxZoom:30,attribution:c.ATTRIBUTION},initialize:function(_,b,x){s.extend(this.options,x),this._layers=_,this._engine=b,this._internalView=null,this._hoveredLayers=[]},addTo:function(_){return this._internalView||(this._internalView=new l(this._engine._cartoLayerGroup,{nativeMap:_,nativeLayer:this}),this._internalView.on("featureClick",this._onFeatureClick,this),this._internalView.on("featureOver",this._onFeatureOver,this),this._internalView.on("featureOut",this._onFeatureOut,this),this._internalView.on("featureError",this._onFeatureError,this)),L.TileLayer.prototype.addTo.call(this,_)},removeFrom:function(_){return this._internalView&&(this._internalView.off("featureClick"),this._internalView.off("featureOver"),this._internalView.off("featureOut"),this._internalView.off("featureError"),this._internalView.notifyRemove()),this._internalView=null,L.TileLayer.prototype.removeFrom.call(this,_)},setUrl:void 0,_setUrl:function(_,b){return L.TileLayer.prototype.setUrl.call(this,_,b)},_onFeatureClick:function(_){var b=this._layers.findById(_.layer.id);d(a.events.FEATURE_CLICKED,_,b)},_onFeatureOver:function(_){var b=this._layers.findById(_.layer.id);b.isInteractive()&&(this._hoveredLayers[_.layerIndex]=!0,this._map.getContainer().style.cursor="pointer"),d(a.events.FEATURE_OVER,_,b)},_onFeatureOut:function(_){var b=this._layers.findById(_.layer.id);this._hoveredLayers[_.layerIndex]=!1,s.any(this._hoveredLayers)?this._map.getContainer().style.cursor="pointer":this._map.getContainer().style.cursor="auto",d(a.events.FEATURE_OUT,_,b)},_onFeatureError:function(_){var b=new f(_);s.each(this._layers.toArray(),function(x){x.isInteractive()&&x.trigger(a.events.TILE_ERROR,b)})}});t.exports=p},function(t,o,n){var s=n(0);function a(c){this._layers=c||[]}a.prototype.add=function(c){return this._layers.push(c),c},a.prototype.remove=function(c){return this._layers.splice(this._layers.indexOf(c),1)},a.prototype.size=function(){return this._layers.length},a.prototype.indexOf=function(c){return this._layers.indexOf(c)},a.prototype.contains=function(c){return this._layers.indexOf(c)>=0},a.prototype.findById=function(c){return s.find(this._layers,function(d){return d.getId()===c},this)},a.prototype.toArray=function(){return this._layers},a.prototype.move=function(c,d){var l=this._layers.indexOf(c);l>=0&&l!==d&&this._layers.splice(d,0,this._layers.splice(l,1)[0])},t.exports=a},function(t,o,n){var s=n(0),a=function(d){this._maxNumberOfRequests=d||3,this.reset()};a.prototype.track=function(c,d){(!this.lastRequestEquals(c)||!this.lastResponseEquals(d))&&this.reset(),this.maxNumberOfRequestsReached()||(this._lastRequest=c,this._lastResponse=d,this._numberOfRequests+=1)},a.prototype.reset=function(){this._lastRequest=void 0,this._lastResponse=void 0,this._numberOfRequests=0},a.prototype.canRequestBePerformed=function(c){return!this.maxNumberOfRequestsReached()||this.maxNumberOfRequestsReached()&&!this.lastRequestEquals(c)},a.prototype.maxNumberOfRequestsReached=function(){return this._numberOfRequests===this._maxNumberOfRequests},a.prototype.lastRequestEquals=function(c){return this._lastRequest&&this._lastRequest.equals(c)},a.prototype.lastResponseEquals=function(c){return s.isEqual(this._lastResponse,c)},t.exports=a},function(t,o){var n=function(){var s=1,a=2;function c(u,O){postMessage({action:3,callback_num:O,result:u})}var d,l,f=[0,-9223372036854776e3],p=[4294967295,-4294967296],m=[0,0],_=[1,0],b=[4,0],x=[4096,0],A=[16777215,0],S=[16777216,0],E=[4278190080,0],F=[4294967295,0],v=[4294967295,9223372032559809e3];function P(){return Hf}function G(){}l=G.prototype={},l.getClass$=P,l.typeMarker$=_r,l.typeId$=1;function $(){return Uf}function Z(){}l=Z.prototype=new G,l.getClass$=$,l.typeId$=3,l.detailMessage=null;function ie(){return Wf}function le(){}l=le.prototype=new Z,l.getClass$=ie,l.typeId$=4;function X(u,O){return u.detailMessage=O,u}function oe(){return Vf}function _e(){}l=_e.prototype=new le,l.getClass$=oe,l.typeId$=5;function Re(u,O){return u}function Se(){return Zf}function we(){}l=we.prototype=new _e,l.getClass$=Se,l.typeId$=6;function Ue(u,O){u[u.explicitLength++]=O}function Oe(u,O){u[u.explicitLength++]=O}function Ft(u){var O,H;return O=(H=u.join(""),u.length=u.explicitLength=0,H),u[u.explicitLength++]=O,O}function Ne(u,O){var H=new Array(O);if(u>0)for(var q=[null,0,!1,[0,0]][u],Q=0;Q<O;++Q)H[Q]=q;return H}function it(){return this.arrayClass$}function Me(u,O,H,q,Q){var J;return J=Ne(Q,q),Ke(),Be(J,Bt,Fn),J.arrayClass$=u,J.typeId$=O,J.queryId$=H,J}function Et(u,O,H,q){return Ke(),Be(q,Bt,Fn),q.arrayClass$=u,q.typeId$=O,q.queryId$=H,q}function mt(u,O,H){if(H!=null){if(u.queryId$>0&&!fn(H.typeId$,u.queryId$))throw new Nn;if(u.queryId$<0&&(H.typeMarker$==_r||H.typeId$==2))throw new Nn}return u[O]=H}function et(){}l=et.prototype=new G,l.getClass$=it,l.typeId$=0,l.arrayClass$=null,l.length=0,l.queryId$=0;function Ke(){Ke=_r,Bt=[],Fn=[],Mt(new et,Bt,Fn)}function Mt(u,O,H){var q=0,Q;for(var J in u)(Q=u[J])&&(O[q]=J,H[q]=Q,++q)}function Be(u,O,H){Ke();for(var q=0,Q=O.length;q<Q;++q)u[O[q]]=H[q]}var Bt,Fn;function gi(u,O){return u&&!!D[u][O]}function fn(u,O){return u&&D[u][O]}function B(u,O){if(u!=null&&!fn(u.typeId$,O))throw new Fi;return u}function w(u,O){return u!=null&&gi(u.typeId$,O)}function R(u){return~~Math.max(Math.min(u,2147483647),-2147483648)}var D=[{},{},{1:1},{2:1},{2:1},{2:1},{2:1},{2:1,10:1},{2:1},{2:1},{2:1},{2:1},{2:1},{2:1,11:1},{2:1},{2:1},{2:1},{4:1},{5:1},{6:1},{7:1},{8:1},{9:1}];function z(u){return u!=null&&gi(u.typeId$,2)?u:Re(new we)}function j(u,O){var H,q;return H=u[1]+O[1],q=u[0]+O[0],Ee(q,H)}function K(u,O,H){return O==0||H==0?u:j(u,Ee(O*H,0))}function pe(u,O){return dn(~~Math.max(Math.min(u[1]/4294967296,2147483647),-2147483648)&~~Math.max(Math.min(O[1]/4294967296,2147483647),-2147483648),lt(u)&lt(O))}function be(u,O){var H,q;return u[0]==O[0]&&u[1]==O[1]?0:(H=u[1]<0,q=O[1]<0,H&&!q?-1:!H&&q?1:ui(u,O)[1]<0?-1:1)}function Ee(u,O){var H,q;for(O%=18446744073709552e3,u%=18446744073709552e3,H=O%4294967296,q=Math.floor(u/4294967296)*4294967296,O=O-H+q,u=u-q+H;u<0;)u+=4294967296,O-=4294967296;for(;u>4294967295;)u-=4294967296,O+=4294967296;for(O=O%18446744073709552e3;O>9223372032559809e3;)O-=18446744073709552e3;for(;O<-9223372036854776e3;)O+=18446744073709552e3;return[u,O]}function We(u,O){var H,q,Q,J,fe,Ce;if(O[0]==0&&O[1]==0)throw Fs(new ko,"/ by zero");if(u[0]==0&&u[1]==0)return on(),mi;if(ot(u,(on(),Pn)))return ot(O,Zi)||ot(O,Pr)?Pn:(J=or(u,1),H=Mi(We(J,O),1),fe=ui(u,tn(O,H)),j(H,We(fe,O)));if(ot(O,Pn))return mi;if(u[1]<0)return O[1]<0?We(nn(u),nn(O)):nn(We(nn(u),O));if(O[1]<0)return nn(We(u,nn(O)));for(Ce=mi,fe=u;be(fe,O)>=0;)Q=Ge(Math.floor(fs(fe)/Tn(O))),Q[0]==0&&Q[1]==0&&(Q=Zi),q=tn(Q,O),Ce=j(Ce,Q),fe=ui(fe,q);return Ce}function ot(u,O){return u[0]==O[0]&&u[1]==O[1]}function Ge(u){return isNaN(u)?(on(),mi):u<-9223372036854776e3?(on(),Pn):u>=9223372036854776e3?(on(),To):u>0?Ee(Math.floor(u),0):Ee(Math.ceil(u),0)}function at(u){var O,H;return u>-129&&u<128?(O=u+128,H=(sr(),Mr)[O],H==null&&(H=Mr[O]=wn(u)),H):wn(u)}function wn(u){return u>=0?[u,0]:[u+4294967296,-4294967296]}function lt(u){return u[0]>=2147483648?~~Math.max(Math.min(u[0]-4294967296,2147483647),-2147483648):~~Math.max(Math.min(u[0],2147483647),-2147483648)}function dn(u,O){var H,q;return H=u*4294967296,q=O,O<0&&(q+=4294967296),[q,H]}function tn(u,O){var H,q,Q,J,fe,Ce,He,ze,ke;return u[0]==0&&u[1]==0||O[0]==0&&O[1]==0?(on(),mi):ot(u,(on(),Pn))?Vi(O):ot(O,Pn)?Vi(u):u[1]<0?O[1]<0?tn(nn(u),nn(O)):nn(tn(nn(u),O)):O[1]<0?nn(tn(u,nn(O))):be(u,Po)<0&&be(O,Po)<0?Ee((u[1]+u[0])*(O[1]+O[0]),0):(Q=u[1]%281474976710656,J=u[1]-Q,H=u[0]%65536,q=u[0]-H,He=O[1]%281474976710656,ze=O[1]-He,fe=O[0]%65536,Ce=O[0]-fe,ke=mi,ke=K(ke,J,fe),ke=K(ke,Q,Ce),ke=K(ke,Q,fe),ke=K(ke,q,He),ke=K(ke,q,Ce),ke=K(ke,q,fe),ke=K(ke,H,ze),ke=K(ke,H,He),ke=K(ke,H,Ce),ke=K(ke,H,fe),ke)}function Vi(u){return(lt(u)&1)==1?(on(),Pn):(on(),mi)}function nn(u){var O,H;return ot(u,(on(),Pn))?Pn:(O=-u[1],H=-u[0],H>4294967295&&(H-=4294967296,O+=4294967296),H<0&&(H+=4294967296,O-=4294967296),[H,O])}function rn(u){return u<=30?1<<u:rn(30)*rn(u-30)}function Mi(u,O){var H,q,Q,J;return O&=63,ot(u,(on(),Pn))?O==0?u:mi:u[1]<0?nn(Mi(nn(u),O)):(J=rn(O),q=u[1]*J%18446744073709552e3,Q=u[0]*J,H=Q-Q%4294967296,q+=H,Q-=H,q>=9223372036854776e3&&(q-=18446744073709552e3),[Q,q])}function or(u,O){var H,q,Q;return O&=63,Q=rn(O),H=u[1]/Q,q=Math.floor(u[0]/Q),Ee(q,H)}function Ds(u,O){var H;return O&=63,H=or(u,O),u[1]<0&&(H=j(H,Mi((on(),Er),63-O))),H}function ui(u,O){var H,q;return H=u[1]-O[1],q=u[0]-O[0],Ee(q,H)}function fs(u){var O,H,q;return H=R(Math.log(u[1])/(on(),Tr)),H<=48?u[1]+u[0]:(O=H-48,q=(1<<O)-1,u[1]+(u[0]-q))}function Tn(u){var O,H,q;return H=R(Math.log(u[1])/(on(),Tr)),H<=48?u[1]+u[0]:(O=H-48,q=(1<<O)-1,u[1]+(u[0]+q))}function Mo(u){var O,H,q,Q,J,fe;if(u[0]==0&&u[1]==0)return"0";if(ot(u,(on(),Pn)))return"-9223372036854775808";if(u[1]<0)return"-"+Mo(nn(u));for(H=u,Q="";!(H[0]==0&&H[1]==0);){if(J=at(1e9),q=We(H,J),O=""+lt(ui(H,tn(q,J))),H=q,!(H[0]==0&&H[1]==0))for(fe=9-O.length;fe>0;--fe)O="0"+O;Q=O+Q}return Q}function sr(){sr=_r,Mr=Me(qf,0,9,256,0)}var Mr;function on(){on=_r,Tr=Math.log(2),To=v,Pn=f,Pr=at(-1),Zi=at(1),Er=at(2),Po=S,mi=at(0)}var Tr,To,Pn,Pr,Zi,Er,Po,mi;function Is(){return Gf}function ds(){}l=ds.prototype=new G,l.getClass$=Is,l.typeId$=0;function Zn(u,O){return je(u,O,0,O.length),u}function je(u,O,H,q){return u.buf=O,u.pos=H,u.count=H+q,u.count>O.length&&(u.count=O.length),u}function Di(u){return u.pos>=u.count?-1:u.buf[u.pos++]&255}function Eo(u,O,H,q){return u.pos>=u.count?-1:(q=Ht(q,u.count-u.pos),cr(u.buf,u.pos,O,H,q),u.pos+=q,q)}function Ao(){return Yf}function Ar(){}l=Ar.prototype=new ds,l.getClass$=Ao,l.typeId$=0,l.buf=null,l.count=0,l.pos=0;function to(){return Kf}function pn(){}l=pn.prototype=new G,l.getClass$=to,l.typeId$=0;function qn(u){return u.buf=Me(yr,0,-1,32,1),u}function ar(u,O){var H;O<=u.buf.length||(O=En(O,u.buf.length*2),H=Me(yr,0,-1,O,1),cr(u.buf,0,H,0,u.buf.length),u.buf=H)}function ps(u){var O;return O=Me(yr,0,-1,u.count,1),cr(u.buf,0,O,0,u.count),O}function Oo(u,O){ar(u,u.count+1),u.buf[u.count++]=O<<24>>24}function gs(u,O,H,q){ar(u,u.count+q),cr(O,H,u.buf,u.count,q),u.count+=q}function no(){return Xf}function Ii(){}l=Ii.prototype=new pn,l.getClass$=no,l.typeId$=0,l.buf=null,l.count=0;function Or(u,O){return u.detailMessage=O,u}function qi(){return Qf}function lr(){}l=lr.prototype=new le,l.getClass$=qi,l.typeId$=7;function Fs(u,O){return u.detailMessage=O,u}function Ns(){return $f}function ko(){}l=ko.prototype=new _e,l.getClass$=Ns,l.typeId$=8;function ms(u,O){return u.detailMessage=O,u}function io(){return ed}function Nn(){}l=Nn.prototype=new _e,l.getClass$=io,l.typeId$=9;function zn(u,O){var H;return H=new At,H.typeName=u+O,H}function Qe(u,O){var H;return H=new At,H.typeName=u+O,H}function kr(u,O){var H;return H=new At,H.typeName=u+O,H}function vt(){return nd}function At(){}l=At.prototype=new G,l.getClass$=vt,l.typeId$=0,l.typeName=null;function ro(){return id}function Fi(){}l=Fi.prototype=new _e,l.getClass$=ro,l.typeId$=12;function ur(){return Jf}function oo(){}l=oo.prototype=new G,l.getClass$=ur,l.typeId$=0;function Je(u,O){return u.detailMessage=O,u}function Gt(){return rd}function jn(){}l=jn.prototype=new _e,l.getClass$=Gt,l.typeId$=13;function Rr(){return od}function Cn(){}l=Cn.prototype=new _e,l.getClass$=Rr,l.typeId$=14;function _s(){return sd}function Gi(){}l=Gi.prototype=new _e,l.getClass$=_s,l.typeId$=15;function En(u,O){return u>O?u:O}function Ht(u,O){return u<O?u:O}function Ni(){return ad}function zi(){}l=zi.prototype=new _e,l.getClass$=Ni,l.typeId$=16;function Br(u,O){return O==null?!1:String(u)==O}function Ro(u,O,H,q,Q){var J;for(J=O;J<H;++J)q[Q++]=u.charCodeAt(J)}function Dr(){return ld}l=String.prototype,l.getClass$=Dr,l.typeId$=2;function Bo(u){var O;return u.data=(O=[],O.explicitLength=0,O),u}function so(){return ud}function Ir(){}l=Ir.prototype=new G,l.getClass$=so,l.typeId$=0;function cr(u,O,H,q,Q){var J,fe,Ce,He,ze,ke,Nt,_t;if(u==null||H==null)throw new zi;if(Nt=(u.typeMarker$==_r||u.typeId$==2?u.getClass$():Wu).typeName,Ce=(H.typeMarker$==_r||H.typeId$==2?H.getClass$():Wu).typeName,Nt.charCodeAt(0)!=91||Ce.charCodeAt(0)!=91)throw ms(new Nn,"Must be array types");if(Nt.charCodeAt(1)!=Ce.charCodeAt(1))throw ms(new Nn,"Array types must match");if(_t=u.length,He=H.length,O<0||q<0||Q<0||O+Q>_t||q+Q>He)throw new Gi;if((Nt.charCodeAt(1)==76||Nt.charCodeAt(1)==91)&&!Br(Nt,Ce))if(ke=B(u,3),J=B(H,3),(u??null)===(H??null)&&O<q)for(O+=Q,fe=q+Q;fe-- >q;)mt(J,fe,ke[--O]);else for(fe=q+Q;q<fe;)mt(J,q++,ke[O++]);else for(ze=0;ze<Q;++ze)H[q+ze]=u[O+ze]}function Fr(u,O){if(!qe(O,1<<u.dictionarySize))throw X(new _e,"unexpected failure");if(!gt(O,u.fb))throw X(new _e,"unexpected failure");if(!It(O,u.matchFinder))throw X(new _e,"unexpected failure");if(!Ye(O,u.lc,u.lp,u.pb))throw X(new _e,"unexpected failure")}function ao(){return kd}l=new oo,l.getClass$=ao,l.typeId$=0,l.dictionarySize=0,l.fb=0,l.lc=0,l.lp=0,l.matchFinder=0,l.pb=0;function Nr(u){try{return zo(u.chunker)}catch(O){if(O=z(O),w(O,10))return!1;throw O}}function Do(u,O,H,q,Q){var J,fe;if(!Q)throw Je(new jn,"null mode");if(be(q,p)<0)throw Je(new jn,"invalid length "+Mo(q));for(u.length_0=q,J=gr(new Qi),Fr(Q,J),J._writeEndMark=!0,dt(J,H),fe=0;fe<64;fe+=8)Oo(H,lt(or(q,fe))&255);u.chunker=(J._needReleaseMFStream=!1,J._inStream=O,J._finished=!1,Jn(J),J._rangeEncoder.Stream=H,ye(J),fo(J),Hr(J),J._lenEncoder._tableSize=J._numFastBytes+1-2,po(J._lenEncoder,1<<J._posStateBits),J._repMatchLenEncoder._tableSize=J._numFastBytes+1-2,po(J._repMatchLenEncoder,1<<J._posStateBits),J.nowPos64=m,Ct(new Yi,J))}function zr(){return Rd}function rt(){}l=rt.prototype=new G,l.getClass$=zr,l.typeId$=0,l.chunker=null;function Gn(u,O,H){u.output=qn(new Ii);try{Do(u,Zn(new Ar,O),u.output,at(O.length),H)}catch(q){throw q=z(q),w(q,10)?X(new _e,"impossible exception"):q}return u}function Dt(){return Bd}function lo(){}l=lo.prototype=new rt,l.getClass$=Dt,l.typeId$=0,l.output=null;function uo(u){var O;try{return zo(u.chunker)}catch(H){if(H=z(H),w(H,10))return O=H,u.exception=O,!1;throw H}}function Io(u,O,H){var q,Q="",J,fe,Ce,He;for(fe=Me(yr,0,-1,5,1),J=0;J<fe.length;++J){if(Ce=Di(O),Ce==-1)throw Or(new lr,"truncated input");fe[J]=Ce<<24>>24}if(q=Hs(new xs),!fr(q,fe))throw Or(new lr,"corrupted input");for(J=0;J<64;J+=8){if(Ce=Di(O),Ce==-1)throw Or(new lr,"truncated input");Ce=Ce.toString(16),Ce.length==1&&(Ce="0"+Ce),Q=Ce+""+Q}Q.toLowerCase()=="ffffffffffffffffff"||Q==0?u.length_0=p:(He=parseInt(Q,16),He>4294967295?u.length_0=p:u.length_0=Ge(He)),u.chunker=vs(q,O,H,u.length_0)}function Fo(){return Dd}function g(){}l=g.prototype=new G,l.getClass$=Fo,l.typeId$=0,l.chunker=null,l.exception=null,l.length_0=m;function C(u,O){return u.output=qn(new Ii),Io(u,Zn(new Ar,O),u.output),u}function T(){return Id}function k(){}l=k.prototype=new g,l.getClass$=T,l.typeId$=0,l.output=null;function N(u,O,H,q){var Q;u._keepSizeBefore=O,u._keepSizeAfter=H,Q=O+H+q,(u._bufferBase==null||u._blockSize!=Q)&&(u._bufferBase=null,u._blockSize=Q,u._bufferBase=Me(yr,0,-1,u._blockSize,1)),u._pointerToLastSafePosition=u._blockSize-H}function U(u,O){return u._bufferBase[u._bufferOffset+u._pos+O]}function V(u,O,H,q){var Q,J;for(u._streamEndWasReached&&u._pos+O+q>u._streamPos&&(q=u._streamPos-(u._pos+O)),++H,J=u._bufferOffset+u._pos+O,Q=0;Q<q&&u._bufferBase[J+Q]==u._bufferBase[J+Q-H];++Q);return Q}function ee(u){return u._streamPos-u._pos}function ae(u){var O,H,q;for(q=u._bufferOffset+u._pos-u._keepSizeBefore,q>0&&--q,H=u._bufferOffset+u._streamPos-q,O=0;O<H;++O)u._bufferBase[O]=u._bufferBase[q+O];u._bufferOffset-=q}function ge(u){var O;++u._pos,u._pos>u._posLimit&&(O=u._bufferOffset+u._pos,O>u._pointerToLastSafePosition&&ae(u),he(u))}function he(u){var O,H,q;if(!u._streamEndWasReached)for(;;){if(q=-u._bufferOffset+u._blockSize-u._streamPos,q==0)return;if(O=Eo(u._stream,u._bufferBase,u._bufferOffset+u._streamPos,q),O==-1){u._posLimit=u._streamPos,H=u._bufferOffset+u._posLimit,H>u._pointerToLastSafePosition&&(u._posLimit=u._pointerToLastSafePosition-u._bufferOffset),u._streamEndWasReached=!0;return}u._streamPos+=O,u._streamPos>=u._pos+u._keepSizeAfter&&(u._posLimit=u._streamPos-u._keepSizeAfter)}}function Le(u,O){u._bufferOffset+=O,u._posLimit-=O,u._pos-=O,u._streamPos-=O}function me(){return cd}function Pe(){}l=Pe.prototype=new G,l.getClass$=me,l.typeId$=0,l._blockSize=0,l._bufferBase=null,l._bufferOffset=0,l._keepSizeAfter=0,l._keepSizeBefore=0,l._pointerToLastSafePosition=0,l._pos=0,l._posLimit=0,l._stream=null,l._streamEndWasReached=!1,l._streamPos=0;function Xe(){Xe=_r;var u,O,H;for(Hn=Me(xi,0,-1,256,1),u=0;u<256;++u){for(H=u,O=0;O<8;++O)H&1?H=H>>>1^-306674912:H>>>=1;Hn[u]=H}}function Ve(u,O,H,q,Q){var J,fe,Ce;return O>1073741567?!1:(u._cutValue=16+(q>>1),Ce=~~((O+H+q+Q)/2)+256,N(u,O+H,q+Q,Ce),u._matchMaxLen=q,J=O+1,u._cyclicBufferSize!=J&&(u._son=Me(xi,0,-1,(u._cyclicBufferSize=J)*2,1)),fe=65536,u.HASH_ARRAY&&(fe=O-1,fe|=fe>>1,fe|=fe>>2,fe|=fe>>4,fe|=fe>>8,fe>>=1,fe|=65535,fe>16777216&&(fe>>=1),u._hashMask=fe,++fe,fe+=u.kFixHashSize),fe!=u._hashSizeSum&&(u._hash=Me(xi,0,-1,u._hashSizeSum=fe,1)),!0)}function ut(u,O){var H,q,Q,J,fe,Ce,He,ze,ke,Nt,_t,Lt,Bn,Ze,Ot,vn,kt,$i,$n,er,vr;if(u._pos+u._matchMaxLen<=u._streamPos)Ze=u._matchMaxLen;else if(Ze=u._streamPos-u._pos,Ze<u.kMinMatchCheck)return Yt(u),0;for(kt=0,Ot=u._pos>u._cyclicBufferSize?u._pos-u._cyclicBufferSize:0,q=u._bufferOffset+u._pos,vn=1,ze=0,ke=0,u.HASH_ARRAY?(vr=Hn[u._bufferBase[q]&255]^u._bufferBase[q+1]&255,ze=vr&1023,vr^=(u._bufferBase[q+2]&255)<<8,ke=vr&65535,Nt=(vr^Hn[u._bufferBase[q+3]&255]<<5)&u._hashMask):Nt=u._bufferBase[q]&255^(u._bufferBase[q+1]&255)<<8,Q=u._hash[u.kFixHashSize+Nt],u.HASH_ARRAY&&(J=u._hash[ze],fe=u._hash[1024+ke],u._hash[ze]=u._pos,u._hash[1024+ke]=u._pos,J>Ot&&u._bufferBase[u._bufferOffset+J]==u._bufferBase[q]&&(O[kt++]=vn=2,O[kt++]=u._pos-J-1),fe>Ot&&u._bufferBase[u._bufferOffset+fe]==u._bufferBase[q]&&(fe==J&&(kt-=2),O[kt++]=vn=3,O[kt++]=u._pos-fe-1,J=fe),kt!=0&&J==Q&&(kt-=2,vn=1)),u._hash[u.kFixHashSize+Nt]=u._pos,$n=(u._cyclicBufferPos<<1)+1,er=u._cyclicBufferPos<<1,Lt=Bn=u.kNumHashDirectBytes,u.kNumHashDirectBytes!=0&&Q>Ot&&u._bufferBase[u._bufferOffset+Q+u.kNumHashDirectBytes]!=u._bufferBase[q+u.kNumHashDirectBytes]&&(O[kt++]=vn=u.kNumHashDirectBytes,O[kt++]=u._pos-Q-1),H=u._cutValue;;){if(Q<=Ot||H--==0){u._son[$n]=u._son[er]=0;break}if(He=u._pos-Q,Ce=(He<=u._cyclicBufferPos?u._cyclicBufferPos-He:u._cyclicBufferPos-He+u._cyclicBufferSize)<<1,$i=u._bufferOffset+Q,_t=Lt<Bn?Lt:Bn,u._bufferBase[$i+_t]==u._bufferBase[q+_t]){for(;++_t!=Ze&&u._bufferBase[$i+_t]==u._bufferBase[q+_t];);if(vn<_t&&(O[kt++]=vn=_t,O[kt++]=He-1,_t==Ze)){u._son[er]=u._son[Ce],u._son[$n]=u._son[Ce+1];break}}(u._bufferBase[$i+_t]&255)<(u._bufferBase[q+_t]&255)?(u._son[er]=Q,er=Ce+1,Q=u._son[er],Bn=_t):(u._son[$n]=Q,$n=Ce,Q=u._son[$n],Lt=_t)}return Yt(u),kt}function Yn(u){var O;for(u._bufferOffset=0,u._pos=0,u._streamPos=0,u._streamEndWasReached=!1,he(u),O=0;O<u._hashSizeSum;++O)u._hash[O]=0;u._cyclicBufferPos=0,Le(u,-1)}function Yt(u){var O;++u._cyclicBufferPos>=u._cyclicBufferSize&&(u._cyclicBufferPos=0),ge(u),u._pos==1073741823&&(O=u._pos-u._cyclicBufferSize,Ti(u._son,u._cyclicBufferSize*2,O),Ti(u._hash,u._hashSizeSum,O),Le(u,O))}function Ti(u,O,H){var q,Q;for(q=0;q<O;++q)Q=u[q],Q<=H?Q=0:Q-=H,u[q]=Q}function De(u,O){u.HASH_ARRAY=O>2,u.HASH_ARRAY?(u.kNumHashDirectBytes=0,u.kMinMatchCheck=4,u.kFixHashSize=66560):(u.kNumHashDirectBytes=2,u.kMinMatchCheck=3,u.kFixHashSize=0)}function gn(u,O){var H,q,Q,J,fe,Ce,He,ze,ke,Nt,_t,Lt,Bn,Ze,Ot,vn,kt;do{if(u._pos+u._matchMaxLen<=u._streamPos)Lt=u._matchMaxLen;else if(Lt=u._streamPos-u._pos,Lt<u.kMinMatchCheck){Yt(u);continue}for(Bn=u._pos>u._cyclicBufferSize?u._pos-u._cyclicBufferSize:0,q=u._bufferOffset+u._pos,u.HASH_ARRAY?(kt=Hn[u._bufferBase[q]&255]^u._bufferBase[q+1]&255,Ce=kt&1023,u._hash[Ce]=u._pos,kt^=(u._bufferBase[q+2]&255)<<8,He=kt&65535,u._hash[1024+He]=u._pos,ze=(kt^Hn[u._bufferBase[q+3]&255]<<5)&u._hashMask):ze=u._bufferBase[q]&255^(u._bufferBase[q+1]&255)<<8,Q=u._hash[u.kFixHashSize+ze],u._hash[u.kFixHashSize+ze]=u._pos,Ot=(u._cyclicBufferPos<<1)+1,vn=u._cyclicBufferPos<<1,Nt=_t=u.kNumHashDirectBytes,H=u._cutValue;;){if(Q<=Bn||H--==0){u._son[Ot]=u._son[vn]=0;break}if(fe=u._pos-Q,J=(fe<=u._cyclicBufferPos?u._cyclicBufferPos-fe:u._cyclicBufferPos-fe+u._cyclicBufferSize)<<1,Ze=u._bufferOffset+Q,ke=Nt<_t?Nt:_t,u._bufferBase[Ze+ke]==u._bufferBase[q+ke]){for(;++ke!=Lt&&u._bufferBase[Ze+ke]==u._bufferBase[q+ke];);if(ke==Lt){u._son[vn]=u._son[J],u._son[Ot]=u._son[J+1];break}}(u._bufferBase[Ze+ke]&255)<(u._bufferBase[q+ke]&255)?(u._son[vn]=Q,vn=J+1,Q=u._son[vn],_t=ke):(u._son[Ot]=Q,Ot=J,Q=u._son[Ot],Nt=ke)}Yt(u)}while(--O!=0)}function ht(){return hd}function Ut(){}l=Ut.prototype=new Pe,l.getClass$=ht,l.typeId$=0,l.HASH_ARRAY=!0,l._cutValue=255,l._cyclicBufferPos=0,l._cyclicBufferSize=0,l._hash=null,l._hashMask=0,l._hashSizeSum=0,l._matchMaxLen=0,l._son=null,l.kFixHashSize=66560,l.kMinMatchCheck=4,l.kNumHashDirectBytes=0;var Hn;function Un(u,O,H){var q;for(q=u._pos-O-1,q<0&&(q+=u._windowSize);H!=0;--H)q>=u._windowSize&&(q=0),u._buffer[u._pos++]=u._buffer[q++],u._pos>=u._windowSize&&Kn(u)}function _i(u,O){(u._buffer==null||u._windowSize!=O)&&(u._buffer=Me(yr,0,-1,O,1)),u._windowSize=O,u._pos=0,u._streamPos=0}function Kn(u){var O;O=u._pos-u._streamPos,O!=0&&(gs(u._stream,u._buffer,u._streamPos,O),u._pos>=u._windowSize&&(u._pos=0),u._streamPos=u._pos)}function mn(u,O){var H;return H=u._pos-O-1,H<0&&(H+=u._windowSize),u._buffer[H]}function Pi(u,O){O||(u._streamPos=0,u._pos=0)}function Ln(u,O){u._buffer[u._pos++]=O,u._pos>=u._windowSize&&Kn(u)}function Xn(u){Kn(u),u._stream=null}function zs(u,O){Kn(u),u._stream=null,u._stream=O}function yi(){return fd}function No(){}l=No.prototype=new G,l.getClass$=yi,l.typeId$=0,l._buffer=null,l._pos=0,l._stream=null,l._streamPos=0,l._windowSize=0;function ci(u){return u-=2,u<4?u:3}function hi(u){return u<4?0:u<10?u-3:u-6}function Ct(u,O){return u.encoder=O,u.decoder=null,u.alive=!0,u}function Qn(u,O){return u.decoder=O,u.encoder=null,u.alive=!0,u}function zo(u){var O;if(!u.alive)throw new Cn;O=!0;try{return u.encoder?An(u):hr(u),O=!1,u.alive}finally{O&&(u.alive=!1)}}function hr(u){var O;if(O=bs(u.decoder),O==-1)throw Or(new lr,"corrupted input");u.inBytesProcessed=p,u.outBytesProcessed=u.decoder.nowPos64,(O==1||be(u.decoder.outSize,m)>=0&&be(u.decoder.nowPos64,u.decoder.outSize)>=0)&&(js(u.decoder),u.alive=!1)}function An(u){Vs(u.encoder,u.encoder.processedInSize,u.encoder.processedOutSize,u.encoder.finished),u.inBytesProcessed=u.encoder.processedInSize[0],u.encoder.finished[0]&&(st(u.encoder),u.alive=!1)}function ys(){return dd}function Yi(){}l=Yi.prototype=new G,l.getClass$=ys,l.typeId$=0,l.alive=!1,l.decoder=null,l.encoder=null;function js(u){Kn(u.m_OutWindow),Xn(u.m_OutWindow),u.m_RangeDecoder.Stream=null}function vs(u,O,H,q){return u.m_RangeDecoder.Stream=O,zs(u.m_OutWindow,H),jo(u),u.state=0,u.rep0=0,u.rep1=0,u.rep2=0,u.rep3=0,u.outSize=q,u.nowPos64=m,u.prevByte=0,Qn(new Yi,u)}function bs(u){var O,H,q,Q,J,fe;if(fe=lt(u.nowPos64)&u.m_PosStateMask,Rn(u.m_RangeDecoder,u.m_IsMatchDecoders,(u.state<<4)+fe)==0)O=Sn(u.m_LiteralDecoder,lt(u.nowPos64),u.prevByte),u.state<7?u.prevByte=ji(O,u.m_RangeDecoder):u.prevByte=co(O,u.m_RangeDecoder,mn(u.m_OutWindow,u.rep0)),Ln(u.m_OutWindow,u.prevByte),u.state=hi(u.state),u.nowPos64=j(u.nowPos64,_);else{if(Rn(u.m_RangeDecoder,u.m_IsRepDecoders,u.state)==1)q=0,Rn(u.m_RangeDecoder,u.m_IsRepG0Decoders,u.state)==0?Rn(u.m_RangeDecoder,u.m_IsRep0LongDecoders,(u.state<<4)+fe)==0&&(u.state=u.state<7?9:11,q=1):(Rn(u.m_RangeDecoder,u.m_IsRepG1Decoders,u.state)==0?H=u.rep1:(Rn(u.m_RangeDecoder,u.m_IsRepG2Decoders,u.state)==0?H=u.rep2:(H=u.rep3,u.rep3=u.rep2),u.rep2=u.rep1),u.rep1=u.rep0,u.rep0=H),q==0&&(q=Ki(u.m_RepLenDecoder,u.m_RangeDecoder,fe)+2,u.state=u.state<7?8:11);else if(u.rep3=u.rep2,u.rep2=u.rep1,u.rep1=u.rep0,q=2+Ki(u.m_LenDecoder,u.m_RangeDecoder,fe),u.state=u.state<7?7:10,J=M(u.m_PosSlotDecoder[ci(q)],u.m_RangeDecoder),J>=4){if(Q=(J>>1)-1,u.rep0=(2|J&1)<<Q,J<14)u.rep0+=W(u.m_PosDecoders,u.rep0-J-1,u.m_RangeDecoder,Q);else if(u.rep0+=Nl(u.m_RangeDecoder,Q-4)<<4,u.rep0+=I(u.m_PosAlignDecoder,u.m_RangeDecoder),u.rep0<0)return u.rep0==-1?1:-1}else u.rep0=J;if(be(at(u.rep0),u.nowPos64)>=0||u.rep0>=u.m_DictionarySizeCheck)return-1;Un(u.m_OutWindow,u.rep0,q),u.nowPos64=j(u.nowPos64,at(q)),u.prevByte=mn(u.m_OutWindow,0)}return 0}function Hs(u){var O;for(u.m_OutWindow=new No,u.m_RangeDecoder=new Ia,u.m_IsMatchDecoders=Me(yn,0,-1,192,1),u.m_IsRepDecoders=Me(yn,0,-1,12,1),u.m_IsRepG0Decoders=Me(yn,0,-1,12,1),u.m_IsRepG1Decoders=Me(yn,0,-1,12,1),u.m_IsRepG2Decoders=Me(yn,0,-1,12,1),u.m_IsRep0LongDecoders=Me(yn,0,-1,192,1),u.m_PosSlotDecoder=Me(Vl,0,7,4,0),u.m_PosDecoders=Me(yn,0,-1,114,1),u.m_PosAlignDecoder=y(new se,4),u.m_LenDecoder=vi(new xt),u.m_RepLenDecoder=vi(new xt),u.m_LiteralDecoder=new Uo,O=0;O<4;++O)u.m_PosSlotDecoder[O]=y(new se,6);return u}function jo(u){var O;for(Pi(u.m_OutWindow,!1),cn(u.m_IsMatchDecoders),cn(u.m_IsRep0LongDecoders),cn(u.m_IsRepDecoders),cn(u.m_IsRepG0Decoders),cn(u.m_IsRepG1Decoders),cn(u.m_IsRepG2Decoders),cn(u.m_PosDecoders),fi(u.m_LiteralDecoder),O=0;O<4;++O)cn(u.m_PosSlotDecoder[O].Models);sn(u.m_LenDecoder),sn(u.m_RepLenDecoder),cn(u.m_PosAlignDecoder.Models),zl(u.m_RangeDecoder)}function fr(u,O){var H,q,Q,J,fe,Ce,He;if(O.length<5)return!1;for(He=O[0]&255,Q=He%9,Ce=~~(He/9),J=Ce%5,fe=~~(Ce/5),H=0,q=0;q<4;++q)H+=(O[1+q]&255)<<q*8;return Ws(u,Q,J,fe)?Us(u,H):!1}function Us(u,O){return O<0?!1:(u.m_DictionarySize!=O&&(u.m_DictionarySize=O,u.m_DictionarySizeCheck=En(u.m_DictionarySize,1),_i(u.m_OutWindow,En(u.m_DictionarySizeCheck,4096))),!0)}function Ws(u,O,H,q){var Q;return O>8||H>4||q>4?!1:(Ho(u.m_LiteralDecoder,H,O),Q=1<<q,On(u.m_LenDecoder,Q),On(u.m_RepLenDecoder,Q),u.m_PosStateMask=Q-1,!0)}function dr(){return pd}function xs(){}l=xs.prototype=new G,l.getClass$=dr,l.typeId$=0,l.m_DictionarySize=-1,l.m_DictionarySizeCheck=-1,l.m_PosStateMask=0,l.nowPos64=m,l.outSize=m,l.prevByte=0,l.rep0=0,l.rep1=0,l.rep2=0,l.rep3=0,l.state=0;function On(u,O){for(;u.m_NumPosStates<O;++u.m_NumPosStates)u.m_LowCoder[u.m_NumPosStates]=y(new se,3),u.m_MidCoder[u.m_NumPosStates]=y(new se,3)}function Ki(u,O,H){var q;return Rn(O,u.m_Choice,0)==0?M(u.m_LowCoder[H],O):(q=8,Rn(O,u.m_Choice,1)==0?q+=M(u.m_MidCoder[H],O):q+=8+M(u.m_HighCoder,O),q)}function vi(u){return u.m_Choice=Me(yn,0,-1,2,1),u.m_LowCoder=Me(Vl,0,7,16,0),u.m_MidCoder=Me(Vl,0,7,16,0),u.m_HighCoder=y(new se,8),u}function sn(u){var O;for(cn(u.m_Choice),O=0;O<u.m_NumPosStates;++O)cn(u.m_LowCoder[O].Models),cn(u.m_MidCoder[O].Models);cn(u.m_HighCoder.Models)}function ws(){return gd}function xt(){}l=xt.prototype=new G,l.getClass$=ws,l.typeId$=0,l.m_NumPosStates=0;function Ho(u,O,H){var q,Q;if(!(u.m_Coders!=null&&u.m_NumPrevBits==H&&u.m_NumPosBits==O))for(u.m_NumPosBits=O,u.m_PosMask=(1<<O)-1,u.m_NumPrevBits=H,Q=1<<u.m_NumPrevBits+u.m_NumPosBits,u.m_Coders=Me(md,0,4,Q,0),q=0;q<Q;++q)u.m_Coders[q]=Xi(new Wo)}function Sn(u,O,H){return u.m_Coders[((O&u.m_PosMask)<<u.m_NumPrevBits)+((H&255)>>>8-u.m_NumPrevBits)]}function fi(u){var O,H;for(H=1<<u.m_NumPrevBits+u.m_NumPosBits,O=0;O<H;++O)cn(u.m_Coders[O].m_Decoders)}function pr(){return _d}function Uo(){}l=Uo.prototype=new G,l.getClass$=pr,l.typeId$=0,l.m_Coders=null,l.m_NumPosBits=0,l.m_NumPrevBits=0,l.m_PosMask=0;function ji(u,O){var H;H=1;do H=H<<1|Rn(O,u.m_Decoders,H);while(H<256);return H<<24>>24}function co(u,O,H){var q,Q,J;J=1;do if(Q=H>>7&1,H<<=1,q=Rn(O,u.m_Decoders,(1+Q<<8)+J),J=J<<1|q,Q!=q){for(;J<256;)J=J<<1|Rn(O,u.m_Decoders,J);break}while(J<256);return J<<24>>24}function Xi(u){return u.m_Decoders=Me(yn,0,-1,768,1),u}function jr(){return yd}function Wo(){}l=Wo.prototype=new G,l.getClass$=jr,l.typeId$=17;function Wn(){Wn=_r;var u,O,H,q;for(kn=Me(yr,0,-1,2048,1),u=2,kn[0]=0,kn[1]=1,q=2;q<22;++q)for(H=1<<(q>>1)-1,O=0;O<H;++O,++u)kn[u]=q<<24>>24}function ho(u,O){var H,q,Q,J;u._optimumEndIndex=O,Q=u._optimum[O].PosPrev,q=u._optimum[O].BackPrev;do u._optimum[O].Prev1IsChar&&(Xs(u._optimum[Q]),u._optimum[Q].PosPrev=Q-1,u._optimum[O].Prev2&&(u._optimum[Q-1].Prev1IsChar=!1,u._optimum[Q-1].PosPrev=u._optimum[O].PosPrev2,u._optimum[Q-1].BackPrev=u._optimum[O].BackPrev2)),J=Q,H=q,q=u._optimum[J].BackPrev,Q=u._optimum[J].PosPrev,u._optimum[J].BackPrev=H,u._optimum[J].PosPrev=O,O=J;while(O>0);return u.backRes=u._optimum[0].BackPrev,u._optimumCurrentIndex=u._optimum[0].PosPrev,u._optimumCurrentIndex}function Hi(u){var O;for(u._state=0,u._previousByte=0,O=0;O<4;++O)u._repDistances[O]=0}function Vs(u,O,H,q){var Q,J,fe,Ce,He,ze,ke,Nt,_t,Lt,Bn,Ze,Ot,vn,kt;if(O[0]=m,H[0]=m,q[0]=!0,u._inStream&&(u._matchFinder._stream=u._inStream,Yn(u._matchFinder),u._needReleaseMFStream=!0,u._inStream=null),!u._finished){if(u._finished=!0,vn=u.nowPos64,ot(u.nowPos64,m)){if(ee(u._matchFinder)==0){Y(u,lt(u.nowPos64));return}Te(u),Ot=lt(u.nowPos64)&u._posStateMask,ft(u._rangeEncoder,u._isMatch,(u._state<<4)+Ot,0),u._state=hi(u._state),fe=U(u._matchFinder,-u._additionalOffset),Ys(Wr(u._literalEncoder,lt(u.nowPos64),u._previousByte),u._rangeEncoder,fe),u._previousByte=fe,--u._additionalOffset,u.nowPos64=j(u.nowPos64,_)}if(ee(u._matchFinder)==0){Y(u,lt(u.nowPos64));return}for(;;){if(ke=ne(u,lt(u.nowPos64)),Lt=u.backRes,Ot=lt(u.nowPos64)&u._posStateMask,J=(u._state<<4)+Ot,ke==1&&Lt==-1)ft(u._rangeEncoder,u._isMatch,J,0),fe=U(u._matchFinder,-u._additionalOffset),kt=Wr(u._literalEncoder,lt(u.nowPos64),u._previousByte),u._state<7?Ys(kt,u._rangeEncoder,fe):(_t=U(u._matchFinder,-u._repDistances[0]-1-u._additionalOffset),Ra(kt,u._rangeEncoder,_t,fe)),u._previousByte=fe,u._state=hi(u._state);else{if(ft(u._rangeEncoder,u._isMatch,J,1),Lt<4){if(ft(u._rangeEncoder,u._isRep,u._state,1),Lt==0?(ft(u._rangeEncoder,u._isRepG0,u._state,0),ke==1?ft(u._rangeEncoder,u._isRep0Long,J,0):ft(u._rangeEncoder,u._isRep0Long,J,1)):(ft(u._rangeEncoder,u._isRepG0,u._state,1),Lt==1?ft(u._rangeEncoder,u._isRepG1,u._state,0):(ft(u._rangeEncoder,u._isRepG1,u._state,1),ft(u._rangeEncoder,u._isRepG2,u._state,Lt-2))),ke==1?u._state=u._state<7?9:11:(Ei(u._repMatchLenEncoder,u._rangeEncoder,ke-2,Ot),u._state=u._state<7?8:11),Ce=u._repDistances[Lt],Lt!=0){for(ze=Lt;ze>=1;--ze)u._repDistances[ze]=u._repDistances[ze-1];u._repDistances[0]=Ce}}else{for(ft(u._rangeEncoder,u._isRep,u._state,0),u._state=u._state<7?7:10,Ei(u._lenEncoder,u._rangeEncoder,ke-2,Ot),Lt-=4,Ze=an(Lt),Nt=ci(ke),xe(u._posSlotEncoder[Nt],u._rangeEncoder,Ze),Ze>=4&&(He=(Ze>>1)-1,Q=(2|Ze&1)<<He,Bn=Lt-Q,Ze<14?bi(u._posEncoders,Q-Ze-1,u._rangeEncoder,He,Bn):(Go(u._rangeEncoder,Bn>>4,He-4),tt(u._posAlignEncoder,u._rangeEncoder,Bn&15),++u._alignPriceCount)),Ce=Lt,ze=3;ze>=1;--ze)u._repDistances[ze]=u._repDistances[ze-1];u._repDistances[0]=Ce,++u._matchPriceCount}u._previousByte=U(u._matchFinder,ke-1-u._additionalOffset)}if(u._additionalOffset-=ke,u.nowPos64=j(u.nowPos64,at(ke)),u._additionalOffset==0){if(u._matchPriceCount>=128&&fo(u),u._alignPriceCount>=16&&Hr(u),O[0]=u.nowPos64,H[0]=Hl(u._rangeEncoder),ee(u._matchFinder)==0){Y(u,lt(u.nowPos64));return}if(be(ui(u.nowPos64,vn),x)>=0){u._finished=!1,q[0]=!1;return}}}}}function Jn(u){var O,H;u._matchFinder||(O=(Xe(),new Ut),H=4,u._matchFinderType==0&&(H=2),De(O,H),u._matchFinder=O),Zo(u._literalEncoder,u._numLiteralPosStateBits,u._numLiteralContextBits),!(u._dictionarySize==u._dictionarySizePrev&&u._numFastBytesPrev==u._numFastBytes)&&(Ve(u._matchFinder,u._dictionarySize,4096,u._numFastBytes,274),u._dictionarySizePrev=u._dictionarySize,u._numFastBytesPrev=u._numFastBytes)}function gr(u){var O;for(Wn(),u._repDistances=Me(xi,0,-1,4,1),u._optimum=Me(vd,0,6,4096,0),u._rangeEncoder=(Ai(),new Hu),u._isMatch=Me(yn,0,-1,192,1),u._isRep=Me(yn,0,-1,12,1),u._isRepG0=Me(yn,0,-1,12,1),u._isRepG1=Me(yn,0,-1,12,1),u._isRepG2=Me(yn,0,-1,12,1),u._isRep0Long=Me(yn,0,-1,192,1),u._posSlotEncoder=Me(Zl,0,8,4,0),u._posEncoders=Me(yn,0,-1,114,1),u._posAlignEncoder=de(new di,4),u._lenEncoder=qs(new go),u._repMatchLenEncoder=qs(new go),u._literalEncoder=new Gs,u._matchDistances=Me(xi,0,-1,548,1),u._posSlotPrices=Me(xi,0,-1,256,1),u._distancesPrices=Me(xi,0,-1,512,1),u._alignPrices=Me(xi,0,-1,16,1),u.reps=Me(xi,0,-1,4,1),u.repLens=Me(xi,0,-1,4,1),u.processedInSize=Me(Vu,0,-1,1,3),u.processedOutSize=Me(Vu,0,-1,1,3),u.finished=Me(bd,0,-1,1,2),u.properties=Me(yr,0,-1,5,1),u.tempPrices=Me(xi,0,-1,128,1),O=0;O<4096;++O)u._optimum[O]=new h;for(O=0;O<4;++O)u._posSlotEncoder[O]=de(new di,6);return u}function Hr(u){var O;for(O=0;O<16;++O)u._alignPrices[O]=bt(u._posAlignEncoder,O);u._alignPriceCount=0}function fo(u){var O,H,q,Q,J,fe,Ce,He;for(Q=4;Q<128;++Q)fe=an(Q),q=(fe>>1)-1,O=(2|fe&1)<<q,u.tempPrices[Q]=Vr(u._posEncoders,O-fe-1,q,Q-O);for(J=0;J<4;++J){for(H=u._posSlotEncoder[J],Ce=J<<6,fe=0;fe<u._distTableSize;++fe)u._posSlotPrices[Ce+fe]=Ae(H,fe);for(fe=14;fe<u._distTableSize;++fe)u._posSlotPrices[Ce+fe]+=(fe>>1)-1-4<<6;for(He=J*128,Q=0;Q<4;++Q)u._distancesPrices[He+Q]=u._posSlotPrices[Ce+Q];for(;Q<128;++Q)u._distancesPrices[He+Q]=u._posSlotPrices[Ce+an(Q)]+u.tempPrices[Q]}u._matchPriceCount=0}function Y(u,O){Fe(u),$t(u,O&u._posStateMask),jl(u._rangeEncoder)}function ne(u,O){var H,q,Q,J,fe,Ce,He,ze,ke,Nt,_t,Lt,Bn,Ze,Ot,vn,kt,$i,$n,er,vr,Oi,Ls,Na,tr,br,xr,wi,Zr,bn,nt,_o,Ko,ei,ti,Zu,nr,Qs,Xo,qr,Ss,Js,Rt,Dn,Ms,qu,Gu,Yu,Ku,Xu;if(u._optimumEndIndex!=u._optimumCurrentIndex)return Bn=u._optimum[u._optimumCurrentIndex].PosPrev-u._optimumCurrentIndex,u.backRes=u._optimum[u._optimumCurrentIndex].BackPrev,u._optimumCurrentIndex=u._optimum[u._optimumCurrentIndex].PosPrev,Bn;if(u._optimumCurrentIndex=u._optimumEndIndex=0,u._longestMatchWasFound?(Lt=u._longestMatchLength,u._longestMatchWasFound=!1):Lt=Te(u),xr=u._numDistancePairs,tr=ee(u._matchFinder)+1,tr<2)return u.backRes=-1,1;for(tr>273&&(tr=273),qr=0,ke=0;ke<4;++ke)u.reps[ke]=u._repDistances[ke],u.repLens[ke]=V(u._matchFinder,-1,u.reps[ke],273),u.repLens[ke]>u.repLens[qr]&&(qr=ke);if(u.repLens[qr]>=u._numFastBytes)return u.backRes=qr,Bn=u.repLens[qr],ve(u,Bn-1),Bn;if(Lt>=u._numFastBytes)return u.backRes=u._matchDistances[xr-1]+4,ve(u,Lt-1),Lt;if(He=U(u._matchFinder,-1),kt=U(u._matchFinder,-u._repDistances[0]-1-1),Lt<2&&He!=kt&&u.repLens[qr]<2)return u.backRes=-1,1;if(u._optimum[0].State=u._state,ei=O&u._posStateMask,u._optimum[1].Price=(Ai(),Tt[u._isMatch[(u._state<<4)+ei]>>>2]+qo(Wr(u._literalEncoder,O,u._previousByte),u._state>=7,kt,He)),Xs(u._optimum[1]),$i=Tt[2048-u._isMatch[(u._state<<4)+ei]>>>2],Xo=$i+Tt[2048-u._isRep[u._state]>>>2],kt==He&&(Ss=Xo+ue(u,u._state,ei),Ss<u._optimum[1].Price&&(u._optimum[1].Price=Ss,Fl(u._optimum[1]))),_t=Lt>=u.repLens[qr]?Lt:u.repLens[qr],_t<2)return u.backRes=u._optimum[1].BackPrev,1;u._optimum[1].PosPrev=0,u._optimum[0].Backs0=u.reps[0],u._optimum[0].Backs1=u.reps[1],u._optimum[0].Backs2=u.reps[2],u._optimum[0].Backs3=u.reps[3],Nt=_t;do u._optimum[Nt--].Price=268435455;while(Nt>=2);for(ke=0;ke<4;++ke)if(Qs=u.repLens[ke],!(Qs<2)){Zu=Xo+ce(u,ke,u._state,ei);do J=Zu+mr(u._repMatchLenEncoder,Qs-2,ei),nt=u._optimum[Qs],J<nt.Price&&(nt.Price=J,nt.PosPrev=0,nt.BackPrev=ke,nt.Prev1IsChar=!1);while(--Qs>=2)}if(Na=$i+Tt[u._isRep[u._state]>>>2],Nt=u.repLens[0]>=2?u.repLens[0]+1:2,Nt<=Lt){for(wi=0;Nt>u._matchDistances[wi];)wi+=2;for(;ze=u._matchDistances[wi+1],J=Na+re(u,ze,Nt,ei),nt=u._optimum[Nt],J<nt.Price&&(nt.Price=J,nt.PosPrev=0,nt.BackPrev=ze+4,nt.Prev1IsChar=!1),!(Nt==u._matchDistances[wi]&&(wi+=2,wi==xr));++Nt);}for(H=0;;){if(++H,H==_t)return ho(u,H);if($n=Te(u),xr=u._numDistancePairs,$n>=u._numFastBytes)return u._longestMatchLength=$n,u._longestMatchWasFound=!0,ho(u,H);if(++O,Ko=u._optimum[H].PosPrev,u._optimum[H].Prev1IsChar?(--Ko,u._optimum[H].Prev2?(Rt=u._optimum[u._optimum[H].PosPrev2].State,u._optimum[H].BackPrev2<4?Rt=Rt<7?8:11:Rt=Rt<7?7:10):Rt=u._optimum[Ko].State,Rt=hi(Rt)):Rt=u._optimum[Ko].State,Ko==H-1?u._optimum[H].BackPrev==0?Rt=Rt<7?9:11:Rt=hi(Rt):(u._optimum[H].Prev1IsChar&&u._optimum[H].Prev2?(Ko=u._optimum[H].PosPrev2,_o=u._optimum[H].BackPrev2,Rt=Rt<7?8:11):(_o=u._optimum[H].BackPrev,_o<4?Rt=Rt<7?8:11:Rt=Rt<7?7:10),bn=u._optimum[Ko],_o<4?_o==0?(u.reps[0]=bn.Backs0,u.reps[1]=bn.Backs1,u.reps[2]=bn.Backs2,u.reps[3]=bn.Backs3):_o==1?(u.reps[0]=bn.Backs1,u.reps[1]=bn.Backs0,u.reps[2]=bn.Backs2,u.reps[3]=bn.Backs3):_o==2?(u.reps[0]=bn.Backs2,u.reps[1]=bn.Backs0,u.reps[2]=bn.Backs1,u.reps[3]=bn.Backs3):(u.reps[0]=bn.Backs3,u.reps[1]=bn.Backs0,u.reps[2]=bn.Backs1,u.reps[3]=bn.Backs2):(u.reps[0]=_o-4,u.reps[1]=bn.Backs0,u.reps[2]=bn.Backs1,u.reps[3]=bn.Backs2)),u._optimum[H].State=Rt,u._optimum[H].Backs0=u.reps[0],u._optimum[H].Backs1=u.reps[1],u._optimum[H].Backs2=u.reps[2],u._optimum[H].Backs3=u.reps[3],Ce=u._optimum[H].Price,He=U(u._matchFinder,-1),kt=U(u._matchFinder,-u.reps[0]-1-1),ei=O&u._posStateMask,q=Ce+Tt[u._isMatch[(Rt<<4)+ei]>>>2]+qo(Wr(u._literalEncoder,O,U(u._matchFinder,-2)),Rt>=7,kt,He),Oi=u._optimum[H+1],er=!1,q<Oi.Price&&(Oi.Price=q,Oi.PosPrev=H,Oi.BackPrev=-1,Oi.Prev1IsChar=!1,er=!0),$i=Ce+Tt[2048-u._isMatch[(Rt<<4)+ei]>>>2],Xo=$i+Tt[2048-u._isRep[Rt]>>>2],kt==He&&!(Oi.PosPrev<H&&Oi.BackPrev==0)&&(Ss=Xo+(Tt[u._isRepG0[Rt]>>>2]+Tt[u._isRep0Long[(Rt<<4)+ei]>>>2]),Ss<=Oi.Price&&(Oi.Price=Ss,Oi.PosPrev=H,Oi.BackPrev=0,Oi.Prev1IsChar=!1,er=!0)),br=ee(u._matchFinder)+1,br=4095-H<br?4095-H:br,tr=br,!(tr<2)){if(tr>u._numFastBytes&&(tr=u._numFastBytes),!er&&kt!=He&&(Ms=Ht(br-1,u._numFastBytes),Ot=V(u._matchFinder,0,u.reps[0],Ms),Ot>=2)){for(Dn=hi(Rt),ti=O+1&u._posStateMask,Ls=q+Tt[2048-u._isMatch[(Dn<<4)+ti]>>>2]+Tt[2048-u._isRep[Dn]>>>2],Zr=H+1+Ot;_t<Zr;)u._optimum[++_t].Price=268435455;J=Ls+(qu=mr(u._repMatchLenEncoder,Ot-2,ti),qu+ce(u,0,Dn,ti)),nt=u._optimum[Zr],J<nt.Price&&(nt.Price=J,nt.PosPrev=H+1,nt.BackPrev=0,nt.Prev1IsChar=!0,nt.Prev2=!1)}for(Js=2,nr=0;nr<4;++nr)if(Ze=V(u._matchFinder,-1,u.reps[nr],tr),!(Ze<2)){vn=Ze;do{for(;_t<H+Ze;)u._optimum[++_t].Price=268435455;J=Xo+(Gu=mr(u._repMatchLenEncoder,Ze-2,ei),Gu+ce(u,nr,Rt,ei)),nt=u._optimum[H+Ze],J<nt.Price&&(nt.Price=J,nt.PosPrev=H,nt.BackPrev=nr,nt.Prev1IsChar=!1)}while(--Ze>=2);if(Ze=vn,nr==0&&(Js=Ze+1),Ze<br&&(Ms=Ht(br-1-Ze,u._numFastBytes),Ot=V(u._matchFinder,Ze,u.reps[nr],Ms),Ot>=2)){for(Dn=Rt<7?8:11,ti=O+Ze&u._posStateMask,Q=Xo+(Yu=mr(u._repMatchLenEncoder,Ze-2,ei),Yu+ce(u,nr,Rt,ei))+Tt[u._isMatch[(Dn<<4)+ti]>>>2]+qo(Wr(u._literalEncoder,O+Ze,U(u._matchFinder,Ze-1-1)),!0,U(u._matchFinder,Ze-1-(u.reps[nr]+1)),U(u._matchFinder,Ze-1)),Dn=hi(Dn),ti=O+Ze+1&u._posStateMask,vr=Q+Tt[2048-u._isMatch[(Dn<<4)+ti]>>>2],Ls=vr+Tt[2048-u._isRep[Dn]>>>2],Zr=Ze+1+Ot;_t<H+Zr;)u._optimum[++_t].Price=268435455;J=Ls+(Ku=mr(u._repMatchLenEncoder,Ot-2,ti),Ku+ce(u,0,Dn,ti)),nt=u._optimum[H+Zr],J<nt.Price&&(nt.Price=J,nt.PosPrev=H+Ze+1,nt.BackPrev=0,nt.Prev1IsChar=!0,nt.Prev2=!0,nt.PosPrev2=H,nt.BackPrev2=nr)}}if($n>tr){for($n=tr,xr=0;$n>u._matchDistances[xr];xr+=2);u._matchDistances[xr]=$n,xr+=2}if($n>=Js){for(Na=$i+Tt[u._isRep[Rt]>>>2];_t<H+$n;)u._optimum[++_t].Price=268435455;for(wi=0;Js>u._matchDistances[wi];)wi+=2;for(Ze=Js;;++Ze)if(fe=u._matchDistances[wi+1],J=Na+re(u,fe,Ze,ei),nt=u._optimum[H+Ze],J<nt.Price&&(nt.Price=J,nt.PosPrev=H,nt.BackPrev=fe+4,nt.Prev1IsChar=!1),Ze==u._matchDistances[wi]){if(Ze<br&&(Ms=Ht(br-1-Ze,u._numFastBytes),Ot=V(u._matchFinder,Ze,fe,Ms),Ot>=2)){for(Dn=Rt<7?7:10,ti=O+Ze&u._posStateMask,Q=J+Tt[u._isMatch[(Dn<<4)+ti]>>>2]+qo(Wr(u._literalEncoder,O+Ze,U(u._matchFinder,Ze-1-1)),!0,U(u._matchFinder,Ze-(fe+1)-1),U(u._matchFinder,Ze-1)),Dn=hi(Dn),ti=O+Ze+1&u._posStateMask,vr=Q+Tt[2048-u._isMatch[(Dn<<4)+ti]>>>2],Ls=vr+Tt[2048-u._isRep[Dn]>>>2],Zr=Ze+1+Ot;_t<H+Zr;)u._optimum[++_t].Price=268435455;J=Ls+(Xu=mr(u._repMatchLenEncoder,Ot-2,ti),Xu+ce(u,0,Dn,ti)),nt=u._optimum[H+Zr],J<nt.Price&&(nt.Price=J,nt.PosPrev=H+Ze+1,nt.BackPrev=0,nt.Prev1IsChar=!0,nt.Prev2=!0,nt.PosPrev2=H,nt.BackPrev2=fe+4)}if(wi+=2,wi==xr)break}}}}}function re(u,O,H,q){var Q,J;return Q=ci(H),O<128?J=u._distancesPrices[Q*128+O]:J=u._posSlotPrices[(Q<<6)+_n(O)]+u._alignPrices[O&15],J+mr(u._lenEncoder,H-2,q)}function ce(u,O,H,q){var Q;return O==0?(Q=(Ai(),Tt[u._isRepG0[H]>>>2]),Q+=Tt[2048-u._isRep0Long[(H<<4)+q]>>>2]):(Q=(Ai(),Tt[2048-u._isRepG0[H]>>>2]),O==1?Q+=Tt[u._isRepG1[H]>>>2]:(Q+=Tt[2048-u._isRepG1[H]>>>2],Q+=mo(u._isRepG2[H],O-2))),Q}function ue(u,O,H){return Ai(),Tt[u._isRepG0[O]>>>2]+Tt[u._isRep0Long[(O<<4)+H]>>>2]}function ye(u){var O;for(Hi(u),Ul(u._rangeEncoder),Ji(u._isMatch),Ji(u._isRep0Long),Ji(u._isRep),Ji(u._isRepG0),Ji(u._isRepG1),Ji(u._isRepG2),Ji(u._posEncoders),ka(u._literalEncoder),O=0;O<4;++O)cn(u._posSlotEncoder[O].Models);Ur(u._lenEncoder,1<<u._posStateBits),Ur(u._repMatchLenEncoder,1<<u._posStateBits),cn(u._posAlignEncoder.Models),u._longestMatchWasFound=!1,u._optimumEndIndex=0,u._optimumCurrentIndex=0,u._additionalOffset=0}function ve(u,O){O>0&&(gn(u._matchFinder,O),u._additionalOffset+=O)}function Te(u){var O;return O=0,u._numDistancePairs=ut(u._matchFinder,u._matchDistances),u._numDistancePairs>0&&(O=u._matchDistances[u._numDistancePairs-2],O==u._numFastBytes&&(O+=V(u._matchFinder,O-1,u._matchDistances[u._numDistancePairs-1],273-O))),++u._additionalOffset,O}function Fe(u){u._matchFinder&&u._needReleaseMFStream&&(u._matchFinder._stream=null,u._needReleaseMFStream=!1)}function st(u){Fe(u),u._rangeEncoder.Stream=null}function qe(u,O){var H;if(O<1||O>536870912)return!1;for(u._dictionarySize=O,H=0;O>1<<H;++H);return u._distTableSize=H*2,!0}function Ye(u,O,H,q){return H<0||H>4||O<0||O>8||q<0||q>4?!1:(u._numLiteralPosStateBits=H,u._numLiteralContextBits=O,u._posStateBits=q,u._posStateMask=(1<<u._posStateBits)-1,!0)}function It(u,O){var H;return O<0||O>2?!1:(H=u._matchFinderType,u._matchFinderType=O,u._matchFinder&&H!=u._matchFinderType&&(u._dictionarySizePrev=-1,u._matchFinder=null),!0)}function gt(u,O){return O<5||O>273?!1:(u._numFastBytes=O,!0)}function dt(u,O){var H;for(u.properties[0]=(u._posStateBits*5+u._numLiteralPosStateBits)*9+u._numLiteralContextBits<<24>>24,H=0;H<4;++H)u.properties[1+H]=u._dictionarySize>>8*H<<24>>24;gs(O,u.properties,0,5)}function $t(u,O){var H;u._writeEndMark&&(ft(u._rangeEncoder,u._isMatch,(u._state<<4)+O,1),ft(u._rangeEncoder,u._isRep,u._state,0),u._state=u._state<7?7:10,Ei(u._lenEncoder,u._rangeEncoder,0,O),H=ci(2),xe(u._posSlotEncoder[H],u._rangeEncoder,63),Go(u._rangeEncoder,67108863,26),tt(u._posAlignEncoder,u._rangeEncoder,15))}function an(u){return u<2048?kn[u]:u<2097152?kn[u>>10]+20:kn[u>>20]+40}function _n(u){return u<131072?kn[u>>6]+12:u<134217728?kn[u>>16]+32:kn[u>>26]+52}function zt(){return xd}function Qi(){}l=Qi.prototype=new G,l.getClass$=zt,l.typeId$=0,l._additionalOffset=0,l._alignPriceCount=0,l._dictionarySize=4194304,l._dictionarySizePrev=-1,l._distTableSize=44,l._finished=!1,l._inStream=null,l._longestMatchLength=0,l._longestMatchWasFound=!1,l._matchFinder=null,l._matchFinderType=1,l._matchPriceCount=0,l._needReleaseMFStream=!1,l._numDistancePairs=0,l._numFastBytes=32,l._numFastBytesPrev=-1,l._numLiteralContextBits=3,l._numLiteralPosStateBits=0,l._optimumCurrentIndex=0,l._optimumEndIndex=0,l._posStateBits=2,l._posStateMask=3,l._previousByte=0,l._state=0,l._writeEndMark=!1,l.backRes=0,l.nowPos64=m;var kn;function Vo(u,O,H,q){H<8?(ft(O,u._choice,0,0),xe(u._lowCoder[q],O,H)):(H-=8,ft(O,u._choice,0,1),H<8?(ft(O,u._choice,1,0),xe(u._midCoder[q],O,H)):(ft(O,u._choice,1,1),xe(u._highCoder,O,H-8)))}function Rl(u){var O;for(u._choice=Me(yn,0,-1,2,1),u._lowCoder=Me(Zl,0,8,16,0),u._midCoder=Me(Zl,0,8,16,0),u._highCoder=de(new di,8),O=0;O<16;++O)u._lowCoder[O]=de(new di,3),u._midCoder[O]=de(new di,3);return u}function Ur(u,O){var H;for(Ji(u._choice),H=0;H<O;++H)cn(u._lowCoder[H].Models),cn(u._midCoder[H].Models);cn(u._highCoder.Models)}function Zs(u,O,H,q,Q){var J,fe,Ce,He,ze;for(J=(Ai(),Tt[u._choice[0]>>>2]),fe=Tt[2048-u._choice[0]>>>2],Ce=fe+Tt[u._choice[1]>>>2],He=fe+Tt[2048-u._choice[1]>>>2],ze=0,ze=0;ze<8;++ze){if(ze>=H)return;q[Q+ze]=J+Ae(u._lowCoder[O],ze)}for(;ze<16;++ze){if(ze>=H)return;q[Q+ze]=Ce+Ae(u._midCoder[O],ze-8)}for(;ze<H;++ze)q[Q+ze]=He+Ae(u._highCoder,ze-8-8)}function Aa(){return Sd}function Oa(){}l=Oa.prototype=new G,l.getClass$=Aa,l.typeId$=0;function Ei(u,O,H,q){Vo(u,O,H,q),--u._counters[q]==0&&(Zs(u,q,u._tableSize,u._prices,q*272),u._counters[q]=u._tableSize)}function qs(u){return Rl(u),u._prices=Me(xi,0,-1,4352,1),u._counters=Me(xi,0,-1,16,1),u}function mr(u,O,H){return u._prices[H*272+O]}function po(u,O){var H;for(H=0;H<O;++H)Zs(u,H,u._tableSize,u._prices,H*272),u._counters[H]=u._tableSize}function Bl(){return Md}function go(){}l=go.prototype=new Oa,l.getClass$=Bl,l.typeId$=0,l._tableSize=0;function Zo(u,O,H){var q,Q;if(!(u.m_Coders!=null&&u.m_NumPrevBits==H&&u.m_NumPosBits==O))for(u.m_NumPosBits=O,u.m_PosMask=(1<<O)-1,u.m_NumPrevBits=H,Q=1<<u.m_NumPrevBits+u.m_NumPosBits,u.m_Coders=Me(wd,0,5,Q,0),q=0;q<Q;++q)u.m_Coders[q]=Ba(new Ks)}function Wr(u,O,H){return u.m_Coders[((O&u.m_PosMask)<<u.m_NumPrevBits)+((H&255)>>>8-u.m_NumPrevBits)]}function ka(u){var O,H;for(H=1<<u.m_NumPrevBits+u.m_NumPosBits,O=0;O<H;++O)Ji(u.m_Coders[O].m_Encoders)}function Dl(){return Cd}function Gs(){}l=Gs.prototype=new G,l.getClass$=Dl,l.typeId$=0,l.m_Coders=null,l.m_NumPosBits=0,l.m_NumPrevBits=0,l.m_PosMask=0;function Ys(u,O,H){var q,Q,J;for(Q=1,J=7;J>=0;--J)q=H>>J&1,ft(O,u.m_Encoders,Q,q),Q=Q<<1|q}function Ra(u,O,H,q){var Q,J,fe,Ce,He,ze;for(J=1,He=!0,fe=7;fe>=0;--fe)Q=q>>fe&1,ze=J,He&&(Ce=H>>fe&1,ze+=1+Ce<<8,He=Ce==Q),ft(O,u.m_Encoders,ze,Q),J=J<<1|Q}function Ba(u){return u.m_Encoders=Me(yn,0,-1,768,1),u}function qo(u,O,H,q){var Q,J,fe,Ce,He;if(He=0,J=1,fe=7,O){for(;fe>=0;--fe)if(Ce=H>>fe&1,Q=q>>fe&1,He+=mo(u.m_Encoders[(1+Ce<<8)+J],Q),J=J<<1|Q,Ce!=Q){--fe;break}}for(;fe>=0;--fe)Q=q>>fe&1,He+=mo(u.m_Encoders[J],Q),J=J<<1|Q;return He}function Il(){return Ld}function Ks(){}l=Ks.prototype=new G,l.getClass$=Il,l.typeId$=18;function Xs(u){u.BackPrev=-1,u.Prev1IsChar=!1}function Fl(u){u.BackPrev=0,u.Prev1IsChar=!1}function r(){return Td}function h(){}l=h.prototype=new G,l.getClass$=r,l.typeId$=19,l.BackPrev=0,l.BackPrev2=0,l.Backs0=0,l.Backs1=0,l.Backs2=0,l.Backs3=0,l.PosPrev=0,l.PosPrev2=0,l.Prev1IsChar=!1,l.Prev2=!1,l.Price=0,l.State=0;function y(u,O){return u.NumBitLevels=O,u.Models=Me(yn,0,-1,1<<O,1),u}function M(u,O){var H,q;for(q=1,H=u.NumBitLevels;H!=0;--H)q=(q<<1)+Rn(O,u.Models,q);return q-(1<<u.NumBitLevels)}function I(u,O){var H,q,Q,J;for(Q=1,J=0,q=0;q<u.NumBitLevels;++q)H=Rn(O,u.Models,Q),Q<<=1,Q+=H,J|=H<<q;return J}function W(u,O,H,q){var Q,J,fe,Ce;for(fe=1,Ce=0,J=0;J<q;++J)Q=Rn(H,u,O+fe),fe<<=1,fe+=Q,Ce|=Q<<J;return Ce}function te(){return Pd}function se(){}l=se.prototype=new G,l.getClass$=te,l.typeId$=20,l.Models=null,l.NumBitLevels=0;function de(u,O){return u.NumBitLevels=O,u.Models=Me(yn,0,-1,1<<O,1),u}function xe(u,O,H){var q,Q,J;for(J=1,Q=u.NumBitLevels;Q!=0;)--Q,q=H>>>Q&1,ft(O,u.Models,J,q),J=J<<1|q}function Ae(u,O){var H,q,Q,J;for(J=0,Q=1,q=u.NumBitLevels;q!=0;)--q,H=O>>>q&1,J+=mo(u.Models[Q],H),Q=(Q<<1)+H;return J}function tt(u,O,H){var q,Q,J;for(J=1,Q=0;Q<u.NumBitLevels;++Q)q=H&1,ft(O,u.Models,J,q),J=J<<1|q,H>>=1}function bt(u,O){var H,q,Q,J;for(J=0,Q=1,q=u.NumBitLevels;q!=0;--q)H=O&1,O>>>=1,J+=mo(u.Models[Q],H),Q=Q<<1|H;return J}function bi(u,O,H,q,Q){var J,fe,Ce;for(Ce=1,fe=0;fe<q;++fe)J=Q&1,ft(H,u,O+Ce,J),Ce=Ce<<1|J,Q>>=1}function Vr(u,O,H,q){var Q,J,fe,Ce;for(Ce=0,fe=1,J=H;J!=0;--J)Q=q&1,q>>>=1,Ce+=(Ai(),Tt[((u[O+fe]-Q^-Q)&2047)>>>2]),fe=fe<<1|Q;return Ce}function Cs(){return Ed}function di(){}l=di.prototype=new G,l.getClass$=Cs,l.typeId$=21,l.Models=null,l.NumBitLevels=0;function Rn(u,O,H){var q,Q;return Q=O[H],q=(u.Range>>>11)*Q,(u.Code^-2147483648)<(q^-2147483648)?(u.Range=q,O[H]=Q+(2048-Q>>>5)<<16>>16,u.Range&-16777216||(u.Code=u.Code<<8|Di(u.Stream),u.Range<<=8),0):(u.Range-=q,u.Code-=q,O[H]=Q-(Q>>>5)<<16>>16,u.Range&-16777216||(u.Code=u.Code<<8|Di(u.Stream),u.Range<<=8),1)}function Nl(u,O){var H,q,Q;for(q=0,H=O;H!=0;--H)u.Range>>>=1,Q=u.Code-u.Range>>>31,u.Code-=u.Range&Q-1,q=q<<1|1-Q,u.Range&-16777216||(u.Code=u.Code<<8|Di(u.Stream),u.Range<<=8);return q}function zl(u){var O;for(u.Code=0,u.Range=-1,O=0;O<5;++O)u.Code=u.Code<<8|Di(u.Stream)}function cn(u){var O;for(O=0;O<u.length;++O)u[O]=1024}function Da(){return Ad}function Ia(){}l=Ia.prototype=new G,l.getClass$=Da,l.typeId$=0,l.Code=0,l.Range=0,l.Stream=null;function Ai(){Ai=_r;var u,O,H,q;for(Tt=Me(xi,0,-1,512,1),O=8;O>=0;--O)for(q=1<<9-O-1,u=1<<9-O,H=q;H<u;++H)Tt[H]=(O<<6)+(u-H<<6>>>9-O-1)}function ft(u,O,H,q){var Q,J;J=O[H],Q=(u.Range>>>11)*J,q==0?(u.Range=Q,O[H]=J+(2048-J>>>5)<<16>>16):(u.Low=j(u.Low,pe(at(Q),F)),u.Range-=Q,O[H]=J-(J>>>5)<<16>>16),u.Range&-16777216||(u.Range<<=8,Yo(u))}function Go(u,O,H){var q;for(q=H-1;q>=0;--q)u.Range>>>=1,(O>>>q&1)==1&&(u.Low=j(u.Low,at(u.Range))),u.Range&-16777216||(u.Range<<=8,Yo(u))}function jl(u){var O;for(O=0;O<5;++O)Yo(u)}function Hl(u){return j(j(at(u._cacheSize),u._position),b)}function Ul(u){u._position=m,u.Low=m,u.Range=-1,u._cacheSize=1,u._cache=0}function Yo(u){var O,H;if(O=lt(Ds(u.Low,32)),O!=0||be(u.Low,E)<0){u._position=j(u._position,at(u._cacheSize)),H=u._cache;do Oo(u.Stream,H+O),H=255;while(--u._cacheSize!=0);u._cache=lt(u.Low)>>>24}++u._cacheSize,u.Low=Mi(pe(u.Low,A),8)}function mo(u,O){return Ai(),Tt[((u-O^-O)&2047)>>>2]}function Ji(u){Ai();var O;for(O=0;O<u.length;++O)u[O]=1024}function Bf(){return Od}function Hu(){}l=Hu.prototype=new G,l.getClass$=Bf,l.typeId$=0,l.Low=m,l.Range=0,l.Stream=null,l._cache=0,l._cacheSize=0,l._position=m;var Tt;function Df(u){var O,H,q,Q,J;for(O=Bo(new Ir),H=0;H<u.length;++H)if(q=u[H]&255,q&128)if((q&224)==192){if(H+1>=u.length)throw Je(new jn,"invalid UTF-8");if(Q=u[++H]&255,(Q&192)!=128)throw Je(new jn,"invalid UTF-8");Ue(O.data,String.fromCharCode((q&31)<<6&65535|Q&63))}else if((q&240)==224){if(H+2>=u.length)throw Je(new jn,"invalid UTF-8");if(Q=u[++H]&255,(Q&192)!=128)throw Je(new jn,"invalid UTF-8");if(J=u[++H]&255,(J&192)!=128)throw Je(new jn,"invalid UTF-8");Oe(O.data,String.fromCharCode(((q&15)<<12|(Q&63)<<6|J&63)&65535))}else throw Je(new jn,"invalid UTF-8");else{if(q==0)throw Je(new jn,"invalid UTF-8");Oe(O.data,String.fromCharCode(q&65535))}return Ft(O.data)}function If(u){var O,H,q,Q,J,fe,Ce;for(H=(Ce=u.length,fe=Me(td,0,-1,Ce,1),Ro(u,0,Ce,fe,0),fe),Q=0,J=0;J<u.length;++J)O=H[J],O>=1&&O<=127?++Q:O==0||O>=128&&O<=2047?Q+=2:Q+=3;for(q=Me(yr,0,-1,Q,1),Q=0,J=0;J<u.length;++J)O=H[J],O>=1&&O<=127?q[Q++]=O<<24>>24:O==0||O>=128&&O<=2047?(q[Q++]=(192|O>>6&31)<<24>>24,q[Q++]=(128|O&63)<<24>>24):(q[Q++]=(224|O>>12&15)<<24>>24,q[Q++]=(128|O>>6&63)<<24>>24,q[Q++]=(128|O&63)<<24>>24);return q}function Jv(u){return u}function Fa(u){return u[1]+u[0]}function Ff(){var u=new Wl,O,H,q=arguments[0],Q=arguments[1],J,fe,Ce;typeof arguments[2]=="function"?(fe=arguments[2],typeof arguments[3]=="function"&&(Ce=arguments[3])):J=arguments[2],u.mode=Nd(Q),u.c=Gn(new lo,If(q),u.mode),Ce?Ce(0):typeof J<"u"&&c(0,J);function He(){var ze;for(H=new Date().getTime();Nr(u.c);)if(O=Fa(u.c.chunker.inBytesProcessed)/Fa(u.c.length_0),new Date().getTime()-H>200)return Ce?Ce(O):typeof J<"u"&&c(O,J),setTimeout(He,0),!1;Ce?Ce(1):typeof J<"u"&&c(1,J),ze=ps(u.c.output).slice(0),fe?fe(ze):typeof J<"u"&&postMessage({action:s,callback_num:J,result:ze})}setTimeout(He,1)}function Nf(){var u=new Wl,O,H,q,Q=arguments[0],J,fe,Ce;typeof arguments[1]=="function"?(fe=arguments[1],typeof arguments[2]=="function"&&(Ce=arguments[2])):J=arguments[1],H=Et(yr,0,-1,Q),u.d=C(new k,H),Ce?Ce(0):typeof J<"u"&&c(0,J);function He(){var ze;for(q=new Date().getTime();uo(u.d);)if(O=Fa(u.d.chunker.decoder.nowPos64)/Fa(u.d.length_0),new Date().getTime()-q>200)return Ce?Ce(O):typeof J<"u"&&c(O,J),setTimeout(He,0),!1;Ce?Ce(1):typeof J<"u"&&c(1,J),ze=Df(ps(u.d.output)),fe?fe(ze):typeof J<"u"&&postMessage({action:a,callback_num:J,result:ze})}setTimeout(He,0)}function zf(){return Fd}function Wl(){}l=Wl.prototype=new G,l.getClass$=zf,l.typeId$=0,l.c=null,l.d=null;function Uu(){$stats&&$stats({moduleName:d,subSystem:"startup",evtGroup:"moduleStartup",millis:new Date().getTime(),type:"onModuleLoadStart",className:"org.dellroad.lzma.demo.client.LZMADemo"})}function jf(u,O,H){if(d=O,u)try{Uu()}catch{u(O)}else Uu()}function _r(){}var Hf=Qe("java.lang.","Object"),Uf=Qe("java.lang.","Throwable"),Wf=Qe("java.lang.","Exception"),Vf=Qe("java.lang.","RuntimeException"),Zf=Qe("com.google.gwt.core.client.","JavaScriptException"),Wu=Qe("com.google.gwt.core.client.","JavaScriptObject$"),qf=zn("","[[D"),Gf=Qe("java.io.","InputStream"),Yf=Qe("java.io.","ByteArrayInputStream"),yr=zn("","[B"),Kf=Qe("java.io.","OutputStream"),Xf=Qe("java.io.","ByteArrayOutputStream"),Qf=Qe("java.io.","IOException"),Jf=Qe("java.lang.","Enum"),$f=Qe("java.lang.","ArithmeticException"),ed=Qe("java.lang.","ArrayStoreException"),td=zn("","[C"),nd=Qe("java.lang.","Class"),id=Qe("java.lang.","ClassCastException"),rd=Qe("java.lang.","IllegalArgumentException"),od=Qe("java.lang.","IllegalStateException"),sd=Qe("java.lang.","IndexOutOfBoundsException"),xi=zn("","[I"),ad=Qe("java.lang.","NullPointerException"),ld=Qe("java.lang.","String"),ud=Qe("java.lang.","StringBuilder"),cd=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZ.","InWindow"),hd=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZ.","BinTree"),fd=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZ.","OutWindow"),dd=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Chunker"),yn=zn("","[S"),Vl=zn("[Lorg.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeDecoder;"),pd=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder"),gd=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LenDecoder"),md=zn("[Lorg.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LiteralDecoder$Decoder2;"),_d=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LiteralDecoder"),yd=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Decoder$LiteralDecoder$Decoder2"),vd=zn("[Lorg.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$Optimal;"),Zl=zn("[Lorg.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeEncoder;"),Vu=zn("","[J"),bd=zn("","[Z"),xd=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder"),wd=zn("[Lorg.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LiteralEncoder$Encoder2;"),Cd=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LiteralEncoder"),Ld=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LiteralEncoder$Encoder2"),Sd=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LenEncoder"),Md=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$LenPriceTableEncoder"),Td=Qe("org.dellroad.lzma.client.SevenZip.Compression.LZMA.","Encoder$Optimal"),Pd=Qe("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeDecoder"),Ed=Qe("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","BitTreeEncoder"),Ad=Qe("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","Decoder"),Od=Qe("org.dellroad.lzma.client.SevenZip.Compression.RangeCoder.","Encoder"),kd=kr("org.dellroad.lzma.client.","CompressionMode"),Rd=Qe("org.dellroad.lzma.client.","LZMACompressor"),Bd=Qe("org.dellroad.lzma.client.","LZMAByteArrayCompressor"),Dd=Qe("org.dellroad.lzma.client.","LZMADecompressor"),Id=Qe("org.dellroad.lzma.client.","LZMAByteArrayDecompressor"),Fd=Qe("org.dellroad.lzma.demo.client.","LZMADemo");jf(function(){},"lzma_demo");var Nd=function(){var u=[{dictionarySize:16,fb:64,matchFinder:0,lc:3,lp:0,pb:2},{dictionarySize:20,fb:64,matchFinder:0,lc:3,lp:0,pb:2},{dictionarySize:19,fb:64,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:20,fb:64,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:21,fb:128,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:22,fb:128,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:23,fb:128,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:24,fb:255,matchFinder:1,lc:3,lp:0,pb:2},{dictionarySize:25,fb:255,matchFinder:1,lc:3,lp:0,pb:2}];function O(H){return!isNaN(parseFloat(H))&&isFinite(H)}return function(H){return O(H)?H<1?H=1:H>9&&(H=9):H=1,u[H-1]}}();return{compress:Ff,decompress:Nf}}();t.exports=n},function(t,o,n){var s=n(17),a=n(0),c=n(113),d=n(7),l=n(42),f=n(112),p=n(27),m=n(25),_=function(F,v){var P=a.filter(v,function(G){return!F[G]});if(P.length)throw new Error("WindshaftClient could not be initialized. The following options are missing: "+P.join(", "))},b=2033,x=3,A=3,S=function(F){_(F,["urlTemplate","userName"]),F.templateName?this.endpoints={get:[l.MAPS_API_BASE_URL,"named",F.templateName,"jsonp"].join("/"),post:[l.MAPS_API_BASE_URL,"named",F.templateName].join("/")}:this.endpoints={get:l.MAPS_API_BASE_URL,post:l.MAPS_API_BASE_URL},this.url=F.urlTemplate.replace("{user}",F.userName),this._requestTracker=new f(A)};S.prototype.instantiateMap=function(E){this._requestTracker.canRequestBePerformed(E)?this._performRequest(E,{success:function(F){if(this._requestTracker.track(E,F),F.errors){var v=m(F);E.options.error&&E.options.error(v)}else E.options.success&&E.options.success(F)}.bind(this),error:function(F,v){if(v!=="abort"){var P={},G={};try{P=JSON.parse(F.responseText),G=m(P)}catch{}this._requestTracker.track(E,P),E.options.error&&E.options.error(G)}}.bind(this)}):(p.error("Maximum number of subsequent equal requests to the Maps API reached ("+A+"):",E.payload,E.params),E.options.error&&E.options.error({}))},S.prototype._performRequest=function(E,F){var v=E.payload,P=E.params,G=this._generateEncodedURL(v,P);this._isURLValid(G)?this._get(G,F):this._generateCompressedURL(v,P,function($){if(this._isURLValid($))this._get($,F);else{var Z=this._getURL(P,"post");this._post(Z,v,F)}}.bind(this))},S.prototype._generateEncodedURL=function(E,F){return F=a.extend({config:JSON.stringify(E)},F),this._getURL(F)},S.prototype._generateCompressedURL=function(E,F,v){var P=JSON.stringify({config:JSON.stringify(E)});c.compress(P,x,function(G){F=a.extend({lzma:d.array2hex(G)},F),v(this._getURL(F))}.bind(this))},S.prototype._isURLValid=function(E){return E.length<b},S.prototype._post=function(E,F,v){this._abortPreviousRequest(),this._previousRequest=s.ajax({url:E,crossOrigin:!0,method:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(F),success:v.success,error:v.error})},S.prototype._get=function(E,F){this._abortPreviousRequest(),this._previousRequest=s.ajax({url:E,method:"GET",dataType:"jsonp",jsonpCallback:this._jsonpCallbackName(E),cache:!0,success:F.success,error:F.error})},S.prototype._abortPreviousRequest=function(){this._previousRequest&&this._previousRequest.abort()},S.prototype._getURL=function(E,F){F=F||"get";var v=this._convertParamsToQueryString(E),P=this.endpoints[F];return[this.url,P].join("/")+v},S.prototype._convertParamsToQueryString=function(E){var F=[];return a.each(E,function(v,P){v instanceof Array?a.each(v,function(G){F.push(P+"[]="+G)}):v instanceof Object?F.push(P+"="+encodeURIComponent(JSON.stringify(v))):F.push(P+"="+encodeURIComponent(v))}),F.length>0?"?"+F.join("&"):""},S.prototype._jsonpCallbackName=function(E){return"_cdbc_"+d.uniqueCallbackName(E)},t.exports=S},function(t,o,n){var s=n(0),a=n(42);function c(d,l){this._windshaftSettings=d,this._layerGroupId=l.layergroupid,this._layers=l.metadata.layers,this._dataviews=l.metadata.dataviews,this._analyses=l.metadata.analyses,this._cdnUrl=l.cdn_url}c.prototype.getLayerIndexesByType=function(l){return s.reduce(this._getLayers(),function(f,p,m){return p.type===l&&f.push(m),f},[])},c.prototype.getBaseURL=function(){return[this._getHost(),a.MAPS_API_BASE_URL,this._layerGroupId].join("/")},c.prototype.getStaticBaseURL=function(){return[this._getHost(),a.MAPS_API_BASE_URL,"static/center",this._layerGroupId].join("/")},c.prototype._getHost=function(){var l=this._windshaftSettings.urlTemplate,f=this._windshaftSettings.userName,p=this.getProtocol(),m=this._cdnUrl,_=m&&m[p],b=m&&m.templates;if(b&&b[p]){var x=b[p];return x.url+"/"+f}return _?[p,"://",_,"/",f].join(""):l.replace("{user}",f)},c.prototype.getProtocol=function(){return this._isHttps()?"https":"http"},c.prototype._isHttps=function(){return this._windshaftSettings.urlTemplate.indexOf("https")===0},c.prototype.getSupportedSubdomains=function(){var l=this._cdnUrl&&this._cdnUrl.templates,f=this.getProtocol();return l&&l[f]?l[f].subdomains:[]},c.prototype.getLayerMetadata=function(l){var f={},p=this._getLayers();return p&&p[l]&&(f=p[l].meta||{}),f},c.prototype.getDataviewMetadata=function(l){var f=this._getDataviews();if(f&&f[l])return f[l];f={};var p=s.compact(s.map(this._getLayers(),function(m){return m.widgets}));if(s.each(p,function(m){s.extend(f,m)}),f&&f[l])return f[l]},c.prototype.getAnalysisNodeMetadata=function(d){var l={},f=s.map(this._getAnalyses(),function(p){return p.nodes});return s.each(f,function(p){s.extend(l,p)}),l[d]},c.prototype._getLayers=function(){return this._layers},c.prototype._getDataviews=function(){return this._dataviews},c.prototype._getAnalyses=function(){return this._analyses},t.exports=c},function(t,o,n){var s=function(c,d,l){this.payload=c,this.params=d,this.options=l};s.prototype.toHashCode=function(){return JSON.stringify(this.payload)+JSON.stringify(this.params)+JSON.stringify(this.options)},s.prototype.equals=function(a){return this.toHashCode()===a.toHashCode()},t.exports=s},function(t,o,n){var s=n(0),a=n(16);function c(l,f){var p=l.filter(function(m){return!a.isGoogleMapsBaseLayer(m)});return{buffersize:{mvt:0},styles:d(p)}}function d(l){return s.reduce(l,function(f,p,m){return p.get("cartocss")&&(f[m]=p.get("cartocss")),f},{})}t.exports={serialize:c}},function(t,o,n){var s=n(0),a=n(15),c=["line-color","marker-fill","polygon-fill","marker-file"],d=["="],l=function(_){var b=_.getBucketsWithCategoryFilter();return s.every(b,function(x){return x.filter.name!=null&&x.value!=null})},f=function(_,b){return s.map(_,function(x){var A=s.find(b,function(S){return S.filter.name===x.filter.name});return{title:x.filter.name,icon:A&&A.value?p(A.value):"",color:x.value}})},p=function(_){var b="",x=/(http|https):\/\/\S+\.(?:gif|jpeg|jpg|png|webp|svg)/g,A=_.match(x);return A&&(b=A[0]),b};t.exports={canAdapt:function(_){return _=new a(_),_.matchesAnyProperty(c)&&_.matchesAnyMapping(d)&&l(_)},adapt:function(_){var b=new a(_[0]),x=new a(_[1]),A=b.getBucketsWithCategoryFilter(),S=x.getBucketsWithCategoryFilter(),E=b.getBucketsWithDefaultFilter(),F=x.getBucketsWithDefaultFilter();return{categories:f(A,S),default:{icon:s.isEmpty(F)?"":p(F[0].value),color:s.isEmpty(E)?"":E[0].value}}}}},function(t,o,n){var s=n(0),a=n(15),c=["line-color","marker-fill","polygon-fill"],d=[">",">=","<","<="],l=function(m){var _=m.getBucketsWithRangeFilter();return s.every(_,function(b){return b.filter.start!=null&&b.filter.end!=null})},f=function(m){if(m.length===1){var _=m[0],b=_.filter.start,x=_.filter.end;return[{value:_.value,label:b.toString()},{value:_.value,label:x.toString()}]}return s.map(m,function(A,S){var E="";return S===0?E=A.filter.start:S===m.length-1&&(E=A.filter.end),{value:A.value,label:E.toString()}})};t.exports={canAdapt:function(m){return m=new a(m),m.matchesAnyProperty(c)&&m.matchesAnyMapping(d)&&l(m)},adapt:function(m){var _=new a(m[0]),b=_.getBucketsWithRangeFilter(),x=s.last(b),A=s.first(b);return{colors:f(b),avg:_.getFilterAvg(),max:x.filter.end,min:A.filter.start}}}},function(t,o,n){var s=n(0),a=n(15),c=["marker-width","line-width"],d=function(p){var m=p.getBucketsWithRangeFilter();return s.every(m,function(_){return _.filter.start!=null&&_.filter.end!=null})},l=function(p){var m=s.last(p);return s.chain(p).map("filter").map("start").concat(m.filter.end).value()};t.exports={canAdapt:function(p){return p=new a(p),p.matchesAnyProperty(c)&&d(p)},adapt:function(p){var m=new a(p[0]),_=m.getBucketsWithRangeFilter();return{values:l(_),sizes:s.map(_,"value"),avg:m.getFilterAvg()}}}},function(t,o,n){var s={bubble:n(120),choropleth:n(119),category:n(118)};t.exports={getAdapterForLegend:function(c){return s[c.get("type")]}}},function(t,o,n){var s={};s.VERSION=n(26).version,s.DEBUG=!1,s.helpers={},t.exports=s},function(t,o,n){var s=n(0),a=n(27),c=n(7),d=n(121),l=n(29),f=n(1);function p(_,b){var x=c.crc32(b)%_.length;return _[x]}var m=function(b){if(!b.layerGroupModel)throw new Error("layerGroupModel is required");if(!b.layersCollection)throw new Error("layersCollection is required");if(!b.dataviewsCollection)throw new Error("dataviewsCollection is required");this._layerGroupModel=b.layerGroupModel,this._layersCollection=b.layersCollection,this._dataviewsCollection=b.dataviewsCollection};m.prototype.updateModels=function(_,b,x){this._updateLayerModels(_),this._updateLayerGroupModel(_),this._updateDataviewModels(_,b,x),this._updateAnalysisModels(_)},m.prototype._updateLayerGroupModel=function(_){var b={tiles:this._generateTileURLTemplate(_),subdomains:_.getSupportedSubdomains(),grids:this._calculateGridURLTemplatesForCartoDBLayers(_),attributes:this._calculateAttributesBaseURLsForCartoDBLayers(_),image:this._calculateStaticMapURL(_)};this._layerGroupModel.set({indexOfLayersInWindshaft:_.getLayerIndexesByType("mapnik"),urls:b})},m.prototype._calculateStaticMapURL=function(_){return[_.getStaticBaseURL(),"{z}/{lat}/{lng}/{width}/{height}.{format}"].join("/")},m.prototype._generateTileURLTemplate=function(_){return _.getBaseURL()+"/{layerIndexes}/{z}/{x}/{y}.{format}"},m.prototype._calculateGridURLTemplatesForCartoDBLayers=function(_){var b=[],x=_.getLayerIndexesByType("mapnik");return x.length>0&&s.each(x,function(A){var S=[],E=this._generateGridURLTemplate(_,A),F=_.getSupportedSubdomains();F.length?s.each(F,function(v){S.push(E.replace("{s}",v))}):S.push(E),b.push(S)},this),b},m.prototype._generateGridURLTemplate=function(_,b){return _.getBaseURL()+"/"+b+"/{z}/{x}/{y}.grid.json"},m.prototype._calculateAttributesBaseURLsForCartoDBLayers=function(_){var b=[],x=_.getLayerIndexesByType("mapnik");return x.length>0&&s.each(x,function(A){b.push(this._generateAttributesBaseURL(_,A))},this),b},m.prototype._generateAttributesBaseURL=function(_,b){var x=_.getBaseURL()+"/"+b+"/attributes";if(x.indexOf("{s}")>=0){var A=p(_.getSupportedSubdomains(),x);x=x.replace("{s}",A)}return x},m.prototype._updateLayerModels=function(_){var b=_.getLayerIndexesByType("mapnik");s.each(this._layersCollection.getCartoDBLayers(),function(A,S){var E=b[S];A.set("meta",_.getLayerMetadata(E)),this._updateLegendModels(A,E,_),A.setOk()},this);var x=_.getLayerIndexesByType("torque");s.each(this._layersCollection.getTorqueLayers(),function(A,S){var E=x[S],F=_.getLayerMetadata(E);A.set("meta",F),A.set(F),A.set("subdomains",_.getSupportedSubdomains()),A.set("tileURLTemplates",this._calculateTileURLTemplatesForTorqueLayers(_)),this._updateLegendModels(A,E,_),A.setOk()},this)},m.prototype._calculateTileURLTemplatesForTorqueLayers=function(_){var b=[],x=_.getLayerIndexesByType("torque");return x.length>0&&b.push(this._generateTorqueTileURLTemplate(_,x)),b},m.prototype._generateTorqueTileURLTemplate=function(_,b){return _.getBaseURL()+"/"+b.join(",")+"/{z}/{x}/{y}.json.torque"},m.prototype._updateLegendModels=function(_,b,x){var A=x.getLayerMetadata(b);s.each(this._getLayerLegends(_),function(S){this._updateLegendModel(S,A)},this)},m.prototype._updateLegendModel=function(_,b){var x=b&&b.cartocss_meta&&b.cartocss_meta.rules;try{var A={state:"success"};if(x){var S=d.getAdapterForLegend(_),E=s.filter(x,S.canAdapt);s.isEmpty(E)||(A=s.extend(A,S.adapt(E)))}_.set(A)}catch(F){_.set({state:"error"}),a.error("legend of type '"+_.get("type")+"' couldn't be updated: "+F.message)}},m.prototype._updateDataviewModels=function(_,b,x){this._dataviewsCollection.each(function(A){var S=_.getDataviewMetadata(A.get("id"));S&&A.set({url:S.url[this._getProtocol()]},{sourceId:b,forceFetch:x})},this)},m.prototype._updateAnalysisModels=function(_){var b=this._getUniqueAnalysisNodesCollection();b.each(function(x){var A=_.getAnalysisNodeMetadata(x.get("id")),S;A&&(S={status:A.status,url:A.url[this._getProtocol()],query:A.query},S=s.omit(S,x.getParamNames()),A.error_message?(S=s.extend(S,{error:{message:A.error_message}}),x.set(S)):(x.set(S),x.setOk()))},this)},m.prototype._getProtocol=function(){return window.location.protocol==="file:"?"http":window.location.protocol.replace(":","")},m.prototype.setErrors=function(_){s.each(_,this._setError,this),this._setLegendErrors()},m.prototype._setError=function(_){if(_.isLayerError()){var b=this._layersCollection.get(_.layerId);b&&b.setError(_)}else if(_.isAnalysisError()){var x=this._getUniqueAnalysisNodesCollection(),A=x.get(_.analysisId);A&&A.setError(_)}},m.prototype._setLegendErrors=function(){var _=this._layersCollection.chain().map(this._getLayerLegends).compact().flatten().value();s.each(_,function(b){b.set("state","error")})},m.prototype._getLayerLegends=function(_){return _.legends&&[_.legends.bubble,_.legends.category,_.legends.choropleth]},m.prototype._getUniqueAnalysisNodesCollection=function(){var _=l.getUniqueAnalysisNodes(this._layersCollection,this._dataviewsCollection);return new f.Collection(_)},t.exports=m},function(t,o,n){var s=n(0),a=n(1),c="Tiled",d="CartoDB",l="torque",f=a.Collection.extend({initialize:function(){this.comparator=function(m){return parseInt(m.get("order"),10)},this.bind("add",this._assignIndexes),this.bind("remove",this._assignIndexes)},_assignIndexes:function(m,_,b){if(this.size()>0&&(this.at(0).set({order:0}),this.size()>1)){var x=this.reduce(function(E,F,v){var P=F.get("type");return v===0&&P===c||(E[P]=E[P]||[],E[P].push(F)),E},{}),A=1,S=[d,l,c];s.each(S,function(E){var F=x[E]||[];s.each(F,function(v){v.set({order:A}),A+=1})})}this.sort()},getCartoDBLayers:function(){return this._getLayersByType(d)},getTiledLayers:function(){return this._getLayersByType(c)},getTorqueLayers:function(){return this._getLayersByType(l)},_getLayersByType:function(m){return this.select(function(_){return _.get("type")===m})},getLayersWithLegends:function(){return this.select(function(m){return!!m.legends})},moveCartoDBLayer:function(m,_){if(m===_)return!1;var b=this.at(m);return!b||b.get("type")!==d?!1:(this.remove(b,{silent:!0}),this.add(b,{at:_,silent:!0}),this.trigger("layerMoved",b),b)}});t.exports=f},function(t,o,n){var s=n(0),a=n(1),c=a.Collection.extend({isAnyDataviewFiltered:function(){return this.any(function(l){var f=l.filter;return f&&!f.isEmpty()})},getFilters:function(){return this.reduce(function(l,f){var p=f.filter;return p&&!p.isEmpty()&&(l.dataviews=l.dataviews||{},s.extend(l.dataviews,p.toJSON())),l},{})}});t.exports=c},function(t,o,n){var s=n(0),a=n(17),c=n(1),d=n(16),l=n(7),f=c.Model.extend({defaults:{visible:!0,type:"layergroup"},initialize:function(m,_){if(_=_||{},!_.layersCollection)throw new Error("layersCollection option is required");this._layersCollection=_.layersCollection},addError:function(m){var _=m.type;if(!_)throw new Error("Error must have a type property.");this.trigger("error:"+_,m)},forEachGroupedLayer:function(m,_){s.each(this._getGroupedLayers(),m.bind(_||this))},_getGroupedLayers:function(){return this._layersCollection.getCartoDBLayers()},_getLayers:function(){return this._layersCollection.reject(d.isGoogleMapsBaseLayer)},getIndexOfLayerInLayerGroup:function(m){return this._getGroupedLayers().indexOf(m)},getLayerInLayerGroupAt:function(m){return this._getGroupedLayers()[m]},getCartoLayerById:function(m){return this._layersCollection.get(m)},isEqual:function(){return!1},hasURLs:function(){return!!this.get("urls")},getSubdomains:function(){return this.get("urls")&&this.get("urls").subdomains||[]},getTileURLTemplatesWithSubdomains:function(){var m=this.getTileURLTemplate(),_=this.getSubdomains();return _&&_.length?s.map(_,function(b){return m.replace("{s}",b)}):[m]},getTileURLTemplate:function(m){m=m||"png";var _=this.get("urls")&&this.get("urls").tiles;if(!_)return"";if(m==="png")return this._areAllLayersHidden()?"":this._generatePNGTileURLTemplate(_);if(m==="mvt")return this._generateMTVTileURLTemplate(_)},_generatePNGTileURLTemplate:function(m){var _=this._getIndexesOfVisibleMapnikLayers();return _?(m=m.replace("{layerIndexes}",_).replace("{format}","png"),this._appendAuthParamsToURL(m)):""},_generateMTVTileURLTemplate:function(m){return m=m.replace("{layerIndexes}","mapnik").replace("{format}","mvt"),this._appendAuthParamsToURL(m)},_areAllLayersHidden:function(){return s.all(this._getGroupedLayers(),function(m){return!m.isVisible()})},_getIndexesOfVisibleMapnikLayers:function(m){var _=this.get("indexOfLayersInWindshaft");return s.reduce(this._getGroupedLayers(),function(b,x,A){return x.isVisible()&&b.push(_[A]),b},[]).join(",")},_getIndexesOfVisibleLayers:function(m){return s.reduce(this._getLayers(),function(_,b,x){return b.isVisible()&&_.push(x),_},[]).join(",")},hasTileURLTemplates:function(){return!!this.getTileURLTemplate()},getGridURLTemplatesWithSubdomains:function(m){var _=this.get("urls")&&this.get("urls").grids&&this.get("urls").grids[m]||[];if(this.get("urls")&&this.get("urls").subdomains){var b=this.get("urls").subdomains;_=s.map(_,function(x,A){return x.replace("{s}",b[A])})}return s.map(_,this._appendAuthParamsToURL,this)},getAttributesBaseURL:function(m){return this.get("urls")&&this.get("urls").attributes&&this.get("urls").attributes[m]},getStaticImageURLTemplate:function(){var m=this.get("urls")&&this.get("urls").image;return m&&(m=this._appendParamsToURL(m,["layer="+this._getIndexesOfVisibleLayers()]),m=this._appendAuthParamsToURL(m),m=m.replace("{s}",this.getSubdomains()[0])),m},fetchAttributes:function(m,_,b){var x=this.getAttributesBaseURL(m);if(!x)throw new Error("Attributes cannot be fetched until urls are set");var A=this._appendAuthParamsToURL(x+"/"+_);a.ajax({dataType:"jsonp",url:A,jsonpCallback:"_cdbi_layer_attributes_"+l.uniqueCallbackName(this.toJSON()),cache:!0,success:function(E){b(E)},error:function(E){b(null)}})},_appendAuthParamsToURL:function(m){var _=[];if(this.get("apiKey"))_.push("api_key="+this.get("apiKey"));else if(this.get("authToken")){var b=this.get("authToken");b instanceof Array?s.each(b,function(x){_.push("auth_token[]="+x)}):_.push("auth_token="+b)}return this._appendParamsToURL(m,_)},_appendParamsToURL:function(m,_){if(_.length){var b="?";return m.indexOf("?")!==-1&&(b="&"),m+b+_.join("&")}return m},onLayerVisibilityChanged:function(m){this._layersCollection.on("change:visible",function(_){this._isLayerGrouped(_)&&m(_)},this)},onLayerAdded:function(m){this._layersCollection.on("add",function(_){this._isLayerGrouped(_)&&m(_,this.getLayerInLayerGroupAt(_))},this)},_isLayerGrouped:function(m){return this._getGroupedLayers().indexOf(m)>=0}});t.exports=f},function(t,o,n){var s=n(0),a=n(16),c="2.1.0",d="http",l="plain",f="mapnik",p="torque";function m(v){return v.chain().map(_).compact().value()}function _(v){if(a.isTiledLayer(v))return b(v);if(a.isPlainLayer(v))return A(v);if(a.isWMSLayer(v))return x(v);if(a.isCartoDBLayer(v))return S(v);if(a.isTorqueLayer(v))return E(v)}function b(v){return{id:v.get("id"),type:d,options:{urlTemplate:v.get("urlTemplate"),subdomains:v.get("subdomains"),tms:v.get("tms")}}}function x(v){return{id:v.get("id"),type:d,options:{urlTemplate:v.get("urlTemplate"),tms:!0}}}function A(v){return{id:v.get("id"),type:l,options:{color:v.get("color"),imageUrl:v.get("image")}}}function S(v){var P=F(v);return P.interactivity=v.getInteractiveColumnNames(),v.infowindow&&v.infowindow.hasFields()&&(P.attributes={id:"cartodb_id",columns:v.infowindow.getFieldNames()}),isFinite(v.get("minzoom"))&&(P.minzoom=v.get("minzoom")),isFinite(v.get("maxzoom"))&&(P.maxzoom=v.get("maxzoom")),s.isEmpty(v.aggregation)||s.extend(P,{aggregation:v.aggregation}),{id:v.get("id"),type:f,options:P}}function E(v){var P=F(v);return{id:v.get("id"),type:p,options:P}}function F(v){var P={cartocss:v.get("cartocss"),cartocss_version:v.get("cartocss_version")||c};return P.source={id:v.getSourceId()},v.get("sql_wrap")&&(P.sql_wrap=v.get("sql_wrap")),P}t.exports={serialize:m}},function(t,o,n){function s(a){return a.reduce(function(c,d){return c[d.get("id")]=d.toJSON(),c},{})}t.exports={serialize:s}},function(t,o,n){var s=n(43);function a(_,b){b=b||"latest",this.definition=_,this.reference=s.getVersion(b)}t.exports=a,a.prototype.getNodesWithId=function(){return l({},this.definition,this.reference)},a.prototype.getChildNodesNames=function(){return f(this.definition.type,this.reference)},a.prototype.getNodesList=function(){return d([],this.definition,this.reference)},a.prototype.getDefinitionWith=function(_,b){return c(this.definition,this.reference,_,b)};function c(_,b,x,A){return _.id&&_.id===x&&Object.keys(A).forEach(function(S){_.params.hasOwnProperty(S)||(_.params[S]={});var E=A[S];Object.keys(E).forEach(function(F){_.params[S][F]=E[F]})}),f(_.type,b).filter(p(_,b)).forEach(function(S){c(_.params[S],b,x,A)}),_}function d(_,b,x){return _.push(b),f(b.type,x).filter(p(b,x)).forEach(function(A){d(_,b.params[A],x)}),_}function l(_,b,x){return b.id&&(_[b.id]=b),f(b.type,x).filter(p(b,x)).forEach(function(A){l(_,b.params[A],x)}),_}function f(_,b){var x=b.analyses[_];return Object.keys(x.params).reduce(function(A,S){return x.params[S].type==="node"&&A.push(S),A},[])}function p(_,b){return function(x){return!m(_.type,x,b)||!!_.params[x]}}function m(_,b,x){var A=x.analyses[_];return A.params[b].optional}},function(t){t.exports={version:"0.59.4",analyses:{"aggregate-intersection":{params:{source:{type:"node",geometry:["*"]},target:{type:"node",geometry:["*"]},aggregate_function:{type:"enum",values:["avg","count","max","min","sum"]},aggregate_column:{type:"string",optional:!0}}},"bounding-box":{params:{source:{type:"node",geometry:["*"]},category_column:{type:"string",optional:!0},aggregation:{type:"enum",values:["avg","count","max","min","sum"],optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}},"bounding-circle":{params:{source:{type:"node",geometry:["*"]},category_column:{type:"string",optional:!0},aggregation:{type:"enum",values:["avg","count","max","min","sum"],optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}},buffer:{params:{source:{type:"node",geometry:["*"]},radius:{type:"number"},isolines:{type:"number",optional:!0},dissolved:{type:"boolean",optional:!0}}},centroid:{params:{source:{type:"node",geometry:["*"]},category_column:{type:"string",optional:!0},aggregation:{type:"string",optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}},closest:{params:{source:{type:"node",geometry:["*"]},target:{type:"node",geometry:["*"]},responses:{type:"number",optional:!0,"default-value":1},category:{type:"string",optional:!0}}},"concave-hull":{params:{source:{type:"node",geometry:["*"]},category_column:{type:"string",optional:!0},target_percent:{type:"number",optional:!0,"default-value":.7},allow_holes:{type:"boolean",optional:!0,"default-value":!1},aggregation:{type:"enum",values:["avg","count","max","min","sum"],optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}},contour:{params:{source:{type:"node",geometry:["point"]},column:{type:"string"},buffer:{type:"number",optional:!0,"default-value":.2},method:{type:"enum",values:["nearest_neighbor","barymetric","IDW"],optional:!0,"default-value":"barymetric"},class_method:{type:"enum",values:["equals","headstails","jenks","quantiles"],optional:!0,"default-value":"quantiles"},steps:{type:"number",optional:!0,"default-value":7},resolution:{type:"number",optional:!0,"default-value":-90}}},"convex-hull":{params:{source:{type:"node",geometry:["*"]},category_column:{type:"string",optional:!0},aggregation:{type:"enum",values:["avg","count","max","min","sum"],optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}},"data-observatory-measure":{params:{source:{type:"node",geometry:["point","polygon"]},final_column:{type:"string"},segment_name:{type:"string"},percent:{type:"boolean",optional:!0}}},"data-observatory-multiple-measures":{params:{source:{type:"node",geometry:["point","polygon"]},numerators:{type:"array"},normalizations:{type:"array"},denominators:{type:"array"},geom_ids:{type:"array"},numerator_timespans:{type:"array"},column_names:{type:"array"}}},"deprecated-sql-function":{params:{function_name:{type:"string"},primary_source:{type:"node",geometry:["*"]},secondary_source:{type:"node",geometry:["*"],optional:!0},function_args:{type:"array",optional:!0}}},"filter-by-node-column":{params:{source:{type:"node",geometry:["*"]},column:{type:"string"},filter_source:{type:"node",geometry:["*"]},filter_column:{type:"string"}}},"filter-category":{params:{source:{type:"node",geometry:["*"]},column:{type:"string"},accept:{type:"array",optional:!0},reject:{type:"array",optional:!0}}},"filter-grouped-rank":{params:{source:{type:"node",geometry:["*"]},column:{type:"string"},rank:{type:"enum",values:["top","bottom"]},group:{type:"string"},min:{type:"number",optional:!0},max:{type:"number",optional:!0}}},"filter-range":{params:{source:{type:"node",geometry:["*"]},column:{type:"string"},min:{type:"number",optional:!0},max:{type:"number",optional:!0},greater_than:{type:"number",optional:!0},greater_than_or_equal:{type:"number",optional:!0},less_than:{type:"number",optional:!0},less_than_or_equal:{type:"number",optional:!0}}},"filter-rank":{params:{source:{type:"node",geometry:["*"]},column:{type:"string"},rank:{type:"enum",values:["top","bottom"]},limit:{type:"number"},action:{type:"enum",values:["show","hide"],optional:!0,"default-value":"show"}}},"georeference-admin-region":{params:{source:{type:"node",geometry:["*"]},admin_region_column:{type:"string"},country:{type:"string",optional:!0},country_column:{type:"string",optional:!0}}},"georeference-city":{params:{source:{type:"node",geometry:["*"]},city_column:{type:"string"},admin_region:{type:"string",optional:!0},admin_region_column:{type:"string",optional:!0},country:{type:"string",optional:!0},country_column:{type:"string",optional:!0}}},"georeference-country":{params:{source:{type:"node",geometry:["*"]},country_column:{type:"string"}}},"georeference-ip-address":{params:{source:{type:"node",geometry:["*"]},ip_address:{type:"string"}}},"georeference-long-lat":{params:{source:{type:"node",geometry:["*"]},longitude:{type:"string"},latitude:{type:"string"}}},"georeference-postal-code":{params:{source:{type:"node",geometry:["*"]},output_geometry_type:{type:"enum",values:["point","polygon"],optional:!0,"default-value":"point"},postal_code_column:{type:"string"},country:{type:"string",optional:!0},country_column:{type:"string",optional:!0}}},"georeference-street-address":{params:{source:{type:"node",geometry:["*"]},street_address_column:{type:"string",optional:!0},street_address_template:{type:"string",optional:!0},city:{type:"string",optional:!0},city_column:{type:"string",optional:!0},state:{type:"string",optional:!0},state_column:{type:"string",optional:!0},country:{type:"string",optional:!0},country_column:{type:"string",optional:!0}}},gravity:{params:{source:{type:"node",geometry:["*"]},target:{type:"node",geometry:["*"]},weight_column:{type:"string"},weight_threshold:{type:"number",optional:!0,"default-value":-1e308},pop_column:{type:"string"},max_distance:{type:"number"},target_id:{type:"number"}}},intersection:{params:{source:{type:"node",geometry:["*"]},source_columns:{type:"array",optional:!0,"default-value":[]},target:{type:"node",geometry:["*"]}}},kmeans:{params:{source:{type:"node",geometry:["point"]},clusters:{type:"number"}}},"line-sequential":{params:{source:{type:"node",geometry:["point"]},order_column:{type:"string"},order_type:{type:"enum",values:["asc","desc"]},category_column:{type:"string",optional:!0}}},"line-source-to-target":{params:{source:{type:"node",geometry:["point"]},source_column:{type:"string",optional:!0},target:{type:"node",geometry:["point"]},target_column:{type:"string",optional:!0},closest:{type:"boolean"}}},"line-to-column":{params:{source:{type:"node",geometry:["point"]},target_column:{type:"string"}}},"line-to-single-point":{params:{source:{type:"node",geometry:["point"]},destination_longitude:{type:"number"},destination_latitude:{type:"number"}}},"link-by-line":{params:{source_points:{type:"node",geometry:["point"]},destination_points:{type:"node",geometry:["point"]},source_column:{type:"string"},destination_column:{type:"string"},use_great_circle:{type:"boolean",optional:!0,"default-value":!1}}},merge:{params:{left_source:{type:"node",geometry:["*"]},right_source:{type:"node",geometry:["*"]},left_source_column:{type:"string"},right_source_column:{type:"string"},join_operator:{type:"enum",values:["inner","left","right"],optional:!0,"default-value":"inner"},source_geometry:{type:"enum",values:["left_source","right_source"],optional:!0,"default-value":"left_source"},left_source_columns:{type:"array",optional:!0},right_source_columns:{type:"array",optional:!0,"default-value":[]}}},moran:{params:{source:{type:"node",geometry:["polygon","point"]},numerator_column:{type:"string"},denominator_column:{type:"string",optional:!0},significance:{type:"number"},neighbours:{type:"number",optional:!0},permutations:{type:"number",optional:!0},w_type:{type:"enum",values:["knn","queen"],optional:!0,"default-value":"knn"}}},"point-in-polygon":{params:{points_source:{type:"node",geometry:["point"]},polygons_source:{type:"node",geometry:["polygon"]}}},"population-in-area":{params:{source:{type:"node",geometry:["polygon"]},final_column:{type:"string"}}},"routing-sequential":{params:{source:{type:"node",geometry:["point"]},mode:{type:"enum",values:["car","walk","bicycle","public_transport"]},units:{type:"enum",values:["kilometers","miles"],optional:!0,"default-value":"kilometers"},order_column:{type:"string",optional:!0,"default-value":"cartodb_id"},order_type:{type:"enum",values:["asc","desc"],optional:!0,"default-value":"asc"}}},"routing-to-layer-all-to-all":{params:{source:{type:"node",geometry:["point"]},source_column:{type:"string"},target:{type:"node",geometry:["point"]},target_column:{type:"string"},mode:{type:"enum",values:["car","walk","bicycle","public_transport"]},units:{type:"enum",values:["kilometers","miles"],optional:!0,"default-value":"kilometers"},closest:{type:"boolean"}}},"routing-to-single-point":{params:{source:{type:"node",geometry:["point"]},mode:{type:"enum",values:["car","walk","bicycle","public_transport"]},destination_longitude:{type:"number"},destination_latitude:{type:"number"},units:{type:"enum",values:["kilometers","miles"],optional:!0,"default-value":"kilometers"}}},sampling:{params:{source:{type:"node",geometry:["*"]},sampling:{type:"number"},seed:{type:"number",optional:!0}}},source:{params:{query:{type:"string"}}},"spatial-markov-trend":{params:{source:{type:"node",geometry:["*"]},time_columns:{type:"array"},num_classes:{type:"number",optional:!0,"default-value":5},weight_type:{type:"string",optional:!0,"default-value":"knn"},num_ngbrs:{type:"number",optional:!0,"default-value":5},permutations:{type:"number",optional:!0,"default-value":0},geom_col:{type:"string",optional:!0,"default-value":"the_geom"},id_col:{type:"string",optional:!0,"default-value":"cartodb_id"}}},"trade-area":{params:{source:{type:"node",geometry:["point"]},kind:{type:"enum",values:["walk","car"]},time:{type:"number"},isolines:{type:"number"},dissolved:{type:"boolean"}}},"weighted-centroid":{params:{source:{type:"node",geometry:["*"]},weight_column:{type:"string"},category_column:{type:"string",optional:!0},aggregation:{type:"string",optional:!0,"default-value":"count"},aggregation_column:{type:"string",optional:!0}}}}}},function(t,o,n){var s={"./0.59.4/reference.json":130};function a(d){var l=c(d);return n(l)}function c(d){var l=s[d];if(!(l+1)){var f=new Error("Cannot find module '"+d+"'");throw f.code="MODULE_NOT_FOUND",f}return l}a.keys=function(){return Object.keys(s)},a.resolve=c,t.exports=a,a.id=131},function(t,o){t.exports.versions=["0.1.0","0.2.0","0.3.0","0.4.0","0.6.0","0.7.0","0.9.0","0.10.0","0.14.0","0.15.0","0.16.0","0.17.0","0.18.0","0.19.0","0.20.0","0.21.0","0.22.0","0.23.0","0.26.0","0.27.0","0.29.0","0.33.0","0.34.0","0.37.0","0.37.1","0.38.0","0.40.0","0.41.0","0.43.0","0.44.0","0.47.0","0.51.0","0.52.0","0.54.0","0.55.0","0.55.1","0.58.1","0.59.3","0.59.4"],t.exports.target="0.59.4"},function(t,o,n){var s=n(43),a=n(129);t.exports.getVersion=s.getVersion,t.exports.versions=s.versions,t.exports.AnalysisGraph=a},function(t,o,n){var s=n(0),a=n(29);function c(f,p){var m=a.getAnalysisList(f,p);return d(m)}function d(f){var p={};return s.reduce(f,function(m,_){return!p[_.get("id")]&&!l(_,f)&&(p[_.get("id")]=!0,m.push(_.toJSON())),m},[])}function l(f,p){return s.any(p,function(m){return f.equals(m)?!1:m.findAnalysisById(f.get("id"))})}t.exports={serialize:c}},function(t,o,n){var s=n(134),a=n(128),c=n(127);function d(l,f){return{buffersize:{mvt:0},layers:c.serialize(l),dataviews:a.serialize(f),analyses:s.serialize(l,f)}}t.exports={serialize:d}},function(t,o,n){var s,a,c;/*!
(c) 2012 Uzi Kilon, Splunk Inc.
Backbone Poller 1.1.4
https://github.com/uzikilon/backbone-poller
Backbone Poller may be freely distributed under the MIT license.
*/(function(d,l){a=[n(0),n(1)],s=l,c=typeof s=="function"?s.apply(o,a):s,c!==void 0&&(t.exports=c)})(this,function(d,l){var f={delay:1e3,condition:function(){return!0}},p=["start","stop","fetch","success","error","complete"],m=[];function _(P){return d.find(m,function(G){return G.model===P})}var b={get:function(P,G){var $=_(P);return $?$.set(G):($=new x(P,G),m.push($)),G&&G.autostart===!0&&$.start({silent:!0}),$},size:function(){return m.length},reset:function(){for(;m.length;)m[0].destroy()}};function x(P,G){this.model=P,this.cid=d.uniqueId("poller"),this.set(G),this.model instanceof l.Model&&this.listenTo(this.model,"destroy",this.destroy)}d.extend(x.prototype,l.Events,{set:function(P){return this.options=d.extend({},f,P||{}),this.options.flush&&this.off(),d.each(p,d.bind(function(G){var $=this.options[G];d.isFunction($)&&(this.off(G,$,this),this.on(G,$,this))},this)),this.stop({silent:!0})},start:function(P){return this.active()||(P&&P.silent||this.trigger("start",this.model),this.options.active=!0,this.options.delayed?F(this,d.isNumber(this.options.delayed)&&this.options.delayed):A(this)),this},stop:function(P){return P&&P.silent||this.trigger("stop",this.model),this.options.active=!1,this.xhr&&this.xhr.abort&&this.xhr.abort(),this.xhr=null,clearTimeout(this.timeoutId),this.timeoutId=null,this},active:function(){return this.options.active===!0},destroy:function(){var P=d.indexOf(m,this);P>-1&&(this.stop().stopListening().off(),m.splice(P,1))}});function A(P){if(v(P)){var G=d.extend({},P.options,{success:function($,Z){P.trigger("success",$,Z),F(P)},error:function($,Z){P.options.continueOnError?(P.trigger("error",$,Z),F(P)):(P.stop({silent:!0}),P.trigger("error",$,Z))}});P.trigger("fetch",P.model),P.xhr=P.model.fetch(G)}}var S={};function E(P){if(d.isNumber(P.options.delay))return P.options.delay;var G=P.options.delay[0],$=P.options.delay[1],Z=P.options.delay[2]||2;S[P.cid]?d.isFunction(Z)?S[P.cid]=Z(S[P.cid]):S[P.cid]*=Z:S[P.cid]=1;var ie=Math.round(G*S[P.cid]);return $&&$>0&&(ie=Math.min(ie,$)),ie}function F(P,G){v(P)&&(P.timeoutId=d.delay(A,G||E(P),P))}function v(P){return P.options.active?P.options.condition(P.model)!==!0?(P.stop({silent:!0}),P.trigger("complete",P.model),!1):!0:!1}return b.getDelay=E,b.prototype=x.prototype,b})},function(t,o,n){var s=n(0),a=n(136);function c(){this._pollers=[]}c.CONFIG={START_DELAY:1e3,MAX_DELAY:1/0,DELAY_MULTIPLIER:1.5},c.prototype.resetAnalysisNodes=function(d){this.reset(),s.each(d,function(l){this._poll(l)},this)},c.prototype._poll=function(d){if(this._canBePolled(d)){var l=this._createPoller(d);l.start()}},c.prototype._canBePolled=function(d){return d.url()&&!d.isDone()},c.prototype._findPoller=function(d){return s.find(this._pollers,function(l){return l.model===d})},c.prototype._createPoller=function(d){var l={delay:[c.CONFIG.START_DELAY,c.CONFIG.MAX_DELAY,c.CONFIG.DELAY_MULTIPLIER],condition:function(m){return!m.isDone()}},f=a.get(d,l);return this._pollers.push(f),f},c.prototype.reset=function(){a.reset(),this._pollers=[]},t.exports=c},function(t,o,n){function s(a){if(window.trackJs)try{var c=a?a.message+" - code: "+a.errorCode:JSON.stringify(a);window.trackJs.track(new Error(c))}catch{}}t.exports={track:s}},function(t,o,n){t.exports={layer:{"non-valid-source":{messageRegex:/nonValidSource/,friendlyMessage:'The given object is not a valid source. See "carto.source.Base".'},"non-valid-style":{messageRegex:/nonValidStyle/,friendlyMessage:'The given object is not a valid style. See "carto.style.Base".'},"non-valid-columns":{messageRegex:/nonValidColumns/,friendlyMessage:"The given object is not a valid array of string columns."},"source-with-different-client":{messageRegex:/differentSourceClient/,friendlyMessage:"A layer can't have a source which belongs to a different client."},"style-with-different-client":{messageRegex:/differentStyleClient/,friendlyMessage:"A layer can't have a style which belongs to a different client."},"wrong-interactivity-columns":{messageRegex:/wrongInteractivityColumns\[(.+)\]#(.+)$/,friendlyMessage:"Columns [$0] set on `$1` do not match the columns set in aggregation options."}},source:{"query-required":{messageRegex:/requiredQuery/,friendlyMessage:"SQL Source must have a SQL query."},"query-string":{messageRegex:/requiredString/,friendlyMessage:"SQL Query must be a string."},"no-dataset-name":{messageRegex:/noDatasetName/,friendlyMessage:"Table name is required."},"dataset-string":{messageRegex:/requiredDatasetString$/,friendlyMessage:"Table name must be a string."},"dataset-required":{messageRegex:/requiredDataset$/,friendlyMessage:"Table name must be not empty."}},style:{"required-css":{messageRegex:/requiredCSS$/,friendlyMessage:"CartoCSS is required."},"css-string":{messageRegex:/requiredCSSString$/,friendlyMessage:"CartoCSS must be a string."}},client:{"bad-layer-type":{messageRegex:/badLayerType/,friendlyMessage:"The given object is not a layer."},"index-number":{messageRegex:/indexNumber/,friendlyMessage:"index property must be a number."},"index-out-of-range":{messageRegex:/indexOutOfRange/,friendlyMessage:"index is out of range."},"api-key-required":{messageRegex:/apiKeyRequired/,friendlyMessage:"apiKey property is required."},"api-key-string":{messageRegex:/apiKeyString/,friendlyMessage:"apiKey property must be a string."},"username-required":{messageRegex:/usernameRequired/,friendlyMessage:"username property is required."},"username-string":{messageRegex:/usernameString/,friendlyMessage:"username property must be a string."},"non-valid-server-url":{messageRegex:/nonValidServerURL/,friendlyMessage:"serverUrl is not a valid URL."},"non-matching-server-url":{messageRegex:/serverURLDoesntMatchUsername/,friendlyMessage:"serverUrl doesn't match the username."},"duplicated-layer-id":{messageRegex:/duplicatedLayerId/,friendlyMessage:"A layer with the same ID already exists in the client."}},dataview:{"source-required":{messageRegex:/sourceRequired/,friendlyMessage:"Source property is required."},"column-required":{messageRegex:/columnRequired/,friendlyMessage:"Column property is required."},"column-string":{messageRegex:/columnString/,friendlyMessage:"Column property must be a string."},"empty-column":{messageRegex:/emptyColumn/,friendlyMessage:"Column property must be not empty."},"filter-required":{messageRegex:/filterRequired/,friendlyMessage:"Filter property is required."},"time-series-options-required":{messageRegex:/timeSeriesOptionsRequired/,friendlyMessage:"Options object to create a time series dataview is required."},"time-series-invalid-aggregation":{messageRegex:/timeSeriesInvalidAggregation/,friendlyMessage:"Time aggregation must be a valid value. Use carto.dataview.timeAggregation."},"time-series-invalid-offset":{messageRegex:/timeSeriesInvalidOffset/,friendlyMessage:"Offset must an integer value between -12 and 14."},"time-series-invalid-uselocaltimezone":{messageRegex:/timeSeriesInvalidUselocaltimezone/,friendlyMessage:"useLocalTimezone must be a boolean value."},"histogram-options-required":{messageRegex:/histogramOptionsRequired/,friendlyMessage:"Options object to create a histogram dataview is required."},"histogram-invalid-bins":{messageRegex:/histogramInvalidBins/,friendlyMessage:"Bins must be a positive integer value."},"histogram-invalid-start-end":{messageRegex:/histogramInvalidStartEnd/,friendlyMessage:"Both start and end values must be a number or null."},"formula-options-required":{messageRegex:/formulaOptionsRequired/,friendlyMessage:"Formula dataview options are not defined."},"formula-invalid-operation":{messageRegex:/formulaInvalidOperation/,friendlyMessage:"Operation for formula dataview is not valid. Use carto.operation"},"category-options-required":{messageRegex:/categoryOptionsRequired/,friendlyMessage:"Category dataview options are not defined."},"category-limit-required":{messageRegex:/categoryLimitRequired/,friendlyMessage:"Limit for category dataview is required."},"category-limit-number":{messageRegex:/categoryLimitNumber/,friendlyMessage:"Limit for category dataview must be a number."},"category-limit-positive":{messageRegex:/categoryLimitPositive/,friendlyMessage:"Limit for category dataview must be greater than 0."},"category-invalid-operation":{messageRegex:/categoryInvalidOperation/,friendlyMessage:"Operation for category dataview is not valid. Use carto.operation"},"category-operation-required":{messageRegex:/categoryOperationRequired/,friendlyMessage:"Operation column for category dataview is required."},"category-operation-string":{messageRegex:/categoryOperationString/,friendlyMessage:"Operation column for category dataview must be a string."},"category-operation-empty":{messageRegex:/categoryOperationEmpty/,friendlyMessage:"Operation column for category dataview must be not empty."}},filter:{"invalid-bounds-object":{messageRegex:/invalidBoundsObject/,friendlyMessage:"Bounds object is not valid. Use a carto.filter.Bounds object"},"invalid-circle-object":{messageRegex:/invalidCircleObject/,friendlyMessage:"Circle object is not valid. Use a carto.filter.CircleData object"},"invalid-polygon-object":{messageRegex:/invalidPolygonObject/,friendlyMessage:"Polygon object is not valid. Use a carto.filter.PolygonData object"},"column-required":{messageRegex:/columnRequired/,friendlyMessage:"Column property is required."},"column-string":{messageRegex:/columnString/,friendlyMessage:"Column property must be a string."},"empty-column":{messageRegex:/emptyColumn/,friendlyMessage:"Column property must be not empty."},"invalid-filter":{messageRegex:/invalidFilter(.+)/,friendlyMessage:"'$0' is not a valid filter. Please check documentation."},"invalid-option":{messageRegex:/invalidOption(.+)/,friendlyMessage:"'$0' is not a valid option for this filter."},"wrong-filter-type":{messageRegex:/wrongFilterType/,friendlyMessage:"Filters need to extend from carto.filter.SQLBase. Please use carto.filter.Category or carto.filter.Range."},"invalid-parameter-type":{messageRegex:/invalidParameterType(.+)/,friendlyMessage:"Invalid parameter type for '$0'. Please check filters documentation."}},aggregation:{"threshold-required":{messageRegex:/thresholdRequired/,friendlyMessage:"Aggregation threshold is required."},"invalid-threshold":{messageRegex:/invalidThreshold/,friendlyMessage:"Aggregation threshold must be an integer value greater than 0."},"resolution-required":{messageRegex:/resolutionRequired/,friendlyMessage:"Aggregation resolution is required."},"invalid-resolution":{messageRegex:/invalidResolution/,friendlyMessage:"Aggregation resolution must be 0.5, 1 or powers of 2 up to 256 (2, 4, 8, 16, 32, 64, 128, 256)."},"invalid-placement":{messageRegex:/invalidPlacement/,friendlyMessage:"Aggregation placement is not valid. Must be one of these values: `point-sample`, `point-grid`, `centroid`"},"column-function-required":{messageRegex:/columnFunctionRequired(.+)$/,friendlyMessage:"Aggregation function for column '$0' is required."},"invalid-column-function":{messageRegex:/invalidColumnFunction(.+)$/,friendlyMessage:"Aggregation function for column '$0' is not valid. Use carto.aggregation.function"},"column-aggregated-column-required":{messageRegex:/columnAggregatedColumnRequired(.+)$/,friendlyMessage:"Column to be aggregated to '$0' is required."},"invalid-column-aggregated-column":{messageRegex:/invalidColumnAggregatedColumn(.+)$/,friendlyMessage:"Column to be aggregated to '$0' must be a string."}}}},function(t,o,n){t.exports={}},function(t,o,n){t.exports={analysis:{"sql-syntax-error":{messageRegex:/^syntax error/},"invalid-dataset":{messageRegex:/relation (.+) does not exist/,friendlyMessage:"Invalid dataset name used. Dataset $0 does not exist."},"column-does-not-exist":{messageRegex:/column (.+) does not exist/,friendlyMessage:"Invalid column name. Column $0 does not exist."},"analysis-requires-authentication":{messageRegex:/^Analysis requires authentication with API key/}},generic:{},limit:{"over-platform-limits":{messageRegex:/^You are over platform's limits/},"generic-limit-error":{messageRegex:/.*/,friendlyMessage:"The server is taking too long to respond, due to poor conectivity or a temporary error with our servers. Please try again soon."}},tile:{"generic-tile-error":{messageRegex:/.*/,friendlyMessage:"Some tiles might not be rendering correctly."}},layer:{"column-does-not-exist":{messageRegex:/column (.+) does not exist/,friendlyMessage:"Invalid column name. Column $0 does not exist."},"unrecognized-rule":{messageRegex:/Unrecognized rule: (.+)/,friendlyMessage:'Unrecognized rule "$0"'},"generic-layer-error":{messageRegex:/.*/}},dataview:{"formula-does-not-support-operation":{messageRegex:/Formula does not support (.+) operation/},"column-does-not-exist":{messageRegex:/column (.+) does not exist/},"permission-denied":{messageRegex:/permission denied for (.+)/},"wrong-type-column-used-in-time-series":{messageRegex:/function date_part\(unknown, (.+)\) does not exist/,friendlyMessage:"Your time series column type is $0. Please use a date type."},"invalid-aggregation-value":{messageRegex:/Invalid aggregation value. Valid ones: auto, minute, hour, day, week, month, quarter, year, decade, century, millennium/}},auth:{forbidden:{messageRegex:/^Forbidden$/,friendlyMessage:"Forbidden. API key does not grant access."}}}},function(t,o,n){var s=n(141),a=n(140),c=n(139);t.exports={ajax:a,windshaft:s,validation:c}},function(t,o,n){var s=n(0),a=n(142);function c(m){var _=d(m),b=l(m,_);return{friendlyMessage:b.friendlyMessage,errorCode:b.errorCode}}function d(m){return a[m.origin]&&a[m.origin][m.type]}function l(m,_){for(var b=s.keys(_),x,A=0;A<b.length;A++){if(x=b[A],!(_[x].messageRegex instanceof RegExp))throw new Error("MessageRegex on "+x+" is not a RegExp.");if(_[x].messageRegex.test(m.message))return{friendlyMessage:f(m,_[x]),errorCode:p(m,x)}}return{friendlyMessage:m.message||"",errorCode:p(m,"unknown-error")}}function f(m,_){if(!_.friendlyMessage)return m.message;var b=m.message&&m.message.match(_.messageRegex);if(b&&b.length>1){var x=_.friendlyMessage.replace("$0",b[1]);return b.length>2&&(x=x.replace("$1",b[2])),x}return _.friendlyMessage}function p(m,_){var b=[];return b.push(m&&m.origin),b.push(m&&m.type),b.push(_),b=s.compact(b),b.join(":")}t.exports={getExtraFields:c}},function(t,o,n){var s=n(0),a=n(1),c=n(4),d=n(44),l=n(14),f=n(40),p=n(111),m=n(26).version,_=n(3),b=n(7);function x(Z){return new _("client",Z)}var A="https://{username}.carto.com";function S(Z){Z.serverUrl=(Z.serverUrl||A).replace(/{username}/,Z.username||""),v(Z),this._layers=new p,this._dataviews=[],this._engine=new d({apiKey:Z.apiKey,username:Z.username,serverUrl:Z.serverUrl,client:"js-"+m}),this._bindEngine(this._engine)}s.extend(S.prototype,a.Events),S.prototype.addLayer=function(Z){return this.addLayers([Z])},S.prototype.addLayers=function(Z){return Z.forEach(this._addLayer,this),this._reload()},S.prototype.removeLayer=function(Z){return this.removeLayers([Z])},S.prototype.removeLayers=function(Z){var ie=Z.slice(0);return ie.forEach(this._removeLayer,this),this._reload()},S.prototype.moveLayer=function(Z,ie){var le=this._layers.indexOf(Z);return this._moveLayer(Z,ie),le===ie?Promise.resolve():this._reload()},S.prototype.getLayers=function(){return this._layers.toArray()},S.prototype.addDataview=function(Z){return this.addDataviews([Z])},S.prototype.addDataviews=function(Z){return Z.forEach(this._addDataview,this),this._reload()},S.prototype.removeDataview=function(Z){var ie=this._dataviews.indexOf(Z);return ie===-1?Promise.resolve():(this._dataviews.splice(ie,1),this._engine.removeDataview(Z.$getInternalModel()),Z.disable(),this._reload())},S.prototype.getDataviews=function(){return this._dataviews},S.prototype.getLeafletLayer=function(Z){if(b.isLeafletLoaded(),!this._leafletLayer){var ie=n(110);this._leafletLayer=new ie(this._layers,this._engine,Z)}return this._leafletLayer},S.prototype.getGoogleMapsMapType=function(Z){if(b.isGoogleMapsLoaded(),!this._gmapsMapType){var ie=n(87);this._gmapsMapType=new ie(this._layers,this._engine,Z)}return this._gmapsMapType},S.prototype._reload=function(){return this._engine.reload().then(function(){return Promise.resolve()}).catch(function(Z){return Promise.reject(new c(Z))})},S.prototype._addLayer=function(Z,ie){E(Z),this._checkDuplicatedLayerId(Z),this._layers.add(Z),Z.$setClient(this),Z.$setEngine(this._engine),this._engine.addLayer(Z.$getInternalModel())},S.prototype._removeLayer=function(Z){E(Z),this._layers.remove(Z),this._engine.removeLayer(Z.$getInternalModel())},S.prototype._moveLayer=function(Z,ie){E(Z),F(ie,this._layers.size()),this._layers.move(Z,ie),this._engine.moveLayer(Z.$getInternalModel(),ie)},S.prototype._addDataview=function(Z,ie){this._dataviews.push(Z),Z.$setEngine(this._engine),this._engine.addDataview(Z.$getInternalModel())},S.prototype._bindEngine=function(Z){Z.on(d.Events.RELOAD_SUCCESS,function(){this.trigger(l.SUCCESS)}.bind(this)),Z.on(d.Events.RELOAD_ERROR,function(ie){this.trigger(l.ERROR,new c(ie,{layers:this._layers}))}.bind(this)),Z.on(d.Events.LAYER_ERROR,function(ie){this.trigger(l.ERROR,new c(ie))}.bind(this))},S.prototype._checkDuplicatedLayerId=function(Z){if(this._layers.findById(Z.getId()))throw x("duplicatedLayerId")};function E(Z){if(!(Z instanceof f))throw x("badLayerType")}function F(Z,ie){if(!s.isNumber(Z))throw x("indexNumber");if(Z<0||Z>=ie)throw x("indexOutOfRange")}function v(Z){P(Z.apiKey),G(Z.username),Z.serverUrl&&$(Z.serverUrl,Z.username)}function P(Z){if(!Z)throw x("apiKeyRequired");if(!s.isString(Z))throw x("apiKeyString")}function G(Z){if(!Z)throw x("usernameRequired");if(!s.isString(Z))throw x("usernameString")}function $(Z,ie){var le=/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/;if(!Z.match(le))throw x("nonValidServerURL");if(Z.indexOf(ie)<0)throw x("serverURLDoesntMatchUsername")}t.exports=S},function(t,o){var n=t.exports={},s,a;function c(){throw new Error("setTimeout has not been defined")}function d(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?s=setTimeout:s=c}catch{s=c}try{typeof clearTimeout=="function"?a=clearTimeout:a=d}catch{a=d}})();function l(F){if(s===setTimeout)return setTimeout(F,0);if((s===c||!s)&&setTimeout)return s=setTimeout,setTimeout(F,0);try{return s(F,0)}catch{try{return s.call(null,F,0)}catch{return s.call(this,F,0)}}}function f(F){if(a===clearTimeout)return clearTimeout(F);if((a===d||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(F);try{return a(F)}catch{try{return a.call(null,F)}catch{return a.call(this,F)}}}var p=[],m=!1,_,b=-1;function x(){!m||!_||(m=!1,_.length?p=_.concat(p):b=-1,p.length&&A())}function A(){if(!m){var F=l(x);m=!0;for(var v=p.length;v;){for(_=p,p=[];++b<v;)_&&_[b].run();b=-1,v=p.length}_=null,m=!1,f(F)}}n.nextTick=function(F){var v=new Array(arguments.length-1);if(arguments.length>1)for(var P=1;P<arguments.length;P++)v[P-1]=arguments[P];p.push(new S(F,v)),p.length===1&&!m&&l(A)};function S(F,v){this.fun=F,this.array=v}S.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={};function E(){}n.on=E,n.addListener=E,n.once=E,n.off=E,n.removeListener=E,n.removeAllListeners=E,n.emit=E,n.prependListener=E,n.prependOnceListener=E,n.listeners=function(F){return[]},n.binding=function(F){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(F){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,o,n){(function(s,a){(function(c,d){if(c.setImmediate)return;var l=1,f={},p=!1,m=c.document,_;function b(ie){typeof ie!="function"&&(ie=new Function(""+ie));for(var le=new Array(arguments.length-1),X=0;X<le.length;X++)le[X]=arguments[X+1];var oe={callback:ie,args:le};return f[l]=oe,_(l),l++}function x(ie){delete f[ie]}function A(ie){var le=ie.callback,X=ie.args;switch(X.length){case 0:le();break;case 1:le(X[0]);break;case 2:le(X[0],X[1]);break;case 3:le(X[0],X[1],X[2]);break;default:le.apply(d,X);break}}function S(ie){if(p)setTimeout(S,0,ie);else{var le=f[ie];if(le){p=!0;try{A(le)}finally{x(ie),p=!1}}}}function E(){_=function(ie){a.nextTick(function(){S(ie)})}}function F(){if(c.postMessage&&!c.importScripts){var ie=!0,le=c.onmessage;return c.onmessage=function(){ie=!1},c.postMessage("","*"),c.onmessage=le,ie}}function v(){var ie="setImmediate$"+Math.random()+"$",le=function(X){X.source===c&&typeof X.data=="string"&&X.data.indexOf(ie)===0&&S(+X.data.slice(ie.length))};c.addEventListener?c.addEventListener("message",le,!1):c.attachEvent("onmessage",le),_=function(X){c.postMessage(ie+X,"*")}}function P(){var ie=new MessageChannel;ie.port1.onmessage=function(le){var X=le.data;S(X)},_=function(le){ie.port2.postMessage(le)}}function G(){var ie=m.documentElement;_=function(le){var X=m.createElement("script");X.onreadystatechange=function(){S(le),X.onreadystatechange=null,ie.removeChild(X),X=null},ie.appendChild(X)}}function $(){_=function(ie){setTimeout(S,0,ie)}}var Z=Object.getPrototypeOf&&Object.getPrototypeOf(c);Z=Z&&Z.setTimeout?Z:c,{}.toString.call(c.process)==="[object process]"?E():F()?v():c.MessageChannel?P():m&&"onreadystatechange"in m.createElement("script")?G():$(),Z.setImmediate=b,Z.clearImmediate=x})(typeof self>"u"?typeof s>"u"?this:s:self)}).call(this,n(30),n(145))},function(t,o,n){(function(s){var a=typeof s<"u"&&s||typeof self<"u"&&self||window,c=Function.prototype.apply;o.setTimeout=function(){return new d(c.call(setTimeout,a,arguments),clearTimeout)},o.setInterval=function(){return new d(c.call(setInterval,a,arguments),clearInterval)},o.clearTimeout=o.clearInterval=function(l){l&&l.close()};function d(l,f){this._id=l,this._clearFn=f}d.prototype.unref=d.prototype.ref=function(){},d.prototype.close=function(){this._clearFn.call(a,this._id)},o.enroll=function(l,f){clearTimeout(l._idleTimeoutId),l._idleTimeout=f},o.unenroll=function(l){clearTimeout(l._idleTimeoutId),l._idleTimeout=-1},o._unrefActive=o.active=function(l){clearTimeout(l._idleTimeoutId);var f=l._idleTimeout;f>=0&&(l._idleTimeoutId=setTimeout(function(){l._onTimeout&&l._onTimeout()},f))},n(146),o.setImmediate=typeof self<"u"&&self.setImmediate||typeof s<"u"&&s.setImmediate||this&&this.setImmediate,o.clearImmediate=typeof self<"u"&&self.clearImmediate||typeof s<"u"&&s.clearImmediate||this&&this.clearImmediate}).call(this,n(30))},function(t,o,n){(function(s){(function(a){var c=setTimeout;function d(){}function l(S,E){return function(){S.apply(E,arguments)}}function f(S){if(!(this instanceof f))throw new TypeError("Promises must be constructed via new");if(typeof S!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],A(S,this)}function p(S,E){for(;S._state===3;)S=S._value;if(S._state===0){S._deferreds.push(E);return}S._handled=!0,f._immediateFn(function(){var F=S._state===1?E.onFulfilled:E.onRejected;if(F===null){(S._state===1?m:_)(E.promise,S._value);return}var v;try{v=F(S._value)}catch(P){_(E.promise,P);return}m(E.promise,v)})}function m(S,E){try{if(E===S)throw new TypeError("A promise cannot be resolved with itself.");if(E&&(typeof E=="object"||typeof E=="function")){var F=E.then;if(E instanceof f){S._state=3,S._value=E,b(S);return}else if(typeof F=="function"){A(l(F,E),S);return}}S._state=1,S._value=E,b(S)}catch(v){_(S,v)}}function _(S,E){S._state=2,S._value=E,b(S)}function b(S){S._state===2&&S._deferreds.length===0&&f._immediateFn(function(){S._handled||f._unhandledRejectionFn(S._value)});for(var E=0,F=S._deferreds.length;E<F;E++)p(S,S._deferreds[E]);S._deferreds=null}function x(S,E,F){this.onFulfilled=typeof S=="function"?S:null,this.onRejected=typeof E=="function"?E:null,this.promise=F}function A(S,E){var F=!1;try{S(function(v){F||(F=!0,m(E,v))},function(v){F||(F=!0,_(E,v))})}catch(v){if(F)return;F=!0,_(E,v)}}f.prototype.catch=function(S){return this.then(null,S)},f.prototype.then=function(S,E){var F=new this.constructor(d);return p(this,new x(S,E,F)),F},f.all=function(S){return new f(function(E,F){if(!S||typeof S.length>"u")throw new TypeError("Promise.all accepts an array");var v=Array.prototype.slice.call(S);if(v.length===0)return E([]);var P=v.length;function G(Z,ie){try{if(ie&&(typeof ie=="object"||typeof ie=="function")){var le=ie.then;if(typeof le=="function"){le.call(ie,function(X){G(Z,X)},F);return}}v[Z]=ie,--P===0&&E(v)}catch(X){F(X)}}for(var $=0;$<v.length;$++)G($,v[$])})},f.resolve=function(S){return S&&typeof S=="object"&&S.constructor===f?S:new f(function(E){E(S)})},f.reject=function(S){return new f(function(E,F){F(S)})},f.race=function(S){return new f(function(E,F){for(var v=0,P=S.length;v<P;v++)S[v].then(E,F)})},f._immediateFn=typeof s=="function"&&function(S){s(S)}||function(S){c(S,0)},f._unhandledRejectionFn=function(E){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",E)},f._setImmediateFn=function(E){f._immediateFn=E},f._setUnhandledRejectionFn=function(E){f._unhandledRejectionFn=E},typeof t<"u"&&t.exports?t.exports=f:a.Promise||(a.Promise=f)})(this)}).call(this,n(147).setImmediate)},function(t,o){(function(n){if(n.fetch)return;var s={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n};if(s.arrayBuffer)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=function(X){return X&&DataView.prototype.isPrototypeOf(X)},d=ArrayBuffer.isView||function(X){return X&&a.indexOf(Object.prototype.toString.call(X))>-1};function l(X){if(typeof X!="string"&&(X=String(X)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(X))throw new TypeError("Invalid character in header field name");return X.toLowerCase()}function f(X){return typeof X!="string"&&(X=String(X)),X}function p(X){var oe={next:function(){var _e=X.shift();return{done:_e===void 0,value:_e}}};return s.iterable&&(oe[Symbol.iterator]=function(){return oe}),oe}function m(X){this.map={},X instanceof m?X.forEach(function(oe,_e){this.append(_e,oe)},this):Array.isArray(X)?X.forEach(function(oe){this.append(oe[0],oe[1])},this):X&&Object.getOwnPropertyNames(X).forEach(function(oe){this.append(oe,X[oe])},this)}m.prototype.append=function(X,oe){X=l(X),oe=f(oe);var _e=this.map[X];this.map[X]=_e?_e+","+oe:oe},m.prototype.delete=function(X){delete this.map[l(X)]},m.prototype.get=function(X){return X=l(X),this.has(X)?this.map[X]:null},m.prototype.has=function(X){return this.map.hasOwnProperty(l(X))},m.prototype.set=function(X,oe){this.map[l(X)]=f(oe)},m.prototype.forEach=function(X,oe){for(var _e in this.map)this.map.hasOwnProperty(_e)&&X.call(oe,this.map[_e],_e,this)},m.prototype.keys=function(){var X=[];return this.forEach(function(oe,_e){X.push(_e)}),p(X)},m.prototype.values=function(){var X=[];return this.forEach(function(oe){X.push(oe)}),p(X)},m.prototype.entries=function(){var X=[];return this.forEach(function(oe,_e){X.push([_e,oe])}),p(X)},s.iterable&&(m.prototype[Symbol.iterator]=m.prototype.entries);function _(X){if(X.bodyUsed)return Promise.reject(new TypeError("Already read"));X.bodyUsed=!0}function b(X){return new Promise(function(oe,_e){X.onload=function(){oe(X.result)},X.onerror=function(){_e(X.error)}})}function x(X){var oe=new FileReader,_e=b(oe);return oe.readAsArrayBuffer(X),_e}function A(X){var oe=new FileReader,_e=b(oe);return oe.readAsText(X),_e}function S(X){for(var oe=new Uint8Array(X),_e=new Array(oe.length),Re=0;Re<oe.length;Re++)_e[Re]=String.fromCharCode(oe[Re]);return _e.join("")}function E(X){if(X.slice)return X.slice(0);var oe=new Uint8Array(X.byteLength);return oe.set(new Uint8Array(X)),oe.buffer}function F(){return this.bodyUsed=!1,this._initBody=function(X){if(this._bodyInit=X,!X)this._bodyText="";else if(typeof X=="string")this._bodyText=X;else if(s.blob&&Blob.prototype.isPrototypeOf(X))this._bodyBlob=X;else if(s.formData&&FormData.prototype.isPrototypeOf(X))this._bodyFormData=X;else if(s.searchParams&&URLSearchParams.prototype.isPrototypeOf(X))this._bodyText=X.toString();else if(s.arrayBuffer&&s.blob&&c(X))this._bodyArrayBuffer=E(X.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else if(s.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(X)||d(X)))this._bodyArrayBuffer=E(X);else throw new Error("unsupported BodyInit type");this.headers.get("content-type")||(typeof X=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):s.searchParams&&URLSearchParams.prototype.isPrototypeOf(X)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s.blob&&(this.blob=function(){var X=_(this);if(X)return X;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(x)}),this.text=function(){var X=_(this);if(X)return X;if(this._bodyBlob)return A(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(S(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s.formData&&(this.formData=function(){return this.text().then($)}),this.json=function(){return this.text().then(JSON.parse)},this}var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function P(X){var oe=X.toUpperCase();return v.indexOf(oe)>-1?oe:X}function G(X,oe){oe=oe||{};var _e=oe.body;if(X instanceof G){if(X.bodyUsed)throw new TypeError("Already read");this.url=X.url,this.credentials=X.credentials,oe.headers||(this.headers=new m(X.headers)),this.method=X.method,this.mode=X.mode,!_e&&X._bodyInit!=null&&(_e=X._bodyInit,X.bodyUsed=!0)}else this.url=String(X);if(this.credentials=oe.credentials||this.credentials||"omit",(oe.headers||!this.headers)&&(this.headers=new m(oe.headers)),this.method=P(oe.method||this.method||"GET"),this.mode=oe.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&_e)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(_e)}G.prototype.clone=function(){return new G(this,{body:this._bodyInit})};function $(X){var oe=new FormData;return X.trim().split("&").forEach(function(_e){if(_e){var Re=_e.split("="),Se=Re.shift().replace(/\+/g," "),we=Re.join("=").replace(/\+/g," ");oe.append(decodeURIComponent(Se),decodeURIComponent(we))}}),oe}function Z(X){var oe=new m,_e=X.replace(/\r?\n[\t ]+/g," ");return _e.split(/\r?\n/).forEach(function(Re){var Se=Re.split(":"),we=Se.shift().trim();if(we){var Ue=Se.join(":").trim();oe.append(we,Ue)}}),oe}F.call(G.prototype);function ie(X,oe){oe||(oe={}),this.type="default",this.status=oe.status===void 0?200:oe.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in oe?oe.statusText:"OK",this.headers=new m(oe.headers),this.url=oe.url||"",this._initBody(X)}F.call(ie.prototype),ie.prototype.clone=function(){return new ie(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},ie.error=function(){var X=new ie(null,{status:0,statusText:""});return X.type="error",X};var le=[301,302,303,307,308];ie.redirect=function(X,oe){if(le.indexOf(oe)===-1)throw new RangeError("Invalid status code");return new ie(null,{status:oe,headers:{location:X}})},n.Headers=m,n.Request=G,n.Response=ie,n.fetch=function(X,oe){return new Promise(function(_e,Re){var Se=new G(X,oe),we=new XMLHttpRequest;we.onload=function(){var Ue={status:we.status,statusText:we.statusText,headers:Z(we.getAllResponseHeaders()||"")};Ue.url="responseURL"in we?we.responseURL:Ue.headers.get("X-Request-URL");var Oe="response"in we?we.response:we.responseText;_e(new ie(Oe,Ue))},we.onerror=function(){Re(new TypeError("Network request failed"))},we.ontimeout=function(){Re(new TypeError("Network request failed"))},we.open(Se.method,Se.url,!0),Se.credentials==="include"?we.withCredentials=!0:Se.credentials==="omit"&&(we.withCredentials=!1),"responseType"in we&&s.blob&&(we.responseType="blob"),Se.headers.forEach(function(Ue,Oe){we.setRequestHeader(Oe,Ue)}),we.send(typeof Se._bodyInit>"u"?null:Se._bodyInit)})},n.fetch.polyfill=!0})(typeof self<"u"?self:this)},function(t,o,n){n(149);var s=n(148);window.Promise||(window.Promise=s);var a=n(144),c=n(82),d=n(79),l=n(23),f=n(77),p=n(59),m=n(14),_=n(5),b={version:n(26).version,ATTRIBUTION:_.ATTRIBUTION,Client:a,source:c,style:d,layer:l,dataview:f,filter:p,events:m,operation:_.operation};t.exports=b}])})})(Lp);const Wt=sp(uu);const Si="default_public";function Sp(i){const{getMap:e,getCartoClient:t,getPopup:o}=$r(Si),n=e(),s=t(),a=o(),c=new Date,d=c.getUTCDate(),l=c.getUTCMonth(),f=c.getUTCFullYear(),p=Date.UTC(f,l,d).valueOf()/1e3,m=`${l+1}/${d}/${f}`,_=new Wt.source.SQL(`
		WITH
			g AS (
				SELECT cartodb_id, ST_Transform(the_geom,3857) AS the_geom_webmercator
				FROM activelicensesv2 WHERE the_geom IS NOT NULL AND countyname IN ('NEW YORK','BRONX','KINGS','QUEENS','RICHMOND') AND licensetyp in ('OP','SW','SB','SL','VL','RL','HL','CL','CT','EL','TL','CR','RW','HW','CW','TW','WC','EB','MR')
			),
			m AS (
				SELECT array_agg(cartodb_id) AS id_list, the_geom_webmercator, ST_Y(the_geom_webmercator) AS y
				FROM g
				GROUP BY the_geom_webmercator
				ORDER BY y DESC
			),
			f AS (
				SELECT generate_series(1, array_length(id_list,1)) AS p, unnest(id_list) AS cartodb_id, the_geom_webmercator
				FROM m
			)
      SELECT ST_Translate(f.the_geom_webmercator,0,f.p*5) AS the_geom_webmercator, q.cartodb_id, premisename, premisedba, 
        licensetyp, 
        TO_CHAR(lic_original_date, 'MM/DD/YYYY') AS license_original_date, 
        TO_CHAR(lic_effective_date, 'MM/DD/YYYY') AS license_effective_date, 
        TO_CHAR(lic_expiration_date, 'MM/DD/YYYY') AS license_expiration_date, 
        date_part('epoch', lic_expiration_date) AS expiration_epoch , 
        serialno, certnum, premiseaddress1, premisezip,
        method_of_operation, days_hours_of_operation
				FROM f, activelicensesv2 q
				WHERE f.cartodb_id = q.cartodb_id
        `),b=new Wt.style.CartoCSS(`
        #layer {
            marker-width: 16;
            marker-fill-opacity: 0.9;
            marker-file: url('https://s3.amazonaws.com/com.cartodb.users-assets.production/maki-icons/bar-18.svg');
            marker-allow-overlap: true;
            marker-line-width: 1;
            marker-line-color: #ffffff;
            marker-line-opacity: 1;
        }
        #layer {
          [expiration_epoch <= ${p}] {
            marker-fill: #e10012;
          }
          [expiration_epoch > ${p}]{
            marker-fill: #e34dee;
          }
        }
        #layer [zoom > 16] {
            marker-width: 16;
        }
        #layer [zoom <=16] {
            marker-width: 12;
        }
        #layer [zoom <=15] {
            marker-width: 10;
        }
        #layer [zoom <=14] {
            marker-width: 7;
        }
        #layer [zoom <=12] {
            marker-width: 2;
        }
    `),x=new Wt.layer.Layer(_,b,{featureClickColumns:["premisename","premisedba","serialno","licensetyp","license_effective_date","license_expiration_date","license_original_date","certnum","premiseaddress1","premisezip","method_of_operation","days_hours_of_operation"]});return s.addLayer(x).then(()=>{Sr.add({order:3,ref:x,label:"State Liquor Authority Licenses",legend:[{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629205705bar-15.svg",text:`Active on ${m}`},{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629205836bar-15.svg",text:"Expired"}],checked:!1})}).catch(A=>console.log(A.message)),x.on("featureOver",A=>{let S="";S+='<div class="widget">',S+=`<p class = "bold">${A.data.premiseaddress1}</p><p>${A.data.premisedba}</p><p>${A.data.premisename}</p>`,a.setContent(S),a.setLatLng(A.latLng),a.isOpen()||a.openOn(n)}),x.on("featureClicked",A=>{let S="",E="";A.data.doing_business_as_premisedba!==""?S+=`<h3 class = "bold">${A.data.premisedba}</h3><h4 class = "bold">${A.data.premisename}</h4>`:S+=`<h3 class = "bold">${A.data.premisename}</h3>`,S+=`<h4>${A.data.premiseaddress1}</h4><div class="separator"></div>
				<h5 class = "lighter">License Type: ${A.data.licensetyp}</h5>
				<h5 class = "lighter">Serial number: ${A.data.serialno}</h5>
        <h5 class = "lighter">Original Date: ${A.data.license_original_date}</h5>
				<h5 class = "lighter">Effective Date: ${A.data.license_effective_date}</h5>
        <h5 class = "lighter">Expiration Date: ${A.data.license_expiration_date}</h5>
        <h5 class = "lighter">Method of Operation: ${A.data.method_of_operation}</h5>
        <h5 class = "lighter">Days/Hours of Operation: ${A.data.days_hours_of_operation}</h5>
        <h5 class = "lighter"><a href= 'https://lamp.sla.ny.gov/?center=${A.latLng.lng},${A.latLng.lat}&level=18' target = '_blank'>View infomation on LAMP</a></h5>
	<h5 class = "lighter">
		<p>Note: Currently the Public Query tool is decommissioned for security reasons. Please <a href="https://sla.ny.gov/public-query">FOIL SLA</a> for 
		principal information or use <a href="https://beta.nyc/radar">BetaNYC's RADAR</a> system. 
		</p>
		<a href= 'https://www.tran.sla.ny.gov/servlet/ApplicationServlet?pageName=com.ibm.nysla.data.publicquery.PublicQuerySuccessfulResultsPage&validated=true&serialNumber=${A.data.serialno}&licenseType=${A.data.licensetyp}' target = '_blank'>Click here for more information about this license.</a>
	</h5>`;const F=new Headers;F.append("Ocp-Apim-Subscription-Key","8ef9b00a1d6c4a97b17a6c4828cfc2eb");var v=`https://api.nyc.gov/geo/geoclient/v1/search.json?input=${A.data.premiseaddress1} ${A.data.premisezip}`,P=new Promise(function(G){fetch(v,{headers:F}).then(function($){return $.json()}).then(function($){const ie=$.results[0].response;G(ie.buildingIdentificationNumber)}).catch(function($){G(0)})});P.then(G=>{if(G===0)S+='<div class="separator"></div><h4>Certificate of Occupancy</h4>><h5 class = "lighter">No BIN Found.</h5>';else{const $=`http://a810-bisweb.nyc.gov/bisweb/COsByLocationServlet?requestid=1&allbin=${G}`;S+=`<div class="separator"></div><h4>Certificate of Occupancy</h4><h5 class = "lighter">BIN: <a href= '${$}' target = '_blank'>${G}</a></h5>`}E+=`<div class="separator"></div>
          <h6>Source: 
            <a href='https://data.ny.gov/Economic-Development/Liquor-Authority-Quarterly-List-of-Active-Licenses/hrvs-fxs2'>Liquor Authority Quarterly List of Active Licenses.</a>
            <a href='https://lamp.sla.ny.gov/'>NYS Liquor Authority Mapping Project (LAMP)</a>
            </h6>
          <h6>Data is filtered to liquor licenses reviewed by the New York City Agency Office. Data is updated Daily.</h6>`,cs.show({content:S,source:E,charts:[]})})}),s.getLeafletLayer().addTo(n),[]}class Mp extends li{constructor(e){super(),ai(this,e,Sp,null,Vn,{})}}function Tp(i){const{getMap:e,getCartoClient:t,getPopup:o}=$r(Si),n=e(),s=t(),a=o(),c=new Wt.source.SQL(`
          SELECT * FROM sidewalk_caf_licenses_and_applications
  `),d=new Wt.style.CartoCSS(`
  				#layer {
  				marker-width: 16;
  				marker-fill-opacity: 0.9;
  				marker-file: url('https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180612173650picnic-site-15.svg');
  				marker-allow-overlap: true;
  				marker-line-width: 0.25;
  				marker-line-color: #FFFFFF;
  				marker-line-opacity: 1;
  				}
  				#layer [zoom > 16]{
  					marker-width: 16;
  				}
  				#layer [zoom <= 16]{
  				marker-width: 12;
  				}
  				#layer [zoom <= 15]{
  				marker-width: 10;
  				}
  				#layer [zoom <= 14]{
  				marker-width: 7;
  				}
  				#layer [zoom <= 12]{
  				marker-width: 2;
  				}
  				#layer {
            [lic_status = 'Active']{
  			    	marker-fill: #07d91c;
  					}
            [lic_status = 'Inactive']{
  				    marker-fill: #227527;
  					}
          }
  				`),l=new Wt.layer.Layer(c,d,{featureOverColumns:["license_nbr","lic_status","business_name","business_name2","building","street","swc_type","swc_sq_ft","swc_tables","swc_chairs","community_district","expiration_date","issuance","issuance_dd","cb","cb_dd","app_id","app_swc_type","app_sq_ft","app_tables","app_chairs","intake_dd"]});return s.addLayer(l).then(()=>{Sr.add({order:4,ref:l,label:"Sidewalk Café Licenses",legend:[{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629210223picnic-site-15.svg",text:"Active"},{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629210143picnic-site-15.svg",text:"Inactive"}],checked:!1})}).catch(f=>console.log(f.message)),l.on("featureOver",f=>{let p="";p+='<div class="widget">',p+=`<p class = "bold">${f.data.building} ${f.data.street}</p><p>${f.data.business_name2}</p><p>${f.data.business_name}</p>`,a.setContent(p),a.setLatLng(f.latLng),a.isOpen()||a.openOn(n)}),l.on("featureClicked",f=>{let p="",m="",_=!1,b=!1;f.data.issuance=="Pending Review"&&f.data.lic_status=="Inactive"?(_=!0,b=!1):f.data.issuance=="Issued"&&f.data.lic_status=="Inactive"&&(_=!1,b=!0),p+=`<h3 class = "bold">${f.data.business_name2}</h3>
				<h4 class = "bold">${f.data.business_name}</h4>
				<h4>${f.data.building} ${f.data.street}</h4><div class="separator"></div>`,_==!0?p+=`<h5 class = "lighter">${f.data.issuance}</h5>
					 <h5 class = "lighter">Application ID: ${f.data.app_id}</h5>
					 <h5 class = "lighter">Application Type: ${f.data.app_swc_type}</h5>
					 <h5 class = "lighter">Application Square footage: ${f.data.app_sq_ft}</h5>
					 <h5 class = "lighter">Application Tables: ${f.data.app_tables}</h5>
					 <h5 class = "lighter">Application Chairs: ${f.data.app_chairs}</h5>
					 <h5 class = "lighter">Application Intake Date: ${f.data.intake_dd}</h5>
					 <h5><a href="https://www1.nyc.gov/assets/dca/SidewalkCafeMap/index.html#home" target="_blank">Click here for more information about this sidewalk cafe.</h5>`:b==!0?p+=`<h5 class = "lighter">Status: ${f.data.lic_status}</h5>
					 <h5 class = "lighter">License Number: ${f.data.license_nbr}</h5>
					 <h5 class = "lighter">Issuance Date: ${f.data.issuance_dd}</h5>
					 <h5 class = "lighter">Expiration Date: ${f.data.expiration_date}</h5>`:p+=`<h5 class = "lighter">Status: ${f.data.lic_status}</h5>
					 <h5 class = "lighter">License Number: ${f.data.license_nbr}</h5>
					 <h5 class = "lighter">Type: ${f.data.swc_type}</h5>
					 <h5 class = "lighter">Square footage: ${f.data.swc_sq_ft}</h5>
					 <h5 class = "lighter">Tables: ${f.data.swc_tables}</h5>
					 <h5 class = "lighter">Chairs: ${f.data.swc_chairs}</h5>
					 <h5 class = "lighter">Issuance Date: ${f.data.issuance_dd}</h5>
					 <h5 class = "lighter">Expiration Date: ${f.data.expiration_date}</h5>
					 <div class="separator"></div>
					 <h5 class = "lighter">Community Board: ${f.data.community_district}</h5>
					 <h5 class = "lighter">Community Board Review Status: ${f.data.cb}</h5>
					 <h5 class = "lighter">Community Board Review Status Date: ${f.data.cb_dd}</h5>
					 <h5><a href="https://www1.nyc.gov/assets/dca/SidewalkCafeMap/index.html#home" target="_blank">Click here for more information about this sidewalk cafe.</h5>
					 `,m+=`<div class="separator"></div><h6>Source: <a href='https://data.cityofnewyork.us/Business/Sidewalk-Caf-Licenses-and-Applications/qcdj-rwhu/data'>Sidewalk Cafe Licenses and Applications.</a></h6><h6>Data is updated weekly.</h6>`,cs.show({content:p,source:m,charts:[]})}),s.getLeafletLayer().addTo(n),[]}class Pp extends li{constructor(e){super(),ai(this,e,Tp,null,Vn,{})}}function Ep(i){const{getMap:e,getCartoClient:t,getPopup:o}=$r(Si),n=e(),s=t(),a=o(),c=new Wt.source.SQL(`
          SELECT * FROM nyc_open_restaurants_application_xjsx
  `),d=new Wt.style.CartoCSS(`
  				#layer {
  				marker-width: 18;
  				marker-fill-opacity: 0.9;
  				marker-file: url('https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180612173650picnic-site-15.svg');
  				marker-allow-overlap: true;
  				marker-line-width: 0.25;
  				marker-line-color: #FFFFFF;
  				marker-line-opacity: 1;
  				}
  				#layer [zoom > 16]{
  					marker-width: 18;
  				}
  				#layer [zoom <= 16]{
  				marker-width: 14;
  				}
  				#layer [zoom <= 15]{
  				marker-width: 12;
  				}
  				#layer [zoom <= 14]{
  				marker-width: 6;
  				}
  				#layer [zoom <= 12]{
  				marker-width: 3;
  				}
  				#layer {
            [alcohol = 'yes']{
                marker-fill: #804F40;
                }
            [alcohol = 'no']{
                marker-fill: #4dc1bb;
            }
          }
  				`),l=new Wt.layer.Layer(c,d,{featureOverColumns:["bizaddress","restaurantname","extra1","alcohol","submissiontime"]});return s.addLayer(l).then(()=>{Sr.add({order:0,ref:l,label:"Open Restaurants (self-certified)",legend:[{image:"./images/alcohol.svg",text:"Alcohol Service"},{image:"./images/no_alcohol.svg",text:"No Alcohol Service"}],checked:!0})}).catch(f=>console.log(f.message)),l.on("featureOver",f=>{const{bizaddress:p,restaurantname:m}=f.data;let _=`
            <div class="widget">
                <p class = "bold">${p}</p>
                <p>${m}</p>
            </div>
        `;a.setContent(_),a.setLatLng(f.latLng),a.isOpen()||a.openOn(n)}),l.on("featureClicked",f=>{const{bizaddress:p,restaurantname:m,extra1:_,alcohol:b,submissiontime:x}=f.data;let A=`
            <div class="widget">
                <p class = "bold">${p}</p>
                <p>${m}</p>
                <div class="tags-group">
                     <div class="tags has-addons">
                        <p class="tag">Sidewalk/ Roadway</p><p class="tag">${_}</p>
                    </div>
                    <div class="tags has-addons">
                        <p class="tag">Alcohol</p><p class="tag ${b==="yes"?"success":""}">${b}</p>
                    </div>
                </div>
            </div>
        `,S=`
            <div class="separator"></div>
            <h6>Source: <a target="_blank" href='http://nycopenrestaurants.info'>Open Restaurant Map & Dashboard.</a></h6>
            <h6>Data is updated hourly. Note: This data is <strong>self-certified responses</strong>.</h6>
        `;cs.show({content:A,source:S,charts:[]})}),s.getLeafletLayer().addTo(n),[]}class Ap extends li{constructor(e){super(),ai(this,e,Ep,null,Vn,{})}}/*!
 * @kurkle/color v0.3.1
 * https://github.com/kurkle/color#readme
 * (c) 2022 Jukka Kurkela
 * Released under the MIT License
 */function Ta(i){return i+.5|0}const yo=(i,e,t)=>Math.max(Math.min(i,t),e);function oa(i){return yo(Ta(i*2.55),0,255)}function wo(i){return yo(Ta(i*255),0,255)}function Xr(i){return yo(Ta(i/2.55)/100,0,1)}function lc(i){return yo(Ta(i*100),0,100)}const Ui={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},cu=[..."0123456789ABCDEF"],Op=i=>cu[i&15],kp=i=>cu[(i&240)>>4]+cu[i&15],Ha=i=>(i&240)>>4===(i&15),Rp=i=>Ha(i.r)&&Ha(i.g)&&Ha(i.b)&&Ha(i.a);function Bp(i){var e=i.length,t;return i[0]==="#"&&(e===4||e===5?t={r:255&Ui[i[1]]*17,g:255&Ui[i[2]]*17,b:255&Ui[i[3]]*17,a:e===5?Ui[i[4]]*17:255}:(e===7||e===9)&&(t={r:Ui[i[1]]<<4|Ui[i[2]],g:Ui[i[3]]<<4|Ui[i[4]],b:Ui[i[5]]<<4|Ui[i[6]],a:e===9?Ui[i[7]]<<4|Ui[i[8]]:255})),t}const Dp=(i,e)=>i<255?e(i):"";function Ip(i){var e=Rp(i)?Op:kp;return i?"#"+e(i.r)+e(i.g)+e(i.b)+Dp(i.a,e):void 0}const Fp=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Bh(i,e,t){const o=e*Math.min(t,1-t),n=(s,a=(s+i/30)%12)=>t-o*Math.max(Math.min(a-3,9-a,1),-1);return[n(0),n(8),n(4)]}function Np(i,e,t){const o=(n,s=(n+i/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[o(5),o(3),o(1)]}function zp(i,e,t){const o=Bh(i,1,.5);let n;for(e+t>1&&(n=1/(e+t),e*=n,t*=n),n=0;n<3;n++)o[n]*=1-e-t,o[n]+=e;return o}function jp(i,e,t,o,n){return i===n?(e-t)/o+(e<t?6:0):e===n?(t-i)/o+2:(i-e)/o+4}function Mu(i){const t=i.r/255,o=i.g/255,n=i.b/255,s=Math.max(t,o,n),a=Math.min(t,o,n),c=(s+a)/2;let d,l,f;return s!==a&&(f=s-a,l=c>.5?f/(2-s-a):f/(s+a),d=jp(t,o,n,f,s),d=d*60+.5),[d|0,l||0,c]}function Tu(i,e,t,o){return(Array.isArray(e)?i(e[0],e[1],e[2]):i(e,t,o)).map(wo)}function Pu(i,e,t){return Tu(Bh,i,e,t)}function Hp(i,e,t){return Tu(zp,i,e,t)}function Up(i,e,t){return Tu(Np,i,e,t)}function Dh(i){return(i%360+360)%360}function Wp(i){const e=Fp.exec(i);let t=255,o;if(!e)return;e[5]!==o&&(t=e[6]?oa(+e[5]):wo(+e[5]));const n=Dh(+e[2]),s=+e[3]/100,a=+e[4]/100;return e[1]==="hwb"?o=Hp(n,s,a):e[1]==="hsv"?o=Up(n,s,a):o=Pu(n,s,a),{r:o[0],g:o[1],b:o[2],a:t}}function Vp(i,e){var t=Mu(i);t[0]=Dh(t[0]+e),t=Pu(t),i.r=t[0],i.g=t[1],i.b=t[2]}function Zp(i){if(!i)return;const e=Mu(i),t=e[0],o=lc(e[1]),n=lc(e[2]);return i.a<255?`hsla(${t}, ${o}%, ${n}%, ${Xr(i.a)})`:`hsl(${t}, ${o}%, ${n}%)`}const uc={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},cc={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function qp(){const i={},e=Object.keys(cc),t=Object.keys(uc);let o,n,s,a,c;for(o=0;o<e.length;o++){for(a=c=e[o],n=0;n<t.length;n++)s=t[n],c=c.replace(s,uc[s]);s=parseInt(cc[a],16),i[c]=[s>>16&255,s>>8&255,s&255]}return i}let Ua;function Gp(i){Ua||(Ua=qp(),Ua.transparent=[0,0,0,0]);const e=Ua[i.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const Yp=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Kp(i){const e=Yp.exec(i);let t=255,o,n,s;if(e){if(e[7]!==o){const a=+e[7];t=e[8]?oa(a):yo(a*255,0,255)}return o=+e[1],n=+e[3],s=+e[5],o=255&(e[2]?oa(o):yo(o,0,255)),n=255&(e[4]?oa(n):yo(n,0,255)),s=255&(e[6]?oa(s):yo(s,0,255)),{r:o,g:n,b:s,a:t}}}function Xp(i){return i&&(i.a<255?`rgba(${i.r}, ${i.g}, ${i.b}, ${Xr(i.a)})`:`rgb(${i.r}, ${i.g}, ${i.b})`)}const Gl=i=>i<=.0031308?i*12.92:Math.pow(i,1/2.4)*1.055-.055,Ps=i=>i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4);function Qp(i,e,t){const o=Ps(Xr(i.r)),n=Ps(Xr(i.g)),s=Ps(Xr(i.b));return{r:wo(Gl(o+t*(Ps(Xr(e.r))-o))),g:wo(Gl(n+t*(Ps(Xr(e.g))-n))),b:wo(Gl(s+t*(Ps(Xr(e.b))-s))),a:i.a+t*(e.a-i.a)}}function Wa(i,e,t){if(i){let o=Mu(i);o[e]=Math.max(0,Math.min(o[e]+o[e]*t,e===0?360:1)),o=Pu(o),i.r=o[0],i.g=o[1],i.b=o[2]}}function Ih(i,e){return i&&Object.assign(e||{},i)}function hc(i){var e={r:0,g:0,b:0,a:255};return Array.isArray(i)?i.length>=3&&(e={r:i[0],g:i[1],b:i[2],a:255},i.length>3&&(e.a=wo(i[3]))):(e=Ih(i,{r:0,g:0,b:0,a:1}),e.a=wo(e.a)),e}function Jp(i){return i.charAt(0)==="r"?Kp(i):Wp(i)}class va{constructor(e){if(e instanceof va)return e;const t=typeof e;let o;t==="object"?o=hc(e):t==="string"&&(o=Bp(e)||Gp(e)||Jp(e)),this._rgb=o,this._valid=!!o}get valid(){return this._valid}get rgb(){var e=Ih(this._rgb);return e&&(e.a=Xr(e.a)),e}set rgb(e){this._rgb=hc(e)}rgbString(){return this._valid?Xp(this._rgb):void 0}hexString(){return this._valid?Ip(this._rgb):void 0}hslString(){return this._valid?Zp(this._rgb):void 0}mix(e,t){if(e){const o=this.rgb,n=e.rgb;let s;const a=t===s?.5:t,c=2*a-1,d=o.a-n.a,l=((c*d===-1?c:(c+d)/(1+c*d))+1)/2;s=1-l,o.r=255&l*o.r+s*n.r+.5,o.g=255&l*o.g+s*n.g+.5,o.b=255&l*o.b+s*n.b+.5,o.a=a*o.a+(1-a)*n.a,this.rgb=o}return this}interpolate(e,t){return e&&(this._rgb=Qp(this._rgb,e._rgb,t)),this}clone(){return new va(this.rgb)}alpha(e){return this._rgb.a=wo(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Ta(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Wa(this._rgb,2,e),this}darken(e){return Wa(this._rgb,2,-e),this}saturate(e){return Wa(this._rgb,1,e),this}desaturate(e){return Wa(this._rgb,1,-e),this}rotate(e){return Vp(this._rgb,e),this}}/*!
 * Chart.js v4.1.2
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function Gr(){}const $p=(()=>{let i=0;return()=>i++})();function Pt(i){return i===null||typeof i>"u"}function Xt(i){if(Array.isArray&&Array.isArray(i))return!0;const e=Object.prototype.toString.call(i);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function wt(i){return i!==null&&Object.prototype.toString.call(i)==="[object Object]"}function ln(i){return(typeof i=="number"||i instanceof Number)&&isFinite(+i)}function ki(i,e){return ln(i)?i:e}function pt(i,e){return typeof i>"u"?e:i}const eg=(i,e)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100:+i/e,Fh=(i,e)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100*e:+i;function Zt(i,e,t){if(i&&typeof i.call=="function")return i.apply(t,e)}function jt(i,e,t,o){let n,s,a;if(Xt(i))if(s=i.length,o)for(n=s-1;n>=0;n--)e.call(t,i[n],n);else for(n=0;n<s;n++)e.call(t,i[n],n);else if(wt(i))for(a=Object.keys(i),s=a.length,n=0;n<s;n++)e.call(t,i[a[n]],a[n])}function ml(i,e){let t,o,n,s;if(!i||!e||i.length!==e.length)return!1;for(t=0,o=i.length;t<o;++t)if(n=i[t],s=e[t],n.datasetIndex!==s.datasetIndex||n.index!==s.index)return!1;return!0}function _l(i){if(Xt(i))return i.map(_l);if(wt(i)){const e=Object.create(null),t=Object.keys(i),o=t.length;let n=0;for(;n<o;++n)e[t[n]]=_l(i[t[n]]);return e}return i}function Nh(i){return["__proto__","prototype","constructor"].indexOf(i)===-1}function tg(i,e,t,o){if(!Nh(i))return;const n=e[i],s=t[i];wt(n)&&wt(s)?ba(n,s,o):e[i]=_l(s)}function ba(i,e,t){const o=Xt(e)?e:[e],n=o.length;if(!wt(i))return i;t=t||{};const s=t.merger||tg;let a;for(let c=0;c<n;++c){if(a=o[c],!wt(a))continue;const d=Object.keys(a);for(let l=0,f=d.length;l<f;++l)s(d[l],i,a,t)}return i}function fa(i,e){return ba(i,e,{merger:ng})}function ng(i,e,t){if(!Nh(i))return;const o=e[i],n=t[i];wt(o)&&wt(n)?fa(o,n):Object.prototype.hasOwnProperty.call(e,i)||(e[i]=_l(n))}const fc={"":i=>i,x:i=>i.x,y:i=>i.y};function ig(i){const e=i.split("."),t=[];let o="";for(const n of e)o+=n,o.endsWith("\\")?o=o.slice(0,-1)+".":(t.push(o),o="");return t}function rg(i){const e=ig(i);return t=>{for(const o of e){if(o==="")break;t=t&&t[o]}return t}}function Co(i,e){return(fc[e]||(fc[e]=rg(e)))(i)}function Eu(i){return i.charAt(0).toUpperCase()+i.slice(1)}const Wi=i=>typeof i<"u",Lo=i=>typeof i=="function",dc=(i,e)=>{if(i.size!==e.size)return!1;for(const t of i)if(!e.has(t))return!1;return!0};function og(i){return i.type==="mouseup"||i.type==="click"||i.type==="contextmenu"}const Jt=Math.PI,Qt=2*Jt,sg=Qt+Jt,yl=Number.POSITIVE_INFINITY,ag=Jt/180,un=Jt/2,Qo=Jt/4,pc=Jt*2/3,vo=Math.log10,Lr=Math.sign;function da(i,e,t){return Math.abs(i-e)<t}function gc(i){const e=Math.round(i);i=da(i,e,i/1e3)?e:i;const t=Math.pow(10,Math.floor(vo(i))),o=i/t;return(o<=1?1:o<=2?2:o<=5?5:10)*t}function lg(i){const e=[],t=Math.sqrt(i);let o;for(o=1;o<t;o++)i%o===0&&(e.push(o),e.push(i/o));return t===(t|0)&&e.push(t),e.sort((n,s)=>n-s).pop(),e}function Os(i){return!isNaN(parseFloat(i))&&isFinite(i)}function ug(i,e){const t=Math.round(i);return t-e<=i&&t+e>=i}function zh(i,e,t){let o,n,s;for(o=0,n=i.length;o<n;o++)s=i[o][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function ir(i){return i*(Jt/180)}function Au(i){return i*(180/Jt)}function mc(i){if(!ln(i))return;let e=1,t=0;for(;Math.round(i*e)/e!==i;)e*=10,t++;return t}function jh(i,e){const t=e.x-i.x,o=e.y-i.y,n=Math.sqrt(t*t+o*o);let s=Math.atan2(o,t);return s<-.5*Jt&&(s+=Qt),{angle:s,distance:n}}function hu(i,e){return Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2))}function cg(i,e){return(i-e+sg)%Qt-Jt}function Ri(i){return(i%Qt+Qt)%Qt}function xa(i,e,t,o){const n=Ri(i),s=Ri(e),a=Ri(t),c=Ri(s-n),d=Ri(a-n),l=Ri(n-s),f=Ri(n-a);return n===s||n===a||o&&s===a||c>d&&l<f}function In(i,e,t){return Math.max(e,Math.min(t,i))}function hg(i){return In(i,-32768,32767)}function Qr(i,e,t,o=1e-6){return i>=Math.min(e,t)-o&&i<=Math.max(e,t)+o}function Ou(i,e,t){t=t||(a=>i[a]<e);let o=i.length-1,n=0,s;for(;o-n>1;)s=n+o>>1,t(s)?n=s:o=s;return{lo:n,hi:o}}const Jr=(i,e,t,o)=>Ou(i,t,o?n=>{const s=i[n][e];return s<t||s===t&&i[n+1][e]===t}:n=>i[n][e]<t),fg=(i,e,t)=>Ou(i,t,o=>i[o][e]>=t);function dg(i,e,t){let o=0,n=i.length;for(;o<n&&i[o]<e;)o++;for(;n>o&&i[n-1]>t;)n--;return o>0||n<i.length?i.slice(o,n):i}const Hh=["push","pop","shift","splice","unshift"];function pg(i,e){if(i._chartjs){i._chartjs.listeners.push(e);return}Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Hh.forEach(t=>{const o="_onData"+Eu(t),n=i[t];Object.defineProperty(i,t,{configurable:!0,enumerable:!1,value(...s){const a=n.apply(this,s);return i._chartjs.listeners.forEach(c=>{typeof c[o]=="function"&&c[o](...s)}),a}})})}function _c(i,e){const t=i._chartjs;if(!t)return;const o=t.listeners,n=o.indexOf(e);n!==-1&&o.splice(n,1),!(o.length>0)&&(Hh.forEach(s=>{delete i[s]}),delete i._chartjs)}function Uh(i){const e=new Set;let t,o;for(t=0,o=i.length;t<o;++t)e.add(i[t]);return e.size===o?i:Array.from(e)}const Wh=function(){return typeof window>"u"?function(i){return i()}:window.requestAnimationFrame}();function Vh(i,e){let t=[],o=!1;return function(...n){t=n,o||(o=!0,Wh.call(window,()=>{o=!1,i.apply(e,t)}))}}function gg(i,e){let t;return function(...o){return e?(clearTimeout(t),t=setTimeout(i,e,o)):i.apply(this,o),e}}const ku=i=>i==="start"?"left":i==="end"?"right":"center",ni=(i,e,t)=>i==="start"?e:i==="end"?t:(e+t)/2,mg=(i,e,t,o)=>i===(o?"left":"right")?t:i==="center"?(e+t)/2:e;function Zh(i,e,t){const o=e.length;let n=0,s=o;if(i._sorted){const{iScale:a,_parsed:c}=i,d=a.axis,{min:l,max:f,minDefined:p,maxDefined:m}=a.getUserBounds();p&&(n=In(Math.min(Jr(c,a.axis,l).lo,t?o:Jr(e,d,a.getPixelForValue(l)).lo),0,o-1)),m?s=In(Math.max(Jr(c,a.axis,f,!0).hi+1,t?0:Jr(e,d,a.getPixelForValue(f),!0).hi+1),n,o)-n:s=o-n}return{start:n,count:s}}function qh(i){const{xScale:e,yScale:t,_scaleRanges:o}=i,n={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!o)return i._scaleRanges=n,!0;const s=o.xmin!==e.min||o.xmax!==e.max||o.ymin!==t.min||o.ymax!==t.max;return Object.assign(o,n),s}const Va=i=>i===0||i===1,yc=(i,e,t)=>-(Math.pow(2,10*(i-=1))*Math.sin((i-e)*Qt/t)),vc=(i,e,t)=>Math.pow(2,-10*i)*Math.sin((i-e)*Qt/t)+1,pa={linear:i=>i,easeInQuad:i=>i*i,easeOutQuad:i=>-i*(i-2),easeInOutQuad:i=>(i/=.5)<1?.5*i*i:-.5*(--i*(i-2)-1),easeInCubic:i=>i*i*i,easeOutCubic:i=>(i-=1)*i*i+1,easeInOutCubic:i=>(i/=.5)<1?.5*i*i*i:.5*((i-=2)*i*i+2),easeInQuart:i=>i*i*i*i,easeOutQuart:i=>-((i-=1)*i*i*i-1),easeInOutQuart:i=>(i/=.5)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2),easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>(i-=1)*i*i*i*i+1,easeInOutQuint:i=>(i/=.5)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2),easeInSine:i=>-Math.cos(i*un)+1,easeOutSine:i=>Math.sin(i*un),easeInOutSine:i=>-.5*(Math.cos(Jt*i)-1),easeInExpo:i=>i===0?0:Math.pow(2,10*(i-1)),easeOutExpo:i=>i===1?1:-Math.pow(2,-10*i)+1,easeInOutExpo:i=>Va(i)?i:i<.5?.5*Math.pow(2,10*(i*2-1)):.5*(-Math.pow(2,-10*(i*2-1))+2),easeInCirc:i=>i>=1?i:-(Math.sqrt(1-i*i)-1),easeOutCirc:i=>Math.sqrt(1-(i-=1)*i),easeInOutCirc:i=>(i/=.5)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1),easeInElastic:i=>Va(i)?i:yc(i,.075,.3),easeOutElastic:i=>Va(i)?i:vc(i,.075,.3),easeInOutElastic(i){return Va(i)?i:i<.5?.5*yc(i*2,.1125,.45):.5+.5*vc(i*2-1,.1125,.45)},easeInBack(i){return i*i*((1.70158+1)*i-1.70158)},easeOutBack(i){return(i-=1)*i*((1.70158+1)*i+1.70158)+1},easeInOutBack(i){let e=1.70158;return(i/=.5)<1?.5*(i*i*(((e*=1.525)+1)*i-e)):.5*((i-=2)*i*(((e*=1.525)+1)*i+e)+2)},easeInBounce:i=>1-pa.easeOutBounce(1-i),easeOutBounce(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},easeInOutBounce:i=>i<.5?pa.easeInBounce(i*2)*.5:pa.easeOutBounce(i*2-1)*.5+.5};function Gh(i){if(i&&typeof i=="object"){const e=i.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function bc(i){return Gh(i)?i:new va(i)}function Yl(i){return Gh(i)?i:new va(i).saturate(.5).darken(.1).hexString()}const _g=["x","y","borderWidth","radius","tension"],yg=["color","borderColor","backgroundColor"];function vg(i){i.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),i.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),i.set("animations",{colors:{type:"color",properties:yg},numbers:{type:"number",properties:_g}}),i.describe("animations",{_fallback:"animation"}),i.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function bg(i){i.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const xc=new Map;function xg(i,e){e=e||{};const t=i+JSON.stringify(e);let o=xc.get(t);return o||(o=new Intl.NumberFormat(i,e),xc.set(t,o)),o}function Pa(i,e,t){return xg(e,t).format(i)}const Yh={values(i){return Xt(i)?i:""+i},numeric(i,e,t){if(i===0)return"0";const o=this.chart.options.locale;let n,s=i;if(t.length>1){const l=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(l<1e-4||l>1e15)&&(n="scientific"),s=wg(i,t)}const a=vo(Math.abs(s)),c=Math.max(Math.min(-1*Math.floor(a),20),0),d={notation:n,minimumFractionDigits:c,maximumFractionDigits:c};return Object.assign(d,this.options.ticks.format),Pa(i,o,d)},logarithmic(i,e,t){if(i===0)return"0";const o=t[e].significand||i/Math.pow(10,Math.floor(vo(i)));return[1,2,3,5,10,15].includes(o)||e>.8*t.length?Yh.numeric.call(this,i,e,t):""}};function wg(i,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&i!==Math.floor(i)&&(t=i-Math.floor(i)),t}var Pl={formatters:Yh};function Cg(i){i.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Pl.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),i.route("scale.ticks","color","","color"),i.route("scale.grid","color","","borderColor"),i.route("scale.border","color","","borderColor"),i.route("scale.title","color","","color"),i.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),i.describe("scales",{_fallback:"scale"}),i.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const ls=Object.create(null),fu=Object.create(null);function ga(i,e){if(!e)return i;const t=e.split(".");for(let o=0,n=t.length;o<n;++o){const s=t[o];i=i[s]||(i[s]=Object.create(null))}return i}function Kl(i,e,t){return typeof e=="string"?ba(ga(i,e),t):ba(ga(i,""),e)}class Lg{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=o=>o.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(o,n)=>Yl(n.backgroundColor),this.hoverBorderColor=(o,n)=>Yl(n.borderColor),this.hoverColor=(o,n)=>Yl(n.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Kl(this,e,t)}get(e){return ga(this,e)}describe(e,t){return Kl(fu,e,t)}override(e,t){return Kl(ls,e,t)}route(e,t,o,n){const s=ga(this,e),a=ga(this,o),c="_"+t;Object.defineProperties(s,{[c]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const d=this[c],l=a[n];return wt(d)?Object.assign({},l,d):pt(d,l)},set(d){this[c]=d}}})}apply(e){e.forEach(t=>t(this))}}var hn=new Lg({_scriptable:i=>!i.startsWith("on"),_indexable:i=>i!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[vg,bg,Cg]);function Sg(i){return!i||Pt(i.size)||Pt(i.family)?null:(i.style?i.style+" ":"")+(i.weight?i.weight+" ":"")+i.size+"px "+i.family}function vl(i,e,t,o,n){let s=e[n];return s||(s=e[n]=i.measureText(n).width,t.push(n)),s>o&&(o=s),o}function Mg(i,e,t,o){o=o||{};let n=o.data=o.data||{},s=o.garbageCollect=o.garbageCollect||[];o.font!==e&&(n=o.data={},s=o.garbageCollect=[],o.font=e),i.save(),i.font=e;let a=0;const c=t.length;let d,l,f,p,m;for(d=0;d<c;d++)if(p=t[d],p!=null&&Xt(p)!==!0)a=vl(i,n,s,a,p);else if(Xt(p))for(l=0,f=p.length;l<f;l++)m=p[l],m!=null&&!Xt(m)&&(a=vl(i,n,s,a,m));i.restore();const _=s.length/2;if(_>t.length){for(d=0;d<_;d++)delete n[s[d]];s.splice(0,_)}return a}function Jo(i,e,t){const o=i.currentDevicePixelRatio,n=t!==0?Math.max(t/2,.5):0;return Math.round((e-n)*o)/o+n}function wc(i,e){e=e||i.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,i.width,i.height),e.restore()}function du(i,e,t,o){Kh(i,e,t,o,null)}function Kh(i,e,t,o,n){let s,a,c,d,l,f,p,m;const _=e.pointStyle,b=e.rotation,x=e.radius;let A=(b||0)*ag;if(_&&typeof _=="object"&&(s=_.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){i.save(),i.translate(t,o),i.rotate(A),i.drawImage(_,-_.width/2,-_.height/2,_.width,_.height),i.restore();return}if(!(isNaN(x)||x<=0)){switch(i.beginPath(),_){default:n?i.ellipse(t,o,n/2,x,0,0,Qt):i.arc(t,o,x,0,Qt),i.closePath();break;case"triangle":f=n?n/2:x,i.moveTo(t+Math.sin(A)*f,o-Math.cos(A)*x),A+=pc,i.lineTo(t+Math.sin(A)*f,o-Math.cos(A)*x),A+=pc,i.lineTo(t+Math.sin(A)*f,o-Math.cos(A)*x),i.closePath();break;case"rectRounded":l=x*.516,d=x-l,a=Math.cos(A+Qo)*d,p=Math.cos(A+Qo)*(n?n/2-l:d),c=Math.sin(A+Qo)*d,m=Math.sin(A+Qo)*(n?n/2-l:d),i.arc(t-p,o-c,l,A-Jt,A-un),i.arc(t+m,o-a,l,A-un,A),i.arc(t+p,o+c,l,A,A+un),i.arc(t-m,o+a,l,A+un,A+Jt),i.closePath();break;case"rect":if(!b){d=Math.SQRT1_2*x,f=n?n/2:d,i.rect(t-f,o-d,2*f,2*d);break}A+=Qo;case"rectRot":p=Math.cos(A)*(n?n/2:x),a=Math.cos(A)*x,c=Math.sin(A)*x,m=Math.sin(A)*(n?n/2:x),i.moveTo(t-p,o-c),i.lineTo(t+m,o-a),i.lineTo(t+p,o+c),i.lineTo(t-m,o+a),i.closePath();break;case"crossRot":A+=Qo;case"cross":p=Math.cos(A)*(n?n/2:x),a=Math.cos(A)*x,c=Math.sin(A)*x,m=Math.sin(A)*(n?n/2:x),i.moveTo(t-p,o-c),i.lineTo(t+p,o+c),i.moveTo(t+m,o-a),i.lineTo(t-m,o+a);break;case"star":p=Math.cos(A)*(n?n/2:x),a=Math.cos(A)*x,c=Math.sin(A)*x,m=Math.sin(A)*(n?n/2:x),i.moveTo(t-p,o-c),i.lineTo(t+p,o+c),i.moveTo(t+m,o-a),i.lineTo(t-m,o+a),A+=Qo,p=Math.cos(A)*(n?n/2:x),a=Math.cos(A)*x,c=Math.sin(A)*x,m=Math.sin(A)*(n?n/2:x),i.moveTo(t-p,o-c),i.lineTo(t+p,o+c),i.moveTo(t+m,o-a),i.lineTo(t-m,o+a);break;case"line":a=n?n/2:Math.cos(A)*x,c=Math.sin(A)*x,i.moveTo(t-a,o-c),i.lineTo(t+a,o+c);break;case"dash":i.moveTo(t,o),i.lineTo(t+Math.cos(A)*(n?n/2:x),o+Math.sin(A)*x);break;case!1:i.closePath();break}i.fill(),e.borderWidth>0&&i.stroke()}}function wa(i,e,t){return t=t||.5,!e||i&&i.x>e.left-t&&i.x<e.right+t&&i.y>e.top-t&&i.y<e.bottom+t}function El(i,e){i.save(),i.beginPath(),i.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),i.clip()}function Al(i){i.restore()}function Tg(i,e,t,o,n){if(!e)return i.lineTo(t.x,t.y);if(n==="middle"){const s=(e.x+t.x)/2;i.lineTo(s,e.y),i.lineTo(s,t.y)}else n==="after"!=!!o?i.lineTo(e.x,t.y):i.lineTo(t.x,e.y);i.lineTo(t.x,t.y)}function Pg(i,e,t,o){if(!e)return i.lineTo(t.x,t.y);i.bezierCurveTo(o?e.cp1x:e.cp2x,o?e.cp1y:e.cp2y,o?t.cp2x:t.cp1x,o?t.cp2y:t.cp1y,t.x,t.y)}function us(i,e,t,o,n,s={}){const a=Xt(e)?e:[e],c=s.strokeWidth>0&&s.strokeColor!=="";let d,l;for(i.save(),i.font=n.string,Eg(i,s),d=0;d<a.length;++d)l=a[d],s.backdrop&&Og(i,s.backdrop),c&&(s.strokeColor&&(i.strokeStyle=s.strokeColor),Pt(s.strokeWidth)||(i.lineWidth=s.strokeWidth),i.strokeText(l,t,o,s.maxWidth)),i.fillText(l,t,o,s.maxWidth),Ag(i,t,o,l,s),o+=n.lineHeight;i.restore()}function Eg(i,e){e.translation&&i.translate(e.translation[0],e.translation[1]),Pt(e.rotation)||i.rotate(e.rotation),e.color&&(i.fillStyle=e.color),e.textAlign&&(i.textAlign=e.textAlign),e.textBaseline&&(i.textBaseline=e.textBaseline)}function Ag(i,e,t,o,n){if(n.strikethrough||n.underline){const s=i.measureText(o),a=e-s.actualBoundingBoxLeft,c=e+s.actualBoundingBoxRight,d=t-s.actualBoundingBoxAscent,l=t+s.actualBoundingBoxDescent,f=n.strikethrough?(d+l)/2:l;i.strokeStyle=i.fillStyle,i.beginPath(),i.lineWidth=n.decorationWidth||2,i.moveTo(a,f),i.lineTo(c,f),i.stroke()}}function Og(i,e){const t=i.fillStyle;i.fillStyle=e.color,i.fillRect(e.left,e.top,e.width,e.height),i.fillStyle=t}function Ca(i,e){const{x:t,y:o,w:n,h:s,radius:a}=e;i.arc(t+a.topLeft,o+a.topLeft,a.topLeft,-un,Jt,!0),i.lineTo(t,o+s-a.bottomLeft),i.arc(t+a.bottomLeft,o+s-a.bottomLeft,a.bottomLeft,Jt,un,!0),i.lineTo(t+n-a.bottomRight,o+s),i.arc(t+n-a.bottomRight,o+s-a.bottomRight,a.bottomRight,un,0,!0),i.lineTo(t+n,o+a.topRight),i.arc(t+n-a.topRight,o+a.topRight,a.topRight,0,-un,!0),i.lineTo(t+a.topLeft,o)}const kg=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Rg=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Bg(i,e){const t=(""+i).match(kg);if(!t||t[1]==="normal")return e*1.2;switch(i=+t[2],t[3]){case"px":return i;case"%":i/=100;break}return e*i}const Dg=i=>+i||0;function Ru(i,e){const t={},o=wt(e),n=o?Object.keys(e):e,s=wt(i)?o?a=>pt(i[a],i[e[a]]):a=>i[a]:()=>i;for(const a of n)t[a]=Dg(s(a));return t}function Xh(i){return Ru(i,{top:"y",right:"x",bottom:"y",left:"x"})}function ss(i){return Ru(i,["topLeft","topRight","bottomLeft","bottomRight"])}function si(i){const e=Xh(i);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Mn(i,e){i=i||{},e=e||hn.font;let t=pt(i.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let o=pt(i.style,e.style);o&&!(""+o).match(Rg)&&(console.warn('Invalid font style specified: "'+o+'"'),o=void 0);const n={family:pt(i.family,e.family),lineHeight:Bg(pt(i.lineHeight,e.lineHeight),t),size:t,style:o,weight:pt(i.weight,e.weight),string:""};return n.string=Sg(n),n}function sa(i,e,t,o){let n=!0,s,a,c;for(s=0,a=i.length;s<a;++s)if(c=i[s],c!==void 0&&(e!==void 0&&typeof c=="function"&&(c=c(e),n=!1),t!==void 0&&Xt(c)&&(c=c[t%c.length],n=!1),c!==void 0))return o&&!n&&(o.cacheable=!1),c}function Ig(i,e,t){const{min:o,max:n}=i,s=Fh(e,(n-o)/2),a=(c,d)=>t&&c===0?0:c+d;return{min:a(o,-Math.abs(s)),max:a(n,s)}}function So(i,e){return Object.assign(Object.create(i),e)}function Bu(i,e=[""],t=i,o,n=()=>i[0]){Wi(o)||(o=ef("_fallback",i));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:i,_rootScopes:t,_fallback:o,_getTarget:n,override:a=>Bu([a,...i],e,t,o)};return new Proxy(s,{deleteProperty(a,c){return delete a[c],delete a._keys,delete i[0][c],!0},get(a,c){return Jh(a,c,()=>Vg(c,e,i,a))},getOwnPropertyDescriptor(a,c){return Reflect.getOwnPropertyDescriptor(a._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(i[0])},has(a,c){return Lc(a).includes(c)},ownKeys(a){return Lc(a)},set(a,c,d){const l=a._storage||(a._storage=n());return a[c]=l[c]=d,delete a._keys,!0}})}function ks(i,e,t,o){const n={_cacheable:!1,_proxy:i,_context:e,_subProxy:t,_stack:new Set,_descriptors:Qh(i,o),setContext:s=>ks(i,s,t,o),override:s=>ks(i.override(s),e,t,o)};return new Proxy(n,{deleteProperty(s,a){return delete s[a],delete i[a],!0},get(s,a,c){return Jh(s,a,()=>Ng(s,a,c))},getOwnPropertyDescriptor(s,a){return s._descriptors.allKeys?Reflect.has(i,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(i,a)},getPrototypeOf(){return Reflect.getPrototypeOf(i)},has(s,a){return Reflect.has(i,a)},ownKeys(){return Reflect.ownKeys(i)},set(s,a,c){return i[a]=c,delete s[a],!0}})}function Qh(i,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:o=e.indexable,_allKeys:n=e.allKeys}=i;return{allKeys:n,scriptable:t,indexable:o,isScriptable:Lo(t)?t:()=>t,isIndexable:Lo(o)?o:()=>o}}const Fg=(i,e)=>i?i+Eu(e):e,Du=(i,e)=>wt(e)&&i!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function Jh(i,e,t){if(Object.prototype.hasOwnProperty.call(i,e))return i[e];const o=t();return i[e]=o,o}function Ng(i,e,t){const{_proxy:o,_context:n,_subProxy:s,_descriptors:a}=i;let c=o[e];return Lo(c)&&a.isScriptable(e)&&(c=zg(e,c,i,t)),Xt(c)&&c.length&&(c=jg(e,c,i,a.isIndexable)),Du(e,c)&&(c=ks(c,n,s&&s[e],a)),c}function zg(i,e,t,o){const{_proxy:n,_context:s,_subProxy:a,_stack:c}=t;if(c.has(i))throw new Error("Recursion detected: "+Array.from(c).join("->")+"->"+i);return c.add(i),e=e(s,a||o),c.delete(i),Du(i,e)&&(e=Iu(n._scopes,n,i,e)),e}function jg(i,e,t,o){const{_proxy:n,_context:s,_subProxy:a,_descriptors:c}=t;if(Wi(s.index)&&o(i))e=e[s.index%e.length];else if(wt(e[0])){const d=e,l=n._scopes.filter(f=>f!==d);e=[];for(const f of d){const p=Iu(l,n,i,f);e.push(ks(p,s,a&&a[i],c))}}return e}function $h(i,e,t){return Lo(i)?i(e,t):i}const Hg=(i,e)=>i===!0?e:typeof i=="string"?Co(e,i):void 0;function Ug(i,e,t,o,n){for(const s of e){const a=Hg(t,s);if(a){i.add(a);const c=$h(a._fallback,t,n);if(Wi(c)&&c!==t&&c!==o)return c}else if(a===!1&&Wi(o)&&t!==o)return null}return!1}function Iu(i,e,t,o){const n=e._rootScopes,s=$h(e._fallback,t,o),a=[...i,...n],c=new Set;c.add(o);let d=Cc(c,a,t,s||t,o);return d===null||Wi(s)&&s!==t&&(d=Cc(c,a,s,d,o),d===null)?!1:Bu(Array.from(c),[""],n,s,()=>Wg(e,t,o))}function Cc(i,e,t,o,n){for(;t;)t=Ug(i,e,t,o,n);return t}function Wg(i,e,t){const o=i._getTarget();e in o||(o[e]={});const n=o[e];return Xt(n)&&wt(t)?t:n||{}}function Vg(i,e,t,o){let n;for(const s of e)if(n=ef(Fg(s,i),t),Wi(n))return Du(i,n)?Iu(t,o,i,n):n}function ef(i,e){for(const t of e){if(!t)continue;const o=t[i];if(Wi(o))return o}}function Lc(i){let e=i._keys;return e||(e=i._keys=Zg(i._scopes)),e}function Zg(i){const e=new Set;for(const t of i)for(const o of Object.keys(t).filter(n=>!n.startsWith("_")))e.add(o);return Array.from(e)}function tf(i,e,t,o){const{iScale:n}=i,{key:s="r"}=this._parsing,a=new Array(o);let c,d,l,f;for(c=0,d=o;c<d;++c)l=c+t,f=e[l],a[c]={r:n.parse(Co(f,s),l)};return a}const qg=Number.EPSILON||1e-14,Rs=(i,e)=>e<i.length&&!i[e].skip&&i[e],nf=i=>i==="x"?"y":"x";function Gg(i,e,t,o){const n=i.skip?e:i,s=e,a=t.skip?e:t,c=hu(s,n),d=hu(a,s);let l=c/(c+d),f=d/(c+d);l=isNaN(l)?0:l,f=isNaN(f)?0:f;const p=o*l,m=o*f;return{previous:{x:s.x-p*(a.x-n.x),y:s.y-p*(a.y-n.y)},next:{x:s.x+m*(a.x-n.x),y:s.y+m*(a.y-n.y)}}}function Yg(i,e,t){const o=i.length;let n,s,a,c,d,l=Rs(i,0);for(let f=0;f<o-1;++f)if(d=l,l=Rs(i,f+1),!(!d||!l)){if(da(e[f],0,qg)){t[f]=t[f+1]=0;continue}n=t[f]/e[f],s=t[f+1]/e[f],c=Math.pow(n,2)+Math.pow(s,2),!(c<=9)&&(a=3/Math.sqrt(c),t[f]=n*a*e[f],t[f+1]=s*a*e[f])}}function Kg(i,e,t="x"){const o=nf(t),n=i.length;let s,a,c,d=Rs(i,0);for(let l=0;l<n;++l){if(a=c,c=d,d=Rs(i,l+1),!c)continue;const f=c[t],p=c[o];a&&(s=(f-a[t])/3,c[`cp1${t}`]=f-s,c[`cp1${o}`]=p-s*e[l]),d&&(s=(d[t]-f)/3,c[`cp2${t}`]=f+s,c[`cp2${o}`]=p+s*e[l])}}function Xg(i,e="x"){const t=nf(e),o=i.length,n=Array(o).fill(0),s=Array(o);let a,c,d,l=Rs(i,0);for(a=0;a<o;++a)if(c=d,d=l,l=Rs(i,a+1),!!d){if(l){const f=l[e]-d[e];n[a]=f!==0?(l[t]-d[t])/f:0}s[a]=c?l?Lr(n[a-1])!==Lr(n[a])?0:(n[a-1]+n[a])/2:n[a-1]:n[a]}Yg(i,n,s),Kg(i,s,e)}function Za(i,e,t){return Math.max(Math.min(i,t),e)}function Qg(i,e){let t,o,n,s,a,c=wa(i[0],e);for(t=0,o=i.length;t<o;++t)a=s,s=c,c=t<o-1&&wa(i[t+1],e),s&&(n=i[t],a&&(n.cp1x=Za(n.cp1x,e.left,e.right),n.cp1y=Za(n.cp1y,e.top,e.bottom)),c&&(n.cp2x=Za(n.cp2x,e.left,e.right),n.cp2y=Za(n.cp2y,e.top,e.bottom)))}function Jg(i,e,t,o,n){let s,a,c,d;if(e.spanGaps&&(i=i.filter(l=>!l.skip)),e.cubicInterpolationMode==="monotone")Xg(i,n);else{let l=o?i[i.length-1]:i[0];for(s=0,a=i.length;s<a;++s)c=i[s],d=Gg(l,c,i[Math.min(s+1,a-(o?0:1))%a],e.tension),c.cp1x=d.previous.x,c.cp1y=d.previous.y,c.cp2x=d.next.x,c.cp2y=d.next.y,l=c}e.capBezierPoints&&Qg(i,t)}function rf(){return typeof window<"u"&&typeof document<"u"}function Fu(i){let e=i.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function bl(i,e,t){let o;return typeof i=="string"?(o=parseInt(i,10),i.indexOf("%")!==-1&&(o=o/100*e.parentNode[t])):o=i,o}const Ol=i=>i.ownerDocument.defaultView.getComputedStyle(i,null);function $g(i,e){return Ol(i).getPropertyValue(e)}const em=["top","right","bottom","left"];function as(i,e,t){const o={};t=t?"-"+t:"";for(let n=0;n<4;n++){const s=em[n];o[s]=parseFloat(i[e+"-"+s+t])||0}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}const tm=(i,e,t)=>(i>0||e>0)&&(!t||!t.shadowRoot);function nm(i,e){const t=i.touches,o=t&&t.length?t[0]:i,{offsetX:n,offsetY:s}=o;let a=!1,c,d;if(tm(n,s,i.target))c=n,d=s;else{const l=e.getBoundingClientRect();c=o.clientX-l.left,d=o.clientY-l.top,a=!0}return{x:c,y:d,box:a}}function ts(i,e){if("native"in i)return i;const{canvas:t,currentDevicePixelRatio:o}=e,n=Ol(t),s=n.boxSizing==="border-box",a=as(n,"padding"),c=as(n,"border","width"),{x:d,y:l,box:f}=nm(i,t),p=a.left+(f&&c.left),m=a.top+(f&&c.top);let{width:_,height:b}=e;return s&&(_-=a.width+c.width,b-=a.height+c.height),{x:Math.round((d-p)/_*t.width/o),y:Math.round((l-m)/b*t.height/o)}}function im(i,e,t){let o,n;if(e===void 0||t===void 0){const s=Fu(i);if(!s)e=i.clientWidth,t=i.clientHeight;else{const a=s.getBoundingClientRect(),c=Ol(s),d=as(c,"border","width"),l=as(c,"padding");e=a.width-l.width-d.width,t=a.height-l.height-d.height,o=bl(c.maxWidth,s,"clientWidth"),n=bl(c.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:o||yl,maxHeight:n||yl}}const qa=i=>Math.round(i*10)/10;function rm(i,e,t,o){const n=Ol(i),s=as(n,"margin"),a=bl(n.maxWidth,i,"clientWidth")||yl,c=bl(n.maxHeight,i,"clientHeight")||yl,d=im(i,e,t);let{width:l,height:f}=d;if(n.boxSizing==="content-box"){const m=as(n,"border","width"),_=as(n,"padding");l-=_.width+m.width,f-=_.height+m.height}return l=Math.max(0,l-s.width),f=Math.max(0,o?l/o:f-s.height),l=qa(Math.min(l,a,d.maxWidth)),f=qa(Math.min(f,c,d.maxHeight)),l&&!f&&(f=qa(l/2)),(e!==void 0||t!==void 0)&&o&&d.height&&f>d.height&&(f=d.height,l=qa(Math.floor(f*o))),{width:l,height:f}}function Sc(i,e,t){const o=e||1,n=Math.floor(i.height*o),s=Math.floor(i.width*o);i.height=Math.floor(i.height),i.width=Math.floor(i.width);const a=i.canvas;return a.style&&(t||!a.style.height&&!a.style.width)&&(a.style.height=`${i.height}px`,a.style.width=`${i.width}px`),i.currentDevicePixelRatio!==o||a.height!==n||a.width!==s?(i.currentDevicePixelRatio=o,a.height=n,a.width=s,i.ctx.setTransform(o,0,0,o,0,0),!0):!1}const om=function(){let i=!1;try{const e={get passive(){return i=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return i}();function Mc(i,e){const t=$g(i,e),o=t&&t.match(/^(\d+)(\.\d+)?px$/);return o?+o[1]:void 0}function ns(i,e,t,o){return{x:i.x+t*(e.x-i.x),y:i.y+t*(e.y-i.y)}}function sm(i,e,t,o){return{x:i.x+t*(e.x-i.x),y:o==="middle"?t<.5?i.y:e.y:o==="after"?t<1?i.y:e.y:t>0?e.y:i.y}}function am(i,e,t,o){const n={x:i.cp2x,y:i.cp2y},s={x:e.cp1x,y:e.cp1y},a=ns(i,n,t),c=ns(n,s,t),d=ns(s,e,t),l=ns(a,c,t),f=ns(c,d,t);return ns(l,f,t)}const lm=function(i,e){return{x(t){return i+i+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,o){return t-o},leftForLtr(t,o){return t-o}}},um=function(){return{x(i){return i},setWidth(i){},textAlign(i){return i},xPlus(i,e){return i+e},leftForLtr(i,e){return i}}};function As(i,e,t){return i?lm(e,t):um()}function of(i,e){let t,o;(e==="ltr"||e==="rtl")&&(t=i.canvas.style,o=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),i.prevTextDirection=o)}function sf(i,e){e!==void 0&&(delete i.prevTextDirection,i.canvas.style.setProperty("direction",e[0],e[1]))}function af(i){return i==="angle"?{between:xa,compare:cg,normalize:Ri}:{between:Qr,compare:(e,t)=>e-t,normalize:e=>e}}function Tc({start:i,end:e,count:t,loop:o,style:n}){return{start:i%t,end:e%t,loop:o&&(e-i+1)%t===0,style:n}}function cm(i,e,t){const{property:o,start:n,end:s}=t,{between:a,normalize:c}=af(o),d=e.length;let{start:l,end:f,loop:p}=i,m,_;if(p){for(l+=d,f+=d,m=0,_=d;m<_&&a(c(e[l%d][o]),n,s);++m)l--,f--;l%=d,f%=d}return f<l&&(f+=d),{start:l,end:f,loop:p,style:i.style}}function lf(i,e,t){if(!t)return[i];const{property:o,start:n,end:s}=t,a=e.length,{compare:c,between:d,normalize:l}=af(o),{start:f,end:p,loop:m,style:_}=cm(i,e,t),b=[];let x=!1,A=null,S,E,F;const v=()=>d(n,F,S)&&c(n,F)!==0,P=()=>c(s,S)===0||d(s,F,S),G=()=>x||v(),$=()=>!x||P();for(let Z=f,ie=f;Z<=p;++Z)E=e[Z%a],!E.skip&&(S=l(E[o]),S!==F&&(x=d(S,n,s),A===null&&G()&&(A=c(S,n)===0?Z:ie),A!==null&&$()&&(b.push(Tc({start:A,end:Z,loop:m,count:a,style:_})),A=null),ie=Z,F=S));return A!==null&&b.push(Tc({start:A,end:p,loop:m,count:a,style:_})),b}function uf(i,e){const t=[],o=i.segments;for(let n=0;n<o.length;n++){const s=lf(o[n],i.points,e);s.length&&t.push(...s)}return t}function hm(i,e,t,o){let n=0,s=e-1;if(t&&!o)for(;n<e&&!i[n].skip;)n++;for(;n<e&&i[n].skip;)n++;for(n%=e,t&&(s+=n);s>n&&i[s%e].skip;)s--;return s%=e,{start:n,end:s}}function fm(i,e,t,o){const n=i.length,s=[];let a=e,c=i[e],d;for(d=e+1;d<=t;++d){const l=i[d%n];l.skip||l.stop?c.skip||(o=!1,s.push({start:e%n,end:(d-1)%n,loop:o}),e=a=l.stop?d:null):(a=d,c.skip&&(e=d)),c=l}return a!==null&&s.push({start:e%n,end:a%n,loop:o}),s}function dm(i,e){const t=i.points,o=i.options.spanGaps,n=t.length;if(!n)return[];const s=!!i._loop,{start:a,end:c}=hm(t,n,s,o);if(o===!0)return Pc(i,[{start:a,end:c,loop:s}],t,e);const d=c<a?c+n:c,l=!!i._fullLoop&&a===0&&c===n-1;return Pc(i,fm(t,a,d,l),t,e)}function Pc(i,e,t,o){return!o||!o.setContext||!t?e:pm(i,e,t,o)}function pm(i,e,t,o){const n=i._chart.getContext(),s=Ec(i.options),{_datasetIndex:a,options:{spanGaps:c}}=i,d=t.length,l=[];let f=s,p=e[0].start,m=p;function _(b,x,A,S){const E=c?-1:1;if(b!==x){for(b+=d;t[b%d].skip;)b-=E;for(;t[x%d].skip;)x+=E;b%d!==x%d&&(l.push({start:b%d,end:x%d,loop:A,style:S}),f=S,p=x%d)}}for(const b of e){p=c?p:b.start;let x=t[p%d],A;for(m=p+1;m<=b.end;m++){const S=t[m%d];A=Ec(o.setContext(So(n,{type:"segment",p0:x,p1:S,p0DataIndex:(m-1)%d,p1DataIndex:m%d,datasetIndex:a}))),gm(A,f)&&_(p,m-1,b.loop,f),x=S,f=A}p<m-1&&_(p,m-1,b.loop,f)}return l}function Ec(i){return{backgroundColor:i.backgroundColor,borderCapStyle:i.borderCapStyle,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderJoinStyle:i.borderJoinStyle,borderWidth:i.borderWidth,borderColor:i.borderColor}}function gm(i,e){return e&&JSON.stringify(i)!==JSON.stringify(e)}/*!
 * Chart.js v4.1.2
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class mm{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,o,n){const s=t.listeners[n],a=t.duration;s.forEach(c=>c({chart:e,initial:t.initial,numSteps:a,currentStep:Math.min(o-t.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=Wh.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((o,n)=>{if(!o.running||!o.items.length)return;const s=o.items;let a=s.length-1,c=!1,d;for(;a>=0;--a)d=s[a],d._active?(d._total>o.duration&&(o.duration=d._total),d.tick(e),c=!0):(s[a]=s[s.length-1],s.pop());c&&(n.draw(),this._notify(n,o,e,"progress")),s.length||(o.running=!1,this._notify(n,o,e,"complete"),o.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let o=t.get(e);return o||(o={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,o)),o}listen(e,t,o){this._getAnims(e).listeners[t].push(o)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((o,n)=>Math.max(o,n._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const o=t.items;let n=o.length-1;for(;n>=0;--n)o[n].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Yr=new mm;const Ac="transparent",_m={boolean(i,e,t){return t>.5?e:i},color(i,e,t){const o=bc(i||Ac),n=o.valid&&bc(e||Ac);return n&&n.valid?n.mix(o,t).hexString():e},number(i,e,t){return i+(e-i)*t}};class ym{constructor(e,t,o,n){const s=t[o];n=sa([e.to,n,s,e.from]);const a=sa([e.from,s,n]);this._active=!0,this._fn=e.fn||_m[e.type||typeof a],this._easing=pa[e.easing]||pa.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=o,this._from=a,this._to=n,this._promises=void 0}active(){return this._active}update(e,t,o){if(this._active){this._notify(!1);const n=this._target[this._prop],s=o-this._start,a=this._duration-s;this._start=o,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=sa([e.to,t,n,e.from]),this._from=sa([e.from,n,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,o=this._duration,n=this._prop,s=this._from,a=this._loop,c=this._to;let d;if(this._active=s!==c&&(a||t<o),!this._active){this._target[n]=c,this._notify(!0);return}if(t<0){this._target[n]=s;return}d=t/o%2,d=a&&d>1?2-d:d,d=this._easing(Math.min(1,Math.max(0,d))),this._target[n]=this._fn(s,c,d)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,o)=>{e.push({res:t,rej:o})})}_notify(e){const t=e?"res":"rej",o=this._promises||[];for(let n=0;n<o.length;n++)o[n][t]()}}class cf{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!wt(e))return;const t=Object.keys(hn.animation),o=this._properties;Object.getOwnPropertyNames(e).forEach(n=>{const s=e[n];if(!wt(s))return;const a={};for(const c of t)a[c]=s[c];(Xt(s.properties)&&s.properties||[n]).forEach(c=>{(c===n||!o.has(c))&&o.set(c,a)})})}_animateOptions(e,t){const o=t.options,n=bm(e,o);if(!n)return[];const s=this._createAnimations(n,o);return o.$shared&&vm(e.options.$animations,o).then(()=>{e.options=o},()=>{}),s}_createAnimations(e,t){const o=this._properties,n=[],s=e.$animations||(e.$animations={}),a=Object.keys(t),c=Date.now();let d;for(d=a.length-1;d>=0;--d){const l=a[d];if(l.charAt(0)==="$")continue;if(l==="options"){n.push(...this._animateOptions(e,t));continue}const f=t[l];let p=s[l];const m=o.get(l);if(p)if(m&&p.active()){p.update(m,f,c);continue}else p.cancel();if(!m||!m.duration){e[l]=f;continue}s[l]=p=new ym(m,e,l,f),n.push(p)}return n}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const o=this._createAnimations(e,t);if(o.length)return Yr.add(this._chart,o),!0}}function vm(i,e){const t=[],o=Object.keys(e);for(let n=0;n<o.length;n++){const s=i[o[n]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function bm(i,e){if(!e)return;let t=i.options;if(!t){i.options=e;return}return t.$shared&&(i.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function Oc(i,e){const t=i&&i.options||{},o=t.reverse,n=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:o?s:n,end:o?n:s}}function xm(i,e,t){if(t===!1)return!1;const o=Oc(i,t),n=Oc(e,t);return{top:n.end,right:o.end,bottom:n.start,left:o.start}}function wm(i){let e,t,o,n;return wt(i)?(e=i.top,t=i.right,o=i.bottom,n=i.left):e=t=o=n=i,{top:e,right:t,bottom:o,left:n,disabled:i===!1}}function hf(i,e){const t=[],o=i._getSortedDatasetMetas(e);let n,s;for(n=0,s=o.length;n<s;++n)t.push(o[n].index);return t}function kc(i,e,t,o={}){const n=i.keys,s=o.mode==="single";let a,c,d,l;if(e!==null){for(a=0,c=n.length;a<c;++a){if(d=+n[a],d===t){if(o.all)continue;break}l=i.values[d],ln(l)&&(s||e===0||Lr(e)===Lr(l))&&(e+=l)}return e}}function Cm(i){const e=Object.keys(i),t=new Array(e.length);let o,n,s;for(o=0,n=e.length;o<n;++o)s=e[o],t[o]={x:s,y:i[s]};return t}function Rc(i,e){const t=i&&i.options.stacked;return t||t===void 0&&e.stack!==void 0}function Lm(i,e,t){return`${i.id}.${e.id}.${t.stack||t.type}`}function Sm(i){const{min:e,max:t,minDefined:o,maxDefined:n}=i.getUserBounds();return{min:o?e:Number.NEGATIVE_INFINITY,max:n?t:Number.POSITIVE_INFINITY}}function Mm(i,e,t){const o=i[e]||(i[e]={});return o[t]||(o[t]={})}function Bc(i,e,t,o){for(const n of e.getMatchingVisibleMetas(o).reverse()){const s=i[n.index];if(t&&s>0||!t&&s<0)return n.index}return null}function Dc(i,e){const{chart:t,_cachedMeta:o}=i,n=t._stacks||(t._stacks={}),{iScale:s,vScale:a,index:c}=o,d=s.axis,l=a.axis,f=Lm(s,a,o),p=e.length;let m;for(let _=0;_<p;++_){const b=e[_],{[d]:x,[l]:A}=b,S=b._stacks||(b._stacks={});m=S[l]=Mm(n,f,x),m[c]=A,m._top=Bc(m,a,!0,o.type),m._bottom=Bc(m,a,!1,o.type);const E=m._visualValues||(m._visualValues={});E[c]=A}}function Xl(i,e){const t=i.scales;return Object.keys(t).filter(o=>t[o].axis===e).shift()}function Tm(i,e){return So(i,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Pm(i,e,t){return So(i,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function $s(i,e){const t=i.controller.index,o=i.vScale&&i.vScale.axis;if(o){e=e||i._parsed;for(const n of e){const s=n._stacks;if(!s||s[o]===void 0||s[o][t]===void 0)return;delete s[o][t],s[o]._visualValues!==void 0&&s[o]._visualValues[t]!==void 0&&delete s[o]._visualValues[t]}}}const Ql=i=>i==="reset"||i==="none",Ic=(i,e)=>e?i:Object.assign({},i),Em=(i,e,t)=>i&&!e.hidden&&e._stacked&&{keys:hf(t,!0),values:null};class rr{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Rc(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&$s(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,o=this.getDataset(),n=(p,m,_,b)=>p==="x"?m:p==="r"?b:_,s=t.xAxisID=pt(o.xAxisID,Xl(e,"x")),a=t.yAxisID=pt(o.yAxisID,Xl(e,"y")),c=t.rAxisID=pt(o.rAxisID,Xl(e,"r")),d=t.indexAxis,l=t.iAxisID=n(d,s,a,c),f=t.vAxisID=n(d,a,s,c);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(a),t.rScale=this.getScaleForId(c),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(f)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&_c(this._data,this),e._stacked&&$s(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),o=this._data;if(wt(t))this._data=Cm(t);else if(o!==t){if(o){_c(o,this);const n=this._cachedMeta;$s(n),n._parsed=[]}t&&Object.isExtensible(t)&&pg(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,o=this.getDataset();let n=!1;this._dataCheck();const s=t._stacked;t._stacked=Rc(t.vScale,t),t.stack!==o.stack&&(n=!0,$s(t),t.stack=o.stack),this._resyncElements(e),(n||s!==t._stacked)&&Dc(this,t._parsed)}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),o=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(o,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:o,_data:n}=this,{iScale:s,_stacked:a}=o,c=s.axis;let d=e===0&&t===n.length?!0:o._sorted,l=e>0&&o._parsed[e-1],f,p,m;if(this._parsing===!1)o._parsed=n,o._sorted=!0,m=n;else{Xt(n[e])?m=this.parseArrayData(o,n,e,t):wt(n[e])?m=this.parseObjectData(o,n,e,t):m=this.parsePrimitiveData(o,n,e,t);const _=()=>p[c]===null||l&&p[c]<l[c];for(f=0;f<t;++f)o._parsed[f+e]=p=m[f],d&&(_()&&(d=!1),l=p);o._sorted=d}a&&Dc(this,m)}parsePrimitiveData(e,t,o,n){const{iScale:s,vScale:a}=e,c=s.axis,d=a.axis,l=s.getLabels(),f=s===a,p=new Array(n);let m,_,b;for(m=0,_=n;m<_;++m)b=m+o,p[m]={[c]:f||s.parse(l[b],b),[d]:a.parse(t[b],b)};return p}parseArrayData(e,t,o,n){const{xScale:s,yScale:a}=e,c=new Array(n);let d,l,f,p;for(d=0,l=n;d<l;++d)f=d+o,p=t[f],c[d]={x:s.parse(p[0],f),y:a.parse(p[1],f)};return c}parseObjectData(e,t,o,n){const{xScale:s,yScale:a}=e,{xAxisKey:c="x",yAxisKey:d="y"}=this._parsing,l=new Array(n);let f,p,m,_;for(f=0,p=n;f<p;++f)m=f+o,_=t[m],l[f]={x:s.parse(Co(_,c),m),y:a.parse(Co(_,d),m)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,o){const n=this.chart,s=this._cachedMeta,a=t[e.axis],c={keys:hf(n,!0),values:t._stacks[e.axis]._visualValues};return kc(c,a,s.index,{mode:o})}updateRangeFromParsed(e,t,o,n){const s=o[t.axis];let a=s===null?NaN:s;const c=n&&o._stacks[t.axis];n&&c&&(n.values=c,a=kc(n,s,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,t){const o=this._cachedMeta,n=o._parsed,s=o._sorted&&e===o.iScale,a=n.length,c=this._getOtherScale(e),d=Em(t,o,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:f,max:p}=Sm(c);let m,_;function b(){_=n[m];const x=_[c.axis];return!ln(_[e.axis])||f>x||p<x}for(m=0;m<a&&!(!b()&&(this.updateRangeFromParsed(l,e,_,d),s));++m);if(s){for(m=a-1;m>=0;--m)if(!b()){this.updateRangeFromParsed(l,e,_,d);break}}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,o=[];let n,s,a;for(n=0,s=t.length;n<s;++n)a=t[n][e.axis],ln(a)&&o.push(a);return o}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,o=t.iScale,n=t.vScale,s=this.getParsed(e);return{label:o?""+o.getLabelForValue(s[o.axis]):"",value:n?""+n.getLabelForValue(s[n.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=wm(pt(this.options.clip,xm(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,o=this._cachedMeta,n=o.data||[],s=t.chartArea,a=[],c=this._drawStart||0,d=this._drawCount||n.length-c,l=this.options.drawActiveElementsOnTop;let f;for(o.dataset&&o.dataset.draw(e,s,c,d),f=c;f<c+d;++f){const p=n[f];p.hidden||(p.active&&l?a.push(p):p.draw(e,s))}for(f=0;f<a.length;++f)a[f].draw(e,s)}getStyle(e,t){const o=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(o):this.resolveDataElementOptions(e||0,o)}getContext(e,t,o){const n=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const a=this._cachedMeta.data[e];s=a.$context||(a.$context=Pm(this.getContext(),e,a)),s.parsed=this.getParsed(e),s.raw=n.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=Tm(this.chart.getContext(),this.index)),s.dataset=n,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=o,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",o){const n=t==="active",s=this._cachedDataOpts,a=e+"-"+t,c=s[a],d=this.enableOptionSharing&&Wi(o);if(c)return Ic(c,d);const l=this.chart.config,f=l.datasetElementScopeKeys(this._type,e),p=n?[`${e}Hover`,"hover",e,""]:[e,""],m=l.getOptionScopes(this.getDataset(),f),_=Object.keys(hn.elements[e]),b=()=>this.getContext(o,n,t),x=l.resolveNamedOptions(m,_,b,p);return x.$shared&&(x.$shared=d,s[a]=Object.freeze(Ic(x,d))),x}_resolveAnimations(e,t,o){const n=this.chart,s=this._cachedDataOpts,a=`animation-${t}`,c=s[a];if(c)return c;let d;if(n.options.animation!==!1){const f=this.chart.config,p=f.datasetAnimationScopeKeys(this._type,t),m=f.getOptionScopes(this.getDataset(),p);d=f.createResolver(m,this.getContext(e,o,t))}const l=new cf(n,d&&d.animations);return d&&d._cacheable&&(s[a]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Ql(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const o=this.resolveDataElementOptions(e,t),n=this._sharedOptions,s=this.getSharedOptions(o),a=this.includeOptions(t,s)||s!==n;return this.updateSharedOptions(s,t,o),{sharedOptions:s,includeOptions:a}}updateElement(e,t,o,n){Ql(n)?Object.assign(e,o):this._resolveAnimations(t,n).update(e,o)}updateSharedOptions(e,t,o){e&&!Ql(t)&&this._resolveAnimations(void 0,t).update(e,o)}_setStyle(e,t,o,n){e.active=n;const s=this.getStyle(t,n);this._resolveAnimations(t,o,n).update(e,{options:!n&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,o){this._setStyle(e,o,"active",!1)}setHoverStyle(e,t,o){this._setStyle(e,o,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,o=this._cachedMeta.data;for(const[c,d,l]of this._syncList)this[c](d,l);this._syncList=[];const n=o.length,s=t.length,a=Math.min(s,n);a&&this.parse(0,a),s>n?this._insertElements(n,s-n,e):s<n&&this._removeElements(s,n-s)}_insertElements(e,t,o=!0){const n=this._cachedMeta,s=n.data,a=e+t;let c;const d=l=>{for(l.length+=t,c=l.length-1;c>=a;c--)l[c]=l[c-t]};for(d(s),c=e;c<a;++c)s[c]=new this.dataElementType;this._parsing&&d(n._parsed),this.parse(e,t),o&&this.updateElements(s,e,t,"reset")}updateElements(e,t,o,n){}_removeElements(e,t){const o=this._cachedMeta;if(this._parsing){const n=o._parsed.splice(e,t);o._stacked&&$s(o,n)}o.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,o,n]=e;this[t](o,n)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const o=arguments.length-2;o&&this._sync(["_insertElements",e,o])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Ie(rr,"defaults",{}),Ie(rr,"datasetElementType",null),Ie(rr,"dataElementType",null);function Am(i,e){if(!i._cache.$bar){const t=i.getMatchingVisibleMetas(e);let o=[];for(let n=0,s=t.length;n<s;n++)o=o.concat(t[n].controller.getAllParsedValues(i));i._cache.$bar=Uh(o.sort((n,s)=>n-s))}return i._cache.$bar}function Om(i){const e=i.iScale,t=Am(e,i.type);let o=e._length,n,s,a,c;const d=()=>{a===32767||a===-32768||(Wi(c)&&(o=Math.min(o,Math.abs(a-c)||o)),c=a)};for(n=0,s=t.length;n<s;++n)a=e.getPixelForValue(t[n]),d();for(c=void 0,n=0,s=e.ticks.length;n<s;++n)a=e.getPixelForTick(n),d();return o}function km(i,e,t,o){const n=t.barThickness;let s,a;return Pt(n)?(s=e.min*t.categoryPercentage,a=t.barPercentage):(s=n*o,a=1),{chunk:s/o,ratio:a,start:e.pixels[i]-s/2}}function Rm(i,e,t,o){const n=e.pixels,s=n[i];let a=i>0?n[i-1]:null,c=i<n.length-1?n[i+1]:null;const d=t.categoryPercentage;a===null&&(a=s-(c===null?e.end-e.start:c-s)),c===null&&(c=s+s-a);const l=s-(s-Math.min(a,c))/2*d;return{chunk:Math.abs(c-a)/2*d/o,ratio:t.barPercentage,start:l}}function Bm(i,e,t,o){const n=t.parse(i[0],o),s=t.parse(i[1],o),a=Math.min(n,s),c=Math.max(n,s);let d=a,l=c;Math.abs(a)>Math.abs(c)&&(d=c,l=a),e[t.axis]=l,e._custom={barStart:d,barEnd:l,start:n,end:s,min:a,max:c}}function ff(i,e,t,o){return Xt(i)?Bm(i,e,t,o):e[t.axis]=t.parse(i,o),e}function Fc(i,e,t,o){const n=i.iScale,s=i.vScale,a=n.getLabels(),c=n===s,d=[];let l,f,p,m;for(l=t,f=t+o;l<f;++l)m=e[l],p={},p[n.axis]=c||n.parse(a[l],l),d.push(ff(m,p,s,l));return d}function Jl(i){return i&&i.barStart!==void 0&&i.barEnd!==void 0}function Dm(i,e,t){return i!==0?Lr(i):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function Im(i){let e,t,o,n,s;return i.horizontal?(e=i.base>i.x,t="left",o="right"):(e=i.base<i.y,t="bottom",o="top"),e?(n="end",s="start"):(n="start",s="end"),{start:t,end:o,reverse:e,top:n,bottom:s}}function Fm(i,e,t,o){let n=e.borderSkipped;const s={};if(!n){i.borderSkipped=s;return}if(n===!0){i.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:c,reverse:d,top:l,bottom:f}=Im(i);n==="middle"&&t&&(i.enableBorderRadius=!0,(t._top||0)===o?n=l:(t._bottom||0)===o?n=f:(s[Nc(f,a,c,d)]=!0,n=l)),s[Nc(n,a,c,d)]=!0,i.borderSkipped=s}function Nc(i,e,t,o){return o?(i=Nm(i,e,t),i=zc(i,t,e)):i=zc(i,e,t),i}function Nm(i,e,t){return i===e?t:i===t?e:i}function zc(i,e,t){return i==="start"?e:i==="end"?t:i}function zm(i,{inflateAmount:e},t){i.inflateAmount=e==="auto"?t===1?.33:0:e}class il extends rr{parsePrimitiveData(e,t,o,n){return Fc(e,t,o,n)}parseArrayData(e,t,o,n){return Fc(e,t,o,n)}parseObjectData(e,t,o,n){const{iScale:s,vScale:a}=e,{xAxisKey:c="x",yAxisKey:d="y"}=this._parsing,l=s.axis==="x"?c:d,f=a.axis==="x"?c:d,p=[];let m,_,b,x;for(m=o,_=o+n;m<_;++m)x=t[m],b={},b[s.axis]=s.parse(Co(x,l),m),p.push(ff(Co(x,f),b,a,m));return p}updateRangeFromParsed(e,t,o,n){super.updateRangeFromParsed(e,t,o,n);const s=o._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:o,vScale:n}=t,s=this.getParsed(e),a=s._custom,c=Jl(a)?"["+a.start+", "+a.end+"]":""+n.getLabelForValue(s[n.axis]);return{label:""+o.getLabelForValue(s[o.axis]),value:c}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,o,n){const s=n==="reset",{index:a,_cachedMeta:{vScale:c}}=this,d=c.getBasePixel(),l=c.isHorizontal(),f=this._getRuler(),{sharedOptions:p,includeOptions:m}=this._getSharedOptions(t,n);for(let _=t;_<t+o;_++){const b=this.getParsed(_),x=s||Pt(b[c.axis])?{base:d,head:d}:this._calculateBarValuePixels(_),A=this._calculateBarIndexPixels(_,f),S=(b._stacks||{})[c.axis],E={horizontal:l,base:x.base,enableBorderRadius:!S||Jl(b._custom)||a===S._top||a===S._bottom,x:l?x.head:A.center,y:l?A.center:x.head,height:l?A.size:Math.abs(x.size),width:l?Math.abs(x.size):A.size};m&&(E.options=p||this.resolveDataElementOptions(_,e[_].active?"active":n));const F=E.options||e[_].options;Fm(E,F,S,a),zm(E,F,f.ratio),this.updateElement(e[_],_,E,n)}}_getStacks(e,t){const{iScale:o}=this._cachedMeta,n=o.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),s=o.options.stacked,a=[],c=d=>{const l=d.controller.getParsed(t),f=l&&l[d.vScale.axis];if(Pt(f)||isNaN(f))return!0};for(const d of n)if(!(t!==void 0&&c(d))&&((s===!1||a.indexOf(d.stack)===-1||s===void 0&&d.stack===void 0)&&a.push(d.stack),d.index===e))break;return a.length||a.push(void 0),a}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,o){const n=this._getStacks(e,o),s=t!==void 0?n.indexOf(t):-1;return s===-1?n.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,o=t.iScale,n=[];let s,a;for(s=0,a=t.data.length;s<a;++s)n.push(o.getPixelForValue(this.getParsed(s)[o.axis],s));const c=e.barThickness;return{min:c||Om(t),pixels:n,start:o._startPixel,end:o._endPixel,stackCount:this._getStackCount(),scale:o,grouped:e.grouped,ratio:c?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:o,index:n},options:{base:s,minBarLength:a}}=this,c=s||0,d=this.getParsed(e),l=d._custom,f=Jl(l);let p=d[t.axis],m=0,_=o?this.applyStack(t,d,o):p,b,x;_!==p&&(m=_-p,_=p),f&&(p=l.barStart,_=l.barEnd-l.barStart,p!==0&&Lr(p)!==Lr(l.barEnd)&&(m=0),m+=p);const A=!Pt(s)&&!f?s:m;let S=t.getPixelForValue(A);if(this.chart.getDataVisibility(e)?b=t.getPixelForValue(m+_):b=S,x=b-S,Math.abs(x)<a){x=Dm(x,t,c)*a,p===c&&(S-=x/2);const E=t.getPixelForDecimal(0),F=t.getPixelForDecimal(1),v=Math.min(E,F),P=Math.max(E,F);S=Math.max(Math.min(S,P),v),b=S+x,o&&!f&&(d._stacks[t.axis]._visualValues[n]=t.getValueForPixel(b)-t.getValueForPixel(S))}if(S===t.getPixelForValue(c)){const E=Lr(x)*t.getLineWidthForValue(c)/2;S+=E,x-=E}return{size:x,base:S,head:b,center:b+x/2}}_calculateBarIndexPixels(e,t){const o=t.scale,n=this.options,s=n.skipNull,a=pt(n.maxBarThickness,1/0);let c,d;if(t.grouped){const l=s?this._getStackCount(e):t.stackCount,f=n.barThickness==="flex"?Rm(e,t,n,l):km(e,t,n,l),p=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0);c=f.start+f.chunk*p+f.chunk/2,d=Math.min(a,f.chunk*f.ratio)}else c=o.getPixelForValue(this.getParsed(e)[o.axis],e),d=Math.min(a,t.min*t.ratio);return{base:c-d/2,head:c+d/2,center:c,size:d}}draw(){const e=this._cachedMeta,t=e.vScale,o=e.data,n=o.length;let s=0;for(;s<n;++s)this.getParsed(s)[t.axis]!==null&&o[s].draw(this._ctx)}}Ie(il,"id","bar"),Ie(il,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Ie(il,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class rl extends rr{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,o,n){const s=super.parsePrimitiveData(e,t,o,n);for(let a=0;a<s.length;a++)s[a]._custom=this.resolveDataElementOptions(a+o).radius;return s}parseArrayData(e,t,o,n){const s=super.parseArrayData(e,t,o,n);for(let a=0;a<s.length;a++){const c=t[o+a];s[a]._custom=pt(c[2],this.resolveDataElementOptions(a+o).radius)}return s}parseObjectData(e,t,o,n){const s=super.parseObjectData(e,t,o,n);for(let a=0;a<s.length;a++){const c=t[o+a];s[a]._custom=pt(c&&c.r&&+c.r,this.resolveDataElementOptions(a+o).radius)}return s}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let o=e.length-1;o>=0;--o)t=Math.max(t,e[o].size(this.resolveDataElementOptions(o))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,o=this.chart.data.labels||[],{xScale:n,yScale:s}=t,a=this.getParsed(e),c=n.getLabelForValue(a.x),d=s.getLabelForValue(a.y),l=a._custom;return{label:o[e]||"",value:"("+c+", "+d+(l?", "+l:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,o,n){const s=n==="reset",{iScale:a,vScale:c}=this._cachedMeta,{sharedOptions:d,includeOptions:l}=this._getSharedOptions(t,n),f=a.axis,p=c.axis;for(let m=t;m<t+o;m++){const _=e[m],b=!s&&this.getParsed(m),x={},A=x[f]=s?a.getPixelForDecimal(.5):a.getPixelForValue(b[f]),S=x[p]=s?c.getBasePixel():c.getPixelForValue(b[p]);x.skip=isNaN(A)||isNaN(S),l&&(x.options=d||this.resolveDataElementOptions(m,_.active?"active":n),s&&(x.options.radius=0)),this.updateElement(_,m,x,n)}}resolveDataElementOptions(e,t){const o=this.getParsed(e);let n=super.resolveDataElementOptions(e,t);n.$shared&&(n=Object.assign({},n,{$shared:!1}));const s=n.radius;return t!=="active"&&(n.radius=0),n.radius+=pt(o&&o._custom,s),n}}Ie(rl,"id","bubble"),Ie(rl,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),Ie(rl,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function jm(i,e,t){let o=1,n=1,s=0,a=0;if(e<Qt){const c=i,d=c+e,l=Math.cos(c),f=Math.sin(c),p=Math.cos(d),m=Math.sin(d),_=(F,v,P)=>xa(F,c,d,!0)?1:Math.max(v,v*t,P,P*t),b=(F,v,P)=>xa(F,c,d,!0)?-1:Math.min(v,v*t,P,P*t),x=_(0,l,p),A=_(un,f,m),S=b(Jt,l,p),E=b(Jt+un,f,m);o=(x-S)/2,n=(A-E)/2,s=-(x+S)/2,a=-(A+E)/2}return{ratioX:o,ratioY:n,offsetX:s,offsetY:a}}class os extends rr{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const o=this.getDataset().data,n=this._cachedMeta;if(this._parsing===!1)n._parsed=o;else{let s=d=>+o[d];if(wt(o[e])){const{key:d="value"}=this._parsing;s=l=>+Co(o[l],d)}let a,c;for(a=e,c=e+t;a<c;++a)n._parsed[a]=s(a)}}_getRotation(){return ir(this.options.rotation-90)}_getCircumference(){return ir(this.options.circumference)}_getRotationExtents(){let e=Qt,t=-Qt;for(let o=0;o<this.chart.data.datasets.length;++o)if(this.chart.isDatasetVisible(o)&&this.chart.getDatasetMeta(o).type===this._type){const n=this.chart.getDatasetMeta(o).controller,s=n._getRotation(),a=n._getCircumference();e=Math.min(e,s),t=Math.max(t,s+a)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:o}=t,n=this._cachedMeta,s=n.data,a=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,c=Math.max((Math.min(o.width,o.height)-a)/2,0),d=Math.min(eg(this.options.cutout,c),1),l=this._getRingWeight(this.index),{circumference:f,rotation:p}=this._getRotationExtents(),{ratioX:m,ratioY:_,offsetX:b,offsetY:x}=jm(p,f,d),A=(o.width-a)/m,S=(o.height-a)/_,E=Math.max(Math.min(A,S)/2,0),F=Fh(this.options.radius,E),v=Math.max(F*d,0),P=(F-v)/this._getVisibleDatasetWeightTotal();this.offsetX=b*F,this.offsetY=x*F,n.total=this.calculateTotal(),this.outerRadius=F-P*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-P*l,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const o=this.options,n=this._cachedMeta,s=this._getCircumference();return t&&o.animation.animateRotate||!this.chart.getDataVisibility(e)||n._parsed[e]===null||n.data[e].hidden?0:this.calculateCircumference(n._parsed[e]*s/Qt)}updateElements(e,t,o,n){const s=n==="reset",a=this.chart,c=a.chartArea,l=a.options.animation,f=(c.left+c.right)/2,p=(c.top+c.bottom)/2,m=s&&l.animateScale,_=m?0:this.innerRadius,b=m?0:this.outerRadius,{sharedOptions:x,includeOptions:A}=this._getSharedOptions(t,n);let S=this._getRotation(),E;for(E=0;E<t;++E)S+=this._circumference(E,s);for(E=t;E<t+o;++E){const F=this._circumference(E,s),v=e[E],P={x:f+this.offsetX,y:p+this.offsetY,startAngle:S,endAngle:S+F,circumference:F,outerRadius:b,innerRadius:_};A&&(P.options=x||this.resolveDataElementOptions(E,v.active?"active":n)),S+=F,this.updateElement(v,E,P,n)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let o=0,n;for(n=0;n<t.length;n++){const s=e._parsed[n];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(n)&&!t[n].hidden&&(o+=Math.abs(s))}return o}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Qt*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,o=this.chart,n=o.data.labels||[],s=Pa(t._parsed[e],o.options.locale);return{label:n[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const o=this.chart;let n,s,a,c,d;if(!e){for(n=0,s=o.data.datasets.length;n<s;++n)if(o.isDatasetVisible(n)){a=o.getDatasetMeta(n),e=a.data,c=a.controller;break}}if(!e)return 0;for(n=0,s=e.length;n<s;++n)d=c.resolveDataElementOptions(n),d.borderAlign!=="inner"&&(t=Math.max(t,d.borderWidth||0,d.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let o=0,n=e.length;o<n;++o){const s=this.resolveDataElementOptions(o);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let o=0;o<e;++o)this.chart.isDatasetVisible(o)&&(t+=this._getRingWeight(o));return t}_getRingWeight(e){return Math.max(pt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Ie(os,"id","doughnut"),Ie(os,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Ie(os,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"}),Ie(os,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:o,color:n}}=e.legend.options;return t.labels.map((s,a)=>{const d=e.getDatasetMeta(0).controller.getStyle(a);return{text:s,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,fontColor:n,lineWidth:d.borderWidth,pointStyle:o,hidden:!e.getDataVisibility(a),index:a}})}return[]}},onClick(e,t,o){o.chart.toggleDataVisibility(t.index),o.chart.update()}}}});class ol extends rr{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:o,data:n=[],_dataset:s}=t,a=this.chart._animationsDisabled;let{start:c,count:d}=Zh(t,n,a);this._drawStart=c,this._drawCount=d,qh(t)&&(c=0,d=n.length),o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!s._decimated,o.points=n;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(o,void 0,{animated:!a,options:l},e),this.updateElements(n,c,d,e)}updateElements(e,t,o,n){const s=n==="reset",{iScale:a,vScale:c,_stacked:d,_dataset:l}=this._cachedMeta,{sharedOptions:f,includeOptions:p}=this._getSharedOptions(t,n),m=a.axis,_=c.axis,{spanGaps:b,segment:x}=this.options,A=Os(b)?b:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||s||n==="none",E=t+o,F=e.length;let v=t>0&&this.getParsed(t-1);for(let P=0;P<F;++P){const G=e[P],$=S?G:{};if(P<t||P>=E){$.skip=!0;continue}const Z=this.getParsed(P),ie=Pt(Z[_]),le=$[m]=a.getPixelForValue(Z[m],P),X=$[_]=s||ie?c.getBasePixel():c.getPixelForValue(d?this.applyStack(c,Z,d):Z[_],P);$.skip=isNaN(le)||isNaN(X)||ie,$.stop=P>0&&Math.abs(Z[m]-v[m])>A,x&&($.parsed=Z,$.raw=l.data[P]),p&&($.options=f||this.resolveDataElementOptions(P,G.active?"active":n)),S||this.updateElement(G,P,$,n),v=Z}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,o=t.options&&t.options.borderWidth||0,n=e.data||[];if(!n.length)return o;const s=n[0].size(this.resolveDataElementOptions(0)),a=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(o,s,a)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Ie(ol,"id","line"),Ie(ol,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Ie(ol,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class ma extends rr{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,o=this.chart,n=o.data.labels||[],s=Pa(t._parsed[e].r,o.options.locale);return{label:n[e]||"",value:s}}parseObjectData(e,t,o,n){return tf.bind(this)(e,t,o,n)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((o,n)=>{const s=this.getParsed(n).r;!isNaN(s)&&this.chart.getDataVisibility(n)&&(s<t.min&&(t.min=s),s>t.max&&(t.max=s))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,o=e.options,n=Math.min(t.right-t.left,t.bottom-t.top),s=Math.max(n/2,0),a=Math.max(o.cutoutPercentage?s/100*o.cutoutPercentage:1,0),c=(s-a)/e.getVisibleDatasetCount();this.outerRadius=s-c*this.index,this.innerRadius=this.outerRadius-c}updateElements(e,t,o,n){const s=n==="reset",a=this.chart,d=a.options.animation,l=this._cachedMeta.rScale,f=l.xCenter,p=l.yCenter,m=l.getIndexAngle(0)-.5*Jt;let _=m,b;const x=360/this.countVisibleElements();for(b=0;b<t;++b)_+=this._computeAngle(b,n,x);for(b=t;b<t+o;b++){const A=e[b];let S=_,E=_+this._computeAngle(b,n,x),F=a.getDataVisibility(b)?l.getDistanceFromCenterForValue(this.getParsed(b).r):0;_=E,s&&(d.animateScale&&(F=0),d.animateRotate&&(S=E=m));const v={x:f,y:p,innerRadius:0,outerRadius:F,startAngle:S,endAngle:E,options:this.resolveDataElementOptions(b,A.active?"active":n)};this.updateElement(A,b,v,n)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((o,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&t++}),t}_computeAngle(e,t,o){return this.chart.getDataVisibility(e)?ir(this.resolveDataElementOptions(e,t).angle||o):0}}Ie(ma,"id","polarArea"),Ie(ma,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),Ie(ma,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:o,color:n}}=e.legend.options;return t.labels.map((s,a)=>{const d=e.getDatasetMeta(0).controller.getStyle(a);return{text:s,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,fontColor:n,lineWidth:d.borderWidth,pointStyle:o,hidden:!e.getDataVisibility(a),index:a}})}return[]}},onClick(e,t,o){o.chart.toggleDataVisibility(t.index),o.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class pu extends os{}Ie(pu,"id","pie"),Ie(pu,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class sl extends rr{getLabelAndValue(e){const t=this._cachedMeta.vScale,o=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(o[t.axis])}}parseObjectData(e,t,o,n){return tf.bind(this)(e,t,o,n)}update(e){const t=this._cachedMeta,o=t.dataset,n=t.data||[],s=t.iScale.getLabels();if(o.points=n,e!=="resize"){const a=this.resolveDatasetElementOptions(e);this.options.showLine||(a.borderWidth=0);const c={_loop:!0,_fullLoop:s.length===n.length,options:a};this.updateElement(o,void 0,c,e)}this.updateElements(n,0,n.length,e)}updateElements(e,t,o,n){const s=this._cachedMeta.rScale,a=n==="reset";for(let c=t;c<t+o;c++){const d=e[c],l=this.resolveDataElementOptions(c,d.active?"active":n),f=s.getPointPositionForValue(c,this.getParsed(c).r),p=a?s.xCenter:f.x,m=a?s.yCenter:f.y,_={x:p,y:m,angle:f.angle,skip:isNaN(p)||isNaN(m),options:l};this.updateElement(d,c,_,n)}}}Ie(sl,"id","radar"),Ie(sl,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),Ie(sl,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class al extends rr{getLabelAndValue(e){const t=this._cachedMeta,o=this.chart.data.labels||[],{xScale:n,yScale:s}=t,a=this.getParsed(e),c=n.getLabelForValue(a.x),d=s.getLabelForValue(a.y);return{label:o[e]||"",value:"("+c+", "+d+")"}}update(e){const t=this._cachedMeta,{data:o=[]}=t,n=this.chart._animationsDisabled;let{start:s,count:a}=Zh(t,o,n);if(this._drawStart=s,this._drawCount=a,qh(t)&&(s=0,a=o.length),this.options.showLine){const{dataset:c,_dataset:d}=t;c._chart=this.chart,c._datasetIndex=this.index,c._decimated=!!d._decimated,c.points=o;const l=this.resolveDatasetElementOptions(e);l.segment=this.options.segment,this.updateElement(c,void 0,{animated:!n,options:l},e)}this.updateElements(o,s,a,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,o,n){const s=n==="reset",{iScale:a,vScale:c,_stacked:d,_dataset:l}=this._cachedMeta,f=this.resolveDataElementOptions(t,n),p=this.getSharedOptions(f),m=this.includeOptions(n,p),_=a.axis,b=c.axis,{spanGaps:x,segment:A}=this.options,S=Os(x)?x:Number.POSITIVE_INFINITY,E=this.chart._animationsDisabled||s||n==="none";let F=t>0&&this.getParsed(t-1);for(let v=t;v<t+o;++v){const P=e[v],G=this.getParsed(v),$=E?P:{},Z=Pt(G[b]),ie=$[_]=a.getPixelForValue(G[_],v),le=$[b]=s||Z?c.getBasePixel():c.getPixelForValue(d?this.applyStack(c,G,d):G[b],v);$.skip=isNaN(ie)||isNaN(le)||Z,$.stop=v>0&&Math.abs(G[_]-F[_])>S,A&&($.parsed=G,$.raw=l.data[v]),m&&($.options=p||this.resolveDataElementOptions(v,P.active?"active":n)),E||this.updateElement(P,v,$,n),F=G}this.updateSharedOptions(p,n,f)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let c=0;for(let d=t.length-1;d>=0;--d)c=Math.max(c,t[d].size(this.resolveDataElementOptions(d))/2);return c>0&&c}const o=e.dataset,n=o.options&&o.options.borderWidth||0;if(!t.length)return n;const s=t[0].size(this.resolveDataElementOptions(0)),a=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(n,s,a)/2}}Ie(al,"id","scatter"),Ie(al,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Ie(al,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var Hm=Object.freeze({__proto__:null,BarController:il,BubbleController:rl,DoughnutController:os,LineController:ol,PolarAreaController:ma,PieController:pu,RadarController:sl,ScatterController:al});function $o(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Nu{static override(e){Object.assign(Nu.prototype,e)}constructor(e){this.options=e||{}}init(){}formats(){return $o()}parse(){return $o()}format(){return $o()}add(){return $o()}diff(){return $o()}startOf(){return $o()}endOf(){return $o()}}var Um={_date:Nu};function Wm(i,e,t,o){const{controller:n,data:s,_sorted:a}=i,c=n._cachedMeta.iScale;if(c&&e===c.axis&&e!=="r"&&a&&s.length){const d=c._reversePixels?fg:Jr;if(o){if(n._sharedOptions){const l=s[0],f=typeof l.getRange=="function"&&l.getRange(e);if(f){const p=d(s,e,t-f),m=d(s,e,t+f);return{lo:p.lo,hi:m.hi}}}}else return d(s,e,t)}return{lo:0,hi:s.length-1}}function Ea(i,e,t,o,n){const s=i.getSortedVisibleDatasetMetas(),a=t[e];for(let c=0,d=s.length;c<d;++c){const{index:l,data:f}=s[c],{lo:p,hi:m}=Wm(s[c],e,a,n);for(let _=p;_<=m;++_){const b=f[_];b.skip||o(b,l,_)}}}function Vm(i){const e=i.indexOf("x")!==-1,t=i.indexOf("y")!==-1;return function(o,n){const s=e?Math.abs(o.x-n.x):0,a=t?Math.abs(o.y-n.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(a,2))}}function $l(i,e,t,o,n){const s=[];return!n&&!i.isPointInArea(e)||Ea(i,t,e,function(c,d,l){!n&&!wa(c,i.chartArea,0)||c.inRange(e.x,e.y,o)&&s.push({element:c,datasetIndex:d,index:l})},!0),s}function Zm(i,e,t,o){let n=[];function s(a,c,d){const{startAngle:l,endAngle:f}=a.getProps(["startAngle","endAngle"],o),{angle:p}=jh(a,{x:e.x,y:e.y});xa(p,l,f)&&n.push({element:a,datasetIndex:c,index:d})}return Ea(i,t,e,s),n}function qm(i,e,t,o,n,s){let a=[];const c=Vm(t);let d=Number.POSITIVE_INFINITY;function l(f,p,m){const _=f.inRange(e.x,e.y,n);if(o&&!_)return;const b=f.getCenterPoint(n);if(!(!!s||i.isPointInArea(b))&&!_)return;const A=c(e,b);A<d?(a=[{element:f,datasetIndex:p,index:m}],d=A):A===d&&a.push({element:f,datasetIndex:p,index:m})}return Ea(i,t,e,l),a}function eu(i,e,t,o,n,s){return!s&&!i.isPointInArea(e)?[]:t==="r"&&!o?Zm(i,e,t,n):qm(i,e,t,o,n,s)}function jc(i,e,t,o,n){const s=[],a=t==="x"?"inXRange":"inYRange";let c=!1;return Ea(i,t,e,(d,l,f)=>{d[a](e[t],n)&&(s.push({element:d,datasetIndex:l,index:f}),c=c||d.inRange(e.x,e.y,n))}),o&&!c?[]:s}var Gm={evaluateInteractionItems:Ea,modes:{index(i,e,t,o){const n=ts(e,i),s=t.axis||"x",a=t.includeInvisible||!1,c=t.intersect?$l(i,n,s,o,a):eu(i,n,s,!1,o,a),d=[];return c.length?(i.getSortedVisibleDatasetMetas().forEach(l=>{const f=c[0].index,p=l.data[f];p&&!p.skip&&d.push({element:p,datasetIndex:l.index,index:f})}),d):[]},dataset(i,e,t,o){const n=ts(e,i),s=t.axis||"xy",a=t.includeInvisible||!1;let c=t.intersect?$l(i,n,s,o,a):eu(i,n,s,!1,o,a);if(c.length>0){const d=c[0].datasetIndex,l=i.getDatasetMeta(d).data;c=[];for(let f=0;f<l.length;++f)c.push({element:l[f],datasetIndex:d,index:f})}return c},point(i,e,t,o){const n=ts(e,i),s=t.axis||"xy",a=t.includeInvisible||!1;return $l(i,n,s,o,a)},nearest(i,e,t,o){const n=ts(e,i),s=t.axis||"xy",a=t.includeInvisible||!1;return eu(i,n,s,t.intersect,o,a)},x(i,e,t,o){const n=ts(e,i);return jc(i,n,"x",t.intersect,o)},y(i,e,t,o){const n=ts(e,i);return jc(i,n,"y",t.intersect,o)}}};const df=["left","top","right","bottom"];function ea(i,e){return i.filter(t=>t.pos===e)}function Hc(i,e){return i.filter(t=>df.indexOf(t.pos)===-1&&t.box.axis===e)}function ta(i,e){return i.sort((t,o)=>{const n=e?o:t,s=e?t:o;return n.weight===s.weight?n.index-s.index:n.weight-s.weight})}function Ym(i){const e=[];let t,o,n,s,a,c;for(t=0,o=(i||[]).length;t<o;++t)n=i[t],{position:s,options:{stack:a,stackWeight:c=1}}=n,e.push({index:t,box:n,pos:s,horizontal:n.isHorizontal(),weight:n.weight,stack:a&&s+a,stackWeight:c});return e}function Km(i){const e={};for(const t of i){const{stack:o,pos:n,stackWeight:s}=t;if(!o||!df.includes(n))continue;const a=e[o]||(e[o]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=s}return e}function Xm(i,e){const t=Km(i),{vBoxMaxWidth:o,hBoxMaxHeight:n}=e;let s,a,c;for(s=0,a=i.length;s<a;++s){c=i[s];const{fullSize:d}=c.box,l=t[c.stack],f=l&&c.stackWeight/l.weight;c.horizontal?(c.width=f?f*o:d&&e.availableWidth,c.height=n):(c.width=o,c.height=f?f*n:d&&e.availableHeight)}return t}function Qm(i){const e=Ym(i),t=ta(e.filter(l=>l.box.fullSize),!0),o=ta(ea(e,"left"),!0),n=ta(ea(e,"right")),s=ta(ea(e,"top"),!0),a=ta(ea(e,"bottom")),c=Hc(e,"x"),d=Hc(e,"y");return{fullSize:t,leftAndTop:o.concat(s),rightAndBottom:n.concat(d).concat(a).concat(c),chartArea:ea(e,"chartArea"),vertical:o.concat(n).concat(d),horizontal:s.concat(a).concat(c)}}function Uc(i,e,t,o){return Math.max(i[t],e[t])+Math.max(i[o],e[o])}function pf(i,e){i.top=Math.max(i.top,e.top),i.left=Math.max(i.left,e.left),i.bottom=Math.max(i.bottom,e.bottom),i.right=Math.max(i.right,e.right)}function Jm(i,e,t,o){const{pos:n,box:s}=t,a=i.maxPadding;if(!wt(n)){t.size&&(i[n]-=t.size);const p=o[t.stack]||{size:0,count:1};p.size=Math.max(p.size,t.horizontal?s.height:s.width),t.size=p.size/p.count,i[n]+=t.size}s.getPadding&&pf(a,s.getPadding());const c=Math.max(0,e.outerWidth-Uc(a,i,"left","right")),d=Math.max(0,e.outerHeight-Uc(a,i,"top","bottom")),l=c!==i.w,f=d!==i.h;return i.w=c,i.h=d,t.horizontal?{same:l,other:f}:{same:f,other:l}}function $m(i){const e=i.maxPadding;function t(o){const n=Math.max(e[o]-i[o],0);return i[o]+=n,n}i.y+=t("top"),i.x+=t("left"),t("right"),t("bottom")}function e_(i,e){const t=e.maxPadding;function o(n){const s={left:0,top:0,right:0,bottom:0};return n.forEach(a=>{s[a]=Math.max(e[a],t[a])}),s}return o(i?["left","right"]:["top","bottom"])}function aa(i,e,t,o){const n=[];let s,a,c,d,l,f;for(s=0,a=i.length,l=0;s<a;++s){c=i[s],d=c.box,d.update(c.width||e.w,c.height||e.h,e_(c.horizontal,e));const{same:p,other:m}=Jm(e,t,c,o);l|=p&&n.length,f=f||m,d.fullSize||n.push(c)}return l&&aa(n,e,t,o)||f}function Ga(i,e,t,o,n){i.top=t,i.left=e,i.right=e+o,i.bottom=t+n,i.width=o,i.height=n}function Wc(i,e,t,o){const n=t.padding;let{x:s,y:a}=e;for(const c of i){const d=c.box,l=o[c.stack]||{count:1,placed:0,weight:1},f=c.stackWeight/l.weight||1;if(c.horizontal){const p=e.w*f,m=l.size||d.height;Wi(l.start)&&(a=l.start),d.fullSize?Ga(d,n.left,a,t.outerWidth-n.right-n.left,m):Ga(d,e.left+l.placed,a,p,m),l.start=a,l.placed+=p,a=d.bottom}else{const p=e.h*f,m=l.size||d.width;Wi(l.start)&&(s=l.start),d.fullSize?Ga(d,s,n.top,m,t.outerHeight-n.bottom-n.top):Ga(d,s,e.top+l.placed,m,p),l.start=s,l.placed+=p,s=d.right}}e.x=s,e.y=a}var oi={addBox(i,e){i.boxes||(i.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},i.boxes.push(e)},removeBox(i,e){const t=i.boxes?i.boxes.indexOf(e):-1;t!==-1&&i.boxes.splice(t,1)},configure(i,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(i,e,t,o){if(!i)return;const n=si(i.options.layout.padding),s=Math.max(e-n.width,0),a=Math.max(t-n.height,0),c=Qm(i.boxes),d=c.vertical,l=c.horizontal;jt(i.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const f=d.reduce((x,A)=>A.box.options&&A.box.options.display===!1?x:x+1,0)||1,p=Object.freeze({outerWidth:e,outerHeight:t,padding:n,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/f,hBoxMaxHeight:a/2}),m=Object.assign({},n);pf(m,si(o));const _=Object.assign({maxPadding:m,w:s,h:a,x:n.left,y:n.top},n),b=Xm(d.concat(l),p);aa(c.fullSize,_,p,b),aa(d,_,p,b),aa(l,_,p,b)&&aa(d,_,p,b),$m(_),Wc(c.leftAndTop,_,p,b),_.x+=_.w,_.y+=_.h,Wc(c.rightAndBottom,_,p,b),i.chartArea={left:_.left,top:_.top,right:_.left+_.w,bottom:_.top+_.h,height:_.h,width:_.w},jt(c.chartArea,x=>{const A=x.box;Object.assign(A,i.chartArea),A.update(_.w,_.h,{left:0,top:0,right:0,bottom:0})})}};class gf{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,o){}removeEventListener(e,t,o){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,o,n){return t=Math.max(0,t||e.width),o=o||e.height,{width:t,height:Math.max(0,n?Math.floor(t/n):o)}}isAttached(e){return!0}updateConfig(e){}}class t_ extends gf{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const ll="$chartjs",n_={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Vc=i=>i===null||i==="";function i_(i,e){const t=i.style,o=i.getAttribute("height"),n=i.getAttribute("width");if(i[ll]={initial:{height:o,width:n,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",Vc(n)){const s=Mc(i,"width");s!==void 0&&(i.width=s)}if(Vc(o))if(i.style.height==="")i.height=i.width/(e||2);else{const s=Mc(i,"height");s!==void 0&&(i.height=s)}return i}const mf=om?{passive:!0}:!1;function r_(i,e,t){i.addEventListener(e,t,mf)}function o_(i,e,t){i.canvas.removeEventListener(e,t,mf)}function s_(i,e){const t=n_[i.type]||i.type,{x:o,y:n}=ts(i,e);return{type:t,chart:e,native:i,x:o!==void 0?o:null,y:n!==void 0?n:null}}function xl(i,e){for(const t of i)if(t===e||t.contains(e))return!0}function a_(i,e,t){const o=i.canvas,n=new MutationObserver(s=>{let a=!1;for(const c of s)a=a||xl(c.addedNodes,o),a=a&&!xl(c.removedNodes,o);a&&t()});return n.observe(document,{childList:!0,subtree:!0}),n}function l_(i,e,t){const o=i.canvas,n=new MutationObserver(s=>{let a=!1;for(const c of s)a=a||xl(c.removedNodes,o),a=a&&!xl(c.addedNodes,o);a&&t()});return n.observe(document,{childList:!0,subtree:!0}),n}const La=new Map;let Zc=0;function _f(){const i=window.devicePixelRatio;i!==Zc&&(Zc=i,La.forEach((e,t)=>{t.currentDevicePixelRatio!==i&&e()}))}function u_(i,e){La.size||window.addEventListener("resize",_f),La.set(i,e)}function c_(i){La.delete(i),La.size||window.removeEventListener("resize",_f)}function h_(i,e,t){const o=i.canvas,n=o&&Fu(o);if(!n)return;const s=Vh((c,d)=>{const l=n.clientWidth;t(c,d),l<n.clientWidth&&t()},window),a=new ResizeObserver(c=>{const d=c[0],l=d.contentRect.width,f=d.contentRect.height;l===0&&f===0||s(l,f)});return a.observe(n),u_(i,s),a}function tu(i,e,t){t&&t.disconnect(),e==="resize"&&c_(i)}function f_(i,e,t){const o=i.canvas,n=Vh(s=>{i.ctx!==null&&t(s_(s,i))},i);return r_(o,e,n),n}class d_ extends gf{acquireContext(e,t){const o=e&&e.getContext&&e.getContext("2d");return o&&o.canvas===e?(i_(e,t),o):null}releaseContext(e){const t=e.canvas;if(!t[ll])return!1;const o=t[ll].initial;["height","width"].forEach(s=>{const a=o[s];Pt(a)?t.removeAttribute(s):t.setAttribute(s,a)});const n=o.style||{};return Object.keys(n).forEach(s=>{t.style[s]=n[s]}),t.width=t.width,delete t[ll],!0}addEventListener(e,t,o){this.removeEventListener(e,t);const n=e.$proxies||(e.$proxies={}),a={attach:a_,detach:l_,resize:h_}[t]||f_;n[t]=a(e,t,o)}removeEventListener(e,t){const o=e.$proxies||(e.$proxies={}),n=o[t];if(!n)return;({attach:tu,detach:tu,resize:tu}[t]||o_)(e,t,n),o[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,o,n){return rm(e,t,o,n)}isAttached(e){const t=Fu(e);return!!(t&&t.isConnected)}}function p_(i){return!rf()||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?t_:d_}var el;let eo=(el=class{constructor(){Ie(this,"active",!1)}tooltipPosition(e){const{x:t,y:o}=this.getProps(["x","y"],e);return{x:t,y:o}}hasValue(){return Os(this.x)&&Os(this.y)}getProps(e,t){const o=this.$animations;if(!t||!o)return this;const n={};return e.forEach(s=>{n[s]=o[s]&&o[s].active()?o[s]._to:this[s]}),n}},Ie(el,"defaults",{}),Ie(el,"defaultRoutes"),el);function g_(i,e){const t=i.options.ticks,o=m_(i),n=Math.min(t.maxTicksLimit||o,o),s=t.major.enabled?y_(e):[],a=s.length,c=s[0],d=s[a-1],l=[];if(a>n)return v_(e,l,s,a/n),l;const f=__(s,e,n);if(a>0){let p,m;const _=a>1?Math.round((d-c)/(a-1)):null;for(Ya(e,l,f,Pt(_)?0:c-_,c),p=0,m=a-1;p<m;p++)Ya(e,l,f,s[p],s[p+1]);return Ya(e,l,f,d,Pt(_)?e.length:d+_),l}return Ya(e,l,f),l}function m_(i){const e=i.options.offset,t=i._tickSize(),o=i._length/t+(e?0:1),n=i._maxLength/t;return Math.floor(Math.min(o,n))}function __(i,e,t){const o=b_(i),n=e.length/t;if(!o)return Math.max(n,1);const s=lg(o);for(let a=0,c=s.length-1;a<c;a++){const d=s[a];if(d>n)return d}return Math.max(n,1)}function y_(i){const e=[];let t,o;for(t=0,o=i.length;t<o;t++)i[t].major&&e.push(t);return e}function v_(i,e,t,o){let n=0,s=t[0],a;for(o=Math.ceil(o),a=0;a<i.length;a++)a===s&&(e.push(i[a]),n++,s=t[n*o])}function Ya(i,e,t,o,n){const s=pt(o,0),a=Math.min(pt(n,i.length),i.length);let c=0,d,l,f;for(t=Math.ceil(t),n&&(d=n-o,t=d/Math.floor(d/t)),f=s;f<0;)c++,f=Math.round(s+c*t);for(l=Math.max(s,0);l<a;l++)l===f&&(e.push(i[l]),c++,f=Math.round(s+c*t))}function b_(i){const e=i.length;let t,o;if(e<2)return!1;for(o=i[0],t=1;t<e;++t)if(i[t]-i[t-1]!==o)return!1;return o}const x_=i=>i==="left"?"right":i==="right"?"left":i,qc=(i,e,t)=>e==="top"||e==="left"?i[e]+t:i[e]-t;function Gc(i,e){const t=[],o=i.length/e,n=i.length;let s=0;for(;s<n;s+=o)t.push(i[Math.floor(s)]);return t}function w_(i,e,t){const o=i.ticks.length,n=Math.min(e,o-1),s=i._startPixel,a=i._endPixel,c=1e-6;let d=i.getPixelForTick(n),l;if(!(t&&(o===1?l=Math.max(d-s,a-d):e===0?l=(i.getPixelForTick(1)-d)/2:l=(d-i.getPixelForTick(n-1))/2,d+=n<e?l:-l,d<s-c||d>a+c)))return d}function C_(i,e){jt(i,t=>{const o=t.gc,n=o.length/2;let s;if(n>e){for(s=0;s<n;++s)delete t.data[o[s]];o.splice(0,n)}})}function na(i){return i.drawTicks?i.tickLength:0}function Yc(i,e){if(!i.display)return 0;const t=Mn(i.font,e),o=si(i.padding);return(Xt(i.text)?i.text.length:1)*t.lineHeight+o.height}function L_(i,e){return So(i,{scale:e,type:"scale"})}function S_(i,e,t){return So(i,{tick:t,index:e,type:"tick"})}function M_(i,e,t){let o=ku(i);return(t&&e!=="right"||!t&&e==="right")&&(o=x_(o)),o}function T_(i,e,t,o){const{top:n,left:s,bottom:a,right:c,chart:d}=i,{chartArea:l,scales:f}=d;let p=0,m,_,b;const x=a-n,A=c-s;if(i.isHorizontal()){if(_=ni(o,s,c),wt(t)){const S=Object.keys(t)[0],E=t[S];b=f[S].getPixelForValue(E)+x-e}else t==="center"?b=(l.bottom+l.top)/2+x-e:b=qc(i,t,e);m=c-s}else{if(wt(t)){const S=Object.keys(t)[0],E=t[S];_=f[S].getPixelForValue(E)-A+e}else t==="center"?_=(l.left+l.right)/2-A+e:_=qc(i,t,e);b=ni(o,a,n),p=t==="left"?-un:un}return{titleX:_,titleY:b,maxWidth:m,rotation:p}}class hs extends eo{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:o,_suggestedMax:n}=this;return e=ki(e,Number.POSITIVE_INFINITY),t=ki(t,Number.NEGATIVE_INFINITY),o=ki(o,Number.POSITIVE_INFINITY),n=ki(n,Number.NEGATIVE_INFINITY),{min:ki(e,o),max:ki(t,n),minDefined:ln(e),maxDefined:ln(t)}}getMinMax(e){let{min:t,max:o,minDefined:n,maxDefined:s}=this.getUserBounds(),a;if(n&&s)return{min:t,max:o};const c=this.getMatchingVisibleMetas();for(let d=0,l=c.length;d<l;++d)a=c[d].controller.getMinMax(this,e),n||(t=Math.min(t,a.min)),s||(o=Math.max(o,a.max));return t=s&&t>o?o:t,o=n&&t>o?t:o,{min:ki(t,ki(o,t)),max:ki(o,ki(t,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Zt(this.options.beforeUpdate,[this])}update(e,t,o){const{beginAtZero:n,grace:s,ticks:a}=this.options,c=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=o=Object.assign({left:0,right:0,top:0,bottom:0},o),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+o.left+o.right:this.height+o.top+o.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Ig(this,s,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const d=c<this.ticks.length;this._convertTicksToLabels(d?Gc(this.ticks,c):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=g_(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),d&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,o;this.isHorizontal()?(t=this.left,o=this.right):(t=this.top,o=this.bottom,e=!e),this._startPixel=t,this._endPixel=o,this._reversePixels=e,this._length=o-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Zt(this.options.afterUpdate,[this])}beforeSetDimensions(){Zt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Zt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Zt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Zt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let o,n,s;for(o=0,n=e.length;o<n;o++)s=e[o],s.label=Zt(t.callback,[s.value,o,e],this)}afterTickToLabelConversion(){Zt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Zt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,o=this.ticks.length,n=t.minRotation||0,s=t.maxRotation;let a=n,c,d,l;if(!this._isVisible()||!t.display||n>=s||o<=1||!this.isHorizontal()){this.labelRotation=n;return}const f=this._getLabelSizes(),p=f.widest.width,m=f.highest.height,_=In(this.chart.width-p,0,this.maxWidth);c=e.offset?this.maxWidth/o:_/(o-1),p+6>c&&(c=_/(o-(e.offset?.5:1)),d=this.maxHeight-na(e.grid)-t.padding-Yc(e.title,this.chart.options.font),l=Math.sqrt(p*p+m*m),a=Au(Math.min(Math.asin(In((f.highest.height+6)/c,-1,1)),Math.asin(In(d/l,-1,1))-Math.asin(In(m/l,-1,1)))),a=Math.max(n,Math.min(s,a))),this.labelRotation=a}afterCalculateLabelRotation(){Zt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Zt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:o,title:n,grid:s}}=this,a=this._isVisible(),c=this.isHorizontal();if(a){const d=Yc(n,t.options.font);if(c?(e.width=this.maxWidth,e.height=na(s)+d):(e.height=this.maxHeight,e.width=na(s)+d),o.display&&this.ticks.length){const{first:l,last:f,widest:p,highest:m}=this._getLabelSizes(),_=o.padding*2,b=ir(this.labelRotation),x=Math.cos(b),A=Math.sin(b);if(c){const S=o.mirror?0:A*p.width+x*m.height;e.height=Math.min(this.maxHeight,e.height+S+_)}else{const S=o.mirror?0:x*p.width+A*m.height;e.width=Math.min(this.maxWidth,e.width+S+_)}this._calculatePadding(l,f,A,x)}}this._handleMargins(),c?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,o,n){const{ticks:{align:s,padding:a},position:c}=this.options,d=this.labelRotation!==0,l=c!=="top"&&this.axis==="x";if(this.isHorizontal()){const f=this.getPixelForTick(0)-this.left,p=this.right-this.getPixelForTick(this.ticks.length-1);let m=0,_=0;d?l?(m=n*e.width,_=o*t.height):(m=o*e.height,_=n*t.width):s==="start"?_=t.width:s==="end"?m=e.width:s!=="inner"&&(m=e.width/2,_=t.width/2),this.paddingLeft=Math.max((m-f+a)*this.width/(this.width-f),0),this.paddingRight=Math.max((_-p+a)*this.width/(this.width-p),0)}else{let f=t.height/2,p=e.height/2;s==="start"?(f=0,p=e.height):s==="end"&&(f=t.height,p=0),this.paddingTop=f+a,this.paddingBottom=p+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Zt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,o;for(t=0,o=e.length;t<o;t++)Pt(e[t].label)&&(e.splice(t,1),o--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let o=this.ticks;t<o.length&&(o=Gc(o,t)),this._labelSizes=e=this._computeLabelSizes(o,o.length)}return e}_computeLabelSizes(e,t){const{ctx:o,_longestTextCache:n}=this,s=[],a=[];let c=0,d=0,l,f,p,m,_,b,x,A,S,E,F;for(l=0;l<t;++l){if(m=e[l].label,_=this._resolveTickFontOptions(l),o.font=b=_.string,x=n[b]=n[b]||{data:{},gc:[]},A=_.lineHeight,S=E=0,!Pt(m)&&!Xt(m))S=vl(o,x.data,x.gc,S,m),E=A;else if(Xt(m))for(f=0,p=m.length;f<p;++f)F=m[f],!Pt(F)&&!Xt(F)&&(S=vl(o,x.data,x.gc,S,F),E+=A);s.push(S),a.push(E),c=Math.max(S,c),d=Math.max(E,d)}C_(n,t);const v=s.indexOf(c),P=a.indexOf(d),G=$=>({width:s[$]||0,height:a[$]||0});return{first:G(0),last:G(t-1),widest:G(v),highest:G(P),widths:s,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return hg(this._alignToPixels?Jo(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const o=t[e];return o.$context||(o.$context=S_(this.getContext(),e,o))}return this.$context||(this.$context=L_(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=ir(this.labelRotation),o=Math.abs(Math.cos(t)),n=Math.abs(Math.sin(t)),s=this._getLabelSizes(),a=e.autoSkipPadding||0,c=s?s.widest.width+a:0,d=s?s.highest.height+a:0;return this.isHorizontal()?d*o>c*n?c/o:d/n:d*n<c*o?d/o:c/n}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,o=this.chart,n=this.options,{grid:s,position:a,border:c}=n,d=s.offset,l=this.isHorizontal(),p=this.ticks.length+(d?1:0),m=na(s),_=[],b=c.setContext(this.getContext()),x=b.display?b.width:0,A=x/2,S=function(we){return Jo(o,we,x)};let E,F,v,P,G,$,Z,ie,le,X,oe,_e;if(a==="top")E=S(this.bottom),$=this.bottom-m,ie=E-A,X=S(e.top)+A,_e=e.bottom;else if(a==="bottom")E=S(this.top),X=e.top,_e=S(e.bottom)-A,$=E+A,ie=this.top+m;else if(a==="left")E=S(this.right),G=this.right-m,Z=E-A,le=S(e.left)+A,oe=e.right;else if(a==="right")E=S(this.left),le=e.left,oe=S(e.right)-A,G=E+A,Z=this.left+m;else if(t==="x"){if(a==="center")E=S((e.top+e.bottom)/2+.5);else if(wt(a)){const we=Object.keys(a)[0],Ue=a[we];E=S(this.chart.scales[we].getPixelForValue(Ue))}X=e.top,_e=e.bottom,$=E+A,ie=$+m}else if(t==="y"){if(a==="center")E=S((e.left+e.right)/2);else if(wt(a)){const we=Object.keys(a)[0],Ue=a[we];E=S(this.chart.scales[we].getPixelForValue(Ue))}G=E-A,Z=G-m,le=e.left,oe=e.right}const Re=pt(n.ticks.maxTicksLimit,p),Se=Math.max(1,Math.ceil(p/Re));for(F=0;F<p;F+=Se){const we=this.getContext(F),Ue=s.setContext(we),Oe=c.setContext(we),Ft=Ue.lineWidth,Ne=Ue.color,it=Oe.dash||[],Me=Oe.dashOffset,Et=Ue.tickWidth,mt=Ue.tickColor,et=Ue.tickBorderDash||[],Ke=Ue.tickBorderDashOffset;v=w_(this,F,d),v!==void 0&&(P=Jo(o,v,Ft),l?G=Z=le=oe=P:$=ie=X=_e=P,_.push({tx1:G,ty1:$,tx2:Z,ty2:ie,x1:le,y1:X,x2:oe,y2:_e,width:Ft,color:Ne,borderDash:it,borderDashOffset:Me,tickWidth:Et,tickColor:mt,tickBorderDash:et,tickBorderDashOffset:Ke}))}return this._ticksLength=p,this._borderValue=E,_}_computeLabelItems(e){const t=this.axis,o=this.options,{position:n,ticks:s}=o,a=this.isHorizontal(),c=this.ticks,{align:d,crossAlign:l,padding:f,mirror:p}=s,m=na(o.grid),_=m+f,b=p?-f:_,x=-ir(this.labelRotation),A=[];let S,E,F,v,P,G,$,Z,ie,le,X,oe,_e="middle";if(n==="top")G=this.bottom-b,$=this._getXAxisLabelAlignment();else if(n==="bottom")G=this.top+b,$=this._getXAxisLabelAlignment();else if(n==="left"){const Se=this._getYAxisLabelAlignment(m);$=Se.textAlign,P=Se.x}else if(n==="right"){const Se=this._getYAxisLabelAlignment(m);$=Se.textAlign,P=Se.x}else if(t==="x"){if(n==="center")G=(e.top+e.bottom)/2+_;else if(wt(n)){const Se=Object.keys(n)[0],we=n[Se];G=this.chart.scales[Se].getPixelForValue(we)+_}$=this._getXAxisLabelAlignment()}else if(t==="y"){if(n==="center")P=(e.left+e.right)/2-_;else if(wt(n)){const Se=Object.keys(n)[0],we=n[Se];P=this.chart.scales[Se].getPixelForValue(we)}$=this._getYAxisLabelAlignment(m).textAlign}t==="y"&&(d==="start"?_e="top":d==="end"&&(_e="bottom"));const Re=this._getLabelSizes();for(S=0,E=c.length;S<E;++S){F=c[S],v=F.label;const Se=s.setContext(this.getContext(S));Z=this.getPixelForTick(S)+s.labelOffset,ie=this._resolveTickFontOptions(S),le=ie.lineHeight,X=Xt(v)?v.length:1;const we=X/2,Ue=Se.color,Oe=Se.textStrokeColor,Ft=Se.textStrokeWidth;let Ne=$;a?(P=Z,$==="inner"&&(S===E-1?Ne=this.options.reverse?"left":"right":S===0?Ne=this.options.reverse?"right":"left":Ne="center"),n==="top"?l==="near"||x!==0?oe=-X*le+le/2:l==="center"?oe=-Re.highest.height/2-we*le+le:oe=-Re.highest.height+le/2:l==="near"||x!==0?oe=le/2:l==="center"?oe=Re.highest.height/2-we*le:oe=Re.highest.height-X*le,p&&(oe*=-1),x!==0&&!Se.showLabelBackdrop&&(P+=le/2*Math.sin(x))):(G=Z,oe=(1-X)*le/2);let it;if(Se.showLabelBackdrop){const Me=si(Se.backdropPadding),Et=Re.heights[S],mt=Re.widths[S];let et=oe-Me.top,Ke=0-Me.left;switch(_e){case"middle":et-=Et/2;break;case"bottom":et-=Et;break}switch($){case"center":Ke-=mt/2;break;case"right":Ke-=mt;break}it={left:Ke,top:et,width:mt+Me.width,height:Et+Me.height,color:Se.backdropColor}}A.push({label:v,font:ie,textOffset:oe,options:{rotation:x,color:Ue,strokeColor:Oe,strokeWidth:Ft,textAlign:Ne,textBaseline:_e,translation:[P,G],backdrop:it}})}return A}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-ir(this.labelRotation))return e==="top"?"left":"right";let n="center";return t.align==="start"?n="left":t.align==="end"?n="right":t.align==="inner"&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:o,mirror:n,padding:s}}=this.options,a=this._getLabelSizes(),c=e+s,d=a.widest.width;let l,f;return t==="left"?n?(f=this.right+s,o==="near"?l="left":o==="center"?(l="center",f+=d/2):(l="right",f+=d)):(f=this.right-c,o==="near"?l="right":o==="center"?(l="center",f-=d/2):(l="left",f=this.left)):t==="right"?n?(f=this.left+s,o==="near"?l="right":o==="center"?(l="center",f-=d/2):(l="left",f-=d)):(f=this.left+c,o==="near"?l="left":o==="center"?(l="center",f+=d/2):(l="right",f=this.right)):l="right",{textAlign:l,x:f}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:o,top:n,width:s,height:a}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(o,n,s,a),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const n=this.ticks.findIndex(s=>s.value===e);return n>=0?t.setContext(this.getContext(n)).lineWidth:0}drawGrid(e){const t=this.options.grid,o=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,a;const c=(d,l,f)=>{!f.width||!f.color||(o.save(),o.lineWidth=f.width,o.strokeStyle=f.color,o.setLineDash(f.borderDash||[]),o.lineDashOffset=f.borderDashOffset,o.beginPath(),o.moveTo(d.x,d.y),o.lineTo(l.x,l.y),o.stroke(),o.restore())};if(t.display)for(s=0,a=n.length;s<a;++s){const d=n[s];t.drawOnChartArea&&c({x:d.x1,y:d.y1},{x:d.x2,y:d.y2},d),t.drawTicks&&c({x:d.tx1,y:d.ty1},{x:d.tx2,y:d.ty2},{color:d.tickColor,width:d.tickWidth,borderDash:d.tickBorderDash,borderDashOffset:d.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:o,grid:n}}=this,s=o.setContext(this.getContext()),a=o.display?s.width:0;if(!a)return;const c=n.setContext(this.getContext(0)).lineWidth,d=this._borderValue;let l,f,p,m;this.isHorizontal()?(l=Jo(e,this.left,a)-a/2,f=Jo(e,this.right,c)+c/2,p=m=d):(p=Jo(e,this.top,a)-a/2,m=Jo(e,this.bottom,c)+c/2,l=f=d),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(l,p),t.lineTo(f,m),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const o=this.ctx,n=this._computeLabelArea();n&&El(o,n);const s=this.getLabelItems(e);for(const a of s){const c=a.options,d=a.font,l=a.label,f=a.textOffset;us(o,l,0,f,d,c)}n&&Al(o)}drawTitle(){const{ctx:e,options:{position:t,title:o,reverse:n}}=this;if(!o.display)return;const s=Mn(o.font),a=si(o.padding),c=o.align;let d=s.lineHeight/2;t==="bottom"||t==="center"||wt(t)?(d+=a.bottom,Xt(o.text)&&(d+=s.lineHeight*(o.text.length-1))):d+=a.top;const{titleX:l,titleY:f,maxWidth:p,rotation:m}=T_(this,d,t,c);us(e,o.text,0,0,s,{color:o.color,maxWidth:p,rotation:m,textAlign:M_(c,t,n),textBaseline:"middle",translation:[l,f]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,o=pt(e.grid&&e.grid.z,-1),n=pt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==hs.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:o,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),o=this.axis+"AxisID",n=[];let s,a;for(s=0,a=t.length;s<a;++s){const c=t[s];c[o]===this.id&&(!e||c.type===e)&&n.push(c)}return n}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Mn(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Ka{constructor(e,t,o){this.type=e,this.scope=t,this.override=o,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let o;A_(t)&&(o=this.register(t));const n=this.items,s=e.id,a=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in n||(n[s]=e,P_(e,a,o),this.override&&hn.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const t=this.items,o=e.id,n=this.scope;o in t&&delete t[o],n&&o in hn[n]&&(delete hn[n][o],this.override&&delete ls[o])}}function P_(i,e,t){const o=ba(Object.create(null),[t?hn.get(t):{},hn.get(e),i.defaults]);hn.set(e,o),i.defaultRoutes&&E_(e,i.defaultRoutes),i.descriptors&&hn.describe(e,i.descriptors)}function E_(i,e){Object.keys(e).forEach(t=>{const o=t.split("."),n=o.pop(),s=[i].concat(o).join("."),a=e[t].split("."),c=a.pop(),d=a.join(".");hn.route(s,n,d,c)})}function A_(i){return"id"in i&&"defaults"in i}class O_{constructor(){this.controllers=new Ka(rr,"datasets",!0),this.elements=new Ka(eo,"elements"),this.plugins=new Ka(Object,"plugins"),this.scales=new Ka(hs,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,o){[...t].forEach(n=>{const s=o||this._getRegistryForType(n);o||s.isForType(n)||s===this.plugins&&n.id?this._exec(e,s,n):jt(n,a=>{const c=o||this._getRegistryForType(a);this._exec(e,c,a)})})}_exec(e,t,o){const n=Eu(e);Zt(o["before"+n],[],o),t[e](o),Zt(o["after"+n],[],o)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const o=this._typedRegistries[t];if(o.isForType(e))return o}return this.plugins}_get(e,t,o){const n=t.get(e);if(n===void 0)throw new Error('"'+e+'" is not a registered '+o+".");return n}}var Cr=new O_;class k_{constructor(){this._init=[]}notify(e,t,o,n){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=n?this._descriptors(e).filter(n):this._descriptors(e),a=this._notify(s,e,t,o);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),a}_notify(e,t,o,n){n=n||{};for(const s of e){const a=s.plugin,c=a[o],d=[t,n,s.options];if(Zt(c,d,a)===!1&&n.cancelable)return!1}return!0}invalidate(){Pt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const o=e&&e.config,n=pt(o.options&&o.options.plugins,{}),s=R_(o);return n===!1&&!t?[]:D_(e,s,n,t)}_notifyStateChanges(e){const t=this._oldCache||[],o=this._cache,n=(s,a)=>s.filter(c=>!a.some(d=>c.plugin.id===d.plugin.id));this._notify(n(t,o),e,"stop"),this._notify(n(o,t),e,"start")}}function R_(i){const e={},t=[],o=Object.keys(Cr.plugins.items);for(let s=0;s<o.length;s++)t.push(Cr.getPlugin(o[s]));const n=i.plugins||[];for(let s=0;s<n.length;s++){const a=n[s];t.indexOf(a)===-1&&(t.push(a),e[a.id]=!0)}return{plugins:t,localIds:e}}function B_(i,e){return!e&&i===!1?null:i===!0?{}:i}function D_(i,{plugins:e,localIds:t},o,n){const s=[],a=i.getContext();for(const c of e){const d=c.id,l=B_(o[d],n);l!==null&&s.push({plugin:c,options:I_(i.config,{plugin:c,local:t[d]},l,a)})}return s}function I_(i,{plugin:e,local:t},o,n){const s=i.pluginScopeKeys(e),a=i.getOptionScopes(o,s);return t&&e.defaults&&a.push(e.defaults),i.createResolver(a,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function gu(i,e){const t=hn.datasets[i]||{};return((e.datasets||{})[i]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function F_(i,e){let t=i;return i==="_index_"?t=e:i==="_value_"&&(t=e==="x"?"y":"x"),t}function N_(i,e){return i===e?"_index_":"_value_"}function z_(i){if(i==="top"||i==="bottom")return"x";if(i==="left"||i==="right")return"y"}function wl(i,e){if(i==="x"||i==="y"||i==="r"||(i=e.axis||z_(e.position)||i.length>1&&wl(i[0].toLowerCase(),e),i))return i;throw new Error(`Cannot determine type of '${name}' axis. Please provide 'axis' or 'position' option.`)}function j_(i,e){const t=ls[i.type]||{scales:{}},o=e.scales||{},n=gu(i.type,e),s=Object.create(null);return Object.keys(o).forEach(a=>{const c=o[a];if(!wt(c))return console.error(`Invalid scale configuration for scale: ${a}`);if(c._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const d=wl(a,c),l=N_(d,n),f=t.scales||{};s[a]=fa(Object.create(null),[{axis:d},c,f[d],f[l]])}),i.data.datasets.forEach(a=>{const c=a.type||i.type,d=a.indexAxis||gu(c,e),f=(ls[c]||{}).scales||{};Object.keys(f).forEach(p=>{const m=F_(p,d),_=a[m+"AxisID"]||m;s[_]=s[_]||Object.create(null),fa(s[_],[{axis:m},o[_],f[p]])})}),Object.keys(s).forEach(a=>{const c=s[a];fa(c,[hn.scales[c.type],hn.scale])}),s}function yf(i){const e=i.options||(i.options={});e.plugins=pt(e.plugins,{}),e.scales=j_(i,e)}function vf(i){return i=i||{},i.datasets=i.datasets||[],i.labels=i.labels||[],i}function H_(i){return i=i||{},i.data=vf(i.data),yf(i),i}const Kc=new Map,bf=new Set;function Xa(i,e){let t=Kc.get(i);return t||(t=e(),Kc.set(i,t),bf.add(t)),t}const ia=(i,e,t)=>{const o=Co(e,t);o!==void 0&&i.add(o)};class U_{constructor(e){this._config=H_(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=vf(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),yf(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Xa(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Xa(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Xa(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,o=this.type;return Xa(`${o}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const o=this._scopeCache;let n=o.get(e);return(!n||t)&&(n=new Map,o.set(e,n)),n}getOptionScopes(e,t,o){const{options:n,type:s}=this,a=this._cachedScopes(e,o),c=a.get(t);if(c)return c;const d=new Set;t.forEach(f=>{e&&(d.add(e),f.forEach(p=>ia(d,e,p))),f.forEach(p=>ia(d,n,p)),f.forEach(p=>ia(d,ls[s]||{},p)),f.forEach(p=>ia(d,hn,p)),f.forEach(p=>ia(d,fu,p))});const l=Array.from(d);return l.length===0&&l.push(Object.create(null)),bf.has(t)&&a.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,ls[t]||{},hn.datasets[t]||{},{type:t},hn,fu]}resolveNamedOptions(e,t,o,n=[""]){const s={$shared:!0},{resolver:a,subPrefixes:c}=Xc(this._resolverCache,e,n);let d=a;if(V_(a,t)){s.$shared=!1,o=Lo(o)?o():o;const l=this.createResolver(e,o,c);d=ks(a,o,l)}for(const l of t)s[l]=d[l];return s}createResolver(e,t,o=[""],n){const{resolver:s}=Xc(this._resolverCache,e,o);return wt(t)?ks(s,t,void 0,n):s}}function Xc(i,e,t){let o=i.get(e);o||(o=new Map,i.set(e,o));const n=t.join();let s=o.get(n);return s||(s={resolver:Bu(e,t),subPrefixes:t.filter(c=>!c.toLowerCase().includes("hover"))},o.set(n,s)),s}const W_=i=>wt(i)&&Object.getOwnPropertyNames(i).reduce((e,t)=>e||Lo(i[t]),!1);function V_(i,e){const{isScriptable:t,isIndexable:o}=Qh(i);for(const n of e){const s=t(n),a=o(n),c=(a||s)&&i[n];if(s&&(Lo(c)||W_(c))||a&&Xt(c))return!0}return!1}var Z_="4.1.2";const q_=["top","bottom","left","right","chartArea"];function Qc(i,e){return i==="top"||i==="bottom"||q_.indexOf(i)===-1&&e==="x"}function Jc(i,e){return function(t,o){return t[i]===o[i]?t[e]-o[e]:t[i]-o[i]}}function $c(i){const e=i.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Zt(t&&t.onComplete,[i],e)}function G_(i){const e=i.chart,t=e.options.animation;Zt(t&&t.onProgress,[i],e)}function xf(i){return rf()&&typeof i=="string"?i=document.getElementById(i):i&&i.length&&(i=i[0]),i&&i.canvas&&(i=i.canvas),i}const ul={},eh=i=>{const e=xf(i);return Object.values(ul).filter(t=>t.canvas===e).pop()};function Y_(i,e,t){const o=Object.keys(i);for(const n of o){const s=+n;if(s>=e){const a=i[n];delete i[n],(t>0||s>e)&&(i[s+t]=a)}}}function K_(i,e,t,o){return!t||i.type==="mouseout"?null:o?e:i}function X_(i){const{xScale:e,yScale:t}=i;if(e&&t)return{left:e.left,right:e.right,top:t.top,bottom:t.bottom}}class Bi{static register(...e){Cr.add(...e),th()}static unregister(...e){Cr.remove(...e),th()}constructor(e,t){const o=this.config=new U_(t),n=xf(e),s=eh(n);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const a=o.createResolver(o.chartOptionScopes(),this.getContext());this.platform=new(o.platform||p_(n)),this.platform.updateConfig(o);const c=this.platform.acquireContext(n,a.aspectRatio),d=c&&c.canvas,l=d&&d.height,f=d&&d.width;if(this.id=$p(),this.ctx=c,this.canvas=d,this.width=f,this.height=l,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new k_,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=gg(p=>this.update(p),a.resizeDelay||0),this._dataChanges=[],ul[this.id]=this,!c||!d){console.error("Failed to create chart: can't acquire context from the given item");return}Yr.listen(this,"complete",$c),Yr.listen(this,"progress",G_),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:o,height:n,_aspectRatio:s}=this;return Pt(e)?t&&s?s:n?o/n:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Cr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Sc(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return wc(this.canvas,this.ctx),this}stop(){return Yr.stop(this),this}resize(e,t){Yr.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const o=this.options,n=this.canvas,s=o.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(n,e,t,s),c=o.devicePixelRatio||this.platform.getDevicePixelRatio(),d=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,Sc(this,c,!0)&&(this.notifyPlugins("resize",{size:a}),Zt(o.onResize,[this,a],this),this.attached&&this._doResize(d)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};jt(t,(o,n)=>{o.id=n})}buildOrUpdateScales(){const e=this.options,t=e.scales,o=this.scales,n=Object.keys(o).reduce((a,c)=>(a[c]=!1,a),{});let s=[];t&&(s=s.concat(Object.keys(t).map(a=>{const c=t[a],d=wl(a,c),l=d==="r",f=d==="x";return{options:c,dposition:l?"chartArea":f?"bottom":"left",dtype:l?"radialLinear":f?"category":"linear"}}))),jt(s,a=>{const c=a.options,d=c.id,l=wl(d,c),f=pt(c.type,a.dtype);(c.position===void 0||Qc(c.position,l)!==Qc(a.dposition))&&(c.position=a.dposition),n[d]=!0;let p=null;if(d in o&&o[d].type===f)p=o[d];else{const m=Cr.getScale(f);p=new m({id:d,type:f,ctx:this.ctx,chart:this}),o[p.id]=p}p.init(c,e)}),jt(n,(a,c)=>{a||delete o[c]}),jt(o,a=>{oi.configure(this,a,a.options),oi.addBox(this,a)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,o=e.length;if(e.sort((n,s)=>n.index-s.index),o>t){for(let n=t;n<o;++n)this._destroyDatasetMeta(n);e.splice(t,o-t)}this._sortedMetasets=e.slice(0).sort(Jc("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((o,n)=>{t.filter(s=>s===o._dataset).length===0&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let o,n;for(this._removeUnreferencedMetasets(),o=0,n=t.length;o<n;o++){const s=t[o];let a=this.getDatasetMeta(o);const c=s.type||this.config.type;if(a.type&&a.type!==c&&(this._destroyDatasetMeta(o),a=this.getDatasetMeta(o)),a.type=c,a.indexAxis=s.indexAxis||gu(c,this.options),a.order=s.order||0,a.index=o,a.label=""+s.label,a.visible=this.isDatasetVisible(o),a.controller)a.controller.updateIndex(o),a.controller.linkScales();else{const d=Cr.getController(c),{datasetElementType:l,dataElementType:f}=hn.datasets[c];Object.assign(d,{dataElementType:Cr.getElement(f),datasetElementType:l&&Cr.getElement(l)}),a.controller=new d(this,o),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){jt(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const o=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!o.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let l=0,f=this.data.datasets.length;l<f;l++){const{controller:p}=this.getDatasetMeta(l),m=!n&&s.indexOf(p)===-1;p.buildOrUpdateElements(m),a=Math.max(+p.getMaxOverflow(),a)}a=this._minPadding=o.layout.autoPadding?a:0,this._updateLayout(a),n||jt(s,l=>{l.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Jc("z","_idx"));const{_active:c,_lastEvent:d}=this;d?this._eventHandler(d,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){jt(this.scales,e=>{oi.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),o=new Set(e.events);(!dc(t,o)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:o,start:n,count:s}of t){const a=o==="_removeElements"?-s:s;Y_(e,n,a)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,o=s=>new Set(e.filter(a=>a[0]===s).map((a,c)=>c+","+a.splice(1).join(","))),n=o(0);for(let s=1;s<t;s++)if(!dc(n,o(s)))return;return Array.from(n).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;oi.update(this,this.width,this.height,e);const t=this.chartArea,o=t.width<=0||t.height<=0;this._layers=[],jt(this.boxes,n=>{o&&n.position==="chartArea"||(n.configure&&n.configure(),this._layers.push(...n._layers()))},this),this._layers.forEach((n,s)=>{n._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,o=this.data.datasets.length;t<o;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,o=this.data.datasets.length;t<o;++t)this._updateDataset(t,Lo(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const o=this.getDatasetMeta(e),n={meta:o,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",n)!==!1&&(o.controller._update(t),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Yr.has(this)?this.attached&&!Yr.running(this)&&Yr.start(this):(this.draw(),$c({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:o,height:n}=this._resizeBeforeDraw;this._resize(o,n),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,o=[];let n,s;for(n=0,s=t.length;n<s;++n){const a=t[n];(!e||a.visible)&&o.push(a)}return o}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,o=e._clip,n=!o.disabled,s=X_(e)||this.chartArea,a={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(n&&El(t,{left:o.left===!1?0:s.left-o.left,right:o.right===!1?this.width:s.right+o.right,top:o.top===!1?0:s.top-o.top,bottom:o.bottom===!1?this.height:s.bottom+o.bottom}),e.controller.draw(),n&&Al(t),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(e){return wa(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,o,n){const s=Gm.modes[t];return typeof s=="function"?s(this,e,o,n):[]}getDatasetMeta(e){const t=this.data.datasets[e],o=this._metasets;let n=o.filter(s=>s&&s._dataset===t).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},o.push(n)),n}getContext(){return this.$context||(this.$context=So(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const o=this.getDatasetMeta(e);return typeof o.hidden=="boolean"?!o.hidden:!t.hidden}setDatasetVisibility(e,t){const o=this.getDatasetMeta(e);o.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,o){const n=o?"show":"hide",s=this.getDatasetMeta(e),a=s.controller._resolveAnimations(void 0,n);Wi(t)?(s.data[t].hidden=!o,this.update()):(this.setDatasetVisibility(e,o),a.update(s,{visible:o}),this.update(c=>c.datasetIndex===e?n:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Yr.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),wc(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete ul[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,o=(s,a)=>{t.addEventListener(this,s,a),e[s]=a},n=(s,a,c)=>{s.offsetX=a,s.offsetY=c,this._eventHandler(s)};jt(this.options.events,s=>o(s,n))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,o=(d,l)=>{t.addEventListener(this,d,l),e[d]=l},n=(d,l)=>{e[d]&&(t.removeEventListener(this,d,l),delete e[d])},s=(d,l)=>{this.canvas&&this.resize(d,l)};let a;const c=()=>{n("attach",c),this.attached=!0,this.resize(),o("resize",s),o("detach",a)};a=()=>{this.attached=!1,n("resize",s),this._stop(),this._resize(0,0),o("attach",c)},t.isAttached(this.canvas)?c():a()}unbindEvents(){jt(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},jt(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,o){const n=o?"set":"remove";let s,a,c,d;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+n+"DatasetHoverStyle"]()),c=0,d=e.length;c<d;++c){a=e[c];const l=a&&this.getDatasetMeta(a.datasetIndex).controller;l&&l[n+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],o=e.map(({datasetIndex:s,index:a})=>{const c=this.getDatasetMeta(s);if(!c)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:c.data[a],index:a}});!ml(o,t)&&(this._active=o,this._lastEvent=null,this._updateHoverStyles(o,t))}notifyPlugins(e,t,o){return this._plugins.notify(this,e,t,o)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,o){const n=this.options.hover,s=(d,l)=>d.filter(f=>!l.some(p=>f.datasetIndex===p.datasetIndex&&f.index===p.index)),a=s(t,e),c=o?e:s(e,t);a.length&&this.updateHoverStyle(a,n.mode,!1),c.length&&n.mode&&this.updateHoverStyle(c,n.mode,!0)}_eventHandler(e,t){const o={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},n=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",o,n)===!1)return;const s=this._handleEvent(e,t,o.inChartArea);return o.cancelable=!1,this.notifyPlugins("afterEvent",o,n),(s||o.changed)&&this.render(),this}_handleEvent(e,t,o){const{_active:n=[],options:s}=this,a=t,c=this._getActiveElements(e,n,o,a),d=og(e),l=K_(e,this._lastEvent,o,d);o&&(this._lastEvent=null,Zt(s.onHover,[e,c,this],this),d&&Zt(s.onClick,[e,c,this],this));const f=!ml(c,n);return(f||t)&&(this._active=c,this._updateHoverStyles(c,n,t)),this._lastEvent=l,f}_getActiveElements(e,t,o,n){if(e.type==="mouseout")return[];if(!o)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,n)}}Ie(Bi,"defaults",hn),Ie(Bi,"instances",ul),Ie(Bi,"overrides",ls),Ie(Bi,"registry",Cr),Ie(Bi,"version",Z_),Ie(Bi,"getChart",eh);function th(){return jt(Bi.instances,i=>i._plugins.invalidate())}function Q_(i,e,t){const{startAngle:o,pixelMargin:n,x:s,y:a,outerRadius:c,innerRadius:d}=e;let l=n/c;i.beginPath(),i.arc(s,a,c,o-l,t+l),d>n?(l=n/d,i.arc(s,a,d,t+l,o-l,!0)):i.arc(s,a,n,t+un,o-un),i.closePath(),i.clip()}function J_(i){return Ru(i,["outerStart","outerEnd","innerStart","innerEnd"])}function $_(i,e,t,o){const n=J_(i.options.borderRadius),s=(t-e)/2,a=Math.min(s,o*e/2),c=d=>{const l=(t-Math.min(s,d))*o/2;return In(d,0,Math.min(s,l))};return{outerStart:c(n.outerStart),outerEnd:c(n.outerEnd),innerStart:In(n.innerStart,0,a),innerEnd:In(n.innerEnd,0,a)}}function Es(i,e,t,o){return{x:t+i*Math.cos(e),y:o+i*Math.sin(e)}}function Cl(i,e,t,o,n,s){const{x:a,y:c,startAngle:d,pixelMargin:l,innerRadius:f}=e,p=Math.max(e.outerRadius+o+t-l,0),m=f>0?f+o+t+l:0;let _=0;const b=n-d;if(o){const Se=f>0?f-o:0,we=p>0?p-o:0,Ue=(Se+we)/2,Oe=Ue!==0?b*Ue/(Ue+o):b;_=(b-Oe)/2}const x=Math.max(.001,b*p-t/Jt)/p,A=(b-x)/2,S=d+A+_,E=n-A-_,{outerStart:F,outerEnd:v,innerStart:P,innerEnd:G}=$_(e,m,p,E-S),$=p-F,Z=p-v,ie=S+F/$,le=E-v/Z,X=m+P,oe=m+G,_e=S+P/X,Re=E-G/oe;if(i.beginPath(),s){const Se=(ie+le)/2;if(i.arc(a,c,p,ie,Se),i.arc(a,c,p,Se,le),v>0){const Ft=Es(Z,le,a,c);i.arc(Ft.x,Ft.y,v,le,E+un)}const we=Es(oe,E,a,c);if(i.lineTo(we.x,we.y),G>0){const Ft=Es(oe,Re,a,c);i.arc(Ft.x,Ft.y,G,E+un,Re+Math.PI)}const Ue=(E-G/m+(S+P/m))/2;if(i.arc(a,c,m,E-G/m,Ue,!0),i.arc(a,c,m,Ue,S+P/m,!0),P>0){const Ft=Es(X,_e,a,c);i.arc(Ft.x,Ft.y,P,_e+Math.PI,S-un)}const Oe=Es($,S,a,c);if(i.lineTo(Oe.x,Oe.y),F>0){const Ft=Es($,ie,a,c);i.arc(Ft.x,Ft.y,F,S-un,ie)}}else{i.moveTo(a,c);const Se=Math.cos(ie)*p+a,we=Math.sin(ie)*p+c;i.lineTo(Se,we);const Ue=Math.cos(le)*p+a,Oe=Math.sin(le)*p+c;i.lineTo(Ue,Oe)}i.closePath()}function ey(i,e,t,o,n){const{fullCircles:s,startAngle:a,circumference:c}=e;let d=e.endAngle;if(s){Cl(i,e,t,o,d,n);for(let l=0;l<s;++l)i.fill();isNaN(c)||(d=a+(c%Qt||Qt))}return Cl(i,e,t,o,d,n),i.fill(),d}function ty(i,e,t,o,n){const{fullCircles:s,startAngle:a,circumference:c,options:d}=e,{borderWidth:l,borderJoinStyle:f}=d,p=d.borderAlign==="inner";if(!l)return;p?(i.lineWidth=l*2,i.lineJoin=f||"round"):(i.lineWidth=l,i.lineJoin=f||"bevel");let m=e.endAngle;if(s){Cl(i,e,t,o,m,n);for(let _=0;_<s;++_)i.stroke();isNaN(c)||(m=a+(c%Qt||Qt))}p&&Q_(i,e,m),s||(Cl(i,e,t,o,m,n),i.stroke())}class cl extends eo{constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,o){const n=this.getProps(["x","y"],o),{angle:s,distance:a}=jh(n,{x:e,y:t}),{startAngle:c,endAngle:d,innerRadius:l,outerRadius:f,circumference:p}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],o),m=this.options.spacing/2,b=pt(p,d-c)>=Qt||xa(s,c,d),x=Qr(a,l+m,f+m);return b&&x}getCenterPoint(e){const{x:t,y:o,startAngle:n,endAngle:s,innerRadius:a,outerRadius:c}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],e),{offset:d,spacing:l}=this.options,f=(n+s)/2,p=(a+c+l+d)/2;return{x:t+Math.cos(f)*p,y:o+Math.sin(f)*p}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:o}=this,n=(t.offset||0)/4,s=(t.spacing||0)/2,a=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=o>Qt?Math.floor(o/Qt):0,o===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const c=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(c)*n,Math.sin(c)*n);const d=1-Math.sin(Math.min(Jt,o||0)),l=n*d;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,ey(e,this,l,s,a),ty(e,this,l,s,a),e.restore()}}Ie(cl,"id","arc"),Ie(cl,"defaults",{borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Ie(cl,"defaultRoutes",{backgroundColor:"backgroundColor"});function wf(i,e,t=e){i.lineCap=pt(t.borderCapStyle,e.borderCapStyle),i.setLineDash(pt(t.borderDash,e.borderDash)),i.lineDashOffset=pt(t.borderDashOffset,e.borderDashOffset),i.lineJoin=pt(t.borderJoinStyle,e.borderJoinStyle),i.lineWidth=pt(t.borderWidth,e.borderWidth),i.strokeStyle=pt(t.borderColor,e.borderColor)}function ny(i,e,t){i.lineTo(t.x,t.y)}function iy(i){return i.stepped?Tg:i.tension||i.cubicInterpolationMode==="monotone"?Pg:ny}function Cf(i,e,t={}){const o=i.length,{start:n=0,end:s=o-1}=t,{start:a,end:c}=e,d=Math.max(n,a),l=Math.min(s,c),f=n<a&&s<a||n>c&&s>c;return{count:o,start:d,loop:e.loop,ilen:l<d&&!f?o+l-d:l-d}}function ry(i,e,t,o){const{points:n,options:s}=e,{count:a,start:c,loop:d,ilen:l}=Cf(n,t,o),f=iy(s);let{move:p=!0,reverse:m}=o||{},_,b,x;for(_=0;_<=l;++_)b=n[(c+(m?l-_:_))%a],!b.skip&&(p?(i.moveTo(b.x,b.y),p=!1):f(i,x,b,m,s.stepped),x=b);return d&&(b=n[(c+(m?l:0))%a],f(i,x,b,m,s.stepped)),!!d}function oy(i,e,t,o){const n=e.points,{count:s,start:a,ilen:c}=Cf(n,t,o),{move:d=!0,reverse:l}=o||{};let f=0,p=0,m,_,b,x,A,S;const E=v=>(a+(l?c-v:v))%s,F=()=>{x!==A&&(i.lineTo(f,A),i.lineTo(f,x),i.lineTo(f,S))};for(d&&(_=n[E(0)],i.moveTo(_.x,_.y)),m=0;m<=c;++m){if(_=n[E(m)],_.skip)continue;const v=_.x,P=_.y,G=v|0;G===b?(P<x?x=P:P>A&&(A=P),f=(p*f+v)/++p):(F(),i.lineTo(v,P),b=G,p=0,x=A=P),S=P}F()}function mu(i){const e=i.options,t=e.borderDash&&e.borderDash.length;return!i._decimated&&!i._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?oy:ry}function sy(i){return i.stepped?sm:i.tension||i.cubicInterpolationMode==="monotone"?am:ns}function ay(i,e,t,o){let n=e._path;n||(n=e._path=new Path2D,e.path(n,t,o)&&n.closePath()),wf(i,e.options),i.stroke(n)}function ly(i,e,t,o){const{segments:n,options:s}=e,a=mu(e);for(const c of n)wf(i,s,c.style),i.beginPath(),a(i,e,c,{start:t,end:t+o-1})&&i.closePath(),i.stroke()}const uy=typeof Path2D=="function";function cy(i,e,t,o){uy&&!e.options.segment?ay(i,e,t,o):ly(i,e,t,o)}class bo extends eo{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const o=this.options;if((o.tension||o.cubicInterpolationMode==="monotone")&&!o.stepped&&!this._pointsUpdated){const n=o.spanGaps?this._loop:this._fullLoop;Jg(this._points,o,e,n,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=dm(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,o=e.length;return o&&t[e[o-1].end]}interpolate(e,t){const o=this.options,n=e[t],s=this.points,a=uf(this,{property:t,start:n,end:n});if(!a.length)return;const c=[],d=sy(o);let l,f;for(l=0,f=a.length;l<f;++l){const{start:p,end:m}=a[l],_=s[p],b=s[m];if(_===b){c.push(_);continue}const x=Math.abs((n-_[t])/(b[t]-_[t])),A=d(_,b,x,o.stepped);A[t]=e[t],c.push(A)}return c.length===1?c[0]:c}pathSegment(e,t,o){return mu(this)(e,this,t,o)}path(e,t,o){const n=this.segments,s=mu(this);let a=this._loop;t=t||0,o=o||this.points.length-t;for(const c of n)a&=s(e,this,c,{start:t,end:t+o-1});return!!a}draw(e,t,o,n){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),cy(e,this,o,n),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Ie(bo,"id","line"),Ie(bo,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Ie(bo,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Ie(bo,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function nh(i,e,t,o){const n=i.options,{[t]:s}=i.getProps([t],o);return Math.abs(e-s)<n.radius+n.hitRadius}class hl extends eo{constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,o){const n=this.options,{x:s,y:a}=this.getProps(["x","y"],o);return Math.pow(e-s,2)+Math.pow(t-a,2)<Math.pow(n.hitRadius+n.radius,2)}inXRange(e,t){return nh(this,e,"x",t)}inYRange(e,t){return nh(this,e,"y",t)}getCenterPoint(e){const{x:t,y:o}=this.getProps(["x","y"],e);return{x:t,y:o}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const o=t&&e.borderWidth||0;return(t+o)*2}draw(e,t){const o=this.options;this.skip||o.radius<.1||!wa(this,t,this.size(o)/2)||(e.strokeStyle=o.borderColor,e.lineWidth=o.borderWidth,e.fillStyle=o.backgroundColor,du(e,o,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}Ie(hl,"id","point"),Ie(hl,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Ie(hl,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function Lf(i,e){const{x:t,y:o,base:n,width:s,height:a}=i.getProps(["x","y","base","width","height"],e);let c,d,l,f,p;return i.horizontal?(p=a/2,c=Math.min(t,n),d=Math.max(t,n),l=o-p,f=o+p):(p=s/2,c=t-p,d=t+p,l=Math.min(o,n),f=Math.max(o,n)),{left:c,top:l,right:d,bottom:f}}function xo(i,e,t,o){return i?0:In(e,t,o)}function hy(i,e,t){const o=i.options.borderWidth,n=i.borderSkipped,s=Xh(o);return{t:xo(n.top,s.top,0,t),r:xo(n.right,s.right,0,e),b:xo(n.bottom,s.bottom,0,t),l:xo(n.left,s.left,0,e)}}function fy(i,e,t){const{enableBorderRadius:o}=i.getProps(["enableBorderRadius"]),n=i.options.borderRadius,s=ss(n),a=Math.min(e,t),c=i.borderSkipped,d=o||wt(n);return{topLeft:xo(!d||c.top||c.left,s.topLeft,0,a),topRight:xo(!d||c.top||c.right,s.topRight,0,a),bottomLeft:xo(!d||c.bottom||c.left,s.bottomLeft,0,a),bottomRight:xo(!d||c.bottom||c.right,s.bottomRight,0,a)}}function dy(i){const e=Lf(i),t=e.right-e.left,o=e.bottom-e.top,n=hy(i,t/2,o/2),s=fy(i,t/2,o/2);return{outer:{x:e.left,y:e.top,w:t,h:o,radius:s},inner:{x:e.left+n.l,y:e.top+n.t,w:t-n.l-n.r,h:o-n.t-n.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(n.t,n.l)),topRight:Math.max(0,s.topRight-Math.max(n.t,n.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(n.b,n.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(n.b,n.r))}}}}function nu(i,e,t,o){const n=e===null,s=t===null,c=i&&!(n&&s)&&Lf(i,o);return c&&(n||Qr(e,c.left,c.right))&&(s||Qr(t,c.top,c.bottom))}function py(i){return i.topLeft||i.topRight||i.bottomLeft||i.bottomRight}function gy(i,e){i.rect(e.x,e.y,e.w,e.h)}function iu(i,e,t={}){const o=i.x!==t.x?-e:0,n=i.y!==t.y?-e:0,s=(i.x+i.w!==t.x+t.w?e:0)-o,a=(i.y+i.h!==t.y+t.h?e:0)-n;return{x:i.x+o,y:i.y+n,w:i.w+s,h:i.h+a,radius:i.radius}}class fl extends eo{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:o,backgroundColor:n}}=this,{inner:s,outer:a}=dy(this),c=py(a.radius)?Ca:gy;e.save(),(a.w!==s.w||a.h!==s.h)&&(e.beginPath(),c(e,iu(a,t,s)),e.clip(),c(e,iu(s,-t,a)),e.fillStyle=o,e.fill("evenodd")),e.beginPath(),c(e,iu(s,t)),e.fillStyle=n,e.fill(),e.restore()}inRange(e,t,o){return nu(this,e,t,o)}inXRange(e,t){return nu(this,e,null,t)}inYRange(e,t){return nu(this,null,e,t)}getCenterPoint(e){const{x:t,y:o,base:n,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+n)/2:t,y:s?o:(o+n)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Ie(fl,"id","bar"),Ie(fl,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Ie(fl,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var my=Object.freeze({__proto__:null,ArcElement:cl,LineElement:bo,PointElement:hl,BarElement:fl});const _u=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],ih=_u.map(i=>i.replace("rgb(","rgba(").replace(")",", 0.5)"));function Sf(i){return _u[i%_u.length]}function Mf(i){return ih[i%ih.length]}function _y(i,e){return i.borderColor=Sf(e),i.backgroundColor=Mf(e),++e}function yy(i,e){return i.backgroundColor=i.data.map(()=>Sf(e++)),e}function vy(i,e){return i.backgroundColor=i.data.map(()=>Mf(e++)),e}function by(i){let e=0;return(t,o)=>{const n=i.getDatasetMeta(o).controller;n instanceof os?e=yy(t,e):n instanceof ma?e=vy(t,e):n&&(e=_y(t,e))}}function rh(i){let e;for(e in i)if(i[e].borderColor||i[e].backgroundColor)return!0;return!1}var xy={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(i,e,t){if(!t.enabled)return;const{options:{elements:o},data:{datasets:n}}=i.config;if(!t.forceOverride&&(rh(n)||o&&rh(o)))return;const s=by(i);n.forEach(s)}};function wy(i,e,t,o,n){const s=n.samples||o;if(s>=t)return i.slice(e,e+t);const a=[],c=(t-2)/(s-2);let d=0;const l=e+t-1;let f=e,p,m,_,b,x;for(a[d++]=i[f],p=0;p<s-2;p++){let A=0,S=0,E;const F=Math.floor((p+1)*c)+1+e,v=Math.min(Math.floor((p+2)*c)+1,t)+e,P=v-F;for(E=F;E<v;E++)A+=i[E].x,S+=i[E].y;A/=P,S/=P;const G=Math.floor(p*c)+1+e,$=Math.min(Math.floor((p+1)*c)+1,t)+e,{x:Z,y:ie}=i[f];for(_=b=-1,E=G;E<$;E++)b=.5*Math.abs((Z-A)*(i[E].y-ie)-(Z-i[E].x)*(S-ie)),b>_&&(_=b,m=i[E],x=E);a[d++]=m,f=x}return a[d++]=i[l],a}function Cy(i,e,t,o){let n=0,s=0,a,c,d,l,f,p,m,_,b,x;const A=[],S=e+t-1,E=i[e].x,v=i[S].x-E;for(a=e;a<e+t;++a){c=i[a],d=(c.x-E)/v*o,l=c.y;const P=d|0;if(P===f)l<b?(b=l,p=a):l>x&&(x=l,m=a),n=(s*n+c.x)/++s;else{const G=a-1;if(!Pt(p)&&!Pt(m)){const $=Math.min(p,m),Z=Math.max(p,m);$!==_&&$!==G&&A.push({...i[$],x:n}),Z!==_&&Z!==G&&A.push({...i[Z],x:n})}a>0&&G!==_&&A.push(i[G]),A.push(c),f=P,s=0,b=x=l,p=m=_=a}}return A}function Tf(i){if(i._decimated){const e=i._data;delete i._decimated,delete i._data,Object.defineProperty(i,"data",{value:e})}}function oh(i){i.data.datasets.forEach(e=>{Tf(e)})}function Ly(i,e){const t=e.length;let o=0,n;const{iScale:s}=i,{min:a,max:c,minDefined:d,maxDefined:l}=s.getUserBounds();return d&&(o=In(Jr(e,s.axis,a).lo,0,t-1)),l?n=In(Jr(e,s.axis,c).hi+1,o,t)-o:n=t-o,{start:o,count:n}}var Sy={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(i,e,t)=>{if(!t.enabled){oh(i);return}const o=i.width;i.data.datasets.forEach((n,s)=>{const{_data:a,indexAxis:c}=n,d=i.getDatasetMeta(s),l=a||n.data;if(sa([c,i.options.indexAxis])==="y"||!d.controller.supportsDecimation)return;const f=i.scales[d.xAxisID];if(f.type!=="linear"&&f.type!=="time"||i.options.parsing)return;let{start:p,count:m}=Ly(d,l);const _=t.threshold||4*o;if(m<=_){Tf(n);return}Pt(a)&&(n._data=l,delete n.data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(x){this._data=x}}));let b;switch(t.algorithm){case"lttb":b=wy(l,p,m,o,t);break;case"min-max":b=Cy(l,p,m,o);break;default:throw new Error(`Unsupported decimation algorithm '${t.algorithm}'`)}n._decimated=b})},destroy(i){oh(i)}};function My(i,e,t){const o=i.segments,n=i.points,s=e.points,a=[];for(const c of o){let{start:d,end:l}=c;l=zu(d,l,n);const f=yu(t,n[d],n[l],c.loop);if(!e.segments){a.push({source:c,target:f,start:n[d],end:n[l]});continue}const p=uf(e,f);for(const m of p){const _=yu(t,s[m.start],s[m.end],m.loop),b=lf(c,n,_);for(const x of b)a.push({source:x,target:m,start:{[t]:sh(f,_,"start",Math.max)},end:{[t]:sh(f,_,"end",Math.min)}})}}return a}function yu(i,e,t,o){if(o)return;let n=e[i],s=t[i];return i==="angle"&&(n=Ri(n),s=Ri(s)),{property:i,start:n,end:s}}function Ty(i,e){const{x:t=null,y:o=null}=i||{},n=e.points,s=[];return e.segments.forEach(({start:a,end:c})=>{c=zu(a,c,n);const d=n[a],l=n[c];o!==null?(s.push({x:d.x,y:o}),s.push({x:l.x,y:o})):t!==null&&(s.push({x:t,y:d.y}),s.push({x:t,y:l.y}))}),s}function zu(i,e,t){for(;e>i;e--){const o=t[e];if(!isNaN(o.x)&&!isNaN(o.y))break}return e}function sh(i,e,t,o){return i&&e?o(i[t],e[t]):i?i[t]:e?e[t]:0}function Pf(i,e){let t=[],o=!1;return Xt(i)?(o=!0,t=i):t=Ty(i,e),t.length?new bo({points:t,options:{tension:0},_loop:o,_fullLoop:o}):null}function ah(i){return i&&i.fill!==!1}function Py(i,e,t){let n=i[e].fill;const s=[e];let a;if(!t)return n;for(;n!==!1&&s.indexOf(n)===-1;){if(!ln(n))return n;if(a=i[n],!a)return!1;if(a.visible)return n;s.push(n),n=a.fill}return!1}function Ey(i,e,t){const o=Ry(i);if(wt(o))return isNaN(o.value)?!1:o;let n=parseFloat(o);return ln(n)&&Math.floor(n)===n?Ay(o[0],e,n,t):["origin","start","end","stack","shape"].indexOf(o)>=0&&o}function Ay(i,e,t,o){return(i==="-"||i==="+")&&(t=e+t),t===e||t<0||t>=o?!1:t}function Oy(i,e){let t=null;return i==="start"?t=e.bottom:i==="end"?t=e.top:wt(i)?t=e.getPixelForValue(i.value):e.getBasePixel&&(t=e.getBasePixel()),t}function ky(i,e,t){let o;return i==="start"?o=t:i==="end"?o=e.options.reverse?e.min:e.max:wt(i)?o=i.value:o=e.getBaseValue(),o}function Ry(i){const e=i.options,t=e.fill;let o=pt(t&&t.target,t);return o===void 0&&(o=!!e.backgroundColor),o===!1||o===null?!1:o===!0?"origin":o}function By(i){const{scale:e,index:t,line:o}=i,n=[],s=o.segments,a=o.points,c=Dy(e,t);c.push(Pf({x:null,y:e.bottom},o));for(let d=0;d<s.length;d++){const l=s[d];for(let f=l.start;f<=l.end;f++)Iy(n,a[f],c)}return new bo({points:n,options:{}})}function Dy(i,e){const t=[],o=i.getMatchingVisibleMetas("line");for(let n=0;n<o.length;n++){const s=o[n];if(s.index===e)break;s.hidden||t.unshift(s.dataset)}return t}function Iy(i,e,t){const o=[];for(let n=0;n<t.length;n++){const s=t[n],{first:a,last:c,point:d}=Fy(s,e,"x");if(!(!d||a&&c)){if(a)o.unshift(d);else if(i.push(d),!c)break}}i.push(...o)}function Fy(i,e,t){const o=i.interpolate(e,t);if(!o)return{};const n=o[t],s=i.segments,a=i.points;let c=!1,d=!1;for(let l=0;l<s.length;l++){const f=s[l],p=a[f.start][t],m=a[f.end][t];if(Qr(n,p,m)){c=n===p,d=n===m;break}}return{first:c,last:d,point:o}}class Ef{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,o){const{x:n,y:s,radius:a}=this;return t=t||{start:0,end:Qt},e.arc(n,s,a,t.end,t.start,!0),!o.bounds}interpolate(e){const{x:t,y:o,radius:n}=this,s=e.angle;return{x:t+Math.cos(s)*n,y:o+Math.sin(s)*n,angle:s}}}function Ny(i){const{chart:e,fill:t,line:o}=i;if(ln(t))return zy(e,t);if(t==="stack")return By(i);if(t==="shape")return!0;const n=jy(i);return n instanceof Ef?n:Pf(n,o)}function zy(i,e){const t=i.getDatasetMeta(e);return t&&i.isDatasetVisible(e)?t.dataset:null}function jy(i){return(i.scale||{}).getPointPositionForValue?Uy(i):Hy(i)}function Hy(i){const{scale:e={},fill:t}=i,o=Oy(t,e);if(ln(o)){const n=e.isHorizontal();return{x:n?o:null,y:n?null:o}}return null}function Uy(i){const{scale:e,fill:t}=i,o=e.options,n=e.getLabels().length,s=o.reverse?e.max:e.min,a=ky(t,e,s),c=[];if(o.grid.circular){const d=e.getPointPositionForValue(0,s);return new Ef({x:d.x,y:d.y,radius:e.getDistanceFromCenterForValue(a)})}for(let d=0;d<n;++d)c.push(e.getPointPositionForValue(d,a));return c}function ru(i,e,t){const o=Ny(e),{line:n,scale:s,axis:a}=e,c=n.options,d=c.fill,l=c.backgroundColor,{above:f=l,below:p=l}=d||{};o&&n.points.length&&(El(i,t),Wy(i,{line:n,target:o,above:f,below:p,area:t,scale:s,axis:a}),Al(i))}function Wy(i,e){const{line:t,target:o,above:n,below:s,area:a,scale:c}=e,d=t._loop?"angle":e.axis;i.save(),d==="x"&&s!==n&&(lh(i,o,a.top),uh(i,{line:t,target:o,color:n,scale:c,property:d}),i.restore(),i.save(),lh(i,o,a.bottom)),uh(i,{line:t,target:o,color:s,scale:c,property:d}),i.restore()}function lh(i,e,t){const{segments:o,points:n}=e;let s=!0,a=!1;i.beginPath();for(const c of o){const{start:d,end:l}=c,f=n[d],p=n[zu(d,l,n)];s?(i.moveTo(f.x,f.y),s=!1):(i.lineTo(f.x,t),i.lineTo(f.x,f.y)),a=!!e.pathSegment(i,c,{move:a}),a?i.closePath():i.lineTo(p.x,t)}i.lineTo(e.first().x,t),i.closePath(),i.clip()}function uh(i,e){const{line:t,target:o,property:n,color:s,scale:a}=e,c=My(t,o,n);for(const{source:d,target:l,start:f,end:p}of c){const{style:{backgroundColor:m=s}={}}=d,_=o!==!0;i.save(),i.fillStyle=m,Vy(i,a,_&&yu(n,f,p)),i.beginPath();const b=!!t.pathSegment(i,d);let x;if(_){b?i.closePath():ch(i,o,p,n);const A=!!o.pathSegment(i,l,{move:b,reverse:!0});x=b&&A,x||ch(i,o,f,n)}i.closePath(),i.fill(x?"evenodd":"nonzero"),i.restore()}}function Vy(i,e,t){const{top:o,bottom:n}=e.chart.chartArea,{property:s,start:a,end:c}=t||{};s==="x"&&(i.beginPath(),i.rect(a,o,c-a,n-o),i.clip())}function ch(i,e,t,o){const n=e.interpolate(t,o);n&&i.lineTo(n.x,n.y)}var Zy={id:"filler",afterDatasetsUpdate(i,e,t){const o=(i.data.datasets||[]).length,n=[];let s,a,c,d;for(a=0;a<o;++a)s=i.getDatasetMeta(a),c=s.dataset,d=null,c&&c.options&&c instanceof bo&&(d={visible:i.isDatasetVisible(a),index:a,fill:Ey(c,a,o),chart:i,axis:s.controller.options.indexAxis,scale:s.vScale,line:c}),s.$filler=d,n.push(d);for(a=0;a<o;++a)d=n[a],!(!d||d.fill===!1)&&(d.fill=Py(n,a,t.propagate))},beforeDraw(i,e,t){const o=t.drawTime==="beforeDraw",n=i.getSortedVisibleDatasetMetas(),s=i.chartArea;for(let a=n.length-1;a>=0;--a){const c=n[a].$filler;c&&(c.line.updateControlPoints(s,c.axis),o&&c.fill&&ru(i.ctx,c,s))}},beforeDatasetsDraw(i,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const o=i.getSortedVisibleDatasetMetas();for(let n=o.length-1;n>=0;--n){const s=o[n].$filler;ah(s)&&ru(i.ctx,s,i.chartArea)}},beforeDatasetDraw(i,e,t){const o=e.meta.$filler;!ah(o)||t.drawTime!=="beforeDatasetDraw"||ru(i.ctx,o,i.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const hh=(i,e)=>{let{boxHeight:t=e,boxWidth:o=e}=i;return i.usePointStyle&&(t=Math.min(t,e),o=i.pointStyleWidth||Math.min(o,e)),{boxWidth:o,boxHeight:t,itemHeight:Math.max(e,t)}},qy=(i,e)=>i!==null&&e!==null&&i.datasetIndex===e.datasetIndex&&i.index===e.index;class fh extends eo{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,o){this.maxWidth=e,this.maxHeight=t,this._margins=o,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Zt(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(o=>e.filter(o,this.chart.data))),e.sort&&(t=t.sort((o,n)=>e.sort(o,n,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const o=e.labels,n=Mn(o.font),s=n.size,a=this._computeTitleHeight(),{boxWidth:c,itemHeight:d}=hh(o,s);let l,f;t.font=n.string,this.isHorizontal()?(l=this.maxWidth,f=this._fitRows(a,s,c,d)+10):(f=this.maxHeight,l=this._fitCols(a,n,c,d)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(f,e.maxHeight||this.maxHeight)}_fitRows(e,t,o,n){const{ctx:s,maxWidth:a,options:{labels:{padding:c}}}=this,d=this.legendHitBoxes=[],l=this.lineWidths=[0],f=n+c;let p=e;s.textAlign="left",s.textBaseline="middle";let m=-1,_=-f;return this.legendItems.forEach((b,x)=>{const A=o+t/2+s.measureText(b.text).width;(x===0||l[l.length-1]+A+2*c>a)&&(p+=f,l[l.length-(x>0?0:1)]=0,_+=f,m++),d[x]={left:0,top:_,row:m,width:A,height:n},l[l.length-1]+=A+c}),p}_fitCols(e,t,o,n){const{ctx:s,maxHeight:a,options:{labels:{padding:c}}}=this,d=this.legendHitBoxes=[],l=this.columnSizes=[],f=a-e;let p=c,m=0,_=0,b=0,x=0;return this.legendItems.forEach((A,S)=>{const{itemWidth:E,itemHeight:F}=Gy(o,t,s,A,n);S>0&&_+F+2*c>f&&(p+=m+c,l.push({width:m,height:_}),b+=m+c,x++,m=_=0),d[S]={left:b,top:_,col:x,width:E,height:F},m=Math.max(m,E),_+=F+c}),p+=m,l.push({width:m,height:_}),p}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:o,labels:{padding:n},rtl:s}}=this,a=As(s,this.left,this.width);if(this.isHorizontal()){let c=0,d=ni(o,this.left+n,this.right-this.lineWidths[c]);for(const l of t)c!==l.row&&(c=l.row,d=ni(o,this.left+n,this.right-this.lineWidths[c])),l.top+=this.top+e+n,l.left=a.leftForLtr(a.x(d),l.width),d+=l.width+n}else{let c=0,d=ni(o,this.top+e+n,this.bottom-this.columnSizes[c].height);for(const l of t)l.col!==c&&(c=l.col,d=ni(o,this.top+e+n,this.bottom-this.columnSizes[c].height)),l.top=d,l.left+=this.left+n,l.left=a.leftForLtr(a.x(l.left),l.width),d+=l.height+n}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;El(e,this),this._draw(),Al(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:o,ctx:n}=this,{align:s,labels:a}=e,c=hn.color,d=As(e.rtl,this.left,this.width),l=Mn(a.font),{padding:f}=a,p=l.size,m=p/2;let _;this.drawTitle(),n.textAlign=d.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=l.string;const{boxWidth:b,boxHeight:x,itemHeight:A}=hh(a,p),S=function(G,$,Z){if(isNaN(b)||b<=0||isNaN(x)||x<0)return;n.save();const ie=pt(Z.lineWidth,1);if(n.fillStyle=pt(Z.fillStyle,c),n.lineCap=pt(Z.lineCap,"butt"),n.lineDashOffset=pt(Z.lineDashOffset,0),n.lineJoin=pt(Z.lineJoin,"miter"),n.lineWidth=ie,n.strokeStyle=pt(Z.strokeStyle,c),n.setLineDash(pt(Z.lineDash,[])),a.usePointStyle){const le={radius:x*Math.SQRT2/2,pointStyle:Z.pointStyle,rotation:Z.rotation,borderWidth:ie},X=d.xPlus(G,b/2),oe=$+m;Kh(n,le,X,oe,a.pointStyleWidth&&b)}else{const le=$+Math.max((p-x)/2,0),X=d.leftForLtr(G,b),oe=ss(Z.borderRadius);n.beginPath(),Object.values(oe).some(_e=>_e!==0)?Ca(n,{x:X,y:le,w:b,h:x,radius:oe}):n.rect(X,le,b,x),n.fill(),ie!==0&&n.stroke()}n.restore()},E=function(G,$,Z){us(n,Z.text,G,$+A/2,l,{strikethrough:Z.hidden,textAlign:d.textAlign(Z.textAlign)})},F=this.isHorizontal(),v=this._computeTitleHeight();F?_={x:ni(s,this.left+f,this.right-o[0]),y:this.top+f+v,line:0}:_={x:this.left+f,y:ni(s,this.top+v+f,this.bottom-t[0].height),line:0},of(this.ctx,e.textDirection);const P=A+f;this.legendItems.forEach((G,$)=>{n.strokeStyle=G.fontColor,n.fillStyle=G.fontColor;const Z=n.measureText(G.text).width,ie=d.textAlign(G.textAlign||(G.textAlign=a.textAlign)),le=b+m+Z;let X=_.x,oe=_.y;d.setWidth(this.width),F?$>0&&X+le+f>this.right&&(oe=_.y+=P,_.line++,X=_.x=ni(s,this.left+f,this.right-o[_.line])):$>0&&oe+P>this.bottom&&(X=_.x=X+t[_.line].width+f,_.line++,oe=_.y=ni(s,this.top+v+f,this.bottom-t[_.line].height));const _e=d.x(X);if(S(_e,oe,G),X=mg(ie,X+b+m,F?X+le:this.right,e.rtl),E(d.x(X),oe,G),F)_.x+=le+f;else if(typeof G.text!="string"){const Re=l.lineHeight;_.y+=Af(G,Re)}else _.y+=P}),sf(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,o=Mn(t.font),n=si(t.padding);if(!t.display)return;const s=As(e.rtl,this.left,this.width),a=this.ctx,c=t.position,d=o.size/2,l=n.top+d;let f,p=this.left,m=this.width;if(this.isHorizontal())m=Math.max(...this.lineWidths),f=this.top+l,p=ni(e.align,p,this.right-m);else{const b=this.columnSizes.reduce((x,A)=>Math.max(x,A.height),0);f=l+ni(e.align,this.top,this.bottom-b-e.labels.padding-this._computeTitleHeight())}const _=ni(c,p,p+m);a.textAlign=s.textAlign(ku(c)),a.textBaseline="middle",a.strokeStyle=t.color,a.fillStyle=t.color,a.font=o.string,us(a,t.text,_,f,o)}_computeTitleHeight(){const e=this.options.title,t=Mn(e.font),o=si(e.padding);return e.display?t.lineHeight+o.height:0}_getLegendItemAt(e,t){let o,n,s;if(Qr(e,this.left,this.right)&&Qr(t,this.top,this.bottom)){for(s=this.legendHitBoxes,o=0;o<s.length;++o)if(n=s[o],Qr(e,n.left,n.left+n.width)&&Qr(t,n.top,n.top+n.height))return this.legendItems[o]}return null}handleEvent(e){const t=this.options;if(!Xy(e.type,t))return;const o=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const n=this._hoveredItem,s=qy(n,o);n&&!s&&Zt(t.onLeave,[e,n,this],this),this._hoveredItem=o,o&&!s&&Zt(t.onHover,[e,o,this],this)}else o&&Zt(t.onClick,[e,o,this],this)}}function Gy(i,e,t,o,n){const s=Yy(o,i,e,t),a=Ky(n,o,e.lineHeight);return{itemWidth:s,itemHeight:a}}function Yy(i,e,t,o){let n=i.text;return n&&typeof n!="string"&&(n=n.reduce((s,a)=>s.length>a.length?s:a)),e+t.size/2+o.measureText(n).width}function Ky(i,e,t){let o=i;return typeof e.text!="string"&&(o=Af(e,t)),o}function Af(i,e){const t=i.text?i.text.length+.5:0;return e*t}function Xy(i,e){return!!((i==="mousemove"||i==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(i==="click"||i==="mouseup"))}var Qy={id:"legend",_element:fh,start(i,e,t){const o=i.legend=new fh({ctx:i.ctx,options:t,chart:i});oi.configure(i,o,t),oi.addBox(i,o)},stop(i){oi.removeBox(i,i.legend),delete i.legend},beforeUpdate(i,e,t){const o=i.legend;oi.configure(i,o,t),o.options=t},afterUpdate(i){const e=i.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(i,e){e.replay||i.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(i,e,t){const o=e.datasetIndex,n=t.chart;n.isDatasetVisible(o)?(n.hide(o),e.hidden=!0):(n.show(o),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:i=>i.chart.options.color,boxWidth:40,padding:10,generateLabels(i){const e=i.data.datasets,{labels:{usePointStyle:t,pointStyle:o,textAlign:n,color:s,useBorderRadius:a,borderRadius:c}}=i.legend.options;return i._getSortedDatasetMetas().map(d=>{const l=d.controller.getStyle(t?0:void 0),f=si(l.borderWidth);return{text:e[d.index].label,fillStyle:l.backgroundColor,fontColor:s,hidden:!d.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(f.width+f.height)/4,strokeStyle:l.borderColor,pointStyle:o||l.pointStyle,rotation:l.rotation,textAlign:n||l.textAlign,borderRadius:a&&(c||l.borderRadius),datasetIndex:d.index}},this)}},title:{color:i=>i.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:i=>!i.startsWith("on"),labels:{_scriptable:i=>!["generateLabels","filter","sort"].includes(i)}}};class ju extends eo{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const o=this.options;if(this.left=0,this.top=0,!o.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const n=Xt(o.text)?o.text.length:1;this._padding=si(o.padding);const s=n*Mn(o.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:o,bottom:n,right:s,options:a}=this,c=a.align;let d=0,l,f,p;return this.isHorizontal()?(f=ni(c,o,s),p=t+e,l=s-o):(a.position==="left"?(f=o+e,p=ni(c,n,t),d=Jt*-.5):(f=s-e,p=ni(c,t,n),d=Jt*.5),l=n-t),{titleX:f,titleY:p,maxWidth:l,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const o=Mn(t.font),s=o.lineHeight/2+this._padding.top,{titleX:a,titleY:c,maxWidth:d,rotation:l}=this._drawArgs(s);us(e,t.text,0,0,o,{color:t.color,maxWidth:d,rotation:l,textAlign:ku(t.align),textBaseline:"middle",translation:[a,c]})}}function Jy(i,e){const t=new ju({ctx:i.ctx,options:e,chart:i});oi.configure(i,t,e),oi.addBox(i,t),i.titleBlock=t}var $y={id:"title",_element:ju,start(i,e,t){Jy(i,t)},stop(i){const e=i.titleBlock;oi.removeBox(i,e),delete i.titleBlock},beforeUpdate(i,e,t){const o=i.titleBlock;oi.configure(i,o,t),o.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Qa=new WeakMap;var ev={id:"subtitle",start(i,e,t){const o=new ju({ctx:i.ctx,options:t,chart:i});oi.configure(i,o,t),oi.addBox(i,o),Qa.set(i,o)},stop(i){oi.removeBox(i,Qa.get(i)),Qa.delete(i)},beforeUpdate(i,e,t){const o=Qa.get(i);oi.configure(i,o,t),o.options=t},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const la={average(i){if(!i.length)return!1;let e,t,o=0,n=0,s=0;for(e=0,t=i.length;e<t;++e){const a=i[e].element;if(a&&a.hasValue()){const c=a.tooltipPosition();o+=c.x,n+=c.y,++s}}return{x:o/s,y:n/s}},nearest(i,e){if(!i.length)return!1;let t=e.x,o=e.y,n=Number.POSITIVE_INFINITY,s,a,c;for(s=0,a=i.length;s<a;++s){const d=i[s].element;if(d&&d.hasValue()){const l=d.getCenterPoint(),f=hu(e,l);f<n&&(n=f,c=d)}}if(c){const d=c.tooltipPosition();t=d.x,o=d.y}return{x:t,y:o}}};function wr(i,e){return e&&(Xt(e)?Array.prototype.push.apply(i,e):i.push(e)),i}function Kr(i){return(typeof i=="string"||i instanceof String)&&i.indexOf(`
`)>-1?i.split(`
`):i}function tv(i,e){const{element:t,datasetIndex:o,index:n}=e,s=i.getDatasetMeta(o).controller,{label:a,value:c}=s.getLabelAndValue(n);return{chart:i,label:a,parsed:s.getParsed(n),raw:i.data.datasets[o].data[n],formattedValue:c,dataset:s.getDataset(),dataIndex:n,datasetIndex:o,element:t}}function dh(i,e){const t=i.chart.ctx,{body:o,footer:n,title:s}=i,{boxWidth:a,boxHeight:c}=e,d=Mn(e.bodyFont),l=Mn(e.titleFont),f=Mn(e.footerFont),p=s.length,m=n.length,_=o.length,b=si(e.padding);let x=b.height,A=0,S=o.reduce((v,P)=>v+P.before.length+P.lines.length+P.after.length,0);if(S+=i.beforeBody.length+i.afterBody.length,p&&(x+=p*l.lineHeight+(p-1)*e.titleSpacing+e.titleMarginBottom),S){const v=e.displayColors?Math.max(c,d.lineHeight):d.lineHeight;x+=_*v+(S-_)*d.lineHeight+(S-1)*e.bodySpacing}m&&(x+=e.footerMarginTop+m*f.lineHeight+(m-1)*e.footerSpacing);let E=0;const F=function(v){A=Math.max(A,t.measureText(v).width+E)};return t.save(),t.font=l.string,jt(i.title,F),t.font=d.string,jt(i.beforeBody.concat(i.afterBody),F),E=e.displayColors?a+2+e.boxPadding:0,jt(o,v=>{jt(v.before,F),jt(v.lines,F),jt(v.after,F)}),E=0,t.font=f.string,jt(i.footer,F),t.restore(),A+=b.width,{width:A,height:x}}function nv(i,e){const{y:t,height:o}=e;return t<o/2?"top":t>i.height-o/2?"bottom":"center"}function iv(i,e,t,o){const{x:n,width:s}=o,a=t.caretSize+t.caretPadding;if(i==="left"&&n+s+a>e.width||i==="right"&&n-s-a<0)return!0}function rv(i,e,t,o){const{x:n,width:s}=t,{width:a,chartArea:{left:c,right:d}}=i;let l="center";return o==="center"?l=n<=(c+d)/2?"left":"right":n<=s/2?l="left":n>=a-s/2&&(l="right"),iv(l,i,e,t)&&(l="center"),l}function ph(i,e,t){const o=t.yAlign||e.yAlign||nv(i,t);return{xAlign:t.xAlign||e.xAlign||rv(i,e,t,o),yAlign:o}}function ov(i,e){let{x:t,width:o}=i;return e==="right"?t-=o:e==="center"&&(t-=o/2),t}function sv(i,e,t){let{y:o,height:n}=i;return e==="top"?o+=t:e==="bottom"?o-=n+t:o-=n/2,o}function gh(i,e,t,o){const{caretSize:n,caretPadding:s,cornerRadius:a}=i,{xAlign:c,yAlign:d}=t,l=n+s,{topLeft:f,topRight:p,bottomLeft:m,bottomRight:_}=ss(a);let b=ov(e,c);const x=sv(e,d,l);return d==="center"?c==="left"?b+=l:c==="right"&&(b-=l):c==="left"?b-=Math.max(f,m)+n:c==="right"&&(b+=Math.max(p,_)+n),{x:In(b,0,o.width-e.width),y:In(x,0,o.height-e.height)}}function Ja(i,e,t){const o=si(t.padding);return e==="center"?i.x+i.width/2:e==="right"?i.x+i.width-o.right:i.x+o.left}function mh(i){return wr([],Kr(i))}function av(i,e,t){return So(i,{tooltip:e,tooltipItems:t,type:"tooltip"})}function _h(i,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?i.override(t):i}const Of={beforeTitle:Gr,title(i){if(i.length>0){const e=i[0],t=e.chart.data.labels,o=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(o>0&&e.dataIndex<o)return t[e.dataIndex]}return""},afterTitle:Gr,beforeBody:Gr,beforeLabel:Gr,label(i){if(this&&this.options&&this.options.mode==="dataset")return i.label+": "+i.formattedValue||i.formattedValue;let e=i.dataset.label||"";e&&(e+=": ");const t=i.formattedValue;return Pt(t)||(e+=t),e},labelColor(i){const t=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(i){const t=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Gr,afterBody:Gr,beforeFooter:Gr,footer:Gr,afterFooter:Gr};function Ci(i,e,t,o){const n=i[e].call(t,o);return typeof n>"u"?Of[e].call(t,o):n}class vu extends eo{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,o=this.options.setContext(this.getContext()),n=o.enabled&&t.options.animation&&o.animations,s=new cf(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=av(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:o}=t,n=Ci(o,"beforeTitle",this,e),s=Ci(o,"title",this,e),a=Ci(o,"afterTitle",this,e);let c=[];return c=wr(c,Kr(n)),c=wr(c,Kr(s)),c=wr(c,Kr(a)),c}getBeforeBody(e,t){return mh(Ci(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:o}=t,n=[];return jt(e,s=>{const a={before:[],lines:[],after:[]},c=_h(o,s);wr(a.before,Kr(Ci(c,"beforeLabel",this,s))),wr(a.lines,Ci(c,"label",this,s)),wr(a.after,Kr(Ci(c,"afterLabel",this,s))),n.push(a)}),n}getAfterBody(e,t){return mh(Ci(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:o}=t,n=Ci(o,"beforeFooter",this,e),s=Ci(o,"footer",this,e),a=Ci(o,"afterFooter",this,e);let c=[];return c=wr(c,Kr(n)),c=wr(c,Kr(s)),c=wr(c,Kr(a)),c}_createItems(e){const t=this._active,o=this.chart.data,n=[],s=[],a=[];let c=[],d,l;for(d=0,l=t.length;d<l;++d)c.push(tv(this.chart,t[d]));return e.filter&&(c=c.filter((f,p,m)=>e.filter(f,p,m,o))),e.itemSort&&(c=c.sort((f,p)=>e.itemSort(f,p,o))),jt(c,f=>{const p=_h(e.callbacks,f);n.push(Ci(p,"labelColor",this,f)),s.push(Ci(p,"labelPointStyle",this,f)),a.push(Ci(p,"labelTextColor",this,f))}),this.labelColors=n,this.labelPointStyles=s,this.labelTextColors=a,this.dataPoints=c,c}update(e,t){const o=this.options.setContext(this.getContext()),n=this._active;let s,a=[];if(!n.length)this.opacity!==0&&(s={opacity:0});else{const c=la[o.position].call(this,n,this._eventPosition);a=this._createItems(o),this.title=this.getTitle(a,o),this.beforeBody=this.getBeforeBody(a,o),this.body=this.getBody(a,o),this.afterBody=this.getAfterBody(a,o),this.footer=this.getFooter(a,o);const d=this._size=dh(this,o),l=Object.assign({},c,d),f=ph(this.chart,o,l),p=gh(o,l,f,this.chart);this.xAlign=f.xAlign,this.yAlign=f.yAlign,s={opacity:1,x:p.x,y:p.y,width:d.width,height:d.height,caretX:c.x,caretY:c.y}}this._tooltipItems=a,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&o.external&&o.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,o,n){const s=this.getCaretPosition(e,o,n);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,o){const{xAlign:n,yAlign:s}=this,{caretSize:a,cornerRadius:c}=o,{topLeft:d,topRight:l,bottomLeft:f,bottomRight:p}=ss(c),{x:m,y:_}=e,{width:b,height:x}=t;let A,S,E,F,v,P;return s==="center"?(v=_+x/2,n==="left"?(A=m,S=A-a,F=v+a,P=v-a):(A=m+b,S=A+a,F=v-a,P=v+a),E=A):(n==="left"?S=m+Math.max(d,f)+a:n==="right"?S=m+b-Math.max(l,p)-a:S=this.caretX,s==="top"?(F=_,v=F-a,A=S-a,E=S+a):(F=_+x,v=F+a,A=S+a,E=S-a),P=F),{x1:A,x2:S,x3:E,y1:F,y2:v,y3:P}}drawTitle(e,t,o){const n=this.title,s=n.length;let a,c,d;if(s){const l=As(o.rtl,this.x,this.width);for(e.x=Ja(this,o.titleAlign,o),t.textAlign=l.textAlign(o.titleAlign),t.textBaseline="middle",a=Mn(o.titleFont),c=o.titleSpacing,t.fillStyle=o.titleColor,t.font=a.string,d=0;d<s;++d)t.fillText(n[d],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+c,d+1===s&&(e.y+=o.titleMarginBottom-c)}}_drawColorBox(e,t,o,n,s){const a=this.labelColors[o],c=this.labelPointStyles[o],{boxHeight:d,boxWidth:l,boxPadding:f}=s,p=Mn(s.bodyFont),m=Ja(this,"left",s),_=n.x(m),b=d<p.lineHeight?(p.lineHeight-d)/2:0,x=t.y+b;if(s.usePointStyle){const A={radius:Math.min(l,d)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},S=n.leftForLtr(_,l)+l/2,E=x+d/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,du(e,A,S,E),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,du(e,A,S,E)}else{e.lineWidth=wt(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const A=n.leftForLtr(_,l-f),S=n.leftForLtr(n.xPlus(_,1),l-f-2),E=ss(a.borderRadius);Object.values(E).some(F=>F!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,Ca(e,{x:A,y:x,w:l,h:d,radius:E}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),Ca(e,{x:S,y:x+1,w:l-2,h:d-2,radius:E}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(A,x,l,d),e.strokeRect(A,x,l,d),e.fillStyle=a.backgroundColor,e.fillRect(S,x+1,l-2,d-2))}e.fillStyle=this.labelTextColors[o]}drawBody(e,t,o){const{body:n}=this,{bodySpacing:s,bodyAlign:a,displayColors:c,boxHeight:d,boxWidth:l,boxPadding:f}=o,p=Mn(o.bodyFont);let m=p.lineHeight,_=0;const b=As(o.rtl,this.x,this.width),x=function(Z){t.fillText(Z,b.x(e.x+_),e.y+m/2),e.y+=m+s},A=b.textAlign(a);let S,E,F,v,P,G,$;for(t.textAlign=a,t.textBaseline="middle",t.font=p.string,e.x=Ja(this,A,o),t.fillStyle=o.bodyColor,jt(this.beforeBody,x),_=c&&A!=="right"?a==="center"?l/2+f:l+2+f:0,v=0,G=n.length;v<G;++v){for(S=n[v],E=this.labelTextColors[v],t.fillStyle=E,jt(S.before,x),F=S.lines,c&&F.length&&(this._drawColorBox(t,e,v,b,o),m=Math.max(p.lineHeight,d)),P=0,$=F.length;P<$;++P)x(F[P]),m=p.lineHeight;jt(S.after,x)}_=0,m=p.lineHeight,jt(this.afterBody,x),e.y-=s}drawFooter(e,t,o){const n=this.footer,s=n.length;let a,c;if(s){const d=As(o.rtl,this.x,this.width);for(e.x=Ja(this,o.footerAlign,o),e.y+=o.footerMarginTop,t.textAlign=d.textAlign(o.footerAlign),t.textBaseline="middle",a=Mn(o.footerFont),t.fillStyle=o.footerColor,t.font=a.string,c=0;c<s;++c)t.fillText(n[c],d.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+o.footerSpacing}}drawBackground(e,t,o,n){const{xAlign:s,yAlign:a}=this,{x:c,y:d}=e,{width:l,height:f}=o,{topLeft:p,topRight:m,bottomLeft:_,bottomRight:b}=ss(n.cornerRadius);t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.beginPath(),t.moveTo(c+p,d),a==="top"&&this.drawCaret(e,t,o,n),t.lineTo(c+l-m,d),t.quadraticCurveTo(c+l,d,c+l,d+m),a==="center"&&s==="right"&&this.drawCaret(e,t,o,n),t.lineTo(c+l,d+f-b),t.quadraticCurveTo(c+l,d+f,c+l-b,d+f),a==="bottom"&&this.drawCaret(e,t,o,n),t.lineTo(c+_,d+f),t.quadraticCurveTo(c,d+f,c,d+f-_),a==="center"&&s==="left"&&this.drawCaret(e,t,o,n),t.lineTo(c,d+p),t.quadraticCurveTo(c,d,c+p,d),t.closePath(),t.fill(),n.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,o=this.$animations,n=o&&o.x,s=o&&o.y;if(n||s){const a=la[e.position].call(this,this._active,this._eventPosition);if(!a)return;const c=this._size=dh(this,e),d=Object.assign({},a,this._size),l=ph(t,e,d),f=gh(e,d,l,t);(n._to!==f.x||s._to!==f.y)&&(this.xAlign=l.xAlign,this.yAlign=l.yAlign,this.width=c.width,this.height=c.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,f))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let o=this.opacity;if(!o)return;this._updateAnimationTarget(t);const n={width:this.width,height:this.height},s={x:this.x,y:this.y};o=Math.abs(o)<.001?0:o;const a=si(t.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&c&&(e.save(),e.globalAlpha=o,this.drawBackground(s,e,n,t),of(e,t.textDirection),s.y+=a.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),sf(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const o=this._active,n=e.map(({datasetIndex:c,index:d})=>{const l=this.chart.getDatasetMeta(c);if(!l)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:l.data[d],index:d}}),s=!ml(o,n),a=this._positionChanged(n,t);(s||a)&&(this._active=n,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,o=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,s=this._active||[],a=this._getActiveElements(e,s,t,o),c=this._positionChanged(a,e),d=t||!ml(a,s)||c;return d&&(this._active=a,(n.enabled||n.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),d}_getActiveElements(e,t,o,n){const s=this.options;if(e.type==="mouseout")return[];if(!n)return t;const a=this.chart.getElementsAtEventForMode(e,s.mode,s,o);return s.reverse&&a.reverse(),a}_positionChanged(e,t){const{caretX:o,caretY:n,options:s}=this,a=la[s.position].call(this,e,t);return a!==!1&&(o!==a.x||n!==a.y)}}Ie(vu,"positioners",la);var lv={id:"tooltip",_element:vu,positioners:la,afterInit(i,e,t){t&&(i.tooltip=new vu({chart:i,options:t}))},beforeUpdate(i,e,t){i.tooltip&&i.tooltip.initialize(t)},reset(i,e,t){i.tooltip&&i.tooltip.initialize(t)},afterDraw(i){const e=i.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(i.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(i.ctx),i.notifyPlugins("afterTooltipDraw",t)}},afterEvent(i,e){if(i.tooltip){const t=e.replay;i.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(i,e)=>e.bodyFont.size,boxWidth:(i,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Of},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:i=>i!=="filter"&&i!=="itemSort"&&i!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},uv=Object.freeze({__proto__:null,Colors:xy,Decimation:Sy,Filler:Zy,Legend:Qy,SubTitle:ev,Title:$y,Tooltip:lv});const cv=(i,e,t,o)=>(typeof e=="string"?(t=i.push(e)-1,o.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function hv(i,e,t,o){const n=i.indexOf(e);if(n===-1)return cv(i,e,t,o);const s=i.lastIndexOf(e);return n!==s?t:n}const fv=(i,e)=>i===null?null:In(Math.round(i),0,e);function yh(i){const e=this.getLabels();return i>=0&&i<e.length?e[i]:i}class bu extends hs{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const o=this.getLabels();for(const{index:n,label:s}of t)o[n]===s&&o.splice(n,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(Pt(e))return null;const o=this.getLabels();return t=isFinite(t)&&o[t]===e?t:hv(o,e,pt(t,e),this._addedLabels),fv(t,o.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:o,max:n}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(o=0),t||(n=this.getLabels().length-1)),this.min=o,this.max=n}buildTicks(){const e=this.min,t=this.max,o=this.options.offset,n=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(o?0:1),1),this._startValue=this.min-(o?.5:0);for(let a=e;a<=t;a++)n.push({value:a});return n}getLabelForValue(e){return yh.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Ie(bu,"id","category"),Ie(bu,"defaults",{ticks:{callback:yh}});function dv(i,e){const t=[],{bounds:n,step:s,min:a,max:c,precision:d,count:l,maxTicks:f,maxDigits:p,includeBounds:m}=i,_=s||1,b=f-1,{min:x,max:A}=e,S=!Pt(a),E=!Pt(c),F=!Pt(l),v=(A-x)/(p+1);let P=gc((A-x)/b/_)*_,G,$,Z,ie;if(P<1e-14&&!S&&!E)return[{value:x},{value:A}];ie=Math.ceil(A/P)-Math.floor(x/P),ie>b&&(P=gc(ie*P/b/_)*_),Pt(d)||(G=Math.pow(10,d),P=Math.ceil(P*G)/G),n==="ticks"?($=Math.floor(x/P)*P,Z=Math.ceil(A/P)*P):($=x,Z=A),S&&E&&s&&ug((c-a)/s,P/1e3)?(ie=Math.round(Math.min((c-a)/P,f)),P=(c-a)/ie,$=a,Z=c):F?($=S?a:$,Z=E?c:Z,ie=l-1,P=(Z-$)/ie):(ie=(Z-$)/P,da(ie,Math.round(ie),P/1e3)?ie=Math.round(ie):ie=Math.ceil(ie));const le=Math.max(mc(P),mc($));G=Math.pow(10,Pt(d)?le:d),$=Math.round($*G)/G,Z=Math.round(Z*G)/G;let X=0;for(S&&(m&&$!==a?(t.push({value:a}),$<a&&X++,da(Math.round(($+X*P)*G)/G,a,vh(a,v,i))&&X++):$<a&&X++);X<ie;++X)t.push({value:Math.round(($+X*P)*G)/G});return E&&m&&Z!==c?t.length&&da(t[t.length-1].value,c,vh(c,v,i))?t[t.length-1].value=c:t.push({value:c}):(!E||Z===c)&&t.push({value:Z}),t}function vh(i,e,{horizontal:t,minRotation:o}){const n=ir(o),s=(t?Math.sin(n):Math.cos(n))||.001,a=.75*e*(""+i).length;return Math.min(e/s,a)}class Ll extends hs{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return Pt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:o}=this.getUserBounds();let{min:n,max:s}=this;const a=d=>n=t?n:d,c=d=>s=o?s:d;if(e){const d=Lr(n),l=Lr(s);d<0&&l<0?c(0):d>0&&l>0&&a(0)}if(n===s){let d=s===0?1:Math.abs(s*.05);c(s+d),e||a(n-d)}this.min=n,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:o}=e,n;return o?(n=Math.ceil(this.max/o)-Math.floor(this.min/o)+1,n>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${o} would result generating up to ${n} ticks. Limiting to 1000.`),n=1e3)):(n=this.computeTickLimit(),t=t||11),t&&(n=Math.min(t,n)),n}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let o=this.getTickLimit();o=Math.max(2,o);const n={maxTicks:o,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,a=dv(n,s);return e.bounds==="ticks"&&zh(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let t=this.min,o=this.max;if(super.configure(),this.options.offset&&e.length){const n=(o-t)/Math.max(e.length-1,1)/2;t-=n,o+=n}this._startValue=t,this._endValue=o,this._valueRange=o-t}getLabelForValue(e){return Pa(e,this.chart.options.locale,this.options.ticks.format)}}class xu extends Ll{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=ln(e)?e:0,this.max=ln(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,o=ir(this.options.ticks.minRotation),n=(e?Math.sin(o):Math.cos(o))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/n))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Ie(xu,"id","linear"),Ie(xu,"defaults",{ticks:{callback:Pl.formatters.numeric}});const Sa=i=>Math.floor(vo(i)),es=(i,e)=>Math.pow(10,Sa(i)+e);function bh(i){return i/Math.pow(10,Sa(i))===1}function xh(i,e,t){const o=Math.pow(10,t),n=Math.floor(i/o);return Math.ceil(e/o)-n}function pv(i,e){const t=e-i;let o=Sa(t);for(;xh(i,e,o)>10;)o++;for(;xh(i,e,o)<10;)o--;return Math.min(o,Sa(i))}function gv(i,{min:e,max:t}){e=ki(i.min,e);const o=[],n=Sa(e);let s=pv(e,t),a=s<0?Math.pow(10,Math.abs(s)):1;const c=Math.pow(10,s),d=n>s?Math.pow(10,n):0,l=Math.round((e-d)*a)/a,f=Math.floor((e-d)/c/10)*c*10;let p=Math.floor((l-f)/Math.pow(10,s)),m=ki(i.min,Math.round((d+f+p*Math.pow(10,s))*a)/a);for(;m<t;)o.push({value:m,major:bh(m),significand:p}),p>=10?p=p<15?15:20:p++,p>=20&&(s++,p=2,a=s>=0?1:a),m=Math.round((d+f+p*Math.pow(10,s))*a)/a;const _=ki(i.max,m);return o.push({value:_,major:bh(_),significand:p}),o}class wu extends hs{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const o=Ll.prototype.parse.apply(this,[e,t]);if(o===0){this._zero=!0;return}return ln(o)&&o>0?o:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=ln(e)?Math.max(0,e):null,this.max=ln(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!ln(this._userMin)&&(this.min=e===es(this.min,0)?es(this.min,-1):es(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let o=this.min,n=this.max;const s=c=>o=e?o:c,a=c=>n=t?n:c;o===n&&(o<=0?(s(1),a(10)):(s(es(o,-1)),a(es(n,1)))),o<=0&&s(es(n,-1)),n<=0&&a(es(o,1)),this.min=o,this.max=n}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},o=gv(t,this);return e.bounds==="ticks"&&zh(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}getLabelForValue(e){return e===void 0?"0":Pa(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=vo(e),this._valueRange=vo(this.max)-vo(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(vo(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}Ie(wu,"id","logarithmic"),Ie(wu,"defaults",{ticks:{callback:Pl.formatters.logarithmic,major:{enabled:!0}}});function Cu(i){const e=i.ticks;if(e.display&&i.display){const t=si(e.backdropPadding);return pt(e.font&&e.font.size,hn.font.size)+t.height}return 0}function mv(i,e,t){return t=Xt(t)?t:[t],{w:Mg(i,e.string,t),h:t.length*e.lineHeight}}function wh(i,e,t,o,n){return i===o||i===n?{start:e-t/2,end:e+t/2}:i<o||i>n?{start:e-t,end:e}:{start:e,end:e+t}}function _v(i){const e={l:i.left+i._padding.left,r:i.right-i._padding.right,t:i.top+i._padding.top,b:i.bottom-i._padding.bottom},t=Object.assign({},e),o=[],n=[],s=i._pointLabels.length,a=i.options.pointLabels,c=a.centerPointLabels?Jt/s:0;for(let d=0;d<s;d++){const l=a.setContext(i.getPointLabelContext(d));n[d]=l.padding;const f=i.getPointPosition(d,i.drawingArea+n[d],c),p=Mn(l.font),m=mv(i.ctx,p,i._pointLabels[d]);o[d]=m;const _=Ri(i.getIndexAngle(d)+c),b=Math.round(Au(_)),x=wh(b,f.x,m.w,0,180),A=wh(b,f.y,m.h,90,270);yv(t,e,_,x,A)}i.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),i._pointLabelItems=vv(i,o,n)}function yv(i,e,t,o,n){const s=Math.abs(Math.sin(t)),a=Math.abs(Math.cos(t));let c=0,d=0;o.start<e.l?(c=(e.l-o.start)/s,i.l=Math.min(i.l,e.l-c)):o.end>e.r&&(c=(o.end-e.r)/s,i.r=Math.max(i.r,e.r+c)),n.start<e.t?(d=(e.t-n.start)/a,i.t=Math.min(i.t,e.t-d)):n.end>e.b&&(d=(n.end-e.b)/a,i.b=Math.max(i.b,e.b+d))}function vv(i,e,t){const o=[],n=i._pointLabels.length,s=i.options,a=Cu(s)/2,c=i.drawingArea,d=s.pointLabels.centerPointLabels?Jt/n:0;for(let l=0;l<n;l++){const f=i.getPointPosition(l,c+a+t[l],d),p=Math.round(Au(Ri(f.angle+un))),m=e[l],_=wv(f.y,m.h,p),b=bv(p),x=xv(f.x,m.w,b);o.push({x:f.x,y:_,textAlign:b,left:x,top:_,right:x+m.w,bottom:_+m.h})}return o}function bv(i){return i===0||i===180?"center":i<180?"left":"right"}function xv(i,e,t){return t==="right"?i-=e:t==="center"&&(i-=e/2),i}function wv(i,e,t){return t===90||t===270?i-=e/2:(t>270||t<90)&&(i-=e),i}function Cv(i,e){const{ctx:t,options:{pointLabels:o}}=i;for(let n=e-1;n>=0;n--){const s=o.setContext(i.getPointLabelContext(n)),a=Mn(s.font),{x:c,y:d,textAlign:l,left:f,top:p,right:m,bottom:_}=i._pointLabelItems[n],{backdropColor:b}=s;if(!Pt(b)){const x=ss(s.borderRadius),A=si(s.backdropPadding);t.fillStyle=b;const S=f-A.left,E=p-A.top,F=m-f+A.width,v=_-p+A.height;Object.values(x).some(P=>P!==0)?(t.beginPath(),Ca(t,{x:S,y:E,w:F,h:v,radius:x}),t.fill()):t.fillRect(S,E,F,v)}us(t,i._pointLabels[n],c,d+a.lineHeight/2,a,{color:s.color,textAlign:l,textBaseline:"middle"})}}function kf(i,e,t,o){const{ctx:n}=i;if(t)n.arc(i.xCenter,i.yCenter,e,0,Qt);else{let s=i.getPointPosition(0,e);n.moveTo(s.x,s.y);for(let a=1;a<o;a++)s=i.getPointPosition(a,e),n.lineTo(s.x,s.y)}}function Lv(i,e,t,o,n){const s=i.ctx,a=e.circular,{color:c,lineWidth:d}=e;!a&&!o||!c||!d||t<0||(s.save(),s.strokeStyle=c,s.lineWidth=d,s.setLineDash(n.dash),s.lineDashOffset=n.dashOffset,s.beginPath(),kf(i,t,a,o),s.closePath(),s.stroke(),s.restore())}function Sv(i,e,t){return So(i,{label:t,index:e,type:"pointLabel"})}class ua extends Ll{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=si(Cu(this.options)/2),t=this.width=this.maxWidth-e.width,o=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+o/2+e.top),this.drawingArea=Math.floor(Math.min(t,o)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=ln(e)&&!isNaN(e)?e:0,this.max=ln(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Cu(this.options))}generateTickLabels(e){Ll.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,o)=>{const n=Zt(this.options.pointLabels.callback,[t,o],this);return n||n===0?n:""}).filter((t,o)=>this.chart.getDataVisibility(o))}fit(){const e=this.options;e.display&&e.pointLabels.display?_v(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,o,n){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((o-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,o,n))}getIndexAngle(e){const t=Qt/(this._pointLabels.length||1),o=this.options.startAngle||0;return Ri(e*t+ir(o))}getDistanceFromCenterForValue(e){if(Pt(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(Pt(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const o=t[e];return Sv(this.getContext(),e,o)}}getPointPosition(e,t,o=0){const n=this.getIndexAngle(e)-un+o;return{x:Math.cos(n)*t+this.xCenter,y:Math.sin(n)*t+this.yCenter,angle:n}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:o,right:n,bottom:s}=this._pointLabelItems[e];return{left:t,top:o,right:n,bottom:s}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const o=this.ctx;o.save(),o.beginPath(),kf(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),o.closePath(),o.fillStyle=e,o.fill(),o.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:o,grid:n,border:s}=t,a=this._pointLabels.length;let c,d,l;if(t.pointLabels.display&&Cv(this,a),n.display&&this.ticks.forEach((f,p)=>{if(p!==0){d=this.getDistanceFromCenterForValue(f.value);const m=this.getContext(p),_=n.setContext(m),b=s.setContext(m);Lv(this,_,d,a,b)}}),o.display){for(e.save(),c=a-1;c>=0;c--){const f=o.setContext(this.getPointLabelContext(c)),{color:p,lineWidth:m}=f;!m||!p||(e.lineWidth=m,e.strokeStyle=p,e.setLineDash(f.borderDash),e.lineDashOffset=f.borderDashOffset,d=this.getDistanceFromCenterForValue(t.ticks.reverse?this.min:this.max),l=this.getPointPosition(c,d),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(l.x,l.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,o=t.ticks;if(!o.display)return;const n=this.getIndexAngle(0);let s,a;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(n),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((c,d)=>{if(d===0&&!t.reverse)return;const l=o.setContext(this.getContext(d)),f=Mn(l.font);if(s=this.getDistanceFromCenterForValue(this.ticks[d].value),l.showLabelBackdrop){e.font=f.string,a=e.measureText(c.label).width,e.fillStyle=l.backdropColor;const p=si(l.backdropPadding);e.fillRect(-a/2-p.left,-s-f.size/2-p.top,a+p.width,f.size+p.height)}us(e,c.label,0,-s,f,{color:l.color})}),e.restore()}drawTitle(){}}Ie(ua,"id","radialLinear"),Ie(ua,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Pl.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),Ie(ua,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Ie(ua,"descriptors",{angleLines:{_fallback:"grid"}});const kl={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Li=Object.keys(kl);function Mv(i,e){return i-e}function Ch(i,e){if(Pt(e))return null;const t=i._adapter,{parser:o,round:n,isoWeekday:s}=i._parseOpts;let a=e;return typeof o=="function"&&(a=o(a)),ln(a)||(a=typeof o=="string"?t.parse(a,o):t.parse(a)),a===null?null:(n&&(a=n==="week"&&(Os(s)||s===!0)?t.startOf(a,"isoWeek",s):t.startOf(a,n)),+a)}function Lh(i,e,t,o){const n=Li.length;for(let s=Li.indexOf(i);s<n-1;++s){const a=kl[Li[s]],c=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((t-e)/(c*a.size))<=o)return Li[s]}return Li[n-1]}function Tv(i,e,t,o,n){for(let s=Li.length-1;s>=Li.indexOf(t);s--){const a=Li[s];if(kl[a].common&&i._adapter.diff(n,o,a)>=e-1)return a}return Li[t?Li.indexOf(t):0]}function Pv(i){for(let e=Li.indexOf(i)+1,t=Li.length;e<t;++e)if(kl[Li[e]].common)return Li[e]}function Sh(i,e,t){if(!t)i[e]=!0;else if(t.length){const{lo:o,hi:n}=Ou(t,e),s=t[o]>=e?t[o]:t[n];i[s]=!0}}function Ev(i,e,t,o){const n=i._adapter,s=+n.startOf(e[0].value,o),a=e[e.length-1].value;let c,d;for(c=s;c<=a;c=+n.add(c,1,o))d=t[c],d>=0&&(e[d].major=!0);return e}function Mh(i,e,t){const o=[],n={},s=e.length;let a,c;for(a=0;a<s;++a)c=e[a],n[c]=a,o.push({value:c,major:!1});return s===0||!t?o:Ev(i,o,n,t)}class Ma extends hs{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const o=e.time||(e.time={}),n=this._adapter=new Um._date(e.adapters.date);n.init(t),fa(o.displayFormats,n.formats()),this._parseOpts={parser:o.parser,round:o.round,isoWeekday:o.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:Ch(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,o=e.time.unit||"day";let{min:n,max:s,minDefined:a,maxDefined:c}=this.getUserBounds();function d(l){!a&&!isNaN(l.min)&&(n=Math.min(n,l.min)),!c&&!isNaN(l.max)&&(s=Math.max(s,l.max))}(!a||!c)&&(d(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&d(this.getMinMax(!1))),n=ln(n)&&!isNaN(n)?n:+t.startOf(Date.now(),o),s=ln(s)&&!isNaN(s)?s:+t.endOf(Date.now(),o)+1,this.min=Math.min(n,s-1),this.max=Math.max(n+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],o=e[e.length-1]),{min:t,max:o}}buildTicks(){const e=this.options,t=e.time,o=e.ticks,n=o.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const s=this.min,a=this.max,c=dg(n,s,a);return this._unit=t.unit||(o.autoSkip?Lh(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):Tv(this,c.length,t.minUnit,this.min,this.max)),this._majorUnit=!o.major.enabled||this._unit==="year"?void 0:Pv(this._unit),this.initOffsets(n),e.reverse&&c.reverse(),Mh(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,o=0,n,s;this.options.offset&&e.length&&(n=this.getDecimalForValue(e[0]),e.length===1?t=1-n:t=(this.getDecimalForValue(e[1])-n)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?o=s:o=(s-this.getDecimalForValue(e[e.length-2]))/2);const a=e.length<3?.5:.25;t=In(t,0,a),o=In(o,0,a),this._offsets={start:t,end:o,factor:1/(t+1+o)}}_generate(){const e=this._adapter,t=this.min,o=this.max,n=this.options,s=n.time,a=s.unit||Lh(s.minUnit,t,o,this._getLabelCapacity(t)),c=pt(n.ticks.stepSize,1),d=a==="week"?s.isoWeekday:!1,l=Os(d)||d===!0,f={};let p=t,m,_;if(l&&(p=+e.startOf(p,"isoWeek",d)),p=+e.startOf(p,l?"day":a),e.diff(o,t,a)>1e5*c)throw new Error(t+" and "+o+" are too far apart with stepSize of "+c+" "+a);const b=n.ticks.source==="data"&&this.getDataTimestamps();for(m=p,_=0;m<o;m=+e.add(m,c,a),_++)Sh(f,m,b);return(m===o||n.bounds==="ticks"||_===1)&&Sh(f,m,b),Object.keys(f).sort((x,A)=>x-A).map(x=>+x)}getLabelForValue(e){const t=this._adapter,o=this.options.time;return o.tooltipFormat?t.format(e,o.tooltipFormat):t.format(e,o.displayFormats.datetime)}_tickFormatFunction(e,t,o,n){const s=this.options,a=s.ticks.callback;if(a)return Zt(a,[e,t,o],this);const c=s.time.displayFormats,d=this._unit,l=this._majorUnit,f=d&&c[d],p=l&&c[l],m=o[t],_=l&&p&&m&&m.major;return this._adapter.format(e,n||(_?p:f))}generateTickLabels(e){let t,o,n;for(t=0,o=e.length;t<o;++t)n=e[t],n.label=this._tickFormatFunction(n.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,o=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+o)*t.factor)}getValueForPixel(e){const t=this._offsets,o=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+o*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,o=this.ctx.measureText(e).width,n=ir(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(n),a=Math.sin(n),c=this._resolveTickFontOptions(0).size;return{w:o*s+c*a,h:o*a+c*s}}_getLabelCapacity(e){const t=this.options.time,o=t.displayFormats,n=o[t.unit]||o.millisecond,s=this._tickFormatFunction(e,0,Mh(this,[e],this._majorUnit),n),a=this._getLabelSize(s),c=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return c>0?c:1}getDataTimestamps(){let e=this._cache.data||[],t,o;if(e.length)return e;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(t=0,o=n.length;t<o;++t)e=e.concat(n[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,o;if(e.length)return e;const n=this.getLabels();for(t=0,o=n.length;t<o;++t)e.push(Ch(this,n[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Uh(e.sort(Mv))}}Ie(Ma,"id","time"),Ie(Ma,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function $a(i,e,t){let o=0,n=i.length-1,s,a,c,d;t?(e>=i[o].pos&&e<=i[n].pos&&({lo:o,hi:n}=Jr(i,"pos",e)),{pos:s,time:c}=i[o],{pos:a,time:d}=i[n]):(e>=i[o].time&&e<=i[n].time&&({lo:o,hi:n}=Jr(i,"time",e)),{time:s,pos:c}=i[o],{time:a,pos:d}=i[n]);const l=a-s;return l?c+(d-c)*(e-s)/l:c}class Lu extends Ma{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=$a(t,this.min),this._tableRange=$a(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:o}=this,n=[],s=[];let a,c,d,l,f;for(a=0,c=e.length;a<c;++a)l=e[a],l>=t&&l<=o&&n.push(l);if(n.length<2)return[{time:t,pos:0},{time:o,pos:1}];for(a=0,c=n.length;a<c;++a)f=n[a+1],d=n[a-1],l=n[a],Math.round((f+d)/2)!==l&&s.push({time:l,pos:a/(c-1)});return s}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),o=this.getLabelTimestamps();return t.length&&o.length?e=this.normalize(t.concat(o)):e=t.length?t:o,e=this._cache.all=e,e}getDecimalForValue(e){return($a(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,o=this.getDecimalForPixel(e)/t.factor-t.end;return $a(this._table,o*this._tableRange+this._minPos,!0)}}Ie(Lu,"id","timeseries"),Ie(Lu,"defaults",Ma.defaults);var Av=Object.freeze({__proto__:null,CategoryScale:bu,LinearScale:xu,LogarithmicScale:wu,RadialLinearScale:ua,TimeScale:Ma,TimeSeriesScale:Lu});const Rf=[Hm,my,uv,Av];function Ov(i){Bi.register(...Rf);const{getMap:e,getCartoClient:t,getPopup:o}=$r(Si),n=e(),s=t(),a=o(),c=new Wt.source.SQL(`WITH
          s AS (
              SELECT ROW_NUMBER() OVER(ORDER BY to_timestamp(created_date, 'MM/DD/YYYY') ASC) rownum, the_geom_webmercator, cartodb_id
              FROM open_restaurants_pre_filter_since_march q WHERE (
                (q.agency = 'NYPD' AND q.descriptor in ('Social Distancing', 'Face Covering Violation') AND q.location_type = 'Store/Commercial') OR
                (q.agency = 'DCA' AND q.descriptor = 'Sidewalk Cafe') OR
                (q.agency = 'DOT' AND q.complaint_type = 'Outdoor Dining')
            )),
          m AS (
              SELECT array_agg(cartodb_id ORDER BY rownum) id_list, the_geom_webmercator, ST_Y(the_geom_webmercator) y
              FROM s
              GROUP BY the_geom_webmercator
              ORDER BY y DESC),
          f AS (
              SELECT  generate_series(1, array_length(id_list,1)) p, unnest(id_list) cartodb_id, the_geom_webmercator
              FROM m)
          SELECT ST_Translate(f.the_geom_webmercator,0,f.p*3) the_geom_webmercator, f.cartodb_id, q.agency, q.complaint_type, q.descriptor, q.location_type, q.created_date, q.incident_address, q.intersection_street_1, q.intersection_street_2, q.location geometry
              FROM f, open_restaurants_pre_filter_since_march q
              WHERE f.cartodb_id = q.cartodb_id AND (
                (q.agency = 'NYPD' AND q.descriptor in ('Social Distancing', 'Face Covering Violation') AND q.location_type = 'Store/Commercial') OR
                (q.agency = 'DCA' AND q.descriptor = 'Sidewalk Cafe') OR
                (q.agency = 'DOT' AND q.complaint_type = 'Outdoor Dining')
            )
      `),d=new Wt.style.CartoCSS(`
            #layer {
                marker-fill: #4d88ee;
                marker-fill-opacity: 0.9;
                marker-allow-overlap: true;
                marker-line-width: 0.4;
                marker-line-color: #FFFFFF;
                marker-line-opacity: 1;
            }
            #layer[agency="NYPD"] {
                marker-fill: #7570b3;
            }
            #layer[agency="DCA"] {
                marker-fill: #d95f02;
            }
            #layer[agency="DOT"] {
                marker-fill: #1b9e77;
            }
            #layer [zoom > 16]{
                marker-width: 7;
            }
            #layer [zoom <= 16]{
                marker-width: 5;
            }
            #layer [zoom <= 15]{
                marker-width: 4;
            }
            #layer [zoom <= 14]{
                marker-width: 3;
            }
            #layer [zoom <= 12]{
                marker-width: 2;
            }
  
              `),l=new Wt.layer.Layer(c,d,{featureOverColumns:["geometry","incident_address","intersection_street_1","intersection_street_2","created_date","agency","descriptor","complaint_type"]});return s.addLayer(l).then(()=>{Sr.add({order:1,ref:l,label:"311 Complaints- Open Restaurants",notes:'*<a href="https://portal.311.nyc.gov/article/?kanumber=KA-03321" target="_blank">Filtered to social distancing and face coverings (NYPD), consumer complaints (DCA), and compliance (DOT)</a>',legend:[{image:"./images/circle-11-nypd.svg",text:"NYPD"},{image:"./images/circle-11-dca.svg",text:"DCA"},{image:"./images/circle-11-dot.svg",text:"DOT"}],checked:!0})}).catch(f=>console.log(f.message)),l.on("featureOver",f=>{let p="";p+='<div class="widget">',f.data.incident_address!=""?p+=`<p class = "bold">${f.data.incident_address}</p>`:p+=`<p class = "bold">${f.data.intersection_street_1}, ${f.data.intersection_street_2}</p>`,p+=`<p>Complaint Type: ${f.data.complaint_type}</p><p>Descriptor: ${f.data.descriptor}</p><p>Date: ${f.data.created_date}</p>`,a.setContent(p),a.setLatLng(f.latLng),a.isOpen()||a.openOn(n)}),l.on("featureClicked",f=>{let p="",m="",_={},b=[],x=[],A=[],S={},E=[],F=[],v=[];const[P,G]=f.data.geometry.match(/[-]?\d+(?:\.\d*)?/g),$=`https://betanyc.carto.com/api/v2/sql/?q=SELECT cartodb_id, descriptor, created_date, EXTRACT(month from to_date(created_date, 'MM/DD/YYYY')) AS created_month FROM open_restaurants_pre_filter_since_march q
            WHERE ST_Intersects(ST_Buffer(q.the_geom, 0.000005), ST_SetSRID(ST_Point(${G}, ${P}), 4326)) AND (
                (q.agency = 'NYPD' AND q.descriptor in ('Social Distancing', 'Face Covering Violation') AND q.location_type = 'Store/Commercial') OR
                (q.agency = 'DCA' AND q.descriptor = 'Sidewalk Cafe') OR
                (q.agency = 'DOT' AND q.complaint_type = 'Outdoor Dining')
            )&api_key=${Si}`;let Z=0;fetch($).then(function(ie){return ie.json()}).then(function(ie){Z=ie.rows.length,f.data.incident_address!=""?p+=`<h4 class = "bold">${f.data.incident_address}</h4>`:p+=`<h4 class = "bold">${f.data.intersection_street_1}, ${f.data.intersection_street_2}</h4>`,p+=`<div class="separator"></div><h5 class = "lighter">Total Number of Complaints around address point: ${Z}</h5>`;for(var le=0;le<Z;le++)_[ie.rows[le].descriptor]=1+(_[ie.rows[le].descriptor]||0);b=Object.keys(_),x=Object.values(_);for(var le=0;le<b.length;le++)A.push("#"+(Math.random().toString(16)+"0000000").slice(2,8));const X=document.createElement("canvas"),oe=X.getContext("2d");new Bi(oe,{type:"pie",data:{labels:b,datasets:[{backgroundColor:A,data:x}]},options:{title:{display:!0,text:"Complaints by Descriptor"},legend:{display:!0,labels:{fontSize:10},position:"right",onClick:null,fullWidth:!0}}});for(var le=0;le<Z;le++)S[ie.rows[le].created_month]=1+(S[ie.rows[le].created_month]||0);E=Object.keys(S),F=Object.values(S);for(var le=0;le<E.length;le++)v.push("#"+(Math.random().toString(16)+"0000000").slice(2,8));const _e=document.createElement("canvas"),Re=_e.getContext("2d"),Se={size:10};new Bi(Re,{type:"line",data:{labels:E,datasets:[{borderColor:"#4d88ee",data:F}]},options:{plugins:{title:{display:!0,text:"Complaints by Month"},legend:{display:!1}},scales:{y:{title:{text:"# of Complaints",display:!0,font:Se},beginAtZero:!0,ticks:{font:Se}},x:{title:{text:"Month",display:!0,font:Se},ticks:{font:Se}}}}}),m+=`<div class="separator"></div><h6>Source: <a href='https://data.cityofnewyork.us/Social-Services/311-Service-Requests-from-2010-to-Present/erm2-nwe9/data'>311 Service Requests from 2010 to Present</a></h6><h6>Data was filtered <a href="https://portal.311.nyc.gov/article/?kanumber=KA-03321" target="_blank">to social distancing and face coverings (NYPD), consumer complaints (DCA), and compliance (DOT)</a> compaints. Data is updated daily.</h6>`,cs.show({content:p,source:m,charts:[X,_e]})})}),s.getLeafletLayer().addTo(n),[]}class kv extends li{constructor(e){super(),ai(this,e,Ov,null,Vn,{})}}function Rv(i){Bi.register(...Rf);const{getMap:e,getCartoClient:t,getPopup:o}=$r(Si),n=e(),s=t(),a=o(),c=new Wt.source.SQL(`WITH
        s AS (
            SELECT ROW_NUMBER() OVER(ORDER BY to_timestamp(created_date, 'MM/DD/YYYY') ASC) rownum, the_geom_webmercator, cartodb_id
            FROM club_bar_restaurant_complaints_since_jan_1_2017 Q WHERE (q.created_date LIKE '%2020%' or q.created_date LIKE '%2019%')),
        m AS (
            SELECT array_agg(cartodb_id ORDER BY rownum) id_list, the_geom_webmercator, ST_Y(the_geom_webmercator) y
            FROM s
            GROUP BY the_geom_webmercator
            ORDER BY y DESC),
        f AS (
            SELECT  generate_series(1, array_length(id_list,1)) p, unnest(id_list) cartodb_id, the_geom_webmercator
            FROM m)
        SELECT  ST_Translate(f.the_geom_webmercator,0,f.p*3) the_geom_webmercator, f.cartodb_id, q.complaint_type, q.descriptor, q.created_date, q.incident_address, q.intersection_street_1, q.intersection_street_2, q.location geometry
            FROM f, club_bar_restaurant_complaints_since_jan_1_2017 q
            WHERE f.cartodb_id = q.cartodb_id AND (q.created_date LIKE '%2020%' or q.created_date LIKE '%2019%')
    `),d=new Wt.style.CartoCSS(`
  		#layer {
  			marker-fill: #4d88ee;
  			marker-fill-opacity: 0.9;
  			marker-allow-overlap: true;
  			marker-line-width: 0.25;
  			marker-line-color: #FFFFFF;
  			marker-line-opacity: 1;
  		}
  		#layer[complaint_type="Drinking"] {
  			marker-fill: #3622b9;
  		}
  		#layer[complaint_type="Noise - Commercial"] {
  			marker-fill: #4d88ee;
  		}
  		#layer [zoom > 16]{
  			marker-width: 7;
  		}
  		#layer [zoom <= 16]{
  		marker-width: 5;
  		}
  		#layer [zoom <= 15]{
  		marker-width: 4;
  		}
  		#layer [zoom <= 14]{
  		marker-width: 3;
  		}
  		#layer [zoom <= 12]{
  		marker-width: 2;
  		}

            `),l=new Wt.layer.Layer(c,d,{featureOverColumns:["geometry","incident_address","intersection_street_1","intersection_street_2","created_date","descriptor","complaint_type"]});return s.addLayer(l).then(()=>{Sr.add({order:2,ref:l,label:"311 Complaints - Noise/ Drinking",notes:"*Filtered to those made at club/bar/restaurant (Since January 1, 2019)",legend:[{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629210011circle-11.svg",text:"Noise"},{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629210053circle-11.svg",text:"Drinking"}],checked:!1})}).catch(f=>console.log(f.message)),l.on("featureOver",f=>{let p="";p+='<div class="widget">',f.data.incident_address!=""?p+=`<p class = "bold">${f.data.incident_address}</p>`:p+=`<p class = "bold">${f.data.intersection_street_1}, ${f.data.intersection_street_2}</p>`,p+=`<p>Complaint Type: ${f.data.complaint_type}</p><p>Descriptor: ${f.data.descriptor}</p><p>Date: ${f.data.created_date}</p>`,a.setContent(p),a.setLatLng(f.latLng),a.isOpen()||a.openOn(n)}),l.on("featureClicked",f=>{let p="",m="",_={},b=[],x=[],A=[],S={},E=[],F=[],v=[];const P=`https://betanyc.carto.com/api/v2/sql/?q=SELECT cartodb_id, descriptor, created_date, EXTRACT(year from to_date(created_date, 'MM/DD/YYYY')) AS created_year FROM club_bar_restaurant_complaints_since_jan_1_2017 WHERE location='${f.data.geometry}'&api_key=${Si}`;let G=0;fetch(P).then(function($){return $.json()}).then(function($){G=$.rows.length,f.data.incident_address!=""?p+=`<h4 class = "bold">${f.data.incident_address}</h4>`:p+=`<h4 class = "bold">${f.data.intersection_street_1}, ${f.data.intersection_street_2}</h4>`,p+=`<div class="separator"></div><h5 class = "lighter">Total Number of Complaints: ${G}</h5>`;for(var Z=0;Z<G;Z++)_[$.rows[Z].descriptor]=1+(_[$.rows[Z].descriptor]||0);b=Object.keys(_),x=Object.values(_);for(var Z=0;Z<b.length;Z++)A.push("#"+(Math.random().toString(16)+"0000000").slice(2,8));const ie=document.createElement("canvas"),le=ie.getContext("2d");new Bi(le,{type:"pie",data:{labels:b,datasets:[{backgroundColor:A,data:x}]},options:{title:{display:!0,text:"Complaints by Descriptor"},legend:{display:!0,labels:{fontSize:10},position:"right",onClick:null,fullWidth:!0}}});for(var Z=0;Z<G;Z++)S[$.rows[Z].created_year]=1+(S[$.rows[Z].created_year]||0);E=Object.keys(S),F=Object.values(S);for(var Z=0;Z<E.length;Z++)v.push("#"+(Math.random().toString(16)+"0000000").slice(2,8));const X=document.createElement("canvas"),oe=X.getContext("2d"),_e={size:10};new Bi(oe,{type:"line",data:{labels:E,datasets:[{borderColor:"#4d88ee",data:F}]},options:{plugins:{title:{display:!0,text:"Complaints by Year"},legend:{display:!1}},scales:{y:{title:{text:"# of Complaints",display:!0,font:_e},beginAtZero:!0,ticks:{font:_e}},x:{title:{text:"Year",display:!0,font:_e},ticks:{font:_e}}}}}),m+=`<div class="separator"></div><h6>Source: <a href='https://data.cityofnewyork.us/Social-Services/311-Service-Requests-from-2010-to-Present/erm2-nwe9/data'>311 Service Requests from 2010 to Present</a></h6><h6>Data was filtered to complaints at a club/restaurant/bar made since January 1, 2019. Data is updated daily.</h6>`,cs.show({content:p,source:m,charts:[ie,X]})})}),s.getLeafletLayer().addTo(n),[]}class Bv extends li{constructor(e){super(),ai(this,e,Rv,null,Vn,{})}}function Dv(i){const{getMap:e,getCartoClient:t,getPopup:o}=$r(Si),n=e(),s=t(),a=o(),c=new Wt.source.SQL(`WITH
  		m AS (
  			SELECT array_agg(cartodb_id) id_list, the_geom_webmercator, ST_Y(the_geom_webmercator) y
  			FROM table_6w5r_a6nw
  			GROUP BY the_geom_webmercator
  			ORDER BY y DESC),
  		f AS (
  			SELECT  generate_series(1, array_length(id_list,1)) p, unnest(id_list) cartodb_id, the_geom_webmercator
  			FROM m)
  		SELECT  ST_Translate(f.the_geom_webmercator,0,f.p*5) the_geom_webmercator, f.cartodb_id, q.camis, q.dba, q.building, q.street
  			FROM f, table_6w5r_a6nw q
  			WHERE f.cartodb_id = q.cartodb_id
            `),d=new Wt.style.CartoCSS(`
  		#layer{
  		marker-fill: #ff8300;
  		marker-fill-opacity: 0.9;
  		marker-file: url('https://s3.amazonaws.com/com.cartodb.users-assets.production/maki-icons/embassy-18.svg');
  		marker-allow-overlap: true;
  		marker-line-width: 1;
  		marker-line-color: #FFFFFF;
  		marker-line-opacity: 1;
  		}
  		#layer [zoom > 16]{
  			marker-width: 20;
  		}
  		#layer [zoom <= 16]{
  		marker-width: 15;
  		}
  		#layer [zoom <= 15]{
  		marker-width: 13;
  		}
  		#layer [zoom <= 14]{
  		marker-width: 8;
  		}
  		#layer [zoom <= 12]{
  		marker-width: 4;
  		}

                `),l=new Wt.layer.Layer(c,d,{featureOverColumns:["camis","dba","building","street"]});return s.addLayer(l).then(()=>{Sr.add({order:5,ref:l,label:"Restaurant Health Grades",legend:[{image:"https://s3.amazonaws.com/com.cartodb.users-assets.production/production/betanyc/assets/20180629205921embassy-15.svg",text:"Restaurant"}],checked:!1})}).catch(f=>console.log(f.message)),l.on("featureOver",f=>{let p="";p+='<div class="widget">',p+=`<p class = "bold">${f.data.building} ${f.data.street}</p><p>${f.data.dba}</p>`,a.setContent(p),a.setLatLng(f.latLng),a.isOpen()||a.openOn(n)}),l.on("featureClicked",f=>{let p="",m="";p+=`<h3 class = "bold">${f.data.dba}</h3><h4>${f.data.building} ${f.data.street}</h4><div class="separator"></div>`;var _=`https://betanyc.carto.com/api/v2/sql/?q=SELECT * FROM camis_grade_not_null WHERE camis='${f.data.camis}' ORDER BY to_timestamp(grade_date, 'MM/DD/YYYY') DESC&api_key=${Si}`;fetch(_).then(function(b){return b.json()}).then(function(b){b.rows.length!=0&&(p+=`
						<h5 class = "lighter">Most Recent Grade: ${b.rows[0].grade}</h5>
						<h5 class = "lighter">Grade Date: ${b.rows[0].grade_date}</h5>`),Array.prototype.groupBy=function(F){return this.reduce(function(v,P){const G=P[F];return v[G]=v[G]||[],v[G].push(P),v},{})};var x=b.rows.groupBy("grade_date");p+='<div class="separator"></div><h5 class = "bold">Grade History</h5>';for(var A=0;A<Object.keys(x).length;A++){var S=Object.keys(x)[A],E=Object.values(x)[A];S!=""&&(p+=`<h5 class = "lighter"> ${S}: ${E[0].grade}</h5>`)}f.data.camis?p+=`<h5><a href="https://a816-health.nyc.gov/ABCEatsRestaurants/#/Search/${f.data.camis}" target="_blank">Click here for more information about this restaurant.</h5> `:p+='<h5><a href="https://a816-health.nyc.gov/ABCEatsRestaurants/#/Search" target="_blank">Click here for more information about this restaurant.</h5> ',m+=`<div class="separator"></div><h6>Source: <a href='https://data.cityofnewyork.us/Health/DOHMH-New-York-City-Restaurant-Inspection-Results/43nn-pn8j/data'>DOHMH New York City Restaurant Inspection Results.</a></h6><h6>Data is geocoded with the Department of City Plannings GeoSupport application once a week. The map does not display restaurants with addresses rejected by the application. Data is updated weekly.</h6>`,cs.show({content:p,source:m,charts:[]})})}),s.getLeafletLayer().addTo(n),[]}class Iv extends li{constructor(e){super(),ai(this,e,Dv,null,Vn,{})}}function Fv(i){const{getMap:e,getCartoClient:t,getPopup:o}=$r(Si),n=e(),s=t(),a=o(),c=new Wt.source.SQL(`SELECT cartodb_id, the_geom_webmercator, address, bldgclass FROM bkmappluto WHERE bldgclass = 'W1' OR bldgclass = 'W2' OR bldgclass = 'W3' OR bldgclass = 'M1' OR bldgclass = 'M2' OR bldgclass = 'M3' OR bldgclass = 'M4' OR bldgclass = 'M9' UNION SELECT cartodb_id, the_geom_webmercator, address, bldgclass FROM bxmappluto WHERE bldgclass = 'W1' OR bldgclass = 'W2' OR bldgclass = 'W3' OR bldgclass = 'M1' OR bldgclass = 'M2' OR bldgclass = 'M3' OR bldgclass = 'M4' OR bldgclass = 'M9' UNION SELECT cartodb_id, the_geom_webmercator, address, bldgclass FROM mnmappluto WHERE bldgclass = 'W1' OR bldgclass = 'W2' OR bldgclass = 'W3' OR bldgclass = 'M1' OR bldgclass = 'M2' OR bldgclass = 'M3' OR bldgclass = 'M4' OR bldgclass = 'M9' UNION SELECT cartodb_id, the_geom_webmercator, address, bldgclass FROM simappluto WHERE bldgclass = 'W1' OR bldgclass = 'W2' OR bldgclass = 'W3' OR bldgclass = 'M1' OR bldgclass = 'M2' OR bldgclass = 'M3' OR bldgclass = 'M4' OR bldgclass = 'M9' UNION SELECT cartodb_id, the_geom_webmercator, address, bldgclass FROM qnmappluto WHERE bldgclass = 'W1' OR bldgclass = 'W2' OR bldgclass = 'W3' OR bldgclass = 'M1' OR bldgclass = 'M2' OR bldgclass = 'M3' OR bldgclass = 'M4' OR bldgclass = 'M9'
            `),d=new Wt.style.CartoCSS(`
					#layer{
						polygon-fill: #12eda4;
					}
				`),l=new Wt.layer.Layer(c,d,{featureOverColumns:["address","bldgclass"]});return s.addLayer(l).then(()=>{Sr.add({order:6,ref:l,label:"Show Schools and Churches",checked:!1,legend_html:'<div class="colored_square" style="background-color: #12eda4;"></div>'})}).catch(f=>console.log(f.message)),l.on("featureOver",f=>{let p="",m="";p+='<div class="widget">',f.data.bldgclass=="W1"?m="Public Elementary, Junior, or Senior High":f.data.bldgclass=="W2"?m="Parochial School, Yeshiva":f.data.bldgclass=="W3"?m="School or Academy":f.data.bldgclass=="M1"?m="Church, Synagogue, Chapel":f.data.bldgclass=="M2"?m="Mission House (non-residential)":f.data.bldgclass=="M3"?m="Parsonage, Rectory":f.data.bldgclass=="M4"?m="Convent":f.data.bldgclass=="M9"&&(m="Miscellaneous Religious Facility"),p+=`<p>Address: ${f.data.address}</p><p>DCP Building Class: ${m}</p>`,a.setContent(p),a.setLatLng(f.latLng),a.isOpen()||a.openOn(n)}),s.getLeafletLayer().addTo(n),[]}class Nv extends li{constructor(e){super(),ai(this,e,Fv,null,Vn,{})}}function zv(i){const{getMap:e,getCartoClient:t,getPopup:o}=$r(Si),n=e(),s=t();o();const a=new Wt.source.SQL("SELECT * FROM all_bounds WHERE id = 'cd' AND NOT namecol IN ('164','226','227','228','355','356','480','481','482')"),c=new Wt.style.CartoCSS(`
    #layer {
        polygon-fill: #fff;
        polygon-opacity: 0;
        text-name: [namecol];
        text-face-name: 'Lato Bold Italic';
        text-fill: #fff;
        text-halo-radius: 2.5;
        text-halo-fill: darken(#000000,20);
        text-allow-overlap: true;
    }
    #layer::outline {
        line-width: 2;
        line-color: #000000;
        line-opacity: 1;
    }
    #layer::outline [zoom <= 12]{
        marker-width: 1;
    }
    #layer[zoom > 12]{
        text-size: 11;
    }
    #layer[zoom <= 12]{
        text-size: 8;
    }
    #layer[zoom > 11]{
        text-size: 16;
        text-character-spacing: 2;
    }
    #layer[zoom <= 11]{
        text-size: 10;
        text-character-spacing: 1;
    }
    `),d=new Wt.layer.Layer(a,c);return s.addLayer(d).then(()=>{Sr.add({order:7,ref:d,label:"Show Community Districts",checked:!1,legend_html:'<hr class="colored_line" style="border-top-color:#000;">'})}).catch(l=>console.log(l.message)),s.getLeafletLayer().addTo(n),[]}class jv extends li{constructor(e){super(),ai(this,e,zv,null,Vn,{})}}function Hv(i){const{getMap:e,getCartoClient:t,getPopup:o}=$r(Si),n=e(),s=t();o();const a=new Wt.source.SQL("SELECT * FROM all_bounds WHERE id = 'cc'"),c=new Wt.style.CartoCSS(`
      #layer {
          polygon-fill: #fff;
          polygon-opacity: 0;
          text-name: [namecol];
          text-face-name: 'Lato Bold Italic';
          text-fill: #fff;
          text-halo-radius: 2.5;
          text-halo-fill: darken(#1212ed,20);
          text-allow-overlap: true;
      }
      #layer::outline {
          line-width: 2;
          line-color: #1212ed;
          line-opacity: 1;
      }
      #layer::outline [zoom <= 12]{
          marker-width: 1;
      }
      #layer[zoom > 12]{
          text-size: 11;
      }
      #layer[zoom <= 12]{
          text-size: 8;
      }
      #layer[zoom > 11]{
          text-size: 16;
          text-character-spacing: 2;
      }
      #layer[zoom <= 11]{
          text-size: 10;
          text-character-spacing: 1;
      }
      `),d=new Wt.layer.Layer(a,c);return s.addLayer(d).then(()=>{Sr.add({order:8,ref:d,label:"Show City Council Districts",checked:!1,legend_html:'<hr class="colored_line" style="border-top-color:#1212ed;">'})}).catch(l=>console.log(l.message)),s.getLeafletLayer().addTo(n),[]}class Uv extends li{constructor(e){super(),ai(this,e,Hv,null,Vn,{})}}function Th(i){let e,t,o,n,s,a,c,d,l,f,p,m,_,b,x,A,S,E;return e=new kv({}),o=new Ap({}),s=new Mp({}),c=new Pp({}),l=new Bv({}),p=new Iv({}),_=new Nv({}),x=new jv({}),S=new Uv({}),{c(){pi(e.$$.fragment),t=St(),pi(o.$$.fragment),n=St(),pi(s.$$.fragment),a=St(),pi(c.$$.fragment),d=St(),pi(l.$$.fragment),f=St(),pi(p.$$.fragment),m=St(),pi(_.$$.fragment),b=St(),pi(x.$$.fragment),A=St(),pi(S.$$.fragment)},m(F,v){ii(e,F,v),Kt(F,t,v),ii(o,F,v),Kt(F,n,v),ii(s,F,v),Kt(F,a,v),ii(c,F,v),Kt(F,d,v),ii(l,F,v),Kt(F,f,v),ii(p,F,v),Kt(F,m,v),ii(_,F,v),Kt(F,b,v),ii(x,F,v),Kt(F,A,v),ii(S,F,v),E=!0},i(F){E||(Vt(e.$$.fragment,F),Vt(o.$$.fragment,F),Vt(s.$$.fragment,F),Vt(c.$$.fragment,F),Vt(l.$$.fragment,F),Vt(p.$$.fragment,F),Vt(_.$$.fragment,F),Vt(x.$$.fragment,F),Vt(S.$$.fragment,F),E=!0)},o(F){en(e.$$.fragment,F),en(o.$$.fragment,F),en(s.$$.fragment,F),en(c.$$.fragment,F),en(l.$$.fragment,F),en(p.$$.fragment,F),en(_.$$.fragment,F),en(x.$$.fragment,F),en(S.$$.fragment,F),E=!1},d(F){ri(e,F),F&&qt(t),ri(o,F),F&&qt(n),ri(s,F),F&&qt(a),ri(c,F),F&&qt(d),ri(l,F),F&&qt(f),ri(p,F),F&&qt(m),ri(_,F),F&&qt(b),ri(x,F),F&&qt(A),ri(S,F)}}}function Wv(i){let e,t,o=i[1]&&Th();return{c(){e=yt("div"),o&&o.c(),ct(e,"id","map"),ct(e,"class","svelte-16jssmr")},m(n,s){Kt(n,e,s),o&&o.m(e,null),i[2](e),t=!0},p(n,[s]){n[1]?o?s&2&&Vt(o,1):(o=Th(),o.c(),Vt(o,1),o.m(e,null)):o&&(pl(),en(o,1,1,()=>{o=null}),gl())},i(n){t||(Vt(o),t=!0)},o(n){en(o),t=!1},d(n){n&&qt(e),o&&o.d(),i[2](null)}}}function Vv(i,e,t){let o,n,s,a;Xd(Si,{getMap:()=>s,getCartoClient:()=>n,getPopup:()=>a}),Kd(()=>{n=new Wt.Client({apiKey:Si,username:"betanyc"});const d=20;t(1,s=ha.map(o,{maxZoom:d}).setView([40.73,-74],18)),s.scrollWheelZoom.disable(),new Cp({keepCurrentZoomLevel:!0}).addTo(s).start(),a=ha.popup({closeButton:!1}),ha.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager/{z}/{x}/{y}{r}.png",{maxZoom:d}).addTo(s),Rh.set(s)});function c(d){dl[d?"unshift":"push"](()=>{o=d,t(0,o)})}return[o,s,c]}let Zv=class extends li{constructor(e){super(),ai(this,e,Vv,Wv,Vn,{})}};function qv(i){let e,t,o=i[1].content+"",n,s,a,c,d=i[1].source+"";return{c(){e=yt("div"),t=new $u(!1),n=St(),s=yt("div"),a=St(),c=new $u(!1),t.a=n,c.a=null,ct(e,"class","infobox svelte-lbk0yk")},m(l,f){Kt(l,e,f),t.m(o,e),$e(e,n),$e(e,s),i[2](s),$e(e,a),c.m(d,e)},p(l,[f]){f&2&&o!==(o=l[1].content+"")&&t.p(o),f&2&&d!==(d=l[1].source+"")&&c.p(d)},i:xn,o:xn,d(l){l&&qt(e),i[2](null)}}}function Gv(i,e,t){let o;Sl(i,cs,a=>t(1,o=a));let n;function s(a){dl[a?"unshift":"push"](()=>{n=a,t(0,n),t(1,o)})}return i.$$.update=()=>{i.$$.dirty&3&&n&&(t(0,n.innerHTML="",n),o.charts.forEach(a=>n.appendChild(a)))},[n,o,s]}class Yv extends li{constructor(e){super(),ai(this,e,Gv,qv,Vn,{})}}function Ph(i){let e,t,o,n,s,a,c;return n=new Yv({}),{c(){e=yt("div"),t=yt("span"),t.textContent="×",o=St(),pi(n.$$.fragment),ct(t,"class","close svelte-qj9d2u"),ct(e,"class","modal svelte-qj9d2u")},m(d,l){Kt(d,e,l),$e(e,t),$e(e,o),ii(n,e,null),s=!0,a||(c=is(t,"click",i[1]),a=!0)},p:xn,i(d){s||(Vt(n.$$.fragment,d),s=!0)},o(d){en(n.$$.fragment,d),s=!1},d(d){d&&qt(e),ri(n),a=!1,c()}}}function Kv(i){let e,t,o,n,s,a,c,d,l;n=new xp({}),c=new Zv({});let f=i[0]&&Ph(i);return{c(){e=yt("main"),t=yt("div"),o=yt("div"),pi(n.$$.fragment),s=St(),a=yt("div"),pi(c.$$.fragment),d=St(),f&&f.c(),ct(o,"class","left svelte-qj9d2u"),ct(a,"class","right svelte-qj9d2u"),ct(t,"class","panel svelte-qj9d2u"),ct(e,"class","svelte-qj9d2u")},m(p,m){Kt(p,e,m),$e(e,t),$e(t,o),ii(n,o,null),$e(t,s),$e(t,a),ii(c,a,null),$e(e,d),f&&f.m(e,null),l=!0},p(p,[m]){p[0]?f?(f.p(p,m),m&1&&Vt(f,1)):(f=Ph(p),f.c(),Vt(f,1),f.m(e,null)):f&&(pl(),en(f,1,1,()=>{f=null}),gl())},i(p){l||(Vt(n.$$.fragment,p),Vt(c.$$.fragment,p),Vt(f),l=!0)},o(p){en(n.$$.fragment,p),en(c.$$.fragment,p),en(f),l=!1},d(p){p&&qt(e),ri(n),ri(c),f&&f.d()}}}function Xv(i,e,t){let o;Sl(i,au,s=>t(0,o=s));function n(){au.set(!1)}return[o,n]}class Qv extends li{constructor(e){super(),ai(this,e,Xv,Kv,Vn,{})}}new Qv({target:document.body});
